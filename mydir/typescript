Script started on 2025-07-12 19:19:32+03:00 [TERM="xterm-256color" TTY="/dev/pts/1" COLUMNS="120" LINES="30"]
[?2004h]0;bezrukavnikov@vbox: ~/mydir[01;32mbezrukavnikov@vbox[00m:[01;34m~/mydir[00m$ run script 
[?2004lbash: run: command not found
[?2004h]0;bezrukavnikov@vbox: ~/mydir[01;32mbezrukavnikov@vbox[00m:[01;34m~/mydir[00m$ nan0 [K[Ko script 
[?2004l[?2004h[?1049h[22;0;0t[1;30r(B[m[4l[?7h[39;49m[?1h=[?1h=[?25l[39;49m(B[m[H[2J[28;54H(B[0;7m[ Reading... ](B[m[28;52H(B[0;7m[ Read 27 lines ](B[m[H(B[0;7m  GNU nano 7.2                                             script                                                       [1;119H(B[m[29d(B[0;7m^G(B[m Help[29;16H(B[0;7m^O(B[m Write Out   (B[0;7m^W(B[m Where Is    (B[0;7m^K(B[m Cut[29;61H(B[0;7m^T(B[m Execute     (B[0;7m^C(B[m Location    (B[0;7mM-U(B[m Undo[106G(B[0;7mM-A(B[m Set Mark[30d(B[0;7m^X(B[m Exit[30;16H(B[0;7m^R(B[m Read File   (B[0;7m^\(B[m Replace     (B[0;7m^U(B[m Paste[61G(B[0;7m^J(B[m Justify     (B[0;7m^/(B[m Go To Line  (B[0;7mM-E(B[m Redo[106G(B[0;7mM-6(B[m Copy[2d[36m#!/bin/bash[4d# Ð¢ÐµÐºÑƒÑ‰Ð°Ñ Ð´Ð°Ñ‚Ð° Ð¸ Ð²Ñ€ÐµÐ¼Ñ[5d(B[0;1m[34mecho[39m(B[m (B[0;1m[33m"===== Ð¡Ð˜Ð¡Ð¢Ð•ÐœÐÐ«Ð™ ÐœÐžÐÐ˜Ð¢ÐžÐ Ð˜ÐÐ“ ====="[6d[34mecho[39m(B[m (B[0;1m[33m"Ð”Ð°Ñ‚Ð°: $(date)"[8d(B[0m[36m# Ð¡Ð²Ð¾Ð±Ð¾Ð´Ð½Ð¾Ðµ Ð´Ð¸ÑÐºÐ¾Ð²Ð¾Ðµ Ð¿Ñ€Ð¾ÑÑ‚Ñ€Ð°Ð½ÑÑ‚Ð²Ð¾[9d(B[0;1m[34mecho[35m -e[39m(B[m (B[0;1m[33m"\nÐ¡Ð²Ð¾Ð±Ð¾Ð´Ð½Ð¾Ðµ Ð¼ÐµÑÑ‚Ð¾ Ð½Ð° Ð´Ð¸ÑÐºÐµ:"[10d[39m(B[mdf(B[0;1m[35m -h[39m(B[m /[12d[36m# Ð¡Ð²Ð¾Ð±Ð¾Ð´Ð½Ð°Ñ Ð¾Ð¿ÐµÑ€Ð°Ñ‚Ð¸Ð²Ð½Ð°Ñ Ð¿Ð°Ð¼ÑÑ‚ÑŒ[13d(B[0;1m[34mecho[35m -e[39m(B[m (B[0;1m[33m"\nÐ˜ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ð½Ð¸Ðµ Ð¾Ð¿ÐµÑ€Ð°Ñ‚Ð¸Ð²Ð½Ð¾Ð¹ Ð¿Ð°Ð¼ÑÑ‚Ð¸:"[14d[39m(B[mfree(B[0;1m[35m -h[15d(B[0m[36m#!/bin/bash[17d# Ð¢ÐµÐºÑƒÑ‰Ð°Ñ Ð´Ð°Ñ‚Ð° Ð¸ Ð²Ñ€ÐµÐ¼Ñ[18d(B[0;1m[34mecho[39m(B[m (B[0;1m[33m"===== Ð¡Ð˜Ð¡Ð¢Ð•ÐœÐÐ«Ð™ ÐœÐžÐÐ˜Ð¢ÐžÐ Ð˜ÐÐ“ ====="[19d[34mecho[39m(B[m (B[0;1m[33m"Ð”Ð°Ñ‚Ð°: $(date)"[21d(B[0m[36m# Ð¡Ð²Ð¾Ð±Ð¾Ð´Ð½Ð¾Ðµ Ð´Ð¸ÑÐºÐ¾Ð²Ð¾Ðµ Ð¿Ñ€Ð¾ÑÑ‚Ñ€Ð°Ð½ÑÑ‚Ð²Ð¾[22d(B[0;1m[34mecho[35m -e[39m(B[m (B[0;1m[33m"\nÐ¡Ð²Ð¾Ð±Ð¾Ð´Ð½Ð¾Ðµ Ð¼ÐµÑÑ‚Ð¾ Ð½Ð° Ð´Ð¸ÑÐºÐµ:"[23d[39m(B[mdf(B[0;1m[35m -h[39m(B[m /[25d[36m# Ð¡Ð²Ð¾Ð±Ð¾Ð´Ð½Ð°Ñ Ð¾Ð¿ÐµÑ€Ð°Ñ‚Ð¸Ð²Ð½Ð°Ñ Ð¿Ð°Ð¼ÑÑ‚ÑŒ[26d(B[0;1m[34mecho[35m -e[39m(B[m (B[0;1m[33m"\nÐ˜ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ð½Ð¸Ðµ Ð¾Ð¿ÐµÑ€Ð°Ñ‚Ð¸Ð²Ð½Ð¾Ð¹ Ð¿Ð°Ð¼ÑÑ‚Ð¸:"[27d[39m(B[mfree(B[0;1m[35m -h[2d[39m(B[m[?12l[?25h[?25l[28d[J[30d[?12l[?25h[30;1H[?1049l[23;0;0t[?1l>[?2004l[?2004h]0;bezrukavnikov@vbox: ~/mydir[01;32mbezrukavnikov@vbox[00m:[01;34m~/mydir[00m$ 
[?2004l[?2004h]0;bezrukavnikov@vbox: ~/mydir[01;32mbezrukavnikov@vbox[00m:[01;34m~/mydir[00m$ nano script 
[?2004l[?2004h[?1049h[22;0;0t[1;30r(B[m[4l[?7h[39;49m[?1h=[?1h=[?25l[39;49m(B[m[H[2J[28;54H(B[0;7m[ Reading... ](B[m[28;52H(B[0;7m[ Read 27 lines ](B[m[H(B[0;7m  GNU nano 7.2                                             script                                                       [1;119H(B[m[29d(B[0;7m^G(B[m Help[29;16H(B[0;7m^O(B[m Write Out   (B[0;7m^W(B[m Where Is    (B[0;7m^K(B[m Cut[29;61H(B[0;7m^T(B[m Execute     (B[0;7m^C(B[m Location    (B[0;7mM-U(B[m Undo[106G(B[0;7mM-A(B[m Set Mark[30d(B[0;7m^X(B[m Exit[30;16H(B[0;7m^R(B[m Read File   (B[0;7m^\(B[m Replace     (B[0;7m^U(B[m Paste[61G(B[0;7m^J(B[m Justify     (B[0;7m^/(B[m Go To Line  (B[0;7mM-E(B[m Redo[106G(B[0;7mM-6(B[m Copy[2d[36m#!/bin/bash[4d# Ð¢ÐµÐºÑƒÑ‰Ð°Ñ Ð´Ð°Ñ‚Ð° Ð¸ Ð²Ñ€ÐµÐ¼Ñ[5d(B[0;1m[34mecho[39m(B[m (B[0;1m[33m"===== Ð¡Ð˜Ð¡Ð¢Ð•ÐœÐÐ«Ð™ ÐœÐžÐÐ˜Ð¢ÐžÐ Ð˜ÐÐ“ ====="[6d[34mecho[39m(B[m (B[0;1m[33m"Ð”Ð°Ñ‚Ð°: $(date)"[8d(B[0m[36m# Ð¡Ð²Ð¾Ð±Ð¾Ð´Ð½Ð¾Ðµ Ð´Ð¸ÑÐºÐ¾Ð²Ð¾Ðµ Ð¿Ñ€Ð¾ÑÑ‚Ñ€Ð°Ð½ÑÑ‚Ð²Ð¾[9d(B[0;1m[34mecho[35m -e[39m(B[m (B[0;1m[33m"\nÐ¡Ð²Ð¾Ð±Ð¾Ð´Ð½Ð¾Ðµ Ð¼ÐµÑÑ‚Ð¾ Ð½Ð° Ð´Ð¸ÑÐºÐµ:"[10d[39m(B[mdf(B[0;1m[35m -h[39m(B[m /[12d[36m# Ð¡Ð²Ð¾Ð±Ð¾Ð´Ð½Ð°Ñ Ð¾Ð¿ÐµÑ€Ð°Ñ‚Ð¸Ð²Ð½Ð°Ñ Ð¿Ð°Ð¼ÑÑ‚ÑŒ[13d(B[0;1m[34mecho[35m -e[39m(B[m (B[0;1m[33m"\nÐ˜ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ð½Ð¸Ðµ Ð¾Ð¿ÐµÑ€Ð°Ñ‚Ð¸Ð²Ð½Ð¾Ð¹ Ð¿Ð°Ð¼ÑÑ‚Ð¸:"[14d[39m(B[mfree(B[0;1m[35m -h[15d(B[0m[36m#!/bin/bash[17d# Ð¢ÐµÐºÑƒÑ‰Ð°Ñ Ð´Ð°Ñ‚Ð° Ð¸ Ð²Ñ€ÐµÐ¼Ñ[18d(B[0;1m[34mecho[39m(B[m (B[0;1m[33m"===== Ð¡Ð˜Ð¡Ð¢Ð•ÐœÐÐ«Ð™ ÐœÐžÐÐ˜Ð¢ÐžÐ Ð˜ÐÐ“ ====="[19d[34mecho[39m(B[m (B[0;1m[33m"Ð”Ð°Ñ‚Ð°: $(date)"[21d(B[0m[36m# Ð¡Ð²Ð¾Ð±Ð¾Ð´Ð½Ð¾Ðµ Ð´Ð¸ÑÐºÐ¾Ð²Ð¾Ðµ Ð¿Ñ€Ð¾ÑÑ‚Ñ€Ð°Ð½ÑÑ‚Ð²Ð¾[22d(B[0;1m[34mecho[35m -e[39m(B[m (B[0;1m[33m"\nÐ¡Ð²Ð¾Ð±Ð¾Ð´Ð½Ð¾Ðµ Ð¼ÐµÑÑ‚Ð¾ Ð½Ð° Ð´Ð¸ÑÐºÐµ:"[23d[39m(B[mdf(B[0;1m[35m -h[39m(B[m /[25d[36m# Ð¡Ð²Ð¾Ð±Ð¾Ð´Ð½Ð°Ñ Ð¾Ð¿ÐµÑ€Ð°Ñ‚Ð¸Ð²Ð½Ð°Ñ Ð¿Ð°Ð¼ÑÑ‚ÑŒ[26d(B[0;1m[34mecho[35m -e[39m(B[m (B[0;1m[33m"\nÐ˜ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ð½Ð¸Ðµ Ð¾Ð¿ÐµÑ€Ð°Ñ‚Ð¸Ð²Ð½Ð¾Ð¹ Ð¿Ð°Ð¼ÑÑ‚Ð¸:"[27d[39m(B[mfree(B[0;1m[35m -h[2d[39m(B[m[?12l[?25h[?25l[1;67H(B[0;7m*[119G(B[m[?12l[?25h[2d[36m #!/bin/bash [39m(B[m[?25l[?12l[?25h[1P[?25l[?12l[?25h[C[?25l[?12l[?25h[C[?25l[?12l[?25h[C[?25l[?12l[?25h[3d[?25l[?12l[?25h[4;4H[?25l[?12l[?25h[5d[?25l[?12l[?25h[6d[?25l[?12l[?25h[7d[?25l[?12l[?25h[8;4H[?25l[?12l[?25h[9d[?25l[?12l[?25h[10d[?25l[?12l[?25h[11d[?25l[?12l[?25h[12;4H[?25l[?12l[?25h[13d[?25l[?12l[?25h[14d[?25l[?12l[?25h[15d[?25l[28d[K[?12l[?25h[17;4H[?25l[?12l[?25h[18d[?25l[?12l[?25h[19d[?25l[?12l[?25h[20d[?25l[?12l[?25h[21;4H[?25l[?12l[?25h[22d[?25l[?12l[?25h[23d[?25l[?12l[?25h[24d[?25l[?12l[?25h[25;4H[?25l[?12l[?25h[26d[?25l[?12l[?25h[27d[?25l[?12l[?25h[2d[K[3d[36m# Ð¢ÐµÐºÑƒÑ‰Ð°Ñ Ð´Ð°Ñ‚Ð° Ð¸ Ð²Ñ€ÐµÐ¼Ñ[4d(B[0;1m[34mecho[39m(B[m (B[0;1m[33m"===== Ð¡Ð˜Ð¡Ð¢Ð•ÐœÐÐ«Ð™ ÐœÐžÐÐ˜Ð¢ÐžÐ Ð˜ÐÐ“ ====="[5;7HÐ”Ð°Ñ‚Ð°: $(date)"[39m(B[m[K[6d[K[7d[36m# Ð¡Ð²Ð¾Ð±Ð¾Ð´Ð½Ð¾Ðµ Ð´Ð¸ÑÐºÐ¾Ð²Ð¾Ðµ Ð¿Ñ€Ð¾ÑÑ‚Ñ€Ð°Ð½ÑÑ‚Ð²Ð¾[8d(B[0;1m[34mecho[35m -e[39m(B[m (B[0;1m[33m"\nÐ¡Ð²Ð¾Ð±Ð¾Ð´Ð½Ð¾Ðµ Ð¼ÐµÑÑ‚Ð¾ Ð½Ð° Ð´Ð¸ÑÐºÐµ:"[9d[39m(B[mdf(B[0;1m[35m -h[39m(B[m /[K[10d[K[11d[36m# Ð¡Ð²Ð¾Ð±Ð¾Ð´Ð½Ð°Ñ Ð¾Ð¿ÐµÑ€Ð°Ñ‚Ð¸Ð²Ð½Ð°Ñ Ð¿Ð°Ð¼ÑÑ‚ÑŒ[12d(B[0;1m[34mecho[35m -e[39m(B[m (B[0;1m[33m"\nÐ˜ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ð½Ð¸Ðµ Ð¾Ð¿ÐµÑ€Ð°Ñ‚Ð¸Ð²Ð½Ð¾Ð¹ Ð¿Ð°Ð¼ÑÑ‚Ð¸:"[13d[39m(B[mfree(B[0;1m[35m -h[39m(B[m[K[14d[36m#!/bin/bash[15d[39m(B[m[K[16d[36m# Ð¢ÐµÐºÑƒÑ‰Ð°Ñ Ð´Ð°Ñ‚Ð° Ð¸ Ð²Ñ€ÐµÐ¼Ñ[17d(B[0;1m[34mecho[39m(B[m (B[0;1m[33m"===== Ð¡Ð˜Ð¡Ð¢Ð•ÐœÐÐ«Ð™ ÐœÐžÐÐ˜Ð¢ÐžÐ Ð˜ÐÐ“ ====="[18;7HÐ”Ð°Ñ‚Ð°: $(date)"[39m(B[m[K[19d[K[20d[36m# Ð¡Ð²Ð¾Ð±Ð¾Ð´Ð½Ð¾Ðµ Ð´Ð¸ÑÐºÐ¾Ð²Ð¾Ðµ Ð¿Ñ€Ð¾ÑÑ‚Ñ€Ð°Ð½ÑÑ‚Ð²Ð¾[21d(B[0;1m[34mecho[35m -e[39m(B[m (B[0;1m[33m"\nÐ¡Ð²Ð¾Ð±Ð¾Ð´Ð½Ð¾Ðµ Ð¼ÐµÑÑ‚Ð¾ Ð½Ð° Ð´Ð¸ÑÐºÐµ:"[22d[39m(B[mdf(B[0;1m[35m -h[39m(B[m /[K[23d[K[24d[36m# Ð¡Ð²Ð¾Ð±Ð¾Ð´Ð½Ð°Ñ Ð¾Ð¿ÐµÑ€Ð°Ñ‚Ð¸Ð²Ð½Ð°Ñ Ð¿Ð°Ð¼ÑÑ‚ÑŒ[25d(B[0;1m[34mecho[35m -e[39m(B[m (B[0;1m[33m"\nÐ˜ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ð½Ð¸Ðµ Ð¾Ð¿ÐµÑ€Ð°Ñ‚Ð¸Ð²Ð½Ð¾Ð¹ Ð¿Ð°Ð¼ÑÑ‚Ð¸:"[26d[39m(B[mfree(B[0;1m[35m -h[39m(B[m[K[27d[K[?25l[?12l[?25h7[2;28r8[28d
[1;30r[27;1H[?25l[A[?12l[?25h[?25l[?12l[?25h[25;8H[?25l[?12l[?25h -[K[?25l[?12l[?25h[42m [49m(B[m[K[?25l[?12l[?25h [?25l[?12l[?25h [?25l[?12l[?25h [?25l[?12l[?25h [?25l[?12l[?25h[K[?25l[24;46H[?12l[?25h[?25l[?12l[?25h[24;9H"[32m\[39m(B[mnÐ˜ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ð½Ð¸Ðµ Ð¾Ð¿ÐµÑ€Ð°Ñ‚Ð¸Ð²Ð½Ð¾Ð¹ Ð¿Ð°Ð¼ÑÑ‚Ð¸[32m:[39m(B[m[K[?25l[?12l[?25h [?25l[?12l[?25h [?25l[?12l[?25h [?25l[?12l[?25h [?25l[?12l[?25h[K[?25l[?12l[?25h[42m [49m(B[m[K[?25l[?12l[?25h [?25l[?12l[?25h [?25l[?12l[?25h [?25l[?12l[?25h [?25l[?12l[?25h [?25l[?12l[?25h [?25l[?12l[?25h [?25l[?12l[?25h [?25l[?12l[?25h [?25l[?12l[?25h [?25l[?12l[?25h [?25l[?12l[?25h[42m [49m(B[m[K[?25l[?12l[?25h [?25l[?12l[?25h [?25l[?12l[?25h [?25l[?12l[?25h [?25l[?12l[?25h [?25l[?12l[?25h [?25l[?12l[?25h [?25l[?12l[?25h [?25l[?12l[?25h [?25l[?12l[?25h [?25l[?12l[?25h [?25l[?12l[?25h [?25l[?12l[?25h [?25l[?12l[?25h [?25l[?12l[?25h [?25l[?12l[?25h [?25l[?12l[?25h[42m [49m(B[m[K[?25l[?12l[?25h [?25l[?12l[?25h -[K[?25l[?12l[?25h[42m [49m(B[m[K[?25l[?12l[?25h [?25l[?12l[?25hech[K[?25l[?12l[?25h [?25l[?12l[?25h [?25l[?12l[?25h[K[?25l[23;31H[?12l[?25h[?25l[?12l[?25h [?25l[?12l[?25h [?25l[?12l[?25h [?25l[?12l[?25h [?25l[?12l[?25h [?25l[?12l[?25h[42m [49m(B[m[K[?25l[?12l[?25h [?25l[?12l[?25h [?25l[?12l[?25h [?25l[?12l[?25h [?25l[?12l[?25h [?25l[?12l[?25h [?25l[?12l[?25h [?25l[?12l[?25h [?25l[?12l[?25h[K[?25l[?12l[?25h [?25l[?12l[?25h[42m [49m(B[m[K[?25l[?12l[?25h [?25l[?12l[?25h [?25l[?12l[?25h [?25l[?12l[?25h [?25l[?12l[?25h [?25l[?12l[?25h [?25l[?12l[?25h [?25l[?12l[?25h [?25l[?12l[?25h [?25l[?12l[?25h[42m [49m(B[m[K[?25l[?12l[?25h [?25l[?12l[?25h[K[?25l[A[?12l[?25h[?25l[21;8H[?12l[?25h[?25l[?12l[?25h[42m [49m(B[m[K[?25l[?12l[?25hdf -[K[?25l[?12l[?25h[42m [49m(B[m[K[?25l[?12l[?25h [?25l[?12l[?25h [?25l[?12l[?25h[K[?25l[20;38H[?12l[?25h[?25l[?12l[?25h[20;9H"[32m\[39m(B[mnÐ¡Ð²Ð¾Ð±Ð¾Ð´Ð½Ð¾Ðµ Ð¼ÐµÑÑ‚Ð¾ Ð½Ð° Ð´Ð¸ÑÐºÐµ[32m:[39m(B[m[K[?25l[?12l[?25h [?25l[?12l[?25h[K[?25l[?12l[?25h [?25l[?12l[?25h [?25l[?12l[?25h[42m [49m(B[m[K[?25l[?12l[?25h [?25l[?12l[?25h [?25l[?12l[?25h[42m [49m(B[m[K[?25l[?12l[?25h [?25l[?12l[?25h [?25l[?12l[?25h [?25l[?12l[?25h [?25l[?12l[?25h [?25l[?12l[?25h[42m [49m(B[m[K[?25l[?12l[?25h [?25l[?12l[?25h [?25l[?12l[?25h [?25l[?12l[?25h [?25l[?12l[?25h [?25l[?12l[?25h [?25l[?12l[?25h [?25l[?12l[?25h [?25l[?12l[?25h [?25l[?12l[?25h [?25l[?12l[?25h [?25l[?12l[?25h [?25l[?12l[?25h[42m [49m(B[m[K[?25l[?12l[?25h [?25l[?12l[?25h -[K[?25l[?12l[?25h[42m [49m(B[m[K[?25l[?12l[?25h [?25l[?12l[?25hech[K[?25l[?12l[?25h [?25l[?12l[?25h [?25l[?12l[?25h[K[?25l[19;34H[?12l[?25h[?25l[?12l[?25h [?25l[?12l[?25h [?25l[?12l[?25h [?25l[?12l[?25h [?25l[?12l[?25h [?25l[?12l[?25h [?25l[?12l[?25h [?25l[?12l[?25h [?25l[?12l[?25h [?25l[?12l[?25h [?25l[?12l[?25h [?25l[?12l[?25h[42m [49m(B[m[K[?25l[?12l[?25h [?25l[?12l[?25h [?25l[?12l[?25h [?25l[?12l[?25h [?25l[?12l[?25h [?25l[?12l[?25h [?25l[?12l[?25h [?25l[?12l[?25h [?25l[?12l[?25h[42m [49m(B[m[K[?25l[?12l[?25h [?25l[?12l[?25h [?25l[?12l[?25h [?25l[?12l[?25h [?25l[?12l[?25h [?25l[?12l[?25h [?25l[?12l[?25h [?25l[?12l[?25h [?25l[?12l[?25h [?25l[?12l[?25h[42m [49m(B[m[K[?25l[?12l[?25h [?25l[?12l[?25h[K[?25l[A[?12l[?25h[?25l[17;21H[?12l[?25h[?25l[?12l[?25h[6G"Ð”Ð°Ñ‚Ð°[32m:[39m(B[m [32m$([39m(B[mdate[32m)[39m(B[m[K[?25l[?12l[?25h [?25l[?12l[?25h [?25l[?12l[?25h [?25l[?12l[?25h [?25l[?12l[?25h [?25l[?12l[?25h [?25l[?12l[?25h[42m [49m(B[m[K[?25l[?12l[?25h [?25l[?12l[?25h [?25l[?12l[?25h [?25l[?12l[?25h [?25l[?12l[?25h [?25l[?12l[?25h [?25l[?12l[?25h[42m [49m(B[m[K[?25l[?12l[?25h [?25l[?12l[?25hech[K[?25l[?12l[?25h [?25l[?12l[?25h [?25l[?12l[?25h[K[?25l[16;40H[?12l[?25h[?25l[?12l[?25h[6G"[32m=====[39m(B[m Ð¡Ð˜Ð¡Ð¢Ð•ÐœÐÐ«Ð™ ÐœÐžÐÐ˜Ð¢ÐžÐ Ð˜ÐÐ“ [32m=====[39m(B[m[K[?25l[?12l[?25h [?25l[?12l[?25h [?25l[?12l[?25h [?25l[?12l[?25h [?25l[?12l[?25h[42m [49m(B[m[K[?25l[?12l[?25h [?25l[?12l[?25h [?25l[?12l[?25h [?25l[?12l[?25h [?25l[?12l[?25h [?25l[?12l[?25h [?25l[?12l[?25h [?25l[?12l[?25h [?25l[?12l[?25h [?25l[?12l[?25h [?25l[?12l[?25h[42m [49m(B[m[K[?25l[?12l[?25h [?25l[?12l[?25h[K[?25l[?12l[?25h [?25l[?12l[?25h [?25l[?12l[?25h [?25l[?12l[?25h [?25l[?12l[?25h [?25l[?12l[?25h [?25l[?12l[?25h[42m [49m(B[m[K[?25l[?12l[?25h [?25l[?12l[?25h [?25l[?12l[?25h [?25l[?12l[?25h [?25l[?12l[?25h [?25l[?12l[?25h [?25l[?12l[?25h[42m [49m(B[m[K[?25l[?12l[?25h [?25l[?12l[?25hech[K[?25l[?12l[?25h [?25l[?12l[?25h [?25l[?12l[?25h[K[?25l[15;23H[?12l[?25h[?25l[?12l[?25h [?25l[?12l[?25h [?25l[?12l[?25h [?25l[?12l[?25h [?25l[?12l[?25h[42m [49m(B[m[K[?25l[?12l[?25h [?25l[?12l[?25h[42m [49m(B[m[K[?25l[?12l[?25h [?25l[?12l[?25h [?25l[?12l[?25h [?25l[?12l[?25h [?25l[?12l[?25h[42m [49m(B[m[K[?25l[?12l[?25h [?25l[?12l[?25h [?25l[?12l[?25h [?25l[?12l[?25h [?25l[?12l[?25h [?25l[?12l[?25h [?25l[?12l[?25h [?25l[?12l[?25h[42m [49m(B[m[K[?25l[?12l[?25h [?25l[?12l[?25h[K[?25l[13;12H[?12l[?25h[?25l[?12l[?25h [?25l[?12l[?25h [?25l[?12l[?25h [?25l[?12l[?25h [?25l[?12l[?25h [?25l[?12l[?25h [?25l[?12l[?25h [?25l[?12l[?25h [?25l[?12l[?25h [?25l[?12l[?25h [?25l[?12l[?25h[K[?25l[12;8H[?12l[?25h[?25l[?12l[?25h[A[?25l[?12l[?25h[A[?25l[?12l[?25h[C[?25l[?12l[?25h[11G[?25l[?12l[?25h[C[?25l[?12l[?25h[C[?25l[?12l[?25h[C[?25l[?12l[?25h[C[?25l[?12l[?25h[C[?25l[?12l[?25h[C[?25l[?12l[?25h[C[?25l[?12l[?25h[C[?25l[?12l[?25h[C[?25l[?12l[?25h[C[?25l[?12l[?25h[C[?25l[?12l[?25h[C[?25l[?12l[?25h[C[?25l[?12l[?25h[C[?25l[?12l[?25h[C[?25l[?12l[?25h[C[?25l[?12l[?25h[C[?25l[?12l[?25h[30G[?25l[?12l[?25h[C[?25l[?12l[?25h [?25l[?12l[?25h [?25l[?12l[?25h [?25l[?12l[?25h [?25l[?12l[?25h [?25l[?12l[?25h[42m [49m(B[m[K[?25l[?12l[?25h [?25l[?12l[?25h [?25l[?12l[?25h [?25l[?12l[?25h [?25l[?12l[?25h [?25l[?12l[?25h [?25l[?12l[?25h [?25l[?12l[?25h [?25l[?12l[?25h [?25l[?12l[?25h [?25l[?12l[?25h [?25l[?12l[?25h[42m [49m(B[m[K[?25l[?12l[?25h [?25l[?12l[?25h [?25l[?12l[?25h [?25l[?12l[?25h [?25l[?12l[?25h [?25l[?12l[?25h [?25l[?12l[?25h [?25l[?12l[?25h [?25l[?12l[?25h [?25l[?12l[?25h[42m [49m(B[m[K[?25l[?12l[?25h [?25l[?12l[?25h[K[?25l[9;28r[28;1H
[1;30r[9;1H[?12l[?25h[?25l[9;28r[28;1H
[1;30r[8;8H[?12l[?25h[?25l7[9;28r8[9dM[1;30r[9;1H[?12l[?25h[?25l[?12l[?25h[A[?25l[?12l[?25h[A[?25l[?12l[?25h[A[?25l[?12l[?25h[C[?25l[?12l[?25h[C[?25l[?12l[?25h[C[?25l[?12l[?25h[C[?25l[?12l[?25h[C[?25l[?12l[?25h[C[?25l[?12l[?25h[C[?25l[?12l[?25h[C[?25l[?12l[?25h[C[?25l[?12l[?25h[C[?25l[?12l[?25h[C[?25l[?12l[?25h[C[?25l[?12l[?25h[C[?25l[?12l[?25h[C[?25l[?12l[?25h[C[?25l[?12l[?25h[C[?25l[?12l[?25h[C[?25l[?12l[?25h[C[?25l[?12l[?25h[C[?25l[?12l[?25h[C[?25l[?12l[?25h[C[?25l[?12l[?25h[C[?25l[?12l[?25h[C[?25l[?12l[?25h[C[?25l[?12l[?25h[C[?25l[?12l[?25h[C[?25l[?12l[?25h[C[?25l[?12l[?25h[C[?25l[?12l[?25h[C[?25l[?12l[?25h[C[?25l[?12l[?25h[C[?25l[?12l[?25h[C[?25l[?12l[?25h[C[?25l[?12l[?25h [?25l[?12l[?25h [?25l[?12l[?25h [?25l[?12l[?25h [?25l[?12l[?25h [?25l[?12l[?25h [?25l[?12l[?25h [?25l[?12l[?25h [?25l[?12l[?25h [?25l[?12l[?25h [?25l[?12l[?25h [?25l[?12l[?25h[42m [49m(B[m[K[?25l[?12l[?25h [?25l[?12l[?25h [?25l[?12l[?25h [?25l[?12l[?25h [?25l[?12l[?25h [?25l[?12l[?25h [?25l[?12l[?25h [?25l[?12l[?25h [?25l[?12l[?25h[42m [49m(B[m[K[?25l[?12l[?25h [?25l[?12l[?25h [?25l[?12l[?25h [?25l[?12l[?25h [?25l[?12l[?25h [?25l[?12l[?25h [?25l[?12l[?25h [?25l[?12l[?25h [?25l[?12l[?25h [?25l[?12l[?25h[42m [49m(B[m[K[?25l[?12l[?25h [?25l[?12l[?25h[K[?25l[5;28r[28;1H
[1;30r[5;1H[?12l[?25h[?25l[?12l[?25h[A[?25l[?12l[?25h[A[?25l[?12l[?25h[A[?25l7[2;28r8M[1;30r[2;1H[?12l[?25h[?25l7[2;28r8M[1;30r[2;1H[36m#!/bin/bash[39m(B[m[?12l[?25h[?25l[?12l[?25h[3d[?25l[?12l[?25h[2;12H[?25l[?12l[?25h[3d[?25l[?12l[?25h[4;12H[?25l[?12l[?25h[C[?25l[?12l[?25h[C[?25l[?12l[?25h[C[?25l[?12l[?25h[C[?25l[?12l[?25h[C[?25l[?12l[?25h[C[?25l[?12l[?25h[C[?25l[?12l[?25h[C[?25l[?12l[?25h[C[?25l[?12l[?25h[C[?25l[?12l[?25h[C[?25l[?12l[?25h [?25l[?12l[?25h [?25l[?12l[?25h [?25l[?12l[?25h [?25l[?12l[?25h[42m [49m(B[m[K[?25l[?12l[?25h [?25l[?12l[?25h[42m [49m(B[m[K[?25l[?12l[?25h [?25l[?12l[?25h [?25l[?12l[?25h [?25l[?12l[?25h [?25l[?12l[?25h[42m [49m(B[m[K[?25l[?12l[?25h [?25l[?12l[?25h [?25l[?12l[?25h [?25l[?12l[?25h [?25l[?12l[?25h[K[?25l[?12l[?25h [?25l[?12l[?25h[42m [49m(B[m[K[?25l[?12l[?25h [?25l[?12l[?25h[K[?25l[3;28r[28;1H
[1;30r[3;1H[?12l[?25h[?25l[28d(B[0;7mSave modified buffer?                                                                                                   [29;1H Y(B[m Yes[K[30d(B[0;7m N(B[m No  [30;16H (B[0;7m^C(B[m Cancel[K[28;23H[?12l[?25h[?25l[29d(B[0;7m^G(B[m Help[29;31H(B[0;7mM-D(B[m DOS Format[29;61H(B[0;7mM-A(B[m Append[29;91H(B[0;7mM-B(B[m Backup File[30d(B[0;7m^C(B[m Cancel[17G[14X[30;31H(B[0;7mM-M(B[m Mac Format[30;61H(B[0;7mM-P(B[m Prepend[30;91H(B[0;7m^T(B[m Browse[28d(B[0;7mFile Name to Write: script(B[m[?12l[?25h[?25l(B[0;7m.(B[m[?12l[?25h[?25l(B[0;7ms(B[m[?12l[?25h[?25l(B[0;7mh(B[m[?12l[?25h[?25l(B[0;7mSave file under DIFFERENT NAME?[29d Y(B[m Yes[K[30d(B[0;7m N(B[m No    [17G(B[0;7m^C(B[m Cancel[K[28;33H[?12l[?25h[?25l[28;53H[1K (B[0;7m[ Writing... ](B[m[K[1;59H(B[0;7mscript.sh[119G(B[m[28;52H(B[0;7m[ Wrote 10 lines ](B[m[J[30d[?12l[?25h[30;1H[?1049l[23;0;0t[?1l>[?2004l[?2004h]0;bezrukavnikov@vbox: ~/mydir[01;32mbezrukavnikov@vbox[00m:[01;34m~/mydir[00m$ 
[?2004l[?2004h]0;bezrukavnikov@vbox: ~/mydir[01;32mbezrukavnikov@vbox[00m:[01;34m~/mydir[00m$ nano script [K[K[K[K[K[K[K[K[K[K[K[K./script.sh
[?2004lbash: ./script.sh: Permission denied
[?2004h]0;bezrukavnikov@vbox: ~/mydir[01;32mbezrukavnikov@vbox[00m:[01;34m~/mydir[00m$ ./script.sh[K[K[K[K[K[K[K[K[K[K[Kls
[?2004l[0m[01;31marchive.tar[0m  lstu.html  morestring  [01;34mmydor[0m  [01;34mmywork[0m  script  script.sh  typescript  win64
[?2004h]0;bezrukavnikov@vbox: ~/mydir[01;32mbezrukavnikov@vbox[00m:[01;34m~/mydir[00m$ scr
screendump    script        scriptlive    scriptreplay  
]0;bezrukavnikov@vbox: ~/mydir[01;32mbezrukavnikov@vbox[00m:[01;34m~/mydir[00m$ scr
screendump    script        scriptlive    scriptreplay  
]0;bezrukavnikov@vbox: ~/mydir[01;32mbezrukavnikov@vbox[00m:[01;34m~/mydir[00m$ script.sh
[?2004lbash: script.sh: command not found
[?2004h]0;bezrukavnikov@vbox: ~/mydir[01;32mbezrukavnikov@vbox[00m:[01;34m~/mydir[00m$ script.sh/script.sh[1Pscript.sh.script.sh/script.sh
[?2004lbash: ./script.sh: Permission denied
[?2004h]0;bezrukavnikov@vbox: ~/mydir[01;32mbezrukavnikov@vbox[00m:[01;34m~/mydir[00m$ Ð´Ñ‹ [K[K[Kls -l scri[K[K[K[K[Ks
[?2004ltotal 216
 44 -rw-r--r-- 1 bezrukavnikov bezrukavnikov  44525 Jul 11 20:10 [0m[01;31marchive.tar[0m
128 -rw-r--r-- 1 bezrukavnikov bezrukavnikov 129798 Jul 11 18:56 lstu.html
  4 -rw-r--r-- 1 egor          bezrukavnikov    161 Jul 11 14:21 morestring
  4 drwxr-xr-x 2 bezrukavnikov bezrukavnikov   4096 Jul 11 14:10 [01;34mmydor[0m
  4 drwxr-xr-x 2 bezrukavnikov bezrukavnikov   4096 Jul 11 13:58 [01;34mmywork[0m
  4 -rw-r--r-- 1 bezrukavnikov bezrukavnikov    821 Jul 12 19:19 script
  4 -rw-r--r-- 1 bezrukavnikov bezrukavnikov    250 Jul 12 19:20 script.sh
 16 -rw-r--r-- 1 bezrukavnikov bezrukavnikov  16384 Jul 12 19:20 typescript
  8 -rw-r--r-- 1 bezrukavnikov bezrukavnikov   5958 Jul 11 19:46 win64
[?2004h]0;bezrukavnikov@vbox: ~/mydir[01;32mbezrukavnikov@vbox[00m:[01;34m~/mydir[00m$ ls -ls[Ka
[?2004ltotal 228
drwxr-xr-x  4 bezrukavnikov bezrukavnikov   4096 Jul 12 19:20 [0m[01;34m.[0m
drwx------ 21 bezrukavnikov bezrukavnikov   4096 Jul 12 19:11 [01;34m..[0m
-rw-r--r--  1 bezrukavnikov bezrukavnikov  44525 Jul 11 20:10 [01;31marchive.tar[0m
-rw-r--r--  1 bezrukavnikov bezrukavnikov 129798 Jul 11 18:56 lstu.html
-rw-r--r--  1 egor          bezrukavnikov    161 Jul 11 14:21 morestring
drwxr-xr-x  2 bezrukavnikov bezrukavnikov   4096 Jul 11 14:10 [01;34mmydor[0m
drwxr-xr-x  2 bezrukavnikov bezrukavnikov   4096 Jul 11 13:58 [01;34mmywork[0m
-rw-r--r--  1 bezrukavnikov bezrukavnikov    821 Jul 12 19:19 script
-rw-r--r--  1 bezrukavnikov bezrukavnikov    250 Jul 12 19:20 script.sh
-rw-r--r--  1 bezrukavnikov bezrukavnikov  20480 Jul 12 19:22 typescript
-rw-r--r--  1 bezrukavnikov bezrukavnikov   5958 Jul 11 19:46 win64
[?2004h]0;bezrukavnikov@vbox: ~/mydir[01;32mbezrukavnikov@vbox[00m:[01;34m~/mydir[00m$ chmod +x sr[Kcript.sh
[?2004l[?2004h]0;bezrukavnikov@vbox: ~/mydir[01;32mbezrukavnikov@vbox[00m:[01;34m~/mydir[00m$ chmod +x script.sh[12Pls -las./script.sh
[?2004l===== Ð¡Ð˜Ð¡Ð¢Ð•ÐœÐÐ«Ð™ ÐœÐžÐÐ˜Ð¢ÐžÐ Ð˜ÐÐ“ =====
Ð”Ð°Ñ‚Ð°: Sat Jul 12 07:22:36 PM MSK 2025

Ð¡Ð²Ð¾Ð±Ð¾Ð´Ð½Ð¾Ðµ Ð¼ÐµÑÑ‚Ð¾ Ð½Ð° Ð´Ð¸ÑÐºÐµ:
Filesystem      Size  Used Avail Use% Mounted on
/dev/sda1        19G   13G  4.7G  74% /

Ð˜ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ð½Ð¸Ðµ Ð¾Ð¿ÐµÑ€Ð°Ñ‚Ð¸Ð²Ð½Ð¾Ð¹ Ð¿Ð°Ð¼ÑÑ‚Ð¸:
               total        used        free      shared  buff/cache   available
Mem:           3.8Gi       1.5Gi       1.8Gi        16Mi       861Mi       2.4Gi
Swap:          974Mi          0B       974Mi
[?2004h]0;bezrukavnikov@vbox: ~/mydir[01;32mbezrukavnikov@vbox[00m:[01;34m~/mydir[00m$ df -h
[?2004lFilesystem      Size  Used Avail Use% Mounted on
udev            1.9G     0  1.9G   0% /dev
tmpfs           392M  1.3M  391M   1% /run
/dev/sda1        19G   13G  4.7G  74% /
tmpfs           2.0G     0  2.0G   0% /dev/shm
tmpfs           5.0M  8.0K  5.0M   1% /run/lock
DebianNew       947G  770G  178G  82% /media/sf_DebianNew
tmpfs           392M  132K  392M   1% /run/user/1004
[?2004h]0;bezrukavnikov@vbox: ~/mydir[01;32mbezrukavnikov@vbox[00m:[01;34m~/mydir[00m$ df -h /
[?2004lFilesystem      Size  Used Avail Use% Mounted on
/dev/sda1        19G   13G  4.7G  74% /
[?2004h]0;bezrukavnikov@vbox: ~/mydir[01;32mbezrukavnikov@vbox[00m:[01;34m~/mydir[00m$ df -h /[K[K
[?2004lFilesystem      Size  Used Avail Use% Mounted on
udev            1.9G     0  1.9G   0% /dev
tmpfs           392M  1.3M  391M   1% /run
/dev/sda1        19G   13G  4.7G  74% /
tmpfs           2.0G     0  2.0G   0% /dev/shm
tmpfs           5.0M  8.0K  5.0M   1% /run/lock
DebianNew       947G  770G  178G  82% /media/sf_DebianNew
tmpfs           392M  132K  392M   1% /run/user/1004
[?2004h]0;bezrukavnikov@vbox: ~/mydir[01;32mbezrukavnikov@vbox[00m:[01;34m~/mydir[00m$ free -h
[?2004l               total        used        free      shared  buff/cache   available
Mem:           3.8Gi       1.4Gi       1.8Gi        16Mi       861Mi       2.4Gi
Swap:          974Mi          0B       974Mi
[?2004h]0;bezrukavnikov@vbox: ~/mydir[01;32mbezrukavnikov@vbox[00m:[01;34m~/mydir[00m$ free -h[K[K[K[K[K[K[Knano script.sh 
[?2004l[?2004h[?1049h[22;0;0t[1;30r(B[m[4l[?7h[39;49m[?1h=[?1h=[?25l[39;49m(B[m[H[2J[28;54H(B[0;7m[ Reading... ](B[m[28;52H(B[0;7m[ Read 10 lines ](B[m[H(B[0;7m  GNU nano 7.2                                            script.sh                                                     [1;119H(B[m[29d(B[0;7m^G(B[m Help[29;16H(B[0;7m^O(B[m Write Out   (B[0;7m^W(B[m Where Is    (B[0;7m^K(B[m Cut[29;61H(B[0;7m^T(B[m Execute     (B[0;7m^C(B[m Location    (B[0;7mM-U(B[m Undo[106G(B[0;7mM-A(B[m Set Mark[30d(B[0;7m^X(B[m Exit[30;16H(B[0;7m^R(B[m Read File   (B[0;7m^\(B[m Replace     (B[0;7m^U(B[m Paste[61G(B[0;7m^J(B[m Justify     (B[0;7m^/(B[m Go To Line  (B[0;7mM-E(B[m Redo[106G(B[0;7mM-6(B[m Copy[2d[36m#!/bin/bash[4d(B[0;1m[34mecho[39m(B[m (B[0;1m[33m"===== Ð¡Ð˜Ð¡Ð¢Ð•ÐœÐÐ«Ð™ ÐœÐžÐÐ˜Ð¢ÐžÐ Ð˜ÐÐ“ ====="[5d[34mecho[39m(B[m (B[0;1m[33m"Ð”Ð°Ñ‚Ð°: $(date)"[7d[34mecho[35m -e[39m(B[m (B[0;1m[33m"\nÐ¡Ð²Ð¾Ð±Ð¾Ð´Ð½Ð¾Ðµ Ð¼ÐµÑÑ‚Ð¾ Ð½Ð° Ð´Ð¸ÑÐºÐµ:"[8d[39m(B[mdf(B[0;1m[35m -h[39m(B[m /[10d(B[0;1m[34mecho[35m -e[39m(B[m (B[0;1m[33m"\nÐ˜ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ð½Ð¸Ðµ Ð¾Ð¿ÐµÑ€Ð°Ñ‚Ð¸Ð²Ð½Ð¾Ð¹ Ð¿Ð°Ð¼ÑÑ‚Ð¸:"[11d[39m(B[mfree(B[0;1m[35m -h[2d[39m(B[m[?12l[?25h[?25l[?12l[?25h[?25l[?12l[?25h[3d[?25l[?12l[?25h[4d[?25l[?12l[?25h[5d[?25l[?12l[?25h[6d[?25l[?12l[?25h[7d[?25l[?12l[?25h[8d[?25l[?12l[?25hd[?25l[?12l[?25hf[?25l[?12l[?25h[C[?25l[?12l[?25h[C[?25l[?12l[?25h[C[?25l[?12l[?25h [?25l[?12l[?25h/[?25l[1;69H(B[0;7m*[119G(B[m[?12l[?25h[8;6H[42m [49m(B[m[K[?25l[?12l[?25h [?25l[28d(B[0;7mSave modified buffer?                                                                                                   [29;1H Y(B[m Yes[K[30d(B[0;7m N(B[m No  [30;16H (B[0;7m^C(B[m Cancel[K[28;23H[?12l[?25h[?25l[29d(B[0;7m^G(B[m Help[29;31H(B[0;7mM-D(B[m DOS Format[29;61H(B[0;7mM-A(B[m Append[29;91H(B[0;7mM-B(B[m Backup File[30d(B[0;7m^C(B[m Cancel[17G[14X[30;31H(B[0;7mM-M(B[m Mac Format[30;61H(B[0;7mM-P(B[m Prepend[30;91H(B[0;7m^T(B[m Browse[28d(B[0;7mFile Name to Write: script.sh(B[m[?12l[?25h[?25l[28;53H[1K (B[0;7m[ Writing... ](B[m[K[1;69H(B[0;7m [119G(B[m[28;52H(B[0;7m[ Wrote 10 lines ](B[m[J[30d[?12l[?25h[30;1H[?1049l[23;0;0t[?1l>[?2004l[?2004h]0;bezrukavnikov@vbox: ~/mydir[01;32mbezrukavnikov@vbox[00m:[01;34m~/mydir[00m$ nano script.sh 
[?2004l[?2004h[?1049h[22;0;0t[1;30r(B[m[4l[?7h[39;49m[?1h=[?1h=[?25l[39;49m(B[m[H[2J[28;54H(B[0;7m[ Reading... ](B[m[28;52H(B[0;7m[ Read 10 lines ](B[m[H(B[0;7m  GNU nano 7.2                                            script.sh                                                     [1;119H(B[m[29d(B[0;7m^G(B[m Help[29;16H(B[0;7m^O(B[m Write Out   (B[0;7m^W(B[m Where Is    (B[0;7m^K(B[m Cut[29;61H(B[0;7m^T(B[m Execute     (B[0;7m^C(B[m Location    (B[0;7mM-U(B[m Undo[106G(B[0;7mM-A(B[m Set Mark[30d(B[0;7m^X(B[m Exit[30;16H(B[0;7m^R(B[m Read File   (B[0;7m^\(B[m Replace     (B[0;7m^U(B[m Paste[61G(B[0;7m^J(B[m Justify     (B[0;7m^/(B[m Go To Line  (B[0;7mM-E(B[m Redo[106G(B[0;7mM-6(B[m Copy[2d[36m#!/bin/bash[4d(B[0;1m[34mecho[39m(B[m (B[0;1m[33m"===== Ð¡Ð˜Ð¡Ð¢Ð•ÐœÐÐ«Ð™ ÐœÐžÐÐ˜Ð¢ÐžÐ Ð˜ÐÐ“ ====="[5d[34mecho[39m(B[m (B[0;1m[33m"Ð”Ð°Ñ‚Ð°: $(date)"[7d[34mecho[35m -e[39m(B[m (B[0;1m[33m"\nÐ¡Ð²Ð¾Ð±Ð¾Ð´Ð½Ð¾Ðµ Ð¼ÐµÑÑ‚Ð¾ Ð½Ð° Ð´Ð¸ÑÐºÐµ:"[8d[39m(B[mdf(B[0;1m[35m -h[10d[34mecho[35m -e[39m(B[m (B[0;1m[33m"\nÐ˜ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ð½Ð¸Ðµ Ð¾Ð¿ÐµÑ€Ð°Ñ‚Ð¸Ð²Ð½Ð¾Ð¹ Ð¿Ð°Ð¼ÑÑ‚Ð¸:"[11d[39m(B[mfree(B[0;1m[35m -h[2d[39m(B[m[?12l[?25h[?25l[1;69H(B[0;7m*[119G(B[m[?12l[?25h[2dx#[32m![39m(B[m/bin/bashx[?25l[?12l[?25h[36m#!/bin/bash[39m(B[m[K[?25l[28d(B[0;7mSave modified buffer?                                                                                                   [29;1H Y(B[m Yes[K[30d(B[0;7m N(B[m No  [30;16H (B[0;7m^C(B[m Cancel[K[28;23H[?12l[?25h[?25l[29d(B[0;7m^G(B[m Help[29;31H(B[0;7mM-D(B[m DOS Format[29;61H(B[0;7mM-A(B[m Append[29;91H(B[0;7mM-B(B[m Backup File[30d(B[0;7m^C(B[m Cancel[17G[14X[30;31H(B[0;7mM-M(B[m Mac Format[30;61H(B[0;7mM-P(B[m Prepend[30;91H(B[0;7m^T(B[m Browse[28d(B[0;7mFile Name to Write: script.sh(B[m[?12l[?25h[?25l[28;53H[1K (B[0;7m[ Writing... ](B[m[K[1;69H(B[0;7m [119G(B[m[28;52H(B[0;7m[ Wrote 10 lines ](B[m[J[30d[?12l[?25h[30;1H[?1049l[23;0;0t[?1l>[?2004l[?2004h]0;bezrukavnikov@vbox: ~/mydir[01;32mbezrukavnikov@vbox[00m:[01;34m~/mydir[00m$ nano script.sh [8Pfree -h[2Pdf[C[C[C /[K./script.sh
[?2004l===== Ð¡Ð˜Ð¡Ð¢Ð•ÐœÐÐ«Ð™ ÐœÐžÐÐ˜Ð¢ÐžÐ Ð˜ÐÐ“ =====
Ð”Ð°Ñ‚Ð°: Sat Jul 12 07:23:49 PM MSK 2025

Ð¡Ð²Ð¾Ð±Ð¾Ð´Ð½Ð¾Ðµ Ð¼ÐµÑÑ‚Ð¾ Ð½Ð° Ð´Ð¸ÑÐºÐµ:
Filesystem      Size  Used Avail Use% Mounted on
udev            1.9G     0  1.9G   0% /dev
tmpfs           392M  1.3M  391M   1% /run
/dev/sda1        19G   13G  4.7G  74% /
tmpfs           2.0G     0  2.0G   0% /dev/shm
tmpfs           5.0M  8.0K  5.0M   1% /run/lock
DebianNew       947G  770G  178G  82% /media/sf_DebianNew
tmpfs           392M  132K  392M   1% /run/user/1004

Ð˜ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ð½Ð¸Ðµ Ð¾Ð¿ÐµÑ€Ð°Ñ‚Ð¸Ð²Ð½Ð¾Ð¹ Ð¿Ð°Ð¼ÑÑ‚Ð¸:
               total        used        free      shared  buff/cache   available
Mem:           3.8Gi       1.4Gi       1.8Gi        16Mi       861Mi       2.4Gi
Swap:          974Mi          0B       974Mi
[?2004h]0;bezrukavnikov@vbox: ~/mydir[01;32mbezrukavnikov@vbox[00m:[01;34m~/mydir[00m$ nano script.sh 
[?2004l[?2004h[?1049h[22;0;0t[1;30r(B[m[4l[?7h[39;49m[?1h=[?1h=[?25l[39;49m(B[m[H[2J[28;54H(B[0;7m[ Reading... ](B[m[28;52H(B[0;7m[ Read 10 lines ](B[m[H(B[0;7m  GNU nano 7.2                                            script.sh                                                     [1;119H(B[m[29d(B[0;7m^G(B[m Help[29;16H(B[0;7m^O(B[m Write Out   (B[0;7m^W(B[m Where Is    (B[0;7m^K(B[m Cut[29;61H(B[0;7m^T(B[m Execute     (B[0;7m^C(B[m Location    (B[0;7mM-U(B[m Undo[106G(B[0;7mM-A(B[m Set Mark[30d(B[0;7m^X(B[m Exit[30;16H(B[0;7m^R(B[m Read File   (B[0;7m^\(B[m Replace     (B[0;7m^U(B[m Paste[61G(B[0;7m^J(B[m Justify     (B[0;7m^/(B[m Go To Line  (B[0;7mM-E(B[m Redo[106G(B[0;7mM-6(B[m Copy[2d[36m#!/bin/bash[4d(B[0;1m[34mecho[39m(B[m (B[0;1m[33m"===== Ð¡Ð˜Ð¡Ð¢Ð•ÐœÐÐ«Ð™ ÐœÐžÐÐ˜Ð¢ÐžÐ Ð˜ÐÐ“ ====="[5d[34mecho[39m(B[m (B[0;1m[33m"Ð”Ð°Ñ‚Ð°: $(date)"[7d[34mecho[35m -e[39m(B[m (B[0;1m[33m"\nÐ¡Ð²Ð¾Ð±Ð¾Ð´Ð½Ð¾Ðµ Ð¼ÐµÑÑ‚Ð¾ Ð½Ð° Ð´Ð¸ÑÐºÐµ:"[8d[39m(B[mdf(B[0;1m[35m -h[10d[34mecho[35m -e[39m(B[m (B[0;1m[33m"\nÐ˜ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ð½Ð¸Ðµ Ð¾Ð¿ÐµÑ€Ð°Ñ‚Ð¸Ð²Ð½Ð¾Ð¹ Ð¿Ð°Ð¼ÑÑ‚Ð¸:"[11d[39m(B[mfree(B[0;1m[35m -h[2d[39m(B[m[?12l[?25h[?25l[?12l[?25h[3d[?25l[?12l[?25h[4d[?25l[?12l[?25h[C[?25l[?12l[?25h[C[?25l[?12l[?25h[C[?25l[?12l[?25h[C[?25l[?12l[?25h [?25l[?12l[?25h[C[?25l[?12l[?25h[C[?25l[?12l[?25h[C[?25l[?12l[?25h[C[?25l[?12l[?25h[C[?25l[?12l[?25h[C[?25l[?12l[?25h[C[?25l[?12l[?25h[C[?25l[?12l[?25h[C[?25l[?12l[?25h[C[?25l[?12l[?25h[C[?25l[?12l[?25h[C[?25l[28d[K[?12l[?25h[4;19H[?25l[?12l[?25h[C[?25l[?12l[?25h[C[?25l[?12l[?25h[C[?25l[?12l[?25h[C[?25l[?12l[?25h[C[?25l[?12l[?25h[C[?25l[?12l[?25h[C[?25l[?12l[?25h[C[?25l[?12l[?25h[C[?25l[?12l[?25h[C[?25l[?12l[?25h[C[?25l[?12l[?25h[C[?25l[?12l[?25h[C[?25l[?12l[?25h[C[?25l[?12l[?25h[C[?25l[?12l[?25h[C[?25l[?12l[?25h[C[?25l[?12l[?25h[C[?25l[?12l[?25h[C[?25l[?12l[?25h[C[?25l[?12l[?25h[C[?25l[1;69H(B[0;7m*[119G(B[m[?12l[?25h[4;6H"[32m=====[39m(B[m Ð¡Ð˜Ð¡Ð¢Ð•ÐœÐÐ«Ð™ ÐœÐžÐÐ˜Ð¢ÐžÐ Ð˜ÐÐ“ [32m=====[39m(B[m[K[?25l[?12l[?25h [?25l[?12l[?25h [?25l[?12l[?25h [?25l[?12l[?25h [?25l[?12l[?25h[42m [49m(B[m[K[?25l[?12l[?25h [?25l[?12l[?25h [?25l[?12l[?25h [?25l[?12l[?25h [?25l[?12l[?25h [?25l[?12l[?25h [?25l[?12l[?25h [?25l[?12l[?25h [?25l[?12l[?25h [?25l[?12l[?25h [?25l[?12l[?25h[42m [49m(B[m[K[?25l[?12l[?25h [?25l[?12l[?25h [?25l[?12l[?25h [?25l[?12l[?25h [?25l[?12l[?25h [?25l[?12l[?25h [?25l[?12l[?25h [?25l[?12l[?25h [?25l[?12l[?25h [?25l[?12l[?25h[42m [49m(B[m[K[?25l[?12l[?25h [?25l[?12l[?25h [?25l[?12l[?25h [?25l[?12l[?25h [?25l[?12l[?25h [?25l[?12l[?25h [?25l[?12l[?25h[42m [49m(B[m[K[?25l[?12l[?25h [?25l[?12l[?25hech[K[?25l[?12l[?25h [?25l[?12l[?25h [?25l[?12l[?25h[K[?25l[3;28r[28;1H
[1;30r[3;1H[?12l[?25h[?25l[3;28r[28;1H
[1;30r[2;12H[?12l[?25h[?25l[?12l[?25h[3d[?25l[?12l[?25h[C[?25l[?12l[?25h[C[?25l[?12l[?25h[C[?25l[?12l[?25h[C[?25l[?12l[?25h[C[?25l[?12l[?25h[C[?25l[?12l[?25h[C[?25l[?12l[?25h[C[?25l[?12l[?25h[C[?25l[?12l[?25h[?25l[28d(B[0;7mSave modified buffer?                                                                                                   [29;1H Y(B[m Yes[K[30d(B[0;7m N(B[m No  [30;16H (B[0;7m^C(B[m Cancel[K[28;23H[?12l[?25h[?25l[29d(B[0;7m^G(B[m Help[29;31H(B[0;7mM-D(B[m DOS Format[29;61H(B[0;7mM-A(B[m Append[29;91H(B[0;7mM-B(B[m Backup File[30d(B[0;7m^C(B[m Cancel[17G[14X[30;31H(B[0;7mM-M(B[m Mac Format[30;61H(B[0;7mM-P(B[m Prepend[30;91H(B[0;7m^T(B[m Browse[28d(B[0;7mFile Name to Write: script.sh(B[m[?12l[?25h[?25l[28;53H[1K (B[0;7m[ Writing... ](B[m[K[1;69H(B[0;7m [119G(B[m[28;52H(B[0;7m[ Wrote 8 lines ](B[m[J[30d[?12l[?25h[30;1H[?1049l[23;0;0t[?1l>[?2004l[?2004h]0;bezrukavnikov@vbox: ~/mydir[01;32mbezrukavnikov@vbox[00m:[01;34m~/mydir[00m$ 
[?2004l[?2004h]0;bezrukavnikov@vbox: ~/mydir[01;32mbezrukavnikov@vbox[00m:[01;34m~/mydir[00m$ nano script.sh [4P./script.sh
[?2004lÐ”Ð°Ñ‚Ð°: Sat Jul 12 07:24:25 PM MSK 2025

Ð¡Ð²Ð¾Ð±Ð¾Ð´Ð½Ð¾Ðµ Ð¼ÐµÑÑ‚Ð¾ Ð½Ð° Ð´Ð¸ÑÐºÐµ:
Filesystem      Size  Used Avail Use% Mounted on
udev            1.9G     0  1.9G   0% /dev
tmpfs           392M  1.3M  391M   1% /run
/dev/sda1        19G   13G  4.7G  74% /
tmpfs           2.0G     0  2.0G   0% /dev/shm
tmpfs           5.0M  8.0K  5.0M   1% /run/lock
DebianNew       947G  770G  178G  82% /media/sf_DebianNew
tmpfs           392M  132K  392M   1% /run/user/1004

Ð˜ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ð½Ð¸Ðµ Ð¾Ð¿ÐµÑ€Ð°Ñ‚Ð¸Ð²Ð½Ð¾Ð¹ Ð¿Ð°Ð¼ÑÑ‚Ð¸:
               total        used        free      shared  buff/cache   available
Mem:           3.8Gi       1.4Gi       1.8Gi        16Mi       861Mi       2.4Gi
Swap:          974Mi          0B       974Mi
[?2004h]0;bezrukavnikov@vbox: ~/mydir[01;32mbezrukavnikov@vbox[00m:[01;34m~/mydir[00m$ Ð²Ð°[K[Kdf
[?2004lFilesystem     1K-blocks      Used Available Use% Mounted on
udev             1975640         0   1975640   0% /dev
tmpfs             400876      1268    399608   1% /run
/dev/sda1       19480400  13628172   4837344  74% /
tmpfs            2004376         0   2004376   0% /dev/shm
tmpfs               5120         8      5112   1% /run/lock
DebianNew      992581628 806893940 185687688  82% /media/sf_DebianNew
tmpfs             400872       132    400740   1% /run/user/1004
[?2004h]0;bezrukavnikov@vbox: ~/mydir[01;32mbezrukavnikov@vbox[00m:[01;34m~/mydir[00m$ nano sr[Kcript.sh
[?2004l[?2004h[?1049h[22;0;0t[1;30r(B[m[4l[?7h[39;49m[?1h=[?1h=[?25l[39;49m(B[m[H[2J[28;54H(B[0;7m[ Reading... ](B[m[28;53H(B[0;7m[ Read 8 lines ](B[m[H(B[0;7m  GNU nano 7.2                                            script.sh                                                     [1;119H(B[m[29d(B[0;7m^G(B[m Help[29;16H(B[0;7m^O(B[m Write Out   (B[0;7m^W(B[m Where Is    (B[0;7m^K(B[m Cut[29;61H(B[0;7m^T(B[m Execute     (B[0;7m^C(B[m Location    (B[0;7mM-U(B[m Undo[106G(B[0;7mM-A(B[m Set Mark[30d(B[0;7m^X(B[m Exit[30;16H(B[0;7m^R(B[m Read File   (B[0;7m^\(B[m Replace     (B[0;7m^U(B[m Paste[61G(B[0;7m^J(B[m Justify     (B[0;7m^/(B[m Go To Line  (B[0;7mM-E(B[m Redo[106G(B[0;7mM-6(B[m Copy[2d[36m#!/bin/bash[3d(B[0;1m[34mecho[39m(B[m (B[0;1m[33m"Ð”Ð°Ñ‚Ð°: $(date)"[5d[34mecho[35m -e[39m(B[m (B[0;1m[33m"\nÐ¡Ð²Ð¾Ð±Ð¾Ð´Ð½Ð¾Ðµ Ð¼ÐµÑÑ‚Ð¾ Ð½Ð° Ð´Ð¸ÑÐºÐµ:"[6d[39m(B[mdf(B[0;1m[35m -h[8d[34mecho[35m -e[39m(B[m (B[0;1m[33m"\nÐ˜ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ð½Ð¸Ðµ Ð¾Ð¿ÐµÑ€Ð°Ñ‚Ð¸Ð²Ð½Ð¾Ð¹ Ð¿Ð°Ð¼ÑÑ‚Ð¸:"[9d[39m(B[mfree(B[0;1m[35m -h[2d[39m(B[m[?12l[?25h[?25l[28d[J[30d[?12l[?25h[30;1H[?1049l[23;0;0t[?1l>[?2004l[?2004h]0;bezrukavnikov@vbox: ~/mydir[01;32mbezrukavnikov@vbox[00m:[01;34m~/mydir[00m$ 
[?2004l[?2004h]0;bezrukavnikov@vbox: ~/mydir[01;32mbezrukavnikov@vbox[00m:[01;34m~/mydir[00m$ d[Ksudo apt in[Kpdate
[?2004l[1;31mE: [0mInvalid operation ipdate[0m
[?2004h]0;bezrukavnikov@vbox: ~/mydir[01;32mbezrukavnikov@vbox[00m:[01;34m~/mydir[00m$ sudo apt ipdate[1Ppdateupdate
[?2004l[33m0% [Working][0m[33m0% [Connecting to debian.map.fastlydns.net] [Connecting to debian.map.fastlydns.net] [Connecting to packages.microsoft.[0m[33m0% [Connecting to debian.map.fastlydns.net] [Connecting to debian.map.fastlydns.net] [Connecting to packages.microsoft.[0m[33m0% [Connecting to debian.map.fastlydns.net] [Connecting to debian.map.fastlydns.net] [Connecting to packages.microsoft.[0m[33m0% [Connecting to debian.map.fastlydns.net] [Connecting to debian.map.fastlydns.net] [Connecting to packages.microsoft.[0m                                                                                                                       Hit:1 http://security.debian.org/debian-security bookworm-security InRelease
[33m                                                                                                                       0% [Waiting for headers] [Connecting to packages.microsoft.com (13.107.246.53)][0m                                                                               Hit:2 http://deb.debian.org/debian bookworm InRelease
[33m                                                                               0% [Connecting to packages.microsoft.com (13.107.246.53)][0m                                                         Hit:3 http://deb.debian.org/debian bookworm-updates InRelease
[33m                                                         0% [Connected to packages.microsoft.com (13.107.246.53)][0m                                                        Hit:4 https://packages.microsoft.com/repos/code stable InRelease
[33m                                                        0% [Working][0m[33m0% [Working][0m[33m0% [Working][0m[33m0% [Working][0m[33m20% [Working][0m             Reading package lists... 0%Reading package lists... 0%Reading package lists... 0%Reading package lists... 56%Reading package lists... 56%Reading package lists... 93%Reading package lists... 93%Reading package lists... 93%Reading package lists... 93%Reading package lists... 93%Reading package lists... 93%Reading package lists... 95%Reading package lists... 95%Reading package lists... 96%Reading package lists... 96%Reading package lists... 96%Reading package lists... 96%Reading package lists... 96%Reading package lists... 96%Reading package lists... 96%Reading package lists... 96%Reading package lists... 96%Reading package lists... 96%Reading package lists... 97%Reading package lists... 97%Reading package lists... 97%Reading package lists... 97%Reading package lists... 97%Reading package lists... 97%Reading package lists... Done
Building dependency tree... 0%Building dependency tree... 0%Building dependency tree... 0%Building dependency tree... 50%Building dependency tree... 50%Building dependency tree... Done
Reading state information... 0% Reading state information... 0%Reading state information... Done
263 packages can be upgraded. Run 'apt list --upgradable' to see them.
[?2004h]0;bezrukavnikov@vbox: ~/mydir[01;32mbezrukavnikov@vbox[00m:[01;34m~/mydir[00m$ ssh
[?2004lusage: ssh [-46AaCfGgKkMNnqsTtVvXxYy] [-B bind_interface]
           [-b bind_address] [-c cipher_spec] [-D [bind_address:]port]
           [-E log_file] [-e escape_char] [-F configfile] [-I pkcs11]
           [-i identity_file] [-J [user@]host[:port]] [-L address]
           [-l login_name] [-m mac_spec] [-O ctl_cmd] [-o option] [-p port]
           [-Q query_option] [-R address] [-S ctl_path] [-W host:port]
           [-w local_tun[:remote_tun]] destination [command [argument ...]]
[?2004h]0;bezrukavnikov@vbox: ~/mydir[01;32mbezrukavnikov@vbox[00m:[01;34m~/mydir[00m$ curl https://packages.gitlab.com/install/repositories/gitlab/gitlab-ce/script.deb.sh | sudo bash
[?2004l  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0  0     0    0     0    0     0      0      0 --:--:--  0:00:01 --:--:--     0  0     0    0     0    0     0      0      0 --:--:--  0:00:02 --:--:--     0  0     0    0     0    0     0      0      0 --:--:--  0:00:03 --:--:--     0  0     0    0     0    0     0      0      0 --:--:--  0:00:04 --:--:--     0  0     0    0     0    0     0      0      0 --:--:--  0:00:05 --:--:--     0  0     0    0     0    0     0      0      0 --:--:--  0:00:06 --:--:--     0  0     0    0     0    0     0      0      0 --:--:--  0:00:07 --:--:--     0  0     0    0     0    0     0      0      0 --:--:--  0:00:08 --:--:--     0  0     0    0     0    0     0      0      0 --:--:--  0:00:09 --:--:--     0  0     0    0     0    0     0      0      0 --:--:--  0:00:10 --:--:--     0  0     0    0     0    0     0      0      0 --:--:--  0:00:11 --:--:--     0  0     0    0     0    0     0      0      0 --:--:--  0:00:12 --:--:--     0  0     0    0     0    0     0      0      0 --:--:--  0:00:13 --:--:--     0  0     0    0     0    0     0      0      0 --:--:--  0:00:14 --:--:--     0  0     0    0     0    0     0      0      0 --:--:--  0:00:15 --:--:--     0  0     0    0     0    0     0      0      0 --:--:--  0:00:16 --:--:--     0  0     0    0     0    0     0      0      0 --:--:--  0:00:17 --:--:--     0  0     0    0     0    0     0      0      0 --:--:--  0:00:18 --:--:--     0  0     0    0     0    0     0      0      0 --:--:--  0:00:19 --:--:--     0curl: (6) Could not resolve host: packages.gitlab.com
[?2004h]0;bezrukavnikov@vbox: ~/mydir[01;32mbezrukavnikov@vbox[00m:[01;34m~/mydir[00m$ Ñ‹Ð³Ð²Ð·[K[K[K[Ksuod a[K[K[K[Kdo apt install gitlab-ce
[?2004lReading package lists... 0%Reading package lists... 100%Reading package lists... Done
Building dependency tree... 0%Building dependency tree... 0%Building dependency tree... 50%Building dependency tree... 50%Building dependency tree... Done
Reading state information... 0% Reading state information... 0%Reading state information... Done
[1;31mE: [0mUnable to locate package gitlab-ce[0m
[?2004h]0;bezrukavnikov@vbox: ~/mydir[01;32mbezrukavnikov@vbox[00m:[01;34m~/mydir[00m$ curl https://packages.gitlab.com/install/repositories/gitlab/gitlab-ce/script.deb.sh | sudo bash
[?2004l  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0100  6865  100  6865    0     0  26684      0 --:--:-- --:--:-- --:--:-- 26816
Detected operating system as debian/bookworm.
Checking for curl...
Detected curl...
Checking for gpg...
Detected gpg...
Running apt-get update... done.
Installing debian-archive-keyring which is needed for installing 
apt-transport-https on many Debian systems.
Installing apt-transport-https... done.
Installing /etc/apt/sources.list.d/gitlab_gitlab-ce.list...curl: (6) Could not resolve host: packages.gitlab.com

Unable to run: 
    curl https://packages.gitlab.com/install/repositories/gitlab/gitlab-ce/config_file.list?os=debian&dist=bookworm&source=script

Double check your curl installation and try again.
[?2004h]0;bezrukavnikov@vbox: ~/mydir[01;32mbezrukavnikov@vbox[00m:[01;34m~/mydir[00m$ curl https://packages.gitlab.com/install/repositories/gitlab/gitlab-ce/script.deb.sh | sudo bash[A]0;bezrukavnikov@vbox: ~/mydir[01;32mbezrukavnikov@vbox[00m:[01;34m~/mydir[00m$ sudo apt install gitlab-ce[K
[K[A[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C
[?2004lReading package lists... 0%Reading package lists... 100%Reading package lists... Done
Building dependency tree... 0%Building dependency tree... 0%Building dependency tree... 50%Building dependency tree... 50%Building dependency tree... Done
Reading state information... 0% Reading state information... 0%Reading state information... Done
[1;31mE: [0mUnable to locate package gitlab-ce[0m
[?2004h]0;bezrukavnikov@vbox: ~/mydir[01;32mbezrukavnikov@vbox[00m:[01;34m~/mydir[00m$ ping -c 4 8.8.8.8
[?2004lPING 8.8.8.8 (8.8.8.8) 56(84) bytes of data.
64 bytes from 8.8.8.8: icmp_seq=1 ttl=107 time=22.5 ms
64 bytes from 8.8.8.8: icmp_seq=2 ttl=107 time=21.9 ms
64 bytes from 8.8.8.8: icmp_seq=3 ttl=107 time=21.5 ms
64 bytes from 8.8.8.8: icmp_seq=4 ttl=107 time=21.9 ms

--- 8.8.8.8 ping statistics ---
4 packets transmitted, 4 received, 0% packet loss, time 3008ms
rtt min/avg/max/mdev = 21.521/21.942/22.524/0.363 ms
[?2004h]0;bezrukavnikov@vbox: ~/mydir[01;32mbezrukavnikov@vbox[00m:[01;34m~/mydir[00m$ ping -c 4 google.com
[?2004lPING google.com (142.251.1.102) 56(84) bytes of data.
64 bytes from lb-in-f102.1e100.net (142.251.1.102): icmp_seq=1 ttl=106 time=26.3 ms
64 bytes from lb-in-f102.1e100.net (142.251.1.102): icmp_seq=2 ttl=106 time=25.4 ms
64 bytes from lb-in-f102.1e100.net (142.251.1.102): icmp_seq=3 ttl=106 time=25.9 ms
64 bytes from lb-in-f102.1e100.net (142.251.1.102): icmp_seq=4 ttl=106 time=25.8 ms

--- google.com ping statistics ---
4 packets transmitted, 4 received, 0% packet loss, time 3011ms
rtt min/avg/max/mdev = 25.372/25.844/26.314/0.336 ms
[?2004h]0;bezrukavnikov@vbox: ~/mydir[01;32mbezrukavnikov@vbox[00m:[01;34m~/mydir[00m$ curl https://packages.gitlab.com/install/repositories/gitlab/gitlab-ce/script.deb.sh | sudo bash
[?2004l  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0100  6865  100  6865    0     0  28118      0 --:--:-- --:--:-- --:--:-- 28251
Detected operating system as debian/bookworm.
Checking for curl...
Detected curl...
Checking for gpg...
Detected gpg...
Running apt-get update... done.
Installing debian-archive-keyring which is needed for installing 
apt-transport-https on many Debian systems.
Installing apt-transport-https... done.
Installing /etc/apt/sources.list.d/gitlab_gitlab-ce.list...done.
Importing packagecloud gpg key... done.
Running apt-get update... done.

The repository is setup! You can now install packages.
[?2004h]0;bezrukavnikov@vbox: ~/mydir[01;32mbezrukavnikov@vbox[00m:[01;34m~/mydir[00m$ curl https://packages.gitlab.com/install/repositories/gitlab/gitlab-ce/script.deb.sh | sudo bash[A]0;bezrukavnikov@vbox: ~/mydir[01;32mbezrukavnikov@vbox[00m:[01;34m~/mydir[00m$ ping -c 4 google.com[K
[K[A[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[3P8.8.8.8sudo apt install gitlab-ce
[?2004lReading package lists... 0%Reading package lists... 100%Reading package lists... Done
Building dependency tree... 0%Building dependency tree... 0%Building dependency tree... 50%Building dependency tree... 50%Building dependency tree... Done
Reading state information... 0% Reading state information... 0%Reading state information... Done
The following package was automatically installed and is no longer required:
  libdbus-glib-1-2
Use 'sudo apt autoremove' to remove it.
The following NEW packages will be installed:
  gitlab-ce
0 upgraded, 1 newly installed, 0 to remove and 262 not upgraded.
Need to get 1,413 MB of archives.
After this operation, 3,806 MB of additional disk space will be used.
[33m0% [Working][0m[33m0% [Working][0m            Get:1 https://packages.gitlab.com/gitlab/gitlab-ce/debian bookworm/main amd64 gitlab-ce amd64 18.1.2-ce.0 [1,413 MB]
[33m0% [1 gitlab-ce 0 B/1,413 MB 0%][0m[33m0% [1 gitlab-ce 2,622 kB/1,413 MB 0%][0m[33m1% [1 gitlab-ce 9,094 kB/1,413 MB 1%][0m[33m                                     1% [1 gitlab-ce 14.5 MB/1,413 MB 1%][0m[33m1% [1 gitlab-ce 20.5 MB/1,413 MB 1%][0m[33m1% [1 gitlab-ce 26.2 MB/1,413 MB 2%][0m[33m2% [1 gitlab-ce 32.0 MB/1,413 MB 2%][0m[33m2% [1 gitlab-ce 37.6 MB/1,413 MB 3%][0m[33m2% [1 gitlab-ce 43.3 MB/1,413 MB 3%][0m[33m3% [1 gitlab-ce 49.0 MB/1,413 MB 3%][0m[33m3% [1 gitlab-ce 54.8 MB/1,413 MB 4%][0m[33m3% [1 gitlab-ce 60.6 MB/1,413 MB 4%]                                                                9,499 kB/s 2min 22s[0m[33m4% [1 gitlab-ce 65.8 MB/1,413 MB 5%]                                                                9,499 kB/s 2min 21s[0m[33m4% [1 gitlab-ce 72.0 MB/1,413 MB 5%]                                                                9,499 kB/s 2min 21s[0m[33m4% [1 gitlab-ce 77.8 MB/1,413 MB 6%]                                                                9,499 kB/s 2min 20s[0m[33m5% [1 gitlab-ce 83.6 MB/1,413 MB 6%]                                                                9,499 kB/s 2min 19s[0m[33m5% [1 gitlab-ce 88.9 MB/1,413 MB 6%]                                                                9,499 kB/s 2min 19s[0m[33m5% [1 gitlab-ce 95.1 MB/1,413 MB 7%]                                                                9,499 kB/s 2min 18s[0m[33m6% [1 gitlab-ce 101 MB/1,413 MB 7%]                                                                 9,499 kB/s 2min 18s[0m[33m6% [1 gitlab-ce 106 MB/1,413 MB 7%]                                                                 9,499 kB/s 2min 17s[0m[33m6% [1 gitlab-ce 112 MB/1,413 MB 8%]                                                                 9,499 kB/s 2min 16s[0m[33m7% [1 gitlab-ce 118 MB/1,413 MB 8%]                                                                 9,499 kB/s 2min 16s[0m[33m7% [1 gitlab-ce 124 MB/1,413 MB 9%]                                                                 9,499 kB/s 2min 15s[0m[33m7% [1 gitlab-ce 127 MB/1,413 MB 9%]                                                                  11.0 MB/s 1min 57s[0m[33m7% [1 gitlab-ce 132 MB/1,413 MB 9%]                                                                  11.0 MB/s 1min 56s[0m[33m8% [1 gitlab-ce 138 MB/1,413 MB 10%]                                                                 11.0 MB/s 1min 56s[0m[33m8% [1 gitlab-ce 144 MB/1,413 MB 10%]                                                                 11.0 MB/s 1min 55s[0m[33m8% [1 gitlab-ce 150 MB/1,413 MB 11%]                                                                 11.0 MB/s 1min 55s[0m[33m9% [1 gitlab-ce 155 MB/1,413 MB 11%]                                                                 11.0 MB/s 1min 54s[0m[33m9% [1 gitlab-ce 161 MB/1,413 MB 11%]                                                                 11.0 MB/s 1min 54s[0m[33m9% [1 gitlab-ce 167 MB/1,413 MB 12%]                                                                 11.0 MB/s 1min 53s[0m[33m10% [1 gitlab-ce 173 MB/1,413 MB 12%]                                                                11.0 MB/s 1min 52s[0m[33m10% [1 gitlab-ce 179 MB/1,413 MB 13%]                                                                11.0 MB/s 1min 52s[0m[33m10% [1 gitlab-ce 184 MB/1,413 MB 13%]                                                                11.0 MB/s 1min 51s[0m[33m11% [1 gitlab-ce 190 MB/1,413 MB 13%]                                                                11.0 MB/s 1min 51s[0m[33m11% [1 gitlab-ce 196 MB/1,413 MB 14%]                                                                11.4 MB/s 1min 46s[0m[33m11% [1 gitlab-ce 201 MB/1,413 MB 14%]                                                                11.4 MB/s 1min 46s[0m[33m12% [1 gitlab-ce 207 MB/1,413 MB 15%]                                                                11.4 MB/s 1min 45s[0m[33m12% [1 gitlab-ce 213 MB/1,413 MB 15%]                                                                11.4 MB/s 1min 45s[0m[33m12% [1 gitlab-ce 219 MB/1,413 MB 15%]                                                                11.4 MB/s 1min 44s[0m[33m13% [1 gitlab-ce 224 MB/1,413 MB 16%]                                                                11.4 MB/s 1min 44s[0m[33m13% [1 gitlab-ce 230 MB/1,413 MB 16%]                                                                11.4 MB/s 1min 43s[0m[33m13% [1 gitlab-ce 236 MB/1,413 MB 17%]                                                                11.4 MB/s 1min 43s[0m[33m14% [1 gitlab-ce 240 MB/1,413 MB 17%]                                                                11.4 MB/s 1min 42s[0m[33m14% [1 gitlab-ce 244 MB/1,413 MB 17%]                                                                11.4 MB/s 1min 42s[0m[33m14% [1 gitlab-ce 250 MB/1,413 MB 18%]                                                                11.4 MB/s 1min 41s[0m[33m14% [1 gitlab-ce 255 MB/1,413 MB 18%]                                                                11.4 MB/s 1min 41s[0m[33m15% [1 gitlab-ce 262 MB/1,413 MB 19%]                                                                10.9 MB/s 1min 45s[0m[33m15% [1 gitlab-ce 267 MB/1,413 MB 19%]                                                                10.9 MB/s 1min 44s[0m[33m15% [1 gitlab-ce 273 MB/1,413 MB 19%]                                                                10.9 MB/s 1min 44s[0m[33m16% [1 gitlab-ce 278 MB/1,413 MB 20%]                                                                10.9 MB/s 1min 43s[0m[33m16% [1 gitlab-ce 285 MB/1,413 MB 20%]                                                                10.9 MB/s 1min 43s[0m[33m16% [1 gitlab-ce 290 MB/1,413 MB 21%]                                                                10.9 MB/s 1min 42s[0m[33m17% [1 gitlab-ce 296 MB/1,413 MB 21%]                                                                10.9 MB/s 1min 42s[0m[33m17% [1 gitlab-ce 302 MB/1,413 MB 21%]                                                                10.9 MB/s 1min 41s[0m[33m17% [1 gitlab-ce 308 MB/1,413 MB 22%]                                                                10.9 MB/s 1min 41s[0m[33m18% [1 gitlab-ce 314 MB/1,413 MB 22%]                                                                10.9 MB/s 1min 40s[0m[33m18% [1 gitlab-ce 319 MB/1,413 MB 23%]                                                                10.9 MB/s 1min 40s[0m[33m18% [1 gitlab-ce 325 MB/1,413 MB 23%]                                                                10.9 MB/s 1min 39s[0m[33m19% [1 gitlab-ce 331 MB/1,413 MB 23%]                                                                11.5 MB/s 1min 34s[0m[33m19% [1 gitlab-ce 337 MB/1,413 MB 24%]                                                                11.5 MB/s 1min 33s[0m[33m19% [1 gitlab-ce 343 MB/1,413 MB 24%]                                                                11.5 MB/s 1min 33s[0m[33m20% [1 gitlab-ce 348 MB/1,413 MB 25%]                                                                11.5 MB/s 1min 32s[0m[33m20% [1 gitlab-ce 354 MB/1,413 MB 25%]                                                                11.5 MB/s 1min 32s[0m[33m20% [1 gitlab-ce 357 MB/1,413 MB 25%]                                                                11.5 MB/s 1min 31s[0m[33m21% [1 gitlab-ce 362 MB/1,413 MB 26%]                                                                11.5 MB/s 1min 31s[0m[33m21% [1 gitlab-ce 368 MB/1,413 MB 26%]                                                                11.5 MB/s 1min 30s[0m[33m21% [1 gitlab-ce 374 MB/1,413 MB 26%]                                                                11.5 MB/s 1min 30s[0m[33m21% [1 gitlab-ce 380 MB/1,413 MB 27%]                                                                11.5 MB/s 1min 29s[0m[33m22% [1 gitlab-ce 385 MB/1,413 MB 27%]                                                                11.5 MB/s 1min 29s[0m[33m22% [1 gitlab-ce 391 MB/1,413 MB 28%]                                                                11.5 MB/s 1min 28s[0m[33m22% [1 gitlab-ce 397 MB/1,413 MB 28%]                                                                10.9 MB/s 1min 32s[0m[33m23% [1 gitlab-ce 403 MB/1,413 MB 28%]                                                                10.9 MB/s 1min 32s[0m[33m23% [1 gitlab-ce 408 MB/1,413 MB 29%]                                                                10.9 MB/s 1min 31s[0m[33m23% [1 gitlab-ce 414 MB/1,413 MB 29%]                                                                10.9 MB/s 1min 31s[0m[33m24% [1 gitlab-ce 420 MB/1,413 MB 30%]                                                                10.9 MB/s 1min 30s[0m[33m24% [1 gitlab-ce 426 MB/1,413 MB 30%]                                                                10.9 MB/s 1min 30s[0m[33m24% [1 gitlab-ce 431 MB/1,413 MB 30%]                                                                10.9 MB/s 1min 29s[0m[33m25% [1 gitlab-ce 437 MB/1,413 MB 31%]                                                                10.9 MB/s 1min 29s[0m[33m25% [1 gitlab-ce 443 MB/1,413 MB 31%]                                                                10.9 MB/s 1min 28s[0m[33m25% [1 gitlab-ce 448 MB/1,413 MB 32%]                                                                10.9 MB/s 1min 28s[0m[33m26% [1 gitlab-ce 454 MB/1,413 MB 32%]                                                                10.9 MB/s 1min 27s[0m[33m26% [1 gitlab-ce 460 MB/1,413 MB 33%]                                                                10.9 MB/s 1min 27s[0m[33m26% [1 gitlab-ce 466 MB/1,413 MB 33%]                                                                11.4 MB/s 1min 22s[0m[33m27% [1 gitlab-ce 471 MB/1,413 MB 33%]                                                                11.4 MB/s 1min 22s[0m[33m27% [1 gitlab-ce 477 MB/1,413 MB 34%]                                                                11.4 MB/s 1min 21s[0m[33m27% [1 gitlab-ce 483 MB/1,413 MB 34%]                                                                11.4 MB/s 1min 21s[0m[33m28% [1 gitlab-ce 489 MB/1,413 MB 35%]                                                                11.4 MB/s 1min 20s[0m[33m28% [1 gitlab-ce 494 MB/1,413 MB 35%]                                                                11.4 MB/s 1min 20s[0m[33m28% [1 gitlab-ce 500 MB/1,413 MB 35%]                                                                11.4 MB/s 1min 19s[0m[33m29% [1 gitlab-ce 506 MB/1,413 MB 36%]                                                                11.4 MB/s 1min 19s[0m[33m29% [1 gitlab-ce 512 MB/1,413 MB 36%]                                                                11.4 MB/s 1min 18s[0m[33m29% [1 gitlab-ce 517 MB/1,413 MB 37%]                                                                11.4 MB/s 1min 18s[0m[33m30% [1 gitlab-ce 523 MB/1,413 MB 37%]                                                                11.4 MB/s 1min 17s[0m[33m30% [1 gitlab-ce 529 MB/1,413 MB 37%]                                                                11.4 MB/s 1min 17s[0m[33m30% [1 gitlab-ce 535 MB/1,413 MB 38%]                                                                11.5 MB/s 1min 16s[0m[33m31% [1 gitlab-ce 540 MB/1,413 MB 38%]                                                                11.5 MB/s 1min 16s[0m[33m31% [1 gitlab-ce 546 MB/1,413 MB 39%]                                                                11.5 MB/s 1min 15s[0m[33m31% [1 gitlab-ce 552 MB/1,413 MB 39%]                                                                11.5 MB/s 1min 15s[0m[33m32% [1 gitlab-ce 558 MB/1,413 MB 39%]                                                                11.5 MB/s 1min 14s[0m[33m32% [1 gitlab-ce 560 MB/1,413 MB 40%]                                                                11.5 MB/s 1min 14s[0m[33m32% [1 gitlab-ce 566 MB/1,413 MB 40%]                                                                11.5 MB/s 1min 14s[0m[33m32% [1 gitlab-ce 572 MB/1,413 MB 40%]                                                                11.5 MB/s 1min 13s[0m[33m33% [1 gitlab-ce 578 MB/1,413 MB 41%]                                                                11.5 MB/s 1min 12s[0m[33m33% [1 gitlab-ce 583 MB/1,413 MB 41%]                                                                11.5 MB/s 1min 12s[0m[33m33% [1 gitlab-ce 589 MB/1,413 MB 42%]                                                                11.5 MB/s 1min 11s[0m[33m34% [1 gitlab-ce 595 MB/1,413 MB 42%]                                                                11.5 MB/s 1min 11s[0m[33m34% [1 gitlab-ce 601 MB/1,413 MB 43%]                                                                11.0 MB/s 1min 14s[0m[33m34% [1 gitlab-ce 606 MB/1,413 MB 43%]                                                                11.0 MB/s 1min 13s[0m[33m35% [1 gitlab-ce 612 MB/1,413 MB 43%]                                                                11.0 MB/s 1min 13s[0m[33m35% [1 gitlab-ce 618 MB/1,413 MB 44%]                                                                11.0 MB/s 1min 12s[0m[33m36% [1 gitlab-ce 627 MB/1,413 MB 44%]                                                                11.0 MB/s 1min 11s[0m[33m36% [1 gitlab-ce 633 MB/1,413 MB 45%]                                                                11.0 MB/s 1min 11s[0m[33m36% [1 gitlab-ce 639 MB/1,413 MB 45%]                                                                11.0 MB/s 1min 10s[0m[33m36% [1 gitlab-ce 644 MB/1,413 MB 46%]                                                                11.0 MB/s 1min 10s[0m[33m37% [1 gitlab-ce 650 MB/1,413 MB 46%]                                                                 11.0 MB/s 1min 9s[0m[33m37% [1 gitlab-ce 656 MB/1,413 MB 46%]                                                                 11.0 MB/s 1min 9s[0m[33m37% [1 gitlab-ce 662 MB/1,413 MB 47%]                                                                 11.0 MB/s 1min 8s[0m[33m38% [1 gitlab-ce 667 MB/1,413 MB 47%]                                                                 11.0 MB/s 1min 8s[0m[33m38% [1 gitlab-ce 673 MB/1,413 MB 48%]                                                                 11.3 MB/s 1min 5s[0m[33m38% [1 gitlab-ce 676 MB/1,413 MB 48%]                                                                 11.3 MB/s 1min 5s[0m[33m39% [1 gitlab-ce 682 MB/1,413 MB 48%]                                                                 11.3 MB/s 1min 4s[0m[33m39% [1 gitlab-ce 687 MB/1,413 MB 49%]                                                                 11.3 MB/s 1min 4s[0m[33m39% [1 gitlab-ce 693 MB/1,413 MB 49%]                                                                 11.3 MB/s 1min 3s[0m[33m40% [1 gitlab-ce 699 MB/1,413 MB 49%]                                                                 11.3 MB/s 1min 3s[0m[33m40% [1 gitlab-ce 705 MB/1,413 MB 50%]                                                                 11.3 MB/s 1min 2s[0m[33m40% [1 gitlab-ce 710 MB/1,413 MB 50%]                                                                 11.3 MB/s 1min 2s[0m[33m41% [1 gitlab-ce 717 MB/1,413 MB 51%]                                                                 11.3 MB/s 1min 1s[0m[33m41% [1 gitlab-ce 722 MB/1,413 MB 51%]                                                                 11.3 MB/s 1min 1s[0m[33m41% [1 gitlab-ce 728 MB/1,413 MB 52%]                                                                     11.3 MB/s 60s[0m[33m42% [1 gitlab-ce 733 MB/1,413 MB 52%]                                                                     11.3 MB/s 60s[0m[33m42% [1 gitlab-ce 740 MB/1,413 MB 52%]                                                                 11.0 MB/s 1min 1s[0m[33m42% [1 gitlab-ce 745 MB/1,413 MB 53%]                                                                     11.0 MB/s 60s[0m[33m43% [1 gitlab-ce 751 MB/1,413 MB 53%]                                                                     11.0 MB/s 60s[0m[33m43% [1 gitlab-ce 756 MB/1,413 MB 54%]                                                                     11.0 MB/s 59s[0m[33m43% [1 gitlab-ce 763 MB/1,413 MB 54%]                                                                     11.0 MB/s 59s[0m[33m44% [1 gitlab-ce 768 MB/1,413 MB 54%]                                                                     11.0 MB/s 58s[0m[33m44% [1 gitlab-ce 774 MB/1,413 MB 55%]                                                                     11.0 MB/s 58s[0m[33m44% [1 gitlab-ce 780 MB/1,413 MB 55%]                                                                     11.0 MB/s 57s[0m[33m44% [1 gitlab-ce 785 MB/1,413 MB 56%]                                                                     11.0 MB/s 57s[0m[33m45% [1 gitlab-ce 791 MB/1,413 MB 56%]                                                                     11.0 MB/s 56s[0m[33m45% [1 gitlab-ce 794 MB/1,413 MB 56%]                                                                     11.0 MB/s 56s[0m[33m45% [1 gitlab-ce 799 MB/1,413 MB 57%]                                                                     11.0 MB/s 55s[0m[33m46% [1 gitlab-ce 806 MB/1,413 MB 57%]                                                                     10.9 MB/s 55s[0m[33m46% [1 gitlab-ce 811 MB/1,413 MB 57%]                                                                     10.9 MB/s 54s[0m[33m46% [1 gitlab-ce 817 MB/1,413 MB 58%]                                                                     10.9 MB/s 54s[0m[33m47% [1 gitlab-ce 822 MB/1,413 MB 58%]                                                                     10.9 MB/s 53s[0m[33m47% [1 gitlab-ce 829 MB/1,413 MB 59%]                                                                     10.9 MB/s 53s[0m[33m47% [1 gitlab-ce 834 MB/1,413 MB 59%]                                                                     10.9 MB/s 52s[0m[33m48% [1 gitlab-ce 840 MB/1,413 MB 59%]                                                                     10.9 MB/s 52s[0m[33m48% [1 gitlab-ce 845 MB/1,413 MB 60%]                                                                     10.9 MB/s 51s[0m[33m48% [1 gitlab-ce 852 MB/1,413 MB 60%]                                                                     10.9 MB/s 51s[0m[33m49% [1 gitlab-ce 857 MB/1,413 MB 61%]                                                                     10.9 MB/s 50s[0m[33m49% [1 gitlab-ce 863 MB/1,413 MB 61%]                                                                     10.9 MB/s 50s[0m[33m49% [1 gitlab-ce 868 MB/1,413 MB 61%]                                                                     10.9 MB/s 49s[0m[33m50% [1 gitlab-ce 874 MB/1,413 MB 62%]                                                                     11.4 MB/s 47s[0m[33m50% [1 gitlab-ce 880 MB/1,413 MB 62%]                                                                     11.4 MB/s 46s[0m[33m50% [1 gitlab-ce 886 MB/1,413 MB 63%]                                                                     11.4 MB/s 46s[0m[33m50% [1 gitlab-ce 892 MB/1,413 MB 63%]                                                                     11.4 MB/s 45s[0m[33m51% [1 gitlab-ce 897 MB/1,413 MB 63%]                                                                     11.4 MB/s 45s[0m[33m51% [1 gitlab-ce 903 MB/1,413 MB 64%]                                                                     11.4 MB/s 44s[0m[33m51% [1 gitlab-ce 909 MB/1,413 MB 64%]                                                                     11.4 MB/s 44s[0m[33m52% [1 gitlab-ce 912 MB/1,413 MB 65%]                                                                     11.4 MB/s 43s[0m[33m52% [1 gitlab-ce 917 MB/1,413 MB 65%]                                                                     11.4 MB/s 43s[0m[33m52% [1 gitlab-ce 923 MB/1,413 MB 65%]                                                                     11.4 MB/s 42s[0m[33m53% [1 gitlab-ce 929 MB/1,413 MB 66%]                                                                     11.4 MB/s 42s[0m[33m53% [1 gitlab-ce 934 MB/1,413 MB 66%]                                                                     11.4 MB/s 41s[0m[33m53% [1 gitlab-ce 940 MB/1,413 MB 67%]                                                                     10.9 MB/s 43s[0m[33m54% [1 gitlab-ce 946 MB/1,413 MB 67%]                                                                     10.9 MB/s 42s[0m[33m54% [1 gitlab-ce 952 MB/1,413 MB 67%]                                                                     10.9 MB/s 42s[0m[33m54% [1 gitlab-ce 957 MB/1,413 MB 68%]                                                                     10.9 MB/s 41s[0m[33m55% [1 gitlab-ce 963 MB/1,413 MB 68%]                                                                     10.9 MB/s 41s[0m[33m55% [1 gitlab-ce 969 MB/1,413 MB 69%]                                                                     10.9 MB/s 40s[0m[33m55% [1 gitlab-ce 975 MB/1,413 MB 69%]                                                                     10.9 MB/s 40s[0m[33m55% [1 gitlab-ce 979 MB/1,413 MB 69%]                                                                     10.9 MB/s 39s[0m[33m56% [1 gitlab-ce 988 MB/1,413 MB 70%]                                                                     10.9 MB/s 39s[0m[33m56% [1 gitlab-ce 994 MB/1,413 MB 70%]                                                                     10.9 MB/s 38s[0m[33m57% [1 gitlab-ce 999 MB/1,413 MB 71%]                                                                     10.9 MB/s 37s[0m[33m57% [1 gitlab-ce 1,005 MB/1,413 MB 71%]                                                                   10.9 MB/s 37s[0m[33m57% [1 gitlab-ce 1,011 MB/1,413 MB 72%]                                                                   11.4 MB/s 35s[0m[33m58% [1 gitlab-ce 1,017 MB/1,413 MB 72%]                                                                   11.4 MB/s 34s[0m[33m58% [1 gitlab-ce 1,023 MB/1,413 MB 72%]                                                                   11.4 MB/s 34s[0m[33m58% [1 gitlab-ce 1,028 MB/1,413 MB 73%]                                                                   11.4 MB/s 33s[0m[33m58% [1 gitlab-ce 1,031 MB/1,413 MB 73%]                                                                   11.4 MB/s 33s[0m[33m59% [1 gitlab-ce 1,037 MB/1,413 MB 73%]                                                                   11.4 MB/s 32s[0m[33m59% [1 gitlab-ce 1,043 MB/1,413 MB 74%]                                                                   11.4 MB/s 32s[0m[33m59% [1 gitlab-ce 1,048 MB/1,413 MB 74%]                                                                   11.4 MB/s 31s[0m[33m60% [1 gitlab-ce 1,054 MB/1,413 MB 75%]                                                                   11.4 MB/s 31s[0m[33m60% [1 gitlab-ce 1,060 MB/1,413 MB 75%]                                                                   11.4 MB/s 30s[0m[33m60% [1 gitlab-ce 1,066 MB/1,413 MB 75%]                                                                   11.4 MB/s 30s[0m[33m61% [1 gitlab-ce 1,071 MB/1,413 MB 76%]                                                                   11.4 MB/s 29s[0m[33m61% [1 gitlab-ce 1,077 MB/1,413 MB 76%]                                                                   11.0 MB/s 30s[0m[33m61% [1 gitlab-ce 1,083 MB/1,413 MB 77%]                                                                   11.0 MB/s 30s[0m[33m62% [1 gitlab-ce 1,089 MB/1,413 MB 77%]                                                                   11.0 MB/s 29s[0m[33m62% [1 gitlab-ce 1,094 MB/1,413 MB 77%]                                                                   11.0 MB/s 29s[0m[33m62% [1 gitlab-ce 1,100 MB/1,413 MB 78%]                                                                   11.0 MB/s 28s[0m[33m63% [1 gitlab-ce 1,106 MB/1,413 MB 78%]                                                                   11.0 MB/s 27s[0m[33m63% [1 gitlab-ce 1,111 MB/1,413 MB 79%]                                                                   11.0 MB/s 27s[0m[33m63% [1 gitlab-ce 1,117 MB/1,413 MB 79%]                                                                   11.0 MB/s 26s[0m[33m64% [1 gitlab-ce 1,123 MB/1,413 MB 79%]                                                                   11.0 MB/s 26s[0m[33m64% [1 gitlab-ce 1,129 MB/1,413 MB 80%]                                                                   11.0 MB/s 25s[0m[33m64% [1 gitlab-ce 1,134 MB/1,413 MB 80%]                                                                   11.0 MB/s 25s[0m[33m65% [1 gitlab-ce 1,140 MB/1,413 MB 81%]                                                                   11.0 MB/s 24s[0m[33m65% [1 gitlab-ce 1,146 MB/1,413 MB 81%]                                                                   11.4 MB/s 23s[0m[33m65% [1 gitlab-ce 1,149 MB/1,413 MB 81%]                                                                   11.4 MB/s 23s[0m[33m65% [1 gitlab-ce 1,154 MB/1,413 MB 82%]                                                                   11.4 MB/s 22s[0m[33m66% [1 gitlab-ce 1,160 MB/1,413 MB 82%]                                                                   11.4 MB/s 22s[0m[33m66% [1 gitlab-ce 1,166 MB/1,413 MB 83%]                                                                   11.4 MB/s 21s[0m[33m66% [1 gitlab-ce 1,172 MB/1,413 MB 83%]                                                                   11.4 MB/s 21s[0m[33m67% [1 gitlab-ce 1,177 MB/1,413 MB 83%]                                                                   11.4 MB/s 20s[0m[33m67% [1 gitlab-ce 1,183 MB/1,413 MB 84%]                                                                   11.4 MB/s 20s[0m[33m67% [1 gitlab-ce 1,189 MB/1,413 MB 84%]                                                                   11.4 MB/s 19s[0m[33m68% [1 gitlab-ce 1,195 MB/1,413 MB 85%]                                                                   11.4 MB/s 19s[0m[33m68% [1 gitlab-ce 1,200 MB/1,413 MB 85%]                                                                   11.4 MB/s 18s[0m[33m68% [1 gitlab-ce 1,206 MB/1,413 MB 85%]                                                                   11.4 MB/s 18s[0m[33m69% [1 gitlab-ce 1,212 MB/1,413 MB 86%]                                                                   10.9 MB/s 18s[0m[33m69% [1 gitlab-ce 1,218 MB/1,413 MB 86%]                                                                   10.9 MB/s 17s[0m[33m69% [1 gitlab-ce 1,223 MB/1,413 MB 87%]                                                                   10.9 MB/s 17s[0m[33m70% [1 gitlab-ce 1,229 MB/1,413 MB 87%]                                                                   10.9 MB/s 16s[0m[33m70% [1 gitlab-ce 1,235 MB/1,413 MB 87%]                                                                   10.9 MB/s 16s[0m[33m70% [1 gitlab-ce 1,241 MB/1,413 MB 88%]                                                                   10.9 MB/s 15s[0m[33m71% [1 gitlab-ce 1,246 MB/1,413 MB 88%]                                                                   10.9 MB/s 15s[0m[33m71% [1 gitlab-ce 1,252 MB/1,413 MB 89%]                                                                   10.9 MB/s 14s[0m[33m71% [1 gitlab-ce 1,258 MB/1,413 MB 89%]                                                                   10.9 MB/s 14s[0m[33m72% [1 gitlab-ce 1,263 MB/1,413 MB 89%]                                                                   10.9 MB/s 13s[0m[33m72% [1 gitlab-ce 1,266 MB/1,413 MB 90%]                                                                   10.9 MB/s 13s[0m[33m72% [1 gitlab-ce 1,272 MB/1,413 MB 90%]                                                                   10.9 MB/s 12s[0m[33m72% [1 gitlab-ce 1,277 MB/1,413 MB 90%]                                                                   10.9 MB/s 12s[0m[33m73% [1 gitlab-ce 1,284 MB/1,413 MB 91%]                                                                   10.9 MB/s 11s[0m[33m73% [1 gitlab-ce 1,289 MB/1,413 MB 91%]                                                                   10.9 MB/s 11s[0m[33m73% [1 gitlab-ce 1,295 MB/1,413 MB 92%]                                                                   10.9 MB/s 10s[0m[33m74% [1 gitlab-ce 1,301 MB/1,413 MB 92%]                                                                   10.9 MB/s 10s[0m[33m74% [1 gitlab-ce 1,307 MB/1,413 MB 92%]                                                                    10.9 MB/s 9s[0m[33m74% [1 gitlab-ce 1,313 MB/1,413 MB 93%]                                                                    10.9 MB/s 9s[0m[33m75% [1 gitlab-ce 1,318 MB/1,413 MB 93%]                                                                    10.9 MB/s 8s[0m[33m75% [1 gitlab-ce 1,324 MB/1,413 MB 94%]                                                                    10.9 MB/s 8s[0m[33m75% [1 gitlab-ce 1,329 MB/1,413 MB 94%]                                                                    10.9 MB/s 7s[0m[33m76% [1 gitlab-ce 1,336 MB/1,413 MB 95%]                                                                    10.9 MB/s 7s[0m[33m76% [1 gitlab-ce 1,341 MB/1,413 MB 95%]                                                                    10.9 MB/s 6s[0m[33m76% [1 gitlab-ce 1,347 MB/1,413 MB 95%]                                                                    11.5 MB/s 5s[0m[33m77% [1 gitlab-ce 1,352 MB/1,413 MB 96%]                                                                    11.5 MB/s 5s[0m[33m77% [1 gitlab-ce 1,359 MB/1,413 MB 96%]                                                                    11.5 MB/s 4s[0m[33m77% [1 gitlab-ce 1,362 MB/1,413 MB 96%]                                                                    11.5 MB/s 4s[0m[33m78% [1 gitlab-ce 1,369 MB/1,413 MB 97%]                                                                    11.5 MB/s 3s[0m[33m78% [1 gitlab-ce 1,375 MB/1,413 MB 97%]                                                                    11.5 MB/s 3s[0m[33m78% [1 gitlab-ce 1,382 MB/1,413 MB 98%]                                                                    11.5 MB/s 2s[0m[33m78% [1 gitlab-ce 1,385 MB/1,413 MB 98%]                                                                    11.5 MB/s 2s[0m[33m79% [1 gitlab-ce 1,390 MB/1,413 MB 98%]                                                                    11.5 MB/s 1s[0m[33m79% [1 gitlab-ce 1,396 MB/1,413 MB 99%]                                                                    11.5 MB/s 1s[0m[33m79% [1 gitlab-ce 1,402 MB/1,413 MB 99%]                                                                    11.5 MB/s 0s[0m[33m80% [1 gitlab-ce 1,407 MB/1,413 MB 100%]                                                                   11.5 MB/s 0s[0m[33m80% [1 gitlab-ce 1,413 MB/1,413 MB 100%]                                                                   10.9 MB/s 0s[0m[33m100% [Working]                                                                            =========================================================================            ]Scanning processes... [=====================================================================================           ]Scanning processes... [=====================================================================================           ]Scanning processes... [=====================================================================================           ]Scanning processes... [======================================================================================          ]Scanning processes... [======================================================================================          ]Scanning processes... [=======================================================================================         ]Scanning processes... [=======================================================================================         ]Scanning processes... [========================================================================================        ]Scanning processes... [========================================================================================        ]Scanning processes... [=========================================================================================       ]Scanning processes... [=========================================================================================       ]Scanning processes... [==========================================================================================      ]Scanning processes... [==========================================================================================      ]Scanning processes... [===========================================================================================     ]Scanning processes... [===========================================================================================     ]Scanning processes... [============================================================================================    ]Scanning processes... [============================================================================================    ]Scanning processes... [=============================================================================================   ]Scanning processes... [=============================================================================================   ]Scanning processes... [==============================================================================================  ]Scanning processes... [==============================================================================================  ]Scanning processes... [=============================================================================================== ]Scanning processes... [=============================================================================================== ]Scanning processes... [================================================================================================]Scanning processes...                                                                                                   
Scanning linux images... [                                                                                             ]Scanning linux images... [==============================================                                               ]Scanning linux images... [=============================================================================================]Scanning linux images...                                                                                                

Running kernel seems to be up-to-date.

No services need to be restarted.

No containers need to be restarted.

No user sessions are running outdated binaries.

No VM guests are running outdated hypervisor (qemu) binaries on this host.
[?2004h]0;bezrukavnikov@vbox: ~/mydir[01;32mbezrukavnikov@vbox[00m:[01;34m~/mydir[00m$ sudo gitlab-ctl reconfigure
[?2004l[2025-07-12T20:43:55+03:00] INFO: Started Cinc Zero at chefzero://localhost:1 with repository at /opt/gitlab/embedded (One version per cookbook)
Cinc Client, version 18.3.0
Patents: https://www.chef.io/patents
Infra Phase starting
[2025-07-12T20:43:56+03:00] INFO: *** Cinc Client 18.3.0 ***
[2025-07-12T20:43:56+03:00] INFO: Platform: x86_64-linux
[2025-07-12T20:43:56+03:00] INFO: Cinc-client pid: 17810
/opt/gitlab/embedded/lib/ruby/gems/3.2.0/gems/ffi-yajl-2.6.0/lib/ffi_yajl/encoder.rb:42: warning: undefining the allocator of T_DATA class FFI_Yajl::Ext::Encoder::YajlGen
[2025-07-12T20:43:57+03:00] INFO: Setting the run_list to ["recipe[gitlab]"] from CLI options
[2025-07-12T20:43:57+03:00] INFO: Run List is [recipe[gitlab]]
[2025-07-12T20:43:57+03:00] INFO: Run List expands to [gitlab]
[2025-07-12T20:43:57+03:00] INFO: Starting Cinc Client Run for vbox.myguest.virtualbox.org
[2025-07-12T20:43:57+03:00] INFO: Running start handlers
[2025-07-12T20:43:57+03:00] INFO: Start handlers complete.
Resolving cookbooks for run list: ["gitlab"]
[2025-07-12T20:43:58+03:00] INFO: Loading cookbooks [gitlab@0.0.1, package@0.1.0, logrotate@0.1.0, postgresql@0.1.0, redis@0.1.0, monitoring@0.1.0, registry@0.1.0, mattermost@0.1.0, consul@0.1.0, gitaly@0.1.0, praefect@0.1.0, gitlab-kas@0.1.0, gitlab-pages@0.1.0, letsencrypt@0.1.0, nginx@0.1.0, runit@5.1.7, acme@4.1.6, crond@0.1.0]
Synchronizing cookbooks:
[2025-07-12T20:43:58+03:00] INFO: Storing updated cookbooks/gitlab/templates/default/cable.yml.erb in the cache.
[2025-07-12T20:43:58+03:00] INFO: Storing updated cookbooks/gitlab/templates/default/gitconfig-system.erb in the cache.
[2025-07-12T20:43:58+03:00] INFO: Storing updated cookbooks/gitlab/templates/default/gitlab-healthcheck-rc.erb in the cache.
[2025-07-12T20:43:58+03:00] INFO: Storing updated cookbooks/gitlab/templates/default/gitlab-rails-rc.erb in the cache.
[2025-07-12T20:43:58+03:00] INFO: Storing updated cookbooks/gitlab/templates/default/database.yml.erb in the cache.
[2025-07-12T20:43:58+03:00] INFO: Storing updated cookbooks/gitlab/templates/default/gitlab-shell-config.yml.erb in the cache.
[2025-07-12T20:43:58+03:00] INFO: Storing updated cookbooks/gitlab/templates/default/gitlab.yml.erb in the cache.
[2025-07-12T20:43:58+03:00] INFO: Storing updated cookbooks/gitlab/templates/default/gitlab-backup-cli-config.yml.erb in the cache.
[2025-07-12T20:43:58+03:00] INFO: Storing updated cookbooks/gitlab/templates/default/click_house.yml.erb in the cache.
[2025-07-12T20:43:58+03:00] INFO: Storing updated cookbooks/gitlab/templates/default/gitlab-rails-error.html.erb in the cache.
[2025-07-12T20:43:58+03:00] INFO: Storing updated cookbooks/gitlab/templates/default/mount_point_check.erb in the cache.
[2025-07-12T20:43:58+03:00] INFO: Storing updated cookbooks/gitlab/templates/default/nginx-gitlab-health.conf.erb in the cache.
[2025-07-12T20:43:58+03:00] INFO: Storing updated cookbooks/gitlab/templates/default/gitconfig.erb in the cache.
[2025-07-12T20:43:58+03:00] INFO: Storing updated cookbooks/gitlab/templates/default/make_metrics_rundir.erb in the cache.
[2025-07-12T20:43:58+03:00] INFO: Storing updated cookbooks/gitlab/templates/default/nginx-gitlab-mattermost-http.conf.erb in the cache.
[2025-07-12T20:43:58+03:00] INFO: Storing updated cookbooks/gitlab/templates/default/nginx-gitlab-http.conf.erb in the cache.
[2025-07-12T20:43:58+03:00] INFO: Storing updated cookbooks/gitlab/templates/default/nginx.conf.erb in the cache.
[2025-07-12T20:43:58+03:00] INFO: Storing updated cookbooks/gitlab/templates/default/redis.yml.erb in the cache.
[2025-07-12T20:43:58+03:00] INFO: Storing updated cookbooks/gitlab/templates/default/nginx-gitlab-registry-http.conf.erb in the cache.
[2025-07-12T20:43:58+03:00] INFO: Storing updated cookbooks/gitlab/templates/default/remote_syslog.yml.erb in the cache.
[2025-07-12T20:43:58+03:00] INFO: Storing updated cookbooks/gitlab/templates/default/nginx-status.conf.erb in the cache.
[2025-07-12T20:43:58+03:00] INFO: Storing updated cookbooks/gitlab/templates/default/resque.yml.erb in the cache.
[2025-07-12T20:43:58+03:00] INFO: Storing updated cookbooks/gitlab/templates/default/nginx-gitlab-pages-http.conf.erb in the cache.
[2025-07-12T20:43:58+03:00] INFO: Storing updated cookbooks/gitlab/templates/default/secrets.yml.erb in the cache.
[2025-07-12T20:43:58+03:00] INFO: Storing updated cookbooks/gitlab/templates/default/puma.rb.erb in the cache.
[2025-07-12T20:43:58+03:00] INFO: Storing updated cookbooks/gitlab/templates/default/smtp_settings.rb.erb in the cache.
[2025-07-12T20:43:58+03:00] INFO: Storing updated cookbooks/gitlab/templates/default/sv-gitlab-workhorse-log-config.erb in the cache.
[2025-07-12T20:43:58+03:00] INFO: Storing updated cookbooks/gitlab/templates/default/sv-gitlab-sshd-log-run.erb in the cache.
[2025-07-12T20:43:58+03:00] INFO: Storing updated cookbooks/gitlab/templates/default/session_store.yml.erb in the cache.
[2025-07-12T20:43:58+03:00] INFO: Storing updated cookbooks/gitlab/templates/default/secret_token.erb in the cache.
[2025-07-12T20:43:58+03:00] INFO: Storing updated cookbooks/gitlab/templates/default/sv-gitlab-sshd-log-config.erb in the cache.
[2025-07-12T20:43:58+03:00] INFO: Storing updated cookbooks/gitlab/templates/default/sv-gitlab-sshd-run.erb in the cache.
[2025-07-12T20:43:58+03:00] INFO: Storing updated cookbooks/gitlab/templates/default/sv-gitlab-workhorse-log-run.erb in the cache.
[2025-07-12T20:43:58+03:00] INFO: Storing updated cookbooks/gitlab/templates/default/nginx-gitlab-kas-http.conf.erb in the cache.
[2025-07-12T20:43:58+03:00] INFO: Storing updated cookbooks/gitlab/templates/default/sv-mailroom-finish.erb in the cache.
[2025-07-12T20:43:58+03:00] INFO: Storing updated cookbooks/gitlab/templates/default/sv-gitlab-workhorse-run.erb in the cache.
[2025-07-12T20:43:58+03:00] INFO: Storing updated cookbooks/gitlab/templates/default/sv-puma-log-config.erb in the cache.
[2025-07-12T20:43:58+03:00] INFO: Storing updated cookbooks/gitlab/templates/default/sv-puma-run.erb in the cache.
[2025-07-12T20:43:58+03:00] INFO: Storing updated cookbooks/gitlab/templates/default/sv-mailroom-run.erb in the cache.
[2025-07-12T20:43:58+03:00] INFO: Storing updated cookbooks/gitlab/templates/default/sv-puma-h.erb in the cache.
[2025-07-12T20:43:58+03:00] INFO: Storing updated cookbooks/gitlab/templates/default/sv-puma-t.erb in the cache.
[2025-07-12T20:43:58+03:00] INFO: Storing updated cookbooks/gitlab/templates/default/sv-remote-syslog-log-run.erb in the cache.
[2025-07-12T20:43:58+03:00] INFO: Storing updated cookbooks/gitlab/templates/default/sv-mailroom-log-config.erb in the cache.
[2025-07-12T20:43:58+03:00] INFO: Storing updated cookbooks/gitlab/templates/default/sv-puma-log-run.erb in the cache.
[2025-07-12T20:43:58+03:00] INFO: Storing updated cookbooks/gitlab/templates/default/sv-sidekiq-run.erb in the cache.
[2025-07-12T20:43:58+03:00] INFO: Storing updated cookbooks/gitlab/templates/default/sv-storage-check-run.erb in the cache.
[2025-07-12T20:43:58+03:00] INFO: Storing updated cookbooks/gitlab/templates/default/sv-sidekiq-log-config.erb in the cache.
[2025-07-12T20:43:58+03:00] INFO: Storing updated cookbooks/gitlab/templates/default/sv-remote-syslog-run.erb in the cache.
[2025-07-12T20:43:58+03:00] INFO: Storing updated cookbooks/gitlab/templates/default/sv-sidekiq-log-run.erb in the cache.
[2025-07-12T20:43:58+03:00] INFO: Storing updated cookbooks/gitlab/templates/default/sv-storage-check-log-config.erb in the cache.
[2025-07-12T20:43:58+03:00] INFO: Storing updated cookbooks/gitlab/templates/default/sv-storage-check-log-run.erb in the cache.
[2025-07-12T20:43:58+03:00] INFO: Storing updated cookbooks/gitlab/metadata.rb in the cache.
[2025-07-12T20:43:58+03:00] INFO: Storing updated cookbooks/gitlab/recipes/bootstrap.rb in the cache.
[2025-07-12T20:43:58+03:00] INFO: Storing updated cookbooks/gitlab/attributes/default.rb in the cache.
[2025-07-12T20:43:58+03:00] INFO: Storing updated cookbooks/gitlab/recipes/bootstrap_disable.rb in the cache.
[2025-07-12T20:43:58+03:00] INFO: Storing updated cookbooks/gitlab/recipes/add_trusted_certs.rb in the cache.
[2025-07-12T20:43:58+03:00] INFO: Storing updated cookbooks/gitlab/templates/default/sv-remote-syslog-log-config.erb in the cache.
[2025-07-12T20:43:58+03:00] INFO: Storing updated cookbooks/gitlab/recipes/generate_secrets.rb in the cache.
[2025-07-12T20:43:58+03:00] INFO: Storing updated cookbooks/gitlab/templates/default/sv-mailroom-log-run.erb in the cache.
[2025-07-12T20:43:58+03:00] INFO: Storing updated cookbooks/gitlab/recipes/database_migrations.rb in the cache.
[2025-07-12T20:43:58+03:00] INFO: Storing updated cookbooks/gitlab/recipes/gitlab-backup-cli.rb in the cache.
[2025-07-12T20:43:58+03:00] INFO: Storing updated cookbooks/gitlab/recipes/config.rb in the cache.
[2025-07-12T20:43:58+03:00] INFO: Storing updated cookbooks/gitlab/recipes/default.rb in the cache.
[2025-07-12T20:43:58+03:00] INFO: Storing updated cookbooks/gitlab/recipes/database_reindexing_enable.rb in the cache.
[2025-07-12T20:43:58+03:00] INFO: Storing updated cookbooks/gitlab/templates/default/workhorse-config.toml.erb in the cache.
[2025-07-12T20:43:58+03:00] INFO: Storing updated cookbooks/gitlab/recipes/gitlab-rails.rb in the cache.
[2025-07-12T20:43:58+03:00] INFO: Storing updated cookbooks/gitlab/recipes/database_reindexing_disable.rb in the cache.
[2025-07-12T20:43:58+03:00] INFO: Storing updated cookbooks/gitlab/recipes/gitlab-workhorse_disable.rb in the cache.
[2025-07-12T20:43:58+03:00] INFO: Storing updated cookbooks/gitlab/recipes/gitlab-workhorse.rb in the cache.
[2025-07-12T20:43:58+03:00] INFO: Storing updated cookbooks/gitlab/recipes/letsencrypt_renew.rb in the cache.
[2025-07-12T20:43:58+03:00] INFO: Storing updated cookbooks/gitlab/recipes/gitlab-shell.rb in the cache.
[2025-07-12T20:43:58+03:00] INFO: Storing updated cookbooks/gitlab/recipes/gitlab-healthcheck.rb in the cache.
[2025-07-12T20:43:58+03:00] INFO: Storing updated cookbooks/gitlab/recipes/puma.rb in the cache.
[2025-07-12T20:43:58+03:00] INFO: Storing updated cookbooks/gitlab/recipes/puma_disable.rb in the cache.
[2025-07-12T20:43:58+03:00] INFO: Storing updated cookbooks/gitlab/recipes/mailroom_disable.rb in the cache.
[2025-07-12T20:43:58+03:00] INFO: Storing updated cookbooks/gitlab/recipes/rails_pages_shared_path.rb in the cache.
[2025-07-12T20:43:58+03:00] INFO: Storing updated cookbooks/gitlab/recipes/nginx.rb in the cache.
[2025-07-12T20:43:58+03:00] INFO: Storing updated cookbooks/gitlab/recipes/nginx_disable.rb in the cache.
[2025-07-12T20:43:58+03:00] INFO: Storing updated cookbooks/gitlab/recipes/show_config.rb in the cache.
[2025-07-12T20:43:58+03:00] INFO: Storing updated cookbooks/gitlab/recipes/mailroom.rb in the cache.
[2025-07-12T20:43:58+03:00] INFO: Storing updated cookbooks/gitlab/recipes/selinux.rb in the cache.
[2025-07-12T20:43:58+03:00] INFO: Storing updated cookbooks/gitlab/recipes/storage-check_disable.rb in the cache.
[2025-07-12T20:43:58+03:00] INFO: Storing updated cookbooks/gitlab/recipes/remote-syslog.rb in the cache.
[2025-07-12T20:43:58+03:00] INFO: Storing updated cookbooks/gitlab/recipes/sidekiq_disable.rb in the cache.
[2025-07-12T20:43:58+03:00] INFO: Storing updated cookbooks/gitlab/recipes/users.rb in the cache.
[2025-07-12T20:43:58+03:00] INFO: Storing updated cookbooks/gitlab/libraries/bash_hide_env.rb in the cache.
[2025-07-12T20:43:58+03:00] INFO: Storing updated cookbooks/gitlab/libraries/account_helper.rb in the cache.
[2025-07-12T20:43:58+03:00] INFO: Storing updated cookbooks/gitlab/recipes/gitlab-backup-cli_disable.rb in the cache.
[2025-07-12T20:43:58+03:00] INFO: Storing updated cookbooks/gitlab/libraries/gitlab_rails.rb in the cache.
[2025-07-12T20:43:58+03:00] INFO: Storing updated cookbooks/gitlab/recipes/web-server.rb in the cache.
[2025-07-12T20:43:58+03:00] INFO: Storing updated cookbooks/gitlab/libraries/gitlab_sshd_helper.rb in the cache.
[2025-07-12T20:43:58+03:00] INFO: Storing updated cookbooks/gitlab/recipes/sidekiq.rb in the cache.
[2025-07-12T20:43:58+03:00] INFO: Storing updated cookbooks/gitlab/recipes/remote-syslog_disable.rb in the cache.
[2025-07-12T20:43:58+03:00] INFO: Storing updated cookbooks/gitlab/libraries/gitlab_exporter.rb in the cache.
[2025-07-12T20:43:58+03:00] INFO: Storing updated cookbooks/gitlab/libraries/gitlab_mattermost.rb in the cache.
[2025-07-12T20:43:58+03:00] INFO: Storing updated cookbooks/gitlab/recipes/storage-check.rb in the cache.
[2025-07-12T20:43:59+03:00] INFO: Storing updated cookbooks/gitlab/libraries/helpers/base_helper.rb in the cache.
[2025-07-12T20:43:59+03:00] INFO: Storing updated cookbooks/gitlab/libraries/helpers/authorizer_helper.rb in the cache.
[2025-07-12T20:43:58+03:00] INFO: Storing updated cookbooks/gitlab/libraries/gitlab_shell.rb in the cache.
[2025-07-12T20:43:58+03:00] INFO: Storing updated cookbooks/gitlab/libraries/gitlab_workhorse.rb in the cache.
[2025-07-12T20:43:59+03:00] INFO: Storing updated cookbooks/gitlab/libraries/helpers/geo_pg_helper.rb in the cache.
[2025-07-12T20:43:58+03:00] INFO: Storing updated cookbooks/gitlab/recipes/remove_accounts.rb in the cache.
[2025-07-12T20:43:59+03:00] INFO: Storing updated cookbooks/gitlab/libraries/helper.rb in the cache.
[2025-07-12T20:43:59+03:00] INFO: Storing updated cookbooks/gitlab/libraries/helpers/gitlab_rails.rb in the cache.
[2025-07-12T20:43:59+03:00] INFO: Storing updated cookbooks/gitlab/libraries/helpers/gitlab_workhorse_helper.rb in the cache.
[2025-07-12T20:43:59+03:00] INFO: Storing updated cookbooks/gitlab/libraries/helpers/metrics_exporter_helper.rb in the cache.
[2025-07-12T20:43:59+03:00] INFO: Storing updated cookbooks/gitlab/libraries/helpers/pg_status_helper.rb in the cache.
[2025-07-12T20:43:59+03:00] INFO: Storing updated cookbooks/gitlab/libraries/helpers/web_server_helper.rb in the cache.
[2025-07-12T20:43:59+03:00] INFO: Storing updated cookbooks/gitlab/libraries/helpers/pg_helper.rb in the cache.
[2025-07-12T20:43:59+03:00] INFO: Storing updated cookbooks/gitlab/libraries/helpers/base_pg_helper.rb in the cache.
[2025-07-12T20:43:59+03:00] INFO: Storing updated cookbooks/gitlab/libraries/helpers/gitlab_rails_env_helper.rb in the cache.
[2025-07-12T20:43:59+03:00] INFO: Storing updated cookbooks/gitlab/libraries/logfiles_helper.rb in the cache.
[2025-07-12T20:43:59+03:00] INFO: Storing updated cookbooks/gitlab/libraries/incoming_email.rb in the cache.
[2025-07-12T20:43:59+03:00] INFO: Storing updated cookbooks/gitlab/libraries/nginx.rb in the cache.
[2025-07-12T20:43:59+03:00] INFO: Storing updated cookbooks/gitlab/libraries/pg_version.rb in the cache.
[2025-07-12T20:43:59+03:00] INFO: Storing updated cookbooks/gitlab/libraries/postgresql.rb in the cache.
[2025-07-12T20:43:59+03:00] INFO: Storing updated cookbooks/gitlab/libraries/puma.rb in the cache.
[2025-07-12T20:43:59+03:00] INFO: Storing updated cookbooks/gitlab/libraries/rails_migration_helper.rb in the cache.
[2025-07-12T20:43:59+03:00] INFO: Storing updated cookbooks/gitlab/libraries/sidekiq.rb in the cache.
[2025-07-12T20:43:59+03:00] INFO: Storing updated cookbooks/gitlab/libraries/logging.rb in the cache.
[2025-07-12T20:43:59+03:00] INFO: Storing updated cookbooks/gitlab/libraries/storage_check.rb in the cache.
[2025-07-12T20:43:59+03:00] INFO: Storing updated cookbooks/gitlab/libraries/mailroom_helper.rb in the cache.
[2025-07-12T20:43:59+03:00] INFO: Storing updated cookbooks/gitlab/resources/database_objects.rb in the cache.
[2025-07-12T20:43:59+03:00] INFO: Storing updated cookbooks/gitlab/libraries/registry.rb in the cache.
[2025-07-12T20:43:59+03:00] INFO: Storing updated cookbooks/gitlab/libraries/patroni.rb in the cache.
[2025-07-12T20:43:59+03:00] INFO: Storing updated cookbooks/gitlab/libraries/redis.rb in the cache.
[2025-07-12T20:43:59+03:00] INFO: Storing updated cookbooks/gitlab/libraries/smtp_helper.rb in the cache.
[2025-07-12T20:43:59+03:00] INFO: Storing updated cookbooks/gitlab/README.md in the cache.
[2025-07-12T20:43:59+03:00] INFO: Storing updated cookbooks/gitlab/libraries/redis_uri.rb in the cache.
[2025-07-12T20:43:59+03:00] INFO: Storing updated cookbooks/package/attributes/default.rb in the cache.
[2025-07-12T20:43:59+03:00] INFO: Storing updated cookbooks/package/metadata.rb in the cache.
[2025-07-12T20:43:59+03:00] INFO: Storing updated cookbooks/package/templates/default/gitlab-runsvdir.service.erb in the cache.
[2025-07-12T20:43:59+03:00] INFO: Storing updated cookbooks/package/recipes/runit_upstart.rb in the cache.
[2025-07-12T20:43:59+03:00] INFO: Storing updated cookbooks/gitlab/resources/rails_migration.rb in the cache.
[2025-07-12T20:43:59+03:00] INFO: Storing updated cookbooks/package/recipes/runit.rb in the cache.
[2025-07-12T20:43:59+03:00] INFO: Storing updated cookbooks/package/recipes/sysctl.rb in the cache.
[2025-07-12T20:43:59+03:00] INFO: Storing updated cookbooks/package/files/default/gitlab-runsvdir.conf in the cache.
[2025-07-12T20:43:59+03:00] INFO: Storing updated cookbooks/gitlab/resources/sidekiq_service.rb in the cache.
[2025-07-12T20:43:59+03:00] INFO: Storing updated cookbooks/package/recipes/runit_systemd.rb in the cache.
[2025-07-12T20:43:59+03:00] INFO: Storing updated cookbooks/package/recipes/runit_sysvinit.rb in the cache.
[2025-07-12T20:43:59+03:00] INFO: Storing updated cookbooks/gitlab/resources/puma_config.rb in the cache.
  - gitlab (0.0.1)
[2025-07-12T20:43:59+03:00] INFO: Storing updated cookbooks/package/libraries/config/gitlab.rb in the cache.
[2025-07-12T20:43:59+03:00] INFO: Storing updated cookbooks/package/libraries/config/roles/application.rb in the cache.
[2025-07-12T20:43:59+03:00] INFO: Storing updated cookbooks/package/libraries/config/roles/gitaly.rb in the cache.
[2025-07-12T20:43:59+03:00] INFO: Storing updated cookbooks/package/libraries/config/roles/geo_primary.rb in the cache.
[2025-07-12T20:43:59+03:00] INFO: Storing updated cookbooks/package/libraries/config/roles/monitoring.rb in the cache.
[2025-07-12T20:43:59+03:00] INFO: Storing updated cookbooks/package/libraries/certificate_helper.rb in the cache.
[2025-07-12T20:43:59+03:00] INFO: Storing updated cookbooks/package/libraries/config/roles/pages.rb in the cache.
[2025-07-12T20:43:59+03:00] INFO: Storing updated cookbooks/package/libraries/config/roles/consul.rb in the cache.
[2025-07-12T20:43:59+03:00] INFO: Storing updated cookbooks/package/libraries/config/roles/redis_master.rb in the cache.
[2025-07-12T20:43:59+03:00] INFO: Storing updated cookbooks/package/libraries/config/roles/geo_secondary.rb in the cache.
[2025-07-12T20:43:59+03:00] INFO: Storing updated cookbooks/package/libraries/config/roles/postgres.rb in the cache.
[2025-07-12T20:43:59+03:00] INFO: Storing updated cookbooks/package/libraries/config/roles/patroni.rb in the cache.
[2025-07-12T20:43:59+03:00] INFO: Storing updated cookbooks/package/libraries/config/roles/pgbouncer.rb in the cache.
[2025-07-12T20:43:59+03:00] INFO: Storing updated cookbooks/package/libraries/config/roles/sidekiq.rb in the cache.
[2025-07-12T20:43:59+03:00] INFO: Storing updated cookbooks/package/libraries/config/services.rb in the cache.
[2025-07-12T20:43:59+03:00] INFO: Storing updated cookbooks/package/libraries/config/roles/redis_sentinel.rb in the cache.
[2025-07-12T20:43:59+03:00] INFO: Storing updated cookbooks/package/libraries/config/roles/spamcheck.rb in the cache.
[2025-07-12T20:43:59+03:00] INFO: Storing updated cookbooks/package/libraries/config/roles/default.rb in the cache.
[2025-07-12T20:43:59+03:00] INFO: Storing updated cookbooks/package/libraries/formatters/gitlab.rb in the cache.
[2025-07-12T20:43:59+03:00] INFO: Storing updated cookbooks/package/libraries/config_mash.rb in the cache.
[2025-07-12T20:43:59+03:00] INFO: Storing updated cookbooks/package/libraries/helper.rb in the cache.
[2025-07-12T20:43:59+03:00] INFO: Storing updated cookbooks/package/libraries/helpers/logging_helper.rb in the cache.
[2025-07-12T20:43:59+03:00] INFO: Storing updated cookbooks/package/libraries/gitlab_cluster.rb in the cache.
[2025-07-12T20:43:59+03:00] INFO: Storing updated cookbooks/package/libraries/helpers/redis_helper/base.rb in the cache.
[2025-07-12T20:43:59+03:00] INFO: Storing updated cookbooks/package/libraries/handlers/gitlab.rb in the cache.
[2025-07-12T20:43:59+03:00] INFO: Storing updated cookbooks/package/libraries/helpers/redis_helper/gitlab_kas.rb in the cache.
[2025-07-12T20:43:59+03:00] INFO: Storing updated cookbooks/package/libraries/helpers/redis_helper/gitlab_workhorse.rb in the cache.
[2025-07-12T20:43:59+03:00] INFO: Storing updated cookbooks/package/libraries/helpers/node_helper.rb in the cache.
[2025-07-12T20:43:59+03:00] INFO: Storing updated cookbooks/package/libraries/helpers/redis_helper/gitlab_exporter.rb in the cache.
[2025-07-12T20:43:59+03:00] INFO: Storing updated cookbooks/package/libraries/helpers/redis_helper/redis_exporter.rb in the cache.
[2025-07-12T20:43:59+03:00] INFO: Storing updated cookbooks/package/libraries/helpers/selinux_helper.rb in the cache.
[2025-07-12T20:43:59+03:00] INFO: Storing updated cookbooks/package/libraries/helpers/selinux_distro_helper.rb in the cache.
[2025-07-12T20:43:59+03:00] INFO: Storing updated cookbooks/package/libraries/helpers/redis_helper/server.rb in the cache.
[2025-07-12T20:43:59+03:00] INFO: Storing updated cookbooks/package/libraries/helpers/services_helper.rb in the cache.
[2025-07-12T20:43:59+03:00] INFO: Storing updated cookbooks/package/libraries/helpers/shell_out_helper.rb in the cache.
[2025-07-12T20:43:59+03:00] INFO: Storing updated cookbooks/package/libraries/deprecations.rb in the cache.
[2025-07-12T20:43:59+03:00] INFO: Storing updated cookbooks/package/libraries/helpers/secrets_helper.rb in the cache.
[2025-07-12T20:43:59+03:00] INFO: Storing updated cookbooks/package/libraries/helpers/output_helper.rb in the cache.
[2025-07-12T20:43:59+03:00] INFO: Storing updated cookbooks/package/libraries/helpers/roles_helper.rb in the cache.
[2025-07-12T20:43:59+03:00] INFO: Storing updated cookbooks/package/libraries/helpers/redis_helper/gitlab_rails.rb in the cache.
[2025-07-12T20:43:59+03:00] INFO: Storing updated cookbooks/package/libraries/helpers/version_helper.rb in the cache.
[2025-07-12T20:43:59+03:00] INFO: Storing updated cookbooks/package/libraries/helpers/redis_helper.rb in the cache.
[2025-07-12T20:43:59+03:00] INFO: Storing updated cookbooks/package/libraries/omnibus_helper.rb in the cache.
[2025-07-12T20:43:59+03:00] INFO: Storing updated cookbooks/package/libraries/helpers/systemd_helper.rb in the cache.
[2025-07-12T20:43:59+03:00] INFO: Storing updated cookbooks/package/libraries/package.rb in the cache.
[2025-07-12T20:43:59+03:00] INFO: Storing updated cookbooks/package/resources/env_dir.rb in the cache.
[2025-07-12T20:43:59+03:00] INFO: Storing updated cookbooks/package/resources/account.rb in the cache.
[2025-07-12T20:43:59+03:00] INFO: Storing updated cookbooks/package/libraries/object_proxy.rb in the cache.
[2025-07-12T20:43:59+03:00] INFO: Storing updated cookbooks/package/libraries/settings_dsl.rb in the cache.
[2025-07-12T20:43:59+03:00] INFO: Storing updated cookbooks/logrotate/templates/default/logrotate-service.erb in the cache.
[2025-07-12T20:43:59+03:00] INFO: Storing updated cookbooks/package/libraries/storage_directory_helper.rb in the cache.
[2025-07-12T20:43:59+03:00] INFO: Storing updated cookbooks/package/resources/gitlab_sysctl.rb in the cache.
[2025-07-12T20:43:59+03:00] INFO: Storing updated cookbooks/logrotate/templates/default/sv-logrotate-run.erb in the cache.
[2025-07-12T20:43:59+03:00] INFO: Storing updated cookbooks/package/resources/storage_directory.rb in the cache.
[2025-07-12T20:43:59+03:00] INFO: Storing updated cookbooks/package/resources/templatesymlink.rb in the cache.
[2025-07-12T20:43:59+03:00] INFO: Storing updated cookbooks/logrotate/templates/default/sv-logrotate-log-config.erb in the cache.
[2025-07-12T20:43:59+03:00] INFO: Storing updated cookbooks/logrotate/templates/default/logrotate.conf.erb in the cache.
[2025-07-12T20:43:59+03:00] INFO: Storing updated cookbooks/logrotate/templates/default/sv-logrotate-log-run.erb in the cache.
[2025-07-12T20:43:59+03:00] INFO: Storing updated cookbooks/package/resources/version_file.rb in the cache.
[2025-07-12T20:43:59+03:00] INFO: Storing updated cookbooks/logrotate/templates/default/sv-logrotate-t.erb in the cache.
[2025-07-12T20:43:59+03:00] INFO: Storing updated cookbooks/logrotate/recipes/disable.rb in the cache.
  - package (0.1.0)
[2025-07-12T20:43:59+03:00] INFO: Storing updated cookbooks/logrotate/recipes/folders_and_configs.rb in the cache.
[2025-07-12T20:43:59+03:00] INFO: Storing updated cookbooks/logrotate/recipes/enable.rb in the cache.
[2025-07-12T20:43:59+03:00] INFO: Storing updated cookbooks/logrotate/attributes/default.rb in the cache.
[2025-07-12T20:43:59+03:00] INFO: Storing updated cookbooks/postgresql/templates/default/pg_hba.conf.erb in the cache.
[2025-07-12T20:43:59+03:00] INFO: Storing updated cookbooks/postgresql/templates/default/pg_ident.conf.erb in the cache.
[2025-07-12T20:43:59+03:00] INFO: Storing updated cookbooks/postgresql/templates/default/sv-postgresql-log-config.erb in the cache.
[2025-07-12T20:43:59+03:00] INFO: Storing updated cookbooks/logrotate/metadata.rb in the cache.
  - logrotate (0.1.0)
[2025-07-12T20:43:59+03:00] INFO: Storing updated cookbooks/postgresql/templates/default/sv-postgresql-run.erb in the cache.
[2025-07-12T20:43:59+03:00] INFO: Storing updated cookbooks/postgresql/templates/default/postgresql-runtime.conf.erb in the cache.
[2025-07-12T20:43:59+03:00] INFO: Storing updated cookbooks/postgresql/templates/default/postgresql.conf.erb in the cache.
[2025-07-12T20:43:59+03:00] INFO: Storing updated cookbooks/postgresql/templates/default/gitlab-psql-rc.erb in the cache.
[2025-07-12T20:43:59+03:00] INFO: Storing updated cookbooks/postgresql/recipes/bin.rb in the cache.
[2025-07-12T20:43:59+03:00] INFO: Storing updated cookbooks/postgresql/templates/default/sv-postgresql-log-run.erb in the cache.
[2025-07-12T20:43:59+03:00] INFO: Storing updated cookbooks/postgresql/templates/default/sv-postgresql-t.erb in the cache.
[2025-07-12T20:43:59+03:00] INFO: Storing updated cookbooks/postgresql/attributes/default.rb in the cache.
[2025-07-12T20:43:59+03:00] INFO: Storing updated cookbooks/postgresql/resources/config.rb in the cache.
[2025-07-12T20:43:59+03:00] INFO: Storing updated cookbooks/postgresql/metadata.rb in the cache.
[2025-07-12T20:43:59+03:00] INFO: Storing updated cookbooks/postgresql/recipes/disable.rb in the cache.
[2025-07-12T20:43:59+03:00] INFO: Storing updated cookbooks/postgresql/resources/database.rb in the cache.
[2025-07-12T20:43:59+03:00] INFO: Storing updated cookbooks/postgresql/recipes/directory_locations.rb in the cache.
[2025-07-12T20:43:59+03:00] INFO: Storing updated cookbooks/postgresql/recipes/sysctl.rb in the cache.
[2025-07-12T20:43:59+03:00] INFO: Storing updated cookbooks/postgresql/resources/user.rb in the cache.
[2025-07-12T20:43:59+03:00] INFO: Storing updated cookbooks/postgresql/recipes/user.rb in the cache.
[2025-07-12T20:43:59+03:00] INFO: Storing updated cookbooks/postgresql/recipes/enable.rb in the cache.
[2025-07-12T20:43:59+03:00] INFO: Storing updated cookbooks/postgresql/resources/extension.rb in the cache.
[2025-07-12T20:43:59+03:00] INFO: Storing updated cookbooks/redis/templates/default/sv-redis-log-run.erb in the cache.
[2025-07-12T20:43:59+03:00] INFO: Storing updated cookbooks/redis/templates/default/sv-redis-log-config.erb in the cache.
[2025-07-12T20:43:59+03:00] INFO: Storing updated cookbooks/redis/templates/default/gitlab-redis-cli-rc.erb in the cache.
[2025-07-12T20:43:59+03:00] INFO: Storing updated cookbooks/postgresql/README.md in the cache.
[2025-07-12T20:43:59+03:00] INFO: Storing updated cookbooks/postgresql/resources/schema.rb in the cache.
[2025-07-12T20:43:59+03:00] INFO: Storing updated cookbooks/postgresql/resources/query.rb in the cache.
[2025-07-12T20:43:59+03:00] INFO: Storing updated cookbooks/postgresql/recipes/standalone.rb in the cache.
[2025-07-12T20:43:59+03:00] INFO: Storing updated cookbooks/redis/templates/default/redis.conf.erb in the cache.
[2025-07-12T20:43:59+03:00] INFO: Storing updated cookbooks/redis/recipes/enable.rb in the cache.
[2025-07-12T20:43:59+03:00] INFO: Storing updated cookbooks/redis/templates/default/sv-redis-run.erb in the cache.
[2025-07-12T20:43:59+03:00] INFO: Storing updated cookbooks/monitoring/templates/gitlab-exporter.yml.erb in the cache.
[2025-07-12T20:43:59+03:00] INFO: Storing updated cookbooks/redis/attributes/attributes.rb in the cache.
  - postgresql (0.1.0)
[2025-07-12T20:43:59+03:00] INFO: Storing updated cookbooks/monitoring/templates/postgres-queries.yaml.erb in the cache.
[2025-07-12T20:43:59+03:00] INFO: Storing updated cookbooks/redis/metadata.rb in the cache.
[2025-07-12T20:43:59+03:00] INFO: Storing updated cookbooks/monitoring/templates/rules/gitlab.rules in the cache.
[2025-07-12T20:43:59+03:00] INFO: Storing updated cookbooks/monitoring/templates/mount_point_check.erb in the cache.
[2025-07-12T20:43:59+03:00] INFO: Storing updated cookbooks/monitoring/templates/rules/node.rules in the cache.
[2025-07-12T20:43:59+03:00] INFO: Storing updated cookbooks/redis/recipes/disable.rb in the cache.
[2025-07-12T20:43:59+03:00] INFO: Storing updated cookbooks/monitoring/templates/sv-alertmanager-log-run.erb in the cache.
[2025-07-12T20:43:59+03:00] INFO: Storing updated cookbooks/monitoring/templates/sv-gitlab-exporter-log-config.erb in the cache.
[2025-07-12T20:43:59+03:00] INFO: Storing updated cookbooks/monitoring/templates/sv-alertmanager-log-config.erb in the cache.
[2025-07-12T20:43:59+03:00] INFO: Storing updated cookbooks/monitoring/templates/sv-gitlab-exporter-run.erb in the cache.
[2025-07-12T20:43:59+03:00] INFO: Storing updated cookbooks/monitoring/templates/sv-alertmanager-run.erb in the cache.
[2025-07-12T20:43:59+03:00] INFO: Storing updated cookbooks/monitoring/templates/sv-node-exporter-run.erb in the cache.
[2025-07-12T20:43:59+03:00] INFO: Storing updated cookbooks/monitoring/templates/sv-pgbouncer-exporter-log-config.erb in the cache.
[2025-07-12T20:43:59+03:00] INFO: Storing updated cookbooks/monitoring/templates/sv-gitlab-exporter-log-run.erb in the cache.
[2025-07-12T20:43:59+03:00] INFO: Storing updated cookbooks/monitoring/templates/sv-postgres-exporter-log-config.erb in the cache.
[2025-07-12T20:43:59+03:00] INFO: Storing updated cookbooks/monitoring/templates/sv-node-exporter-log-config.erb in the cache.
[2025-07-12T20:43:59+03:00] INFO: Storing updated cookbooks/monitoring/templates/sv-prometheus-log-config.erb in the cache.
[2025-07-12T20:43:59+03:00] INFO: Storing updated cookbooks/monitoring/templates/sv-postgres-exporter-log-run.erb in the cache.
[2025-07-12T20:43:59+03:00] INFO: Storing updated cookbooks/monitoring/templates/sv-node-exporter-log-run.erb in the cache.
[2025-07-12T20:43:59+03:00] INFO: Storing updated cookbooks/monitoring/templates/sv-prometheus-run.erb in the cache.
[2025-07-12T20:43:59+03:00] INFO: Storing updated cookbooks/monitoring/templates/sv-pgbouncer-exporter-run.erb in the cache.
[2025-07-12T20:43:59+03:00] INFO: Storing updated cookbooks/monitoring/templates/sv-redis-exporter-log-config.erb in the cache.
[2025-07-12T20:43:59+03:00] INFO: Storing updated cookbooks/monitoring/templates/sv-postgres-exporter-run.erb in the cache.
[2025-07-12T20:43:59+03:00] INFO: Storing updated cookbooks/monitoring/attributes/default.rb in the cache.
[2025-07-12T20:43:59+03:00] INFO: Storing updated cookbooks/monitoring/metadata.rb in the cache.
[2025-07-12T20:43:59+03:00] INFO: Storing updated cookbooks/monitoring/templates/sv-redis-exporter-run.erb in the cache.
[2025-07-12T20:43:59+03:00] INFO: Storing updated cookbooks/monitoring/recipes/default.rb in the cache.
[2025-07-12T20:43:59+03:00] INFO: Storing updated cookbooks/monitoring/templates/sv-prometheus-log-run.erb in the cache.
[2025-07-12T20:43:59+03:00] INFO: Storing updated cookbooks/redis/resources/service.rb in the cache.
[2025-07-12T20:43:59+03:00] INFO: Storing updated cookbooks/monitoring/recipes/alertmanager.rb in the cache.
  - redis (0.1.0)
[2025-07-12T20:43:59+03:00] INFO: Storing updated cookbooks/monitoring/recipes/alertmanager_disable.rb in the cache.
[2025-07-12T20:43:59+03:00] INFO: Storing updated cookbooks/monitoring/recipes/gitlab-exporter.rb in the cache.
[2025-07-12T20:43:59+03:00] INFO: Storing updated cookbooks/monitoring/recipes/pgbouncer-exporter_disable.rb in the cache.
[2025-07-12T20:43:59+03:00] INFO: Storing updated cookbooks/monitoring/recipes/pgbouncer-exporter.rb in the cache.
[2025-07-12T20:43:59+03:00] INFO: Storing updated cookbooks/monitoring/templates/sv-pgbouncer-exporter-log-run.erb in the cache.
[2025-07-12T20:43:59+03:00] INFO: Storing updated cookbooks/monitoring/recipes/gitlab-exporter_disable.rb in the cache.
[2025-07-12T20:43:59+03:00] INFO: Storing updated cookbooks/monitoring/recipes/postgres-exporter.rb in the cache.
[2025-07-12T20:43:59+03:00] INFO: Storing updated cookbooks/monitoring/recipes/prometheus.rb in the cache.
[2025-07-12T20:43:59+03:00] INFO: Storing updated cookbooks/monitoring/recipes/node-exporter.rb in the cache.
[2025-07-12T20:43:59+03:00] INFO: Storing updated cookbooks/monitoring/recipes/redis-exporter.rb in the cache.
[2025-07-12T20:43:59+03:00] INFO: Storing updated cookbooks/monitoring/templates/sv-redis-exporter-log-run.erb in the cache.
[2025-07-12T20:43:59+03:00] INFO: Storing updated cookbooks/monitoring/recipes/postgres-exporter_disable.rb in the cache.
[2025-07-12T20:43:59+03:00] INFO: Storing updated cookbooks/monitoring/recipes/node-exporter_disable.rb in the cache.
[2025-07-12T20:43:59+03:00] INFO: Storing updated cookbooks/monitoring/recipes/user.rb in the cache.
[2025-07-12T20:43:59+03:00] INFO: Storing updated cookbooks/monitoring/recipes/redis-exporter_disable.rb in the cache.
[2025-07-12T20:43:59+03:00] INFO: Storing updated cookbooks/monitoring/recipes/prometheus_disable.rb in the cache.
[2025-07-12T20:43:59+03:00] INFO: Storing updated cookbooks/registry/metadata.rb in the cache.
[2025-07-12T20:43:59+03:00] INFO: Storing updated cookbooks/registry/templates/default/registry-config.yml.erb in the cache.
[2025-07-12T20:43:59+03:00] INFO: Storing updated cookbooks/monitoring/libraries/prometheus.rb in the cache.
[2025-07-12T20:43:59+03:00] INFO: Storing updated cookbooks/registry/recipes/enable.rb in the cache.
[2025-07-12T20:43:59+03:00] INFO: Storing updated cookbooks/registry/templates/default/sv-registry-log-run.erb in the cache.
[2025-07-12T20:43:59+03:00] INFO: Storing updated cookbooks/mattermost/templates/default/sv-mattermost-log-config.erb in the cache.
[2025-07-12T20:43:59+03:00] INFO: Storing updated cookbooks/registry/attributes/default.rb in the cache.
[2025-07-12T20:43:59+03:00] INFO: Storing updated cookbooks/mattermost/templates/default/sv-mattermost-run.erb in the cache.
[2025-07-12T20:43:59+03:00] INFO: Storing updated cookbooks/registry/recipes/disable.rb in the cache.
[2025-07-12T20:43:59+03:00] INFO: Storing updated cookbooks/mattermost/metadata.rb in the cache.
[2025-07-12T20:43:59+03:00] INFO: Storing updated cookbooks/registry/templates/default/sv-registry-log-config.erb in the cache.
[2025-07-12T20:43:59+03:00] INFO: Storing updated cookbooks/mattermost/recipes/disable.rb in the cache.
[2025-07-12T20:43:59+03:00] INFO: Storing updated cookbooks/mattermost/attributes/default.rb in the cache.
[2025-07-12T20:43:59+03:00] INFO: Storing updated cookbooks/registry/templates/default/sv-registry-run.erb in the cache.
[2025-07-12T20:43:59+03:00] INFO: Storing updated cookbooks/monitoring/libraries/prometheus_helper.rb in the cache.
  - registry (0.1.0)
[2025-07-12T20:43:59+03:00] INFO: Storing updated cookbooks/mattermost/recipes/enable.rb in the cache.
  - monitoring (0.1.0)
[2025-07-12T20:43:59+03:00] INFO: Storing updated cookbooks/consul/templates/default/sv-consul-log-config.erb in the cache.
[2025-07-12T20:44:00+03:00] INFO: Storing updated cookbooks/consul/attributes/default.rb in the cache.
[2025-07-12T20:43:59+03:00] INFO: Storing updated cookbooks/mattermost/templates/default/sv-mattermost-log-run.erb in the cache.
[2025-07-12T20:43:59+03:00] INFO: Storing updated cookbooks/consul/attributes/services.rb in the cache.
[2025-07-12T20:43:59+03:00] INFO: Storing updated cookbooks/mattermost/libraries/mattermost_helper.rb in the cache.
[2025-07-12T20:43:59+03:00] INFO: Storing updated cookbooks/consul/templates/default/sv-consul-log-run.erb in the cache.
[2025-07-12T20:44:00+03:00] INFO: Storing updated cookbooks/consul/attributes/watchers.rb in the cache.
[2025-07-12T20:44:00+03:00] INFO: Storing updated cookbooks/consul/recipes/configure_services.rb in the cache.
[2025-07-12T20:44:00+03:00] INFO: Storing updated cookbooks/consul/recipes/disable_daemon.rb in the cache.
[2025-07-12T20:44:00+03:00] INFO: Storing updated cookbooks/consul/templates/default/sv-consul-run.erb in the cache.
  - mattermost (0.1.0)[2025-07-12T20:43:59+03:00] INFO: Storing updated cookbooks/consul/templates/default/watcher_scripts/failover_pgbouncer.erb in the cache.

[2025-07-12T20:44:00+03:00] INFO: Storing updated cookbooks/consul/recipes/disable_service_postgresql.rb in the cache.
[2025-07-12T20:44:00+03:00] INFO: Storing updated cookbooks/consul/recipes/enable.rb in the cache.
[2025-07-12T20:44:00+03:00] INFO: Storing updated cookbooks/consul/recipes/enable_daemon.rb in the cache.
[2025-07-12T20:44:00+03:00] INFO: Storing updated cookbooks/consul/recipes/enable_service_postgresql.rb in the cache.
[2025-07-12T20:44:00+03:00] INFO: Storing updated cookbooks/consul/recipes/watchers.rb in the cache.
[2025-07-12T20:44:00+03:00] INFO: Storing updated cookbooks/consul/libraries/consul_helper.rb in the cache.
[2025-07-12T20:44:00+03:00] INFO: Storing updated cookbooks/gitaly/templates/default/gitaly-config.toml.erb in the cache.
[2025-07-12T20:44:00+03:00] INFO: Storing updated cookbooks/consul/libraries/consul.rb in the cache.
[2025-07-12T20:44:00+03:00] INFO: Storing updated cookbooks/consul/libraries/watch_helper.rb in the cache.
[2025-07-12T20:44:00+03:00] INFO: Storing updated cookbooks/consul/libraries/failover_helper.rb in the cache.
[2025-07-12T20:44:00+03:00] INFO: Storing updated cookbooks/consul/recipes/disable.rb in the cache.
[2025-07-12T20:44:00+03:00] INFO: Storing updated cookbooks/gitaly/templates/default/sv-gitaly-run.erb in the cache.
[2025-07-12T20:44:00+03:00] INFO: Storing updated cookbooks/gitaly/templates/default/sv-gitaly-log-config.erb in the cache.
[2025-07-12T20:44:00+03:00] INFO: Storing updated cookbooks/gitaly/recipes/enable.rb in the cache.
[2025-07-12T20:44:00+03:00] INFO: Storing updated cookbooks/consul/resources/consul_service.rb in the cache.
[2025-07-12T20:44:00+03:00] INFO: Storing updated cookbooks/gitaly/recipes/git_data_dirs.rb in the cache.
[2025-07-12T20:44:00+03:00] INFO: Storing updated cookbooks/gitaly/metadata.rb in the cache.
[2025-07-12T20:44:00+03:00] INFO: Storing updated cookbooks/praefect/templates/default/praefect-config.toml.erb in the cache.
[2025-07-12T20:44:00+03:00] INFO: Storing updated cookbooks/gitaly/recipes/disable.rb in the cache.
[2025-07-12T20:44:00+03:00] INFO: Storing updated cookbooks/gitaly/attributes/default.rb in the cache.
[2025-07-12T20:44:00+03:00] INFO: Storing updated cookbooks/consul/metadata.rb in the cache.
[2025-07-12T20:44:00+03:00] INFO: Storing updated cookbooks/praefect/templates/default/sv-praefect-run.erb in the cache.
  - consul (0.1.0)
[2025-07-12T20:44:00+03:00] INFO: Storing updated cookbooks/gitaly/libraries/gitaly.rb in the cache.
[2025-07-12T20:44:00+03:00] INFO: Storing updated cookbooks/praefect/templates/default/sv-praefect-log-config.erb in the cache.
[2025-07-12T20:44:00+03:00] INFO: Storing updated cookbooks/praefect/attributes/default.rb in the cache.
[2025-07-12T20:44:00+03:00] INFO: Storing updated cookbooks/gitaly/templates/default/sv-gitaly-log-run.erb in the cache.
[2025-07-12T20:44:00+03:00] INFO: Storing updated cookbooks/praefect/recipes/enable.rb in the cache.
[2025-07-12T20:44:00+03:00] INFO: Storing updated cookbooks/gitlab-kas/templates/default/gitlab-kas-config.yml.erb in the cache.
[2025-07-12T20:44:00+03:00] INFO: Storing updated cookbooks/gitlab-kas/templates/default/sv-gitlab-kas-log-config.erb in the cache.
[2025-07-12T20:44:00+03:00] INFO: Storing updated cookbooks/praefect/metadata.rb in the cache.
[2025-07-12T20:44:00+03:00] INFO: Storing updated cookbooks/praefect/recipes/database_migrations.rb in the cache.
  - gitaly (0.1.0)
[2025-07-12T20:44:00+03:00] INFO: Storing updated cookbooks/praefect/templates/default/sv-praefect-log-run.erb in the cache.
[2025-07-12T20:44:00+03:00] INFO: Storing updated cookbooks/praefect/recipes/disable.rb in the cache.
[2025-07-12T20:44:00+03:00] INFO: Storing updated cookbooks/gitlab-kas/templates/default/sv-gitlab-kas-log-run.erb in the cache.
[2025-07-12T20:44:00+03:00] INFO: Storing updated cookbooks/gitlab-kas/attributes/default.rb in the cache.
[2025-07-12T20:44:00+03:00] INFO: Storing updated cookbooks/gitlab-kas/libraries/gitlab_kas.rb in the cache.
[2025-07-12T20:44:00+03:00] INFO: Storing updated cookbooks/gitlab-kas/metadata.rb in the cache.
  - praefect (0.1.0)
[2025-07-12T20:44:00+03:00] INFO: Storing updated cookbooks/gitlab-kas/templates/default/sv-gitlab-kas-run.erb in the cache.
[2025-07-12T20:44:00+03:00] INFO: Storing updated cookbooks/gitlab-pages/templates/default/secret_token.erb in the cache.
[2025-07-12T20:44:00+03:00] INFO: Storing updated cookbooks/gitlab-kas/recipes/disable.rb in the cache.
[2025-07-12T20:44:00+03:00] INFO: Storing updated cookbooks/gitlab-pages/templates/default/mount_point_check.erb in the cache.
[2025-07-12T20:44:00+03:00] INFO: Storing updated cookbooks/gitlab-pages/templates/default/gitlab-pages-config.erb in the cache.
[2025-07-12T20:44:00+03:00] INFO: Storing updated cookbooks/gitlab-kas/recipes/enable.rb in the cache.
[2025-07-12T20:44:00+03:00] INFO: Storing updated cookbooks/gitlab-pages/templates/default/sv-gitlab-pages-log-run.erb in the cache.
[2025-07-12T20:44:00+03:00] INFO: Storing updated cookbooks/gitlab-pages/attributes/default.rb in the cache.
[2025-07-12T20:44:00+03:00] INFO: Storing updated cookbooks/gitlab-pages/templates/default/sv-gitlab-pages-run.erb in the cache.
  - gitlab-kas (0.1.0)
[2025-07-12T20:44:00+03:00] INFO: Storing updated cookbooks/gitlab-pages/recipes/enable.rb in the cache.
[2025-07-12T20:44:00+03:00] INFO: Storing updated cookbooks/letsencrypt/metadata.rb in the cache.
[2025-07-12T20:44:00+03:00] INFO: Storing updated cookbooks/gitlab-pages/metadata.rb in the cache.
[2025-07-12T20:44:00+03:00] INFO: Storing updated cookbooks/letsencrypt/libraries/helper.rb in the cache.
[2025-07-12T20:44:00+03:00] INFO: Storing updated cookbooks/letsencrypt/attributes/default.rb in the cache.
[2025-07-12T20:44:00+03:00] INFO: Storing updated cookbooks/letsencrypt/recipes/disable.rb in the cache.
[2025-07-12T20:44:00+03:00] INFO: Storing updated cookbooks/gitlab-pages/templates/default/sv-gitlab-pages-log-config.erb in the cache.
[2025-07-12T20:44:00+03:00] INFO: Storing updated cookbooks/letsencrypt/recipes/enable.rb in the cache.
[2025-07-12T20:44:00+03:00] INFO: Storing updated cookbooks/letsencrypt/README.md in the cache.
[2025-07-12T20:44:00+03:00] INFO: Storing updated cookbooks/gitlab-pages/recipes/disable.rb in the cache.
[2025-07-12T20:44:00+03:00] INFO: Storing updated cookbooks/letsencrypt/libraries/lets_encrypt.rb in the cache.
[2025-07-12T20:44:00+03:00] INFO: Storing updated cookbooks/nginx/templates/default/sv-nginx-log-run.erb in the cache.
[2025-07-12T20:44:00+03:00] INFO: Storing updated cookbooks/gitlab-pages/libraries/gitlab_pages.rb in the cache.
[2025-07-12T20:44:00+03:00] INFO: Storing updated cookbooks/letsencrypt/recipes/http_authorization.rb in the cache.
[2025-07-12T20:44:00+03:00] INFO: Storing updated cookbooks/nginx/templates/default/sv-nginx-log-config.erb in the cache.
  - gitlab-pages (0.1.0)
[2025-07-12T20:44:00+03:00] INFO: Storing updated cookbooks/runit/LICENSE in the cache.
[2025-07-12T20:44:00+03:00] INFO: Storing updated cookbooks/nginx/recipes/enable.rb in the cache.
[2025-07-12T20:44:00+03:00] INFO: Storing updated cookbooks/runit/metadata.rb in the cache.
[2025-07-12T20:44:00+03:00] INFO: Storing updated cookbooks/nginx/templates/default/sv-nginx-run.erb in the cache.
[2025-07-12T20:44:00+03:00] INFO: Storing updated cookbooks/nginx/metadata.rb in the cache.
[2025-07-12T20:44:00+03:00] INFO: Storing updated cookbooks/letsencrypt/resources/certificate.rb in the cache.
[2025-07-12T20:44:00+03:00] INFO: Storing updated cookbooks/runit/libraries/helpers.rb in the cache.
[2025-07-12T20:44:00+03:00] INFO: Storing updated cookbooks/runit/libraries/resource_runit_service.rb in the cache.
  - nginx (0.1.0)
[2025-07-12T20:44:00+03:00] INFO: Storing updated cookbooks/runit/README.md in the cache.
[2025-07-12T20:44:00+03:00] INFO: Storing updated cookbooks/acme/kitchen.dokken.yml in the cache.
[2025-07-12T20:44:00+03:00] INFO: Storing updated cookbooks/acme/templates/acme-challange.nginx.erb in the cache.
[2025-07-12T20:44:00+03:00] INFO: Storing updated cookbooks/acme/kitchen.yml in the cache.
[2025-07-12T20:44:00+03:00] INFO: Storing updated cookbooks/acme/attributes/default.rb in the cache.
  - letsencrypt (0.1.0)
[2025-07-12T20:44:00+03:00] INFO: Storing updated cookbooks/acme/LICENSE in the cache.
[2025-07-12T20:44:00+03:00] INFO: Storing updated cookbooks/acme/chefignore in the cache.
[2025-07-12T20:44:00+03:00] INFO: Storing updated cookbooks/acme/metadata.rb in the cache.
[2025-07-12T20:44:00+03:00] INFO: Storing updated cookbooks/runit/libraries/provider_runit_service.rb in the cache.
  - runit (5.1.7)
[2025-07-12T20:44:00+03:00] INFO: Storing updated cookbooks/acme/Berksfile in the cache.
[2025-07-12T20:44:00+03:00] INFO: Storing updated cookbooks/acme/.rubocop.yml in the cache.
[2025-07-12T20:44:00+03:00] INFO: Storing updated cookbooks/acme/recipes/default.rb in the cache.
[2025-07-12T20:44:00+03:00] INFO: Storing updated cookbooks/acme/resources/certificate.rb in the cache.
[2025-07-12T20:44:00+03:00] INFO: Storing updated cookbooks/acme/README.md in the cache.
[2025-07-12T20:44:00+03:00] INFO: Storing updated cookbooks/acme/libraries/acme.rb in the cache.
[2025-07-12T20:44:00+03:00] INFO: Storing updated cookbooks/acme/kitchen.digitalocean.yml in the cache.
[2025-07-12T20:44:00+03:00] INFO: Storing updated cookbooks/acme/resources/selfsigned.rb in the cache.
[2025-07-12T20:44:00+03:00] INFO: Storing updated cookbooks/crond/templates/default/sv-crond-run.erb in the cache.
[2025-07-12T20:44:00+03:00] INFO: Storing updated cookbooks/crond/metadata.rb in the cache.
[2025-07-12T20:44:00+03:00] INFO: Storing updated cookbooks/acme/resources/ssl_key.rb in the cache.
[2025-07-12T20:44:00+03:00] INFO: Storing updated cookbooks/crond/recipes/enable.rb in the cache.
[2025-07-12T20:44:00+03:00] INFO: Storing updated cookbooks/crond/attributes/default.rb in the cache.
[2025-07-12T20:44:00+03:00] INFO: Storing updated cookbooks/crond/recipes/disable.rb in the cache.
[2025-07-12T20:44:00+03:00] INFO: Storing updated cookbooks/crond/templates/default/sv-crond-log-config.erb in the cache.
[2025-07-12T20:44:00+03:00] INFO: Storing updated cookbooks/crond/templates/default/sv-crond-log-run.erb in the cache.
[2025-07-12T20:44:00+03:00] INFO: Storing updated cookbooks/crond/libraries/crond_helper.rb in the cache.
[2025-07-12T20:44:00+03:00] INFO: Storing updated cookbooks/crond/resources/job.rb in the cache.
  - acme (4.1.6)
  - crond (0.1.0)
Installing cookbook gem dependencies:
Compiling cookbooks...
/opt/gitlab/embedded/cookbooks/cache/cookbooks/package/libraries/helpers/selinux_distro_helper.rb:2: warning: already initialized constant SELinuxDistroHelper::REDHAT_RELEASE_FILE
/opt/gitlab/embedded/cookbooks/package/libraries/helpers/selinux_distro_helper.rb:2: warning: previous definition of REDHAT_RELEASE_FILE was here
/opt/gitlab/embedded/cookbooks/cache/cookbooks/package/libraries/helpers/selinux_distro_helper.rb:3: warning: already initialized constant SELinuxDistroHelper::OS_RELEASE_FILE
/opt/gitlab/embedded/cookbooks/package/libraries/helpers/selinux_distro_helper.rb:3: warning: previous definition of OS_RELEASE_FILE was here
/opt/gitlab/embedded/cookbooks/cache/cookbooks/package/libraries/helpers/secrets_helper.rb:4: warning: already initialized constant SecretsHelper::SECRETS_FILE
/opt/gitlab/embedded/cookbooks/package/libraries/helpers/secrets_helper.rb:4: warning: previous definition of SECRETS_FILE was here
/opt/gitlab/embedded/cookbooks/cache/cookbooks/package/libraries/helpers/secrets_helper.rb:5: warning: already initialized constant SecretsHelper::SECRETS_FILE_CHEF_ATTR
/opt/gitlab/embedded/cookbooks/package/libraries/helpers/secrets_helper.rb:5: warning: previous definition of SECRETS_FILE_CHEF_ATTR was here
/opt/gitlab/embedded/cookbooks/cache/cookbooks/package/libraries/helpers/secrets_helper.rb:6: warning: already initialized constant SecretsHelper::SKIP_GENERATE_SECRETS_CHEF_ATTR
/opt/gitlab/embedded/cookbooks/package/libraries/helpers/secrets_helper.rb:6: warning: previous definition of SKIP_GENERATE_SECRETS_CHEF_ATTR was here
/opt/gitlab/embedded/cookbooks/cache/cookbooks/package/libraries/gitlab_cluster.rb:16: warning: already initialized constant GitlabCluster::CONFIG_PATH
/opt/gitlab/embedded/cookbooks/package/libraries/gitlab_cluster.rb:16: warning: previous definition of CONFIG_PATH was here
/opt/gitlab/embedded/cookbooks/cache/cookbooks/package/libraries/gitlab_cluster.rb:17: warning: already initialized constant GitlabCluster::JSON_FILE
/opt/gitlab/embedded/cookbooks/package/libraries/gitlab_cluster.rb:17: warning: previous definition of JSON_FILE was here
Loading Cinc Auditor profile files:
Loading Cinc Auditor input files:
Loading Cinc Auditor waiver files:
[2025-07-12T20:44:02+03:00] INFO: Generating default secrets
[2025-07-12T20:44:05+03:00] INFO: Generating /etc/gitlab/gitlab-secrets.json file
Recipe: gitlab::default
  * directory[/etc/gitlab] action create[2025-07-12T20:44:05+03:00] INFO: directory[/etc/gitlab] mode changed to 775

    [32m- change mode from '0755' to '0775'[0m
[2025-07-12T20:44:05+03:00] WARN: gitlab-rails does not have a log_group or default logdir mode defined. Setting to 0700.
[2025-07-12T20:44:05+03:00] WARN: Selected systemd because /run/systemd/system/ exists
[2025-07-12T20:44:05+03:00] WARN: gitlab-shell does not have a log_group or default logdir mode defined. Setting to 0700.
[2025-07-12T20:44:05+03:00] WARN: gitlab-sshd does not have a log_group or default logdir mode defined. Setting to 0700.
[2025-07-12T20:44:05+03:00] WARN: logrotate does not have a log_group or default logdir mode defined. Setting to 0700.
[2025-07-12T20:44:05+03:00] WARN: logrotate does not have a log_group or default logdir mode defined. Setting to 0700.
[2025-07-12T20:44:05+03:00] WARN: puma does not have a log_group or default logdir mode defined. Setting to 0700.
[2025-07-12T20:44:05+03:00] WARN: gitlab-rails does not have a log_group or default logdir mode defined. Setting to 0700.
[2025-07-12T20:44:05+03:00] WARN: gitlab-shell does not have a log_group or default logdir mode defined. Setting to 0700.
[2025-07-12T20:44:05+03:00] WARN: gitlab-workhorse does not have a log_group or default logdir mode defined. Setting to 0700.
[2025-07-12T20:44:05+03:00] WARN: gitlab-pages does not have a log_group or default logdir mode defined. Setting to 0700.
[2025-07-12T20:44:05+03:00] WARN: gitlab-kas does not have a log_group or default logdir mode defined. Setting to 0700.
[2025-07-12T20:44:05+03:00] WARN: gitaly does not have a log_group or default logdir mode defined. Setting to 0700.
[2025-07-12T20:44:05+03:00] WARN: mailroom does not have a log_group or default logdir mode defined. Setting to 0700.
[2025-07-12T20:44:05+03:00] WARN: gitaly does not have a log_group or default logdir mode defined. Setting to 0700.
[2025-07-12T20:44:05+03:00] WARN: postgresql does not have a log_group or default logdir mode defined. Setting to 0700.
[2025-07-12T20:44:05+03:00] WARN: postgresql does not have a log_group or default logdir mode defined. Setting to 0700.
[2025-07-12T20:44:05+03:00] INFO: /opt/gitlab/init/postgresql status does not exist.
[2025-07-12T20:44:05+03:00] WARN: gitlab-kas does not have a log_group or default logdir mode defined. Setting to 0700.
[2025-07-12T20:44:05+03:00] WARN: puma does not have a log_group or default logdir mode defined. Setting to 0700.
[2025-07-12T20:44:05+03:00] WARN: sidekiq does not have a log_group or default logdir mode defined. Setting to 0700.
[2025-07-12T20:44:05+03:00] WARN: gitlab-workhorse does not have a log_group or default logdir mode defined. Setting to 0700.
[2025-07-12T20:44:05+03:00] WARN: node-exporter does not have a log_group or default logdir mode defined. Setting to 0700.
[2025-07-12T20:44:05+03:00] WARN: gitlab-exporter does not have a log_group or default logdir mode defined. Setting to 0700.
[2025-07-12T20:44:05+03:00] WARN: redis-exporter does not have a log_group or default logdir mode defined. Setting to 0700.
[2025-07-12T20:44:05+03:00] WARN: prometheus does not have a log_group or default logdir mode defined. Setting to 0700.
[2025-07-12T20:44:05+03:00] WARN: alertmanager does not have a log_group or default logdir mode defined. Setting to 0700.
[2025-07-12T20:44:05+03:00] WARN: postgres-exporter does not have a log_group or default logdir mode defined. Setting to 0700.
  Converging 293 resources
  * directory[/etc/gitlab] action create (up to date)
  * directory[Create /var/opt/gitlab] action create[2025-07-12T20:44:06+03:00] INFO: directory[Create /var/opt/gitlab] created directory /var/opt/gitlab

    [32m- create new directory /var/opt/gitlab[0m[2025-07-12T20:44:06+03:00] INFO: directory[Create /var/opt/gitlab] owner changed to 0
[2025-07-12T20:44:06+03:00] INFO: directory[Create /var/opt/gitlab] group changed to 0
[2025-07-12T20:44:06+03:00] INFO: directory[Create /var/opt/gitlab] mode changed to 755

    [32m- change mode from '' to '0755'[0m
    [32m- change owner from '' to 'root'[0m
    [32m- change group from '' to 'root'[0m
  * directory[Create /var/log/gitlab] action create (up to date)
  * directory[/opt/gitlab/embedded/etc] action create[2025-07-12T20:44:06+03:00] INFO: directory[/opt/gitlab/embedded/etc] created directory /opt/gitlab/embedded/etc

    [32m- create new directory /opt/gitlab/embedded/etc[0m[2025-07-12T20:44:06+03:00] INFO: directory[/opt/gitlab/embedded/etc] owner changed to 0
[2025-07-12T20:44:06+03:00] INFO: directory[/opt/gitlab/embedded/etc] group changed to 0
[2025-07-12T20:44:06+03:00] INFO: directory[/opt/gitlab/embedded/etc] mode changed to 755

    [32m- change mode from '' to '0755'[0m
    [32m- change owner from '' to 'root'[0m
    [32m- change group from '' to 'root'[0m
  * template[/opt/gitlab/embedded/etc/gitconfig] action create[2025-07-12T20:44:06+03:00] INFO: template[/opt/gitlab/embedded/etc/gitconfig] created file /opt/gitlab/embedded/etc/gitconfig

    [32m- create new file /opt/gitlab/embedded/etc/gitconfig[0m[2025-07-12T20:44:06+03:00] INFO: template[/opt/gitlab/embedded/etc/gitconfig] updated file contents /opt/gitlab/embedded/etc/gitconfig

    [32m- update content in file /opt/gitlab/embedded/etc/gitconfig from none to e3b0c4[0m
    [37m(no diff)[0m[2025-07-12T20:44:06+03:00] INFO: template[/opt/gitlab/embedded/etc/gitconfig] mode changed to 755

    [32m- change mode from '' to '0755'[0m
Recipe: gitlab::web-server
  * account[Webserver user and group] action create
    * group[Webserver user and group] action create[2025-07-12T20:44:06+03:00] INFO: group[Webserver user and group] created

      [32m- create group gitlab-www[0m
    * linux_user[Webserver user and group] action create[2025-07-12T20:44:06+03:00] INFO: linux_user[Webserver user and group] created

      [32m- create user gitlab-www[0m
  
Recipe: gitlab::users
  * directory[/var/opt/gitlab] action create (up to date)
  * account[GitLab user and group] action create
    * group[GitLab user and group] action create[2025-07-12T20:44:06+03:00] INFO: group[GitLab user and group] created

      [32m- create group git[0m
    * linux_user[GitLab user and group] action create[2025-07-12T20:44:06+03:00] INFO: linux_user[GitLab user and group] created

      [32m- create user git[0m
  
  * template[/var/opt/gitlab/.gitconfig] action create[2025-07-12T20:44:06+03:00] INFO: template[/var/opt/gitlab/.gitconfig] created file /var/opt/gitlab/.gitconfig

    [32m- create new file /var/opt/gitlab/.gitconfig[0m[2025-07-12T20:44:06+03:00] INFO: template[/var/opt/gitlab/.gitconfig] updated file contents /var/opt/gitlab/.gitconfig

    [32m- update content in file /var/opt/gitlab/.gitconfig from none to b63a27[0m
    [37m--- /var/opt/gitlab/.gitconfig	2025-07-12 20:44:06.837835988 +0300[0m
    [37m+++ /var/opt/gitlab/.chef-.gitconfig20250712-17810-cdpegw.gitconfig	2025-07-12 20:44:06.837835988 +0300[0m
    [37m@@ -1,12 +1,24 @@[0m
    [37m+# This file is managed by gitlab-ctl. Manual changes will be[0m
    [37m+# erased! To change the contents below, edit /etc/gitlab/gitlab.rb[0m
    [37m+# and run `sudo gitlab-ctl reconfigure`.[0m
    [37m+[0m
    [37m+[user][0m
    [37m+        name = GitLab[0m
    [37m+        email = gitlab@gitlab.example.com[0m
    [37m+[core][0m
    [37m+        autocrlf = input[0m
    [37m+        [0m
    [37m+[gc][0m
    [37m+        auto = 0[0m[2025-07-12T20:44:06+03:00] INFO: template[/var/opt/gitlab/.gitconfig] owner changed to 994
[2025-07-12T20:44:06+03:00] INFO: template[/var/opt/gitlab/.gitconfig] group changed to 991
[2025-07-12T20:44:06+03:00] INFO: template[/var/opt/gitlab/.gitconfig] mode changed to 644

    [32m- change mode from '' to '0644'[0m
    [32m- change owner from '' to 'git'[0m
    [32m- change group from '' to 'git'[0m
  * directory[/var/opt/gitlab/.bundle] action create[2025-07-12T20:44:06+03:00] INFO: directory[/var/opt/gitlab/.bundle] created directory /var/opt/gitlab/.bundle

    [32m- create new directory /var/opt/gitlab/.bundle[0m[2025-07-12T20:44:06+03:00] INFO: directory[/var/opt/gitlab/.bundle] owner changed to 994
[2025-07-12T20:44:06+03:00] INFO: directory[/var/opt/gitlab/.bundle] group changed to 991

    [32m- change owner from '' to 'git'[0m
    [32m- change group from '' to 'git'[0m
Recipe: gitaly::git_data_dirs
  * storage_directory[/var/opt/gitlab/git-data/repositories] action create
    * ruby_block[directory resource: /var/opt/gitlab/git-data/repositories] action run[2025-07-12T20:44:07+03:00] INFO: ruby_block[directory resource: /var/opt/gitlab/git-data/repositories] called

      [32m- execute the ruby block directory resource: /var/opt/gitlab/git-data/repositories[0m
  
Recipe: gitlab::rails_pages_shared_path
  * storage_directory[/var/opt/gitlab/gitlab-rails/shared] action create
    * ruby_block[directory resource: /var/opt/gitlab/gitlab-rails/shared] action run[2025-07-12T20:44:07+03:00] INFO: ruby_block[directory resource: /var/opt/gitlab/gitlab-rails/shared] called

      [32m- execute the ruby block directory resource: /var/opt/gitlab/gitlab-rails/shared[0m
  
  * storage_directory[/var/opt/gitlab/gitlab-rails/shared/pages] action create
    * ruby_block[directory resource: /var/opt/gitlab/gitlab-rails/shared/pages] action run[2025-07-12T20:44:07+03:00] INFO: ruby_block[directory resource: /var/opt/gitlab/gitlab-rails/shared/pages] called

      [32m- execute the ruby block directory resource: /var/opt/gitlab/gitlab-rails/shared/pages[0m
  
Recipe: gitlab::gitlab-rails
  * storage_directory[/var/opt/gitlab/gitlab-rails/shared/artifacts] action create
    * ruby_block[directory resource: /var/opt/gitlab/gitlab-rails/shared/artifacts] action run[2025-07-12T20:44:08+03:00] INFO: ruby_block[directory resource: /var/opt/gitlab/gitlab-rails/shared/artifacts] called

      [32m- execute the ruby block directory resource: /var/opt/gitlab/gitlab-rails/shared/artifacts[0m
  
  * storage_directory[/var/opt/gitlab/gitlab-rails/shared/external-diffs] action create
    * ruby_block[directory resource: /var/opt/gitlab/gitlab-rails/shared/external-diffs] action run[2025-07-12T20:44:08+03:00] INFO: ruby_block[directory resource: /var/opt/gitlab/gitlab-rails/shared/external-diffs] called

      [32m- execute the ruby block directory resource: /var/opt/gitlab/gitlab-rails/shared/external-diffs[0m
  
  * storage_directory[/var/opt/gitlab/gitlab-rails/shared/lfs-objects] action create
    * ruby_block[directory resource: /var/opt/gitlab/gitlab-rails/shared/lfs-objects] action run[2025-07-12T20:44:08+03:00] INFO: ruby_block[directory resource: /var/opt/gitlab/gitlab-rails/shared/lfs-objects] called

      [32m- execute the ruby block directory resource: /var/opt/gitlab/gitlab-rails/shared/lfs-objects[0m
  
  * storage_directory[/var/opt/gitlab/gitlab-rails/shared/packages] action create
    * ruby_block[directory resource: /var/opt/gitlab/gitlab-rails/shared/packages] action run[2025-07-12T20:44:08+03:00] INFO: ruby_block[directory resource: /var/opt/gitlab/gitlab-rails/shared/packages] called

      [32m- execute the ruby block directory resource: /var/opt/gitlab/gitlab-rails/shared/packages[0m
  
  * storage_directory[/var/opt/gitlab/gitlab-rails/shared/dependency_proxy] action create
    * ruby_block[directory resource: /var/opt/gitlab/gitlab-rails/shared/dependency_proxy] action run[2025-07-12T20:44:09+03:00] INFO: ruby_block[directory resource: /var/opt/gitlab/gitlab-rails/shared/dependency_proxy] called

      [32m- execute the ruby block directory resource: /var/opt/gitlab/gitlab-rails/shared/dependency_proxy[0m
  
  * storage_directory[/var/opt/gitlab/gitlab-rails/shared/terraform_state] action create
    * ruby_block[directory resource: /var/opt/gitlab/gitlab-rails/shared/terraform_state] action run[2025-07-12T20:44:09+03:00] INFO: ruby_block[directory resource: /var/opt/gitlab/gitlab-rails/shared/terraform_state] called

      [32m- execute the ruby block directory resource: /var/opt/gitlab/gitlab-rails/shared/terraform_state[0m
  
  * storage_directory[/var/opt/gitlab/gitlab-rails/shared/ci_secure_files] action create
    * ruby_block[directory resource: /var/opt/gitlab/gitlab-rails/shared/ci_secure_files] action run[2025-07-12T20:44:09+03:00] INFO: ruby_block[directory resource: /var/opt/gitlab/gitlab-rails/shared/ci_secure_files] called

      [32m- execute the ruby block directory resource: /var/opt/gitlab/gitlab-rails/shared/ci_secure_files[0m
  
  * storage_directory[/var/opt/gitlab/gitlab-rails/shared/encrypted_settings] action create
    * ruby_block[directory resource: /var/opt/gitlab/gitlab-rails/shared/encrypted_settings] action run[2025-07-12T20:44:09+03:00] INFO: ruby_block[directory resource: /var/opt/gitlab/gitlab-rails/shared/encrypted_settings] called

      [32m- execute the ruby block directory resource: /var/opt/gitlab/gitlab-rails/shared/encrypted_settings[0m
  
  * storage_directory[/var/opt/gitlab/gitlab-rails/uploads] action create
    * ruby_block[directory resource: /var/opt/gitlab/gitlab-rails/uploads] action run[2025-07-12T20:44:10+03:00] INFO: ruby_block[directory resource: /var/opt/gitlab/gitlab-rails/uploads] called

      [32m- execute the ruby block directory resource: /var/opt/gitlab/gitlab-rails/uploads[0m
  
  * storage_directory[/var/opt/gitlab/gitlab-ci/builds] action create
    * ruby_block[directory resource: /var/opt/gitlab/gitlab-ci/builds] action run[2025-07-12T20:44:10+03:00] INFO: ruby_block[directory resource: /var/opt/gitlab/gitlab-ci/builds] called

      [32m- execute the ruby block directory resource: /var/opt/gitlab/gitlab-ci/builds[0m
  
  * storage_directory[/var/opt/gitlab/gitlab-rails/shared/cache] action create
    * ruby_block[directory resource: /var/opt/gitlab/gitlab-rails/shared/cache] action run[2025-07-12T20:44:10+03:00] INFO: ruby_block[directory resource: /var/opt/gitlab/gitlab-rails/shared/cache] called

      [32m- execute the ruby block directory resource: /var/opt/gitlab/gitlab-rails/shared/cache[0m
  
  * storage_directory[/var/opt/gitlab/gitlab-rails/shared/tmp] action create
    * ruby_block[directory resource: /var/opt/gitlab/gitlab-rails/shared/tmp] action run[2025-07-12T20:44:11+03:00] INFO: ruby_block[directory resource: /var/opt/gitlab/gitlab-rails/shared/tmp] called

      [32m- execute the ruby block directory resource: /var/opt/gitlab/gitlab-rails/shared/tmp[0m
  
  * storage_directory[/opt/gitlab/embedded/service/gitlab-rails/public] action create (skipped due to only_if)
  * directory[create /var/opt/gitlab/gitlab-rails/etc] action create[2025-07-12T20:44:11+03:00] INFO: directory[create /var/opt/gitlab/gitlab-rails/etc] created directory /var/opt/gitlab/gitlab-rails/etc

    [32m- create new directory /var/opt/gitlab/gitlab-rails/etc[0m[2025-07-12T20:44:11+03:00] INFO: directory[create /var/opt/gitlab/gitlab-rails/etc] owner changed to 994
[2025-07-12T20:44:11+03:00] INFO: directory[create /var/opt/gitlab/gitlab-rails/etc] mode changed to 700

    [32m- change mode from '' to '0700'[0m
    [32m- change owner from '' to 'git'[0m
  * directory[create /opt/gitlab/etc/gitlab-rails] action create[2025-07-12T20:44:11+03:00] INFO: directory[create /opt/gitlab/etc/gitlab-rails] created directory /opt/gitlab/etc/gitlab-rails

    [32m- create new directory /opt/gitlab/etc/gitlab-rails[0m[2025-07-12T20:44:11+03:00] INFO: directory[create /opt/gitlab/etc/gitlab-rails] owner changed to 994
[2025-07-12T20:44:11+03:00] INFO: directory[create /opt/gitlab/etc/gitlab-rails] mode changed to 700

    [32m- change mode from '' to '0700'[0m
    [32m- change owner from '' to 'git'[0m
  * directory[create /var/opt/gitlab/gitlab-rails/working] action create[2025-07-12T20:44:11+03:00] INFO: directory[create /var/opt/gitlab/gitlab-rails/working] created directory /var/opt/gitlab/gitlab-rails/working

    [32m- create new directory /var/opt/gitlab/gitlab-rails/working[0m[2025-07-12T20:44:11+03:00] INFO: directory[create /var/opt/gitlab/gitlab-rails/working] owner changed to 994
[2025-07-12T20:44:11+03:00] INFO: directory[create /var/opt/gitlab/gitlab-rails/working] mode changed to 700

    [32m- change mode from '' to '0700'[0m
    [32m- change owner from '' to 'git'[0m
  * directory[create /var/opt/gitlab/gitlab-rails/tmp] action create[2025-07-12T20:44:11+03:00] INFO: directory[create /var/opt/gitlab/gitlab-rails/tmp] created directory /var/opt/gitlab/gitlab-rails/tmp

    [32m- create new directory /var/opt/gitlab/gitlab-rails/tmp[0m[2025-07-12T20:44:11+03:00] INFO: directory[create /var/opt/gitlab/gitlab-rails/tmp] owner changed to 994
[2025-07-12T20:44:11+03:00] INFO: directory[create /var/opt/gitlab/gitlab-rails/tmp] mode changed to 700

    [32m- change mode from '' to '0700'[0m
    [32m- change owner from '' to 'git'[0m
  * directory[create /var/opt/gitlab/gitlab-rails/upgrade-status] action create[2025-07-12T20:44:11+03:00] INFO: directory[create /var/opt/gitlab/gitlab-rails/upgrade-status] created directory /var/opt/gitlab/gitlab-rails/upgrade-status

    [32m- create new directory /var/opt/gitlab/gitlab-rails/upgrade-status[0m[2025-07-12T20:44:11+03:00] INFO: directory[create /var/opt/gitlab/gitlab-rails/upgrade-status] owner changed to 994
[2025-07-12T20:44:11+03:00] INFO: directory[create /var/opt/gitlab/gitlab-rails/upgrade-status] mode changed to 700

    [32m- change mode from '' to '0700'[0m
    [32m- change owner from '' to 'git'[0m
  * directory[/var/log/gitlab/gitlab-rails] action create[2025-07-12T20:44:11+03:00] INFO: directory[/var/log/gitlab/gitlab-rails] created directory /var/log/gitlab/gitlab-rails

    [32m- create new directory /var/log/gitlab/gitlab-rails[0m[2025-07-12T20:44:11+03:00] INFO: directory[/var/log/gitlab/gitlab-rails] owner changed to 994
[2025-07-12T20:44:11+03:00] INFO: directory[/var/log/gitlab/gitlab-rails] mode changed to 700

    [32m- change mode from '' to '0700'[0m
    [32m- change owner from '' to 'git'[0m
  * storage_directory[/var/opt/gitlab/backups] action create
    * ruby_block[directory resource: /var/opt/gitlab/backups] action run[2025-07-12T20:44:11+03:00] INFO: ruby_block[directory resource: /var/opt/gitlab/backups] called

      [32m- execute the ruby block directory resource: /var/opt/gitlab/backups[0m
  
  * directory[/var/opt/gitlab/gitlab-rails] action create[2025-07-12T20:44:11+03:00] INFO: directory[/var/opt/gitlab/gitlab-rails] owner changed to 994

    [32m- change owner from 'root' to 'git'[0m
  * directory[/var/opt/gitlab/gitlab-ci] action create[2025-07-12T20:44:11+03:00] INFO: directory[/var/opt/gitlab/gitlab-ci] owner changed to 994

    [32m- change owner from 'root' to 'git'[0m
  * file[/var/opt/gitlab/gitlab-rails/etc/gitlab-registry.key] action create (skipped due to only_if)
  * template[/opt/gitlab/etc/gitlab-rails-rc] action create[2025-07-12T20:44:11+03:00] INFO: template[/opt/gitlab/etc/gitlab-rails-rc] created file /opt/gitlab/etc/gitlab-rails-rc

    [32m- create new file /opt/gitlab/etc/gitlab-rails-rc[0m[2025-07-12T20:44:11+03:00] INFO: template[/opt/gitlab/etc/gitlab-rails-rc] updated file contents /opt/gitlab/etc/gitlab-rails-rc

    [32m- update content in file /opt/gitlab/etc/gitlab-rails-rc from none to 7b16c8[0m
    [37m--- /opt/gitlab/etc/gitlab-rails-rc	2025-07-12 20:44:11.469835988 +0300[0m
    [37m+++ /opt/gitlab/etc/.chef-gitlab-rails-rc20250712-17810-7th14v	2025-07-12 20:44:11.469835988 +0300[0m
    [37m@@ -1,5 +1,10 @@[0m
    [37m+gitlab_user='git'[0m
    [37m+gitlab_group='git'[0m
    [37m+registry_dir=''[0m
    [37m+registry_user='registry'[0m
    [37m+registry_group='registry'[0m[2025-07-12T20:44:11+03:00] INFO: template[/opt/gitlab/etc/gitlab-rails-rc] owner changed to 0
[2025-07-12T20:44:11+03:00] INFO: template[/opt/gitlab/etc/gitlab-rails-rc] group changed to 0
[2025-07-12T20:44:11+03:00] INFO: template[/opt/gitlab/etc/gitlab-rails-rc] mode changed to 644

    [32m- change mode from '' to '0644'[0m
    [32m- change owner from '' to 'root'[0m
    [32m- change group from '' to 'root'[0m
  * file[/opt/gitlab/embedded/service/gitlab-rails/.secret] action delete (up to date)
  * file[/var/opt/gitlab/gitlab-rails/etc/secret] action delete (up to date)
  * templatesymlink[Create a database.yml and create a symlink to Rails root] action create
    * template[/var/opt/gitlab/gitlab-rails/etc/database.yml] action create[2025-07-12T20:44:11+03:00] INFO: template[/var/opt/gitlab/gitlab-rails/etc/database.yml] created file /var/opt/gitlab/gitlab-rails/etc/database.yml

      [32m- create new file /var/opt/gitlab/gitlab-rails/etc/database.yml[0m[2025-07-12T20:44:11+03:00] INFO: template[/var/opt/gitlab/gitlab-rails/etc/database.yml] updated file contents /var/opt/gitlab/gitlab-rails/etc/database.yml

      [32m- update content in file /var/opt/gitlab/gitlab-rails/etc/database.yml from none to 9c495c[0m
      [32m- suppressed sensitive resource[0m[2025-07-12T20:44:11+03:00] INFO: template[/var/opt/gitlab/gitlab-rails/etc/database.yml] owner changed to 0
[2025-07-12T20:44:11+03:00] INFO: template[/var/opt/gitlab/gitlab-rails/etc/database.yml] group changed to 991
[2025-07-12T20:44:11+03:00] INFO: template[/var/opt/gitlab/gitlab-rails/etc/database.yml] mode changed to 640

      [32m- change mode from '' to '0640'[0m
      [32m- change owner from '' to 'root'[0m
      [32m- change group from '' to 'git'[0m
    * link[Link /opt/gitlab/embedded/service/gitlab-rails/config/database.yml to /var/opt/gitlab/gitlab-rails/etc/database.yml] action create[2025-07-12T20:44:11+03:00] INFO: link[Link /opt/gitlab/embedded/service/gitlab-rails/config/database.yml to /var/opt/gitlab/gitlab-rails/etc/database.yml] created

      [32m- create symlink at /opt/gitlab/embedded/service/gitlab-rails/config/database.yml to /var/opt/gitlab/gitlab-rails/etc/database.yml[0m
  
  * templatesymlink[Create a clickhouse.yml and create a symlink to Rails root] action create
    * template[/var/opt/gitlab/gitlab-rails/etc/click_house.yml] action create[2025-07-12T20:44:11+03:00] INFO: template[/var/opt/gitlab/gitlab-rails/etc/click_house.yml] created file /var/opt/gitlab/gitlab-rails/etc/click_house.yml

      [32m- create new file /var/opt/gitlab/gitlab-rails/etc/click_house.yml[0m[2025-07-12T20:44:11+03:00] INFO: template[/var/opt/gitlab/gitlab-rails/etc/click_house.yml] updated file contents /var/opt/gitlab/gitlab-rails/etc/click_house.yml

      [32m- update content in file /var/opt/gitlab/gitlab-rails/etc/click_house.yml from none to 460e0a[0m
      [32m- suppressed sensitive resource[0m[2025-07-12T20:44:11+03:00] INFO: template[/var/opt/gitlab/gitlab-rails/etc/click_house.yml] owner changed to 0
[2025-07-12T20:44:11+03:00] INFO: template[/var/opt/gitlab/gitlab-rails/etc/click_house.yml] group changed to 991
[2025-07-12T20:44:11+03:00] INFO: template[/var/opt/gitlab/gitlab-rails/etc/click_house.yml] mode changed to 640

      [32m- change mode from '' to '0640'[0m
      [32m- change owner from '' to 'root'[0m
      [32m- change group from '' to 'git'[0m
    * link[Link /opt/gitlab/embedded/service/gitlab-rails/config/click_house.yml to /var/opt/gitlab/gitlab-rails/etc/click_house.yml] action create[2025-07-12T20:44:11+03:00] INFO: link[Link /opt/gitlab/embedded/service/gitlab-rails/config/click_house.yml to /var/opt/gitlab/gitlab-rails/etc/click_house.yml] created

      [32m- create symlink at /opt/gitlab/embedded/service/gitlab-rails/config/click_house.yml to /var/opt/gitlab/gitlab-rails/etc/click_house.yml[0m
  
  * templatesymlink[Create a secrets.yml and create a symlink to Rails root] action create
    * template[/var/opt/gitlab/gitlab-rails/etc/secrets.yml] action create[2025-07-12T20:44:11+03:00] INFO: template[/var/opt/gitlab/gitlab-rails/etc/secrets.yml] created file /var/opt/gitlab/gitlab-rails/etc/secrets.yml

      [32m- create new file /var/opt/gitlab/gitlab-rails/etc/secrets.yml[0m[2025-07-12T20:44:11+03:00] INFO: template[/var/opt/gitlab/gitlab-rails/etc/secrets.yml] updated file contents /var/opt/gitlab/gitlab-rails/etc/secrets.yml

      [32m- update content in file /var/opt/gitlab/gitlab-rails/etc/secrets.yml from none to 89a73c[0m
      [32m- suppressed sensitive resource[0m[2025-07-12T20:44:11+03:00] INFO: template[/var/opt/gitlab/gitlab-rails/etc/secrets.yml] owner changed to 0
[2025-07-12T20:44:11+03:00] INFO: template[/var/opt/gitlab/gitlab-rails/etc/secrets.yml] group changed to 0
[2025-07-12T20:44:11+03:00] INFO: template[/var/opt/gitlab/gitlab-rails/etc/secrets.yml] mode changed to 644

      [32m- change mode from '' to '0644'[0m
      [32m- change owner from '' to 'root'[0m
      [32m- change group from '' to 'root'[0m
    * link[Link /opt/gitlab/embedded/service/gitlab-rails/config/secrets.yml to /var/opt/gitlab/gitlab-rails/etc/secrets.yml] action create[2025-07-12T20:44:11+03:00] INFO: link[Link /opt/gitlab/embedded/service/gitlab-rails/config/secrets.yml to /var/opt/gitlab/gitlab-rails/etc/secrets.yml] created

      [32m- create symlink at /opt/gitlab/embedded/service/gitlab-rails/config/secrets.yml to /var/opt/gitlab/gitlab-rails/etc/secrets.yml[0m
  
  * templatesymlink[Create a resque.yml and create a symlink to Rails root] action create
    * template[/var/opt/gitlab/gitlab-rails/etc/resque.yml] action create[2025-07-12T20:44:11+03:00] INFO: template[/var/opt/gitlab/gitlab-rails/etc/resque.yml] created file /var/opt/gitlab/gitlab-rails/etc/resque.yml

      [32m- create new file /var/opt/gitlab/gitlab-rails/etc/resque.yml[0m[2025-07-12T20:44:11+03:00] INFO: template[/var/opt/gitlab/gitlab-rails/etc/resque.yml] updated file contents /var/opt/gitlab/gitlab-rails/etc/resque.yml

      [32m- update content in file /var/opt/gitlab/gitlab-rails/etc/resque.yml from none to 213e3b[0m
      [32m- suppressed sensitive resource[0m[2025-07-12T20:44:11+03:00] INFO: template[/var/opt/gitlab/gitlab-rails/etc/resque.yml] owner changed to 0
[2025-07-12T20:44:11+03:00] INFO: template[/var/opt/gitlab/gitlab-rails/etc/resque.yml] group changed to 0
[2025-07-12T20:44:11+03:00] INFO: template[/var/opt/gitlab/gitlab-rails/etc/resque.yml] mode changed to 644

      [32m- change mode from '' to '0644'[0m
      [32m- change owner from '' to 'root'[0m
      [32m- change group from '' to 'root'[0m
    * link[Link /opt/gitlab/embedded/service/gitlab-rails/config/resque.yml to /var/opt/gitlab/gitlab-rails/etc/resque.yml] action create[2025-07-12T20:44:11+03:00] INFO: link[Link /opt/gitlab/embedded/service/gitlab-rails/config/resque.yml to /var/opt/gitlab/gitlab-rails/etc/resque.yml] created

      [32m- create symlink at /opt/gitlab/embedded/service/gitlab-rails/config/resque.yml to /var/opt/gitlab/gitlab-rails/etc/resque.yml[0m
  
  * templatesymlink[Create an override redis.yml and create a symlink to Rails root] action create
    * template[/var/opt/gitlab/gitlab-rails/etc/redis.yml] action create[2025-07-12T20:44:11+03:00] INFO: template[/var/opt/gitlab/gitlab-rails/etc/redis.yml] created file /var/opt/gitlab/gitlab-rails/etc/redis.yml

      [32m- create new file /var/opt/gitlab/gitlab-rails/etc/redis.yml[0m[2025-07-12T20:44:11+03:00] INFO: template[/var/opt/gitlab/gitlab-rails/etc/redis.yml] updated file contents /var/opt/gitlab/gitlab-rails/etc/redis.yml

      [32m- update content in file /var/opt/gitlab/gitlab-rails/etc/redis.yml from none to e3b0c4[0m
      [32m- suppressed sensitive resource[0m[2025-07-12T20:44:11+03:00] INFO: template[/var/opt/gitlab/gitlab-rails/etc/redis.yml] owner changed to 0
[2025-07-12T20:44:11+03:00] INFO: template[/var/opt/gitlab/gitlab-rails/etc/redis.yml] group changed to 0
[2025-07-12T20:44:11+03:00] INFO: template[/var/opt/gitlab/gitlab-rails/etc/redis.yml] mode changed to 644

      [32m- change mode from '' to '0644'[0m
      [32m- change owner from '' to 'root'[0m
      [32m- change group from '' to 'root'[0m
    * link[Link /opt/gitlab/embedded/service/gitlab-rails/config/redis.yml to /var/opt/gitlab/gitlab-rails/etc/redis.yml] action create[2025-07-12T20:44:11+03:00] INFO: link[Link /opt/gitlab/embedded/service/gitlab-rails/config/redis.yml to /var/opt/gitlab/gitlab-rails/etc/redis.yml] created

      [32m- create symlink at /opt/gitlab/embedded/service/gitlab-rails/config/redis.yml to /var/opt/gitlab/gitlab-rails/etc/redis.yml[0m
  
  * templatesymlink[Create a cable.yml and create a symlink to Rails root] action create
    * template[/var/opt/gitlab/gitlab-rails/etc/cable.yml] action create[2025-07-12T20:44:11+03:00] INFO: template[/var/opt/gitlab/gitlab-rails/etc/cable.yml] created file /var/opt/gitlab/gitlab-rails/etc/cable.yml

      [32m- create new file /var/opt/gitlab/gitlab-rails/etc/cable.yml[0m[2025-07-12T20:44:11+03:00] INFO: template[/var/opt/gitlab/gitlab-rails/etc/cable.yml] updated file contents /var/opt/gitlab/gitlab-rails/etc/cable.yml

      [32m- update content in file /var/opt/gitlab/gitlab-rails/etc/cable.yml from none to 50bd4b[0m
      [32m- suppressed sensitive resource[0m[2025-07-12T20:44:11+03:00] INFO: template[/var/opt/gitlab/gitlab-rails/etc/cable.yml] owner changed to 0
[2025-07-12T20:44:11+03:00] INFO: template[/var/opt/gitlab/gitlab-rails/etc/cable.yml] group changed to 0
[2025-07-12T20:44:11+03:00] INFO: template[/var/opt/gitlab/gitlab-rails/etc/cable.yml] mode changed to 644

      [32m- change mode from '' to '0644'[0m
      [32m- change owner from '' to 'root'[0m
      [32m- change group from '' to 'root'[0m
    * link[Link /opt/gitlab/embedded/service/gitlab-rails/config/cable.yml to /var/opt/gitlab/gitlab-rails/etc/cable.yml] action create[2025-07-12T20:44:11+03:00] INFO: link[Link /opt/gitlab/embedded/service/gitlab-rails/config/cable.yml to /var/opt/gitlab/gitlab-rails/etc/cable.yml] created

      [32m- create symlink at /opt/gitlab/embedded/service/gitlab-rails/config/cable.yml to /var/opt/gitlab/gitlab-rails/etc/cable.yml[0m
  
  * templatesymlink[Create a redis.cache.yml and create a symlink to Rails root] action delete
    * file[/var/opt/gitlab/gitlab-rails/etc/redis.cache.yml] action delete (up to date)
    * link[/opt/gitlab/embedded/service/gitlab-rails/config/redis.cache.yml] action delete (up to date)
     (up to date)
  * templatesymlink[Create a redis.queues.yml and create a symlink to Rails root] action delete
    * file[/var/opt/gitlab/gitlab-rails/etc/redis.queues.yml] action delete (up to date)
    * link[/opt/gitlab/embedded/service/gitlab-rails/config/redis.queues.yml] action delete (up to date)
     (up to date)
  * templatesymlink[Create a redis.shared_state.yml and create a symlink to Rails root] action delete
    * file[/var/opt/gitlab/gitlab-rails/etc/redis.shared_state.yml] action delete (up to date)
    * link[/opt/gitlab/embedded/service/gitlab-rails/config/redis.shared_state.yml] action delete (up to date)
     (up to date)
  * templatesymlink[Create a redis.trace_chunks.yml and create a symlink to Rails root] action delete
    * file[/var/opt/gitlab/gitlab-rails/etc/redis.trace_chunks.yml] action delete (up to date)
    * link[/opt/gitlab/embedded/service/gitlab-rails/config/redis.trace_chunks.yml] action delete (up to date)
     (up to date)
  * templatesymlink[Create a redis.rate_limiting.yml and create a symlink to Rails root] action delete
    * file[/var/opt/gitlab/gitlab-rails/etc/redis.rate_limiting.yml] action delete (up to date)
    * link[/opt/gitlab/embedded/service/gitlab-rails/config/redis.rate_limiting.yml] action delete (up to date)
     (up to date)
  * templatesymlink[Create a redis.sessions.yml and create a symlink to Rails root] action delete
    * file[/var/opt/gitlab/gitlab-rails/etc/redis.sessions.yml] action delete (up to date)
    * link[/opt/gitlab/embedded/service/gitlab-rails/config/redis.sessions.yml] action delete (up to date)
     (up to date)
  * templatesymlink[Create a redis.repository_cache.yml and create a symlink to Rails root] action delete
    * file[/var/opt/gitlab/gitlab-rails/etc/redis.repository_cache.yml] action delete (up to date)
    * link[/opt/gitlab/embedded/service/gitlab-rails/config/redis.repository_cache.yml] action delete (up to date)
     (up to date)
  * templatesymlink[Create a redis.cluster_rate_limiting.yml and create a symlink to Rails root] action delete
    * file[/var/opt/gitlab/gitlab-rails/etc/redis.cluster_rate_limiting.yml] action delete (up to date)
    * link[/opt/gitlab/embedded/service/gitlab-rails/config/redis.cluster_rate_limiting.yml] action delete (up to date)
     (up to date)
  * templatesymlink[Create a redis.workhorse.yml and create a symlink to Rails root] action delete
    * file[/var/opt/gitlab/gitlab-rails/etc/redis.workhorse.yml] action delete (up to date)
    * link[/opt/gitlab/embedded/service/gitlab-rails/config/redis.workhorse.yml] action delete (up to date)
     (up to date)
  * templatesymlink[Create a session_store.yml and create a symlink to Rails root] action create
    * template[/var/opt/gitlab/gitlab-rails/etc/session_store.yml] action create[2025-07-12T20:44:11+03:00] INFO: template[/var/opt/gitlab/gitlab-rails/etc/session_store.yml] created file /var/opt/gitlab/gitlab-rails/etc/session_store.yml

      [32m- create new file /var/opt/gitlab/gitlab-rails/etc/session_store.yml[0m[2025-07-12T20:44:11+03:00] INFO: template[/var/opt/gitlab/gitlab-rails/etc/session_store.yml] updated file contents /var/opt/gitlab/gitlab-rails/etc/session_store.yml

      [32m- update content in file /var/opt/gitlab/gitlab-rails/etc/session_store.yml from none to c362aa[0m
      [32m- suppressed sensitive resource[0m[2025-07-12T20:44:11+03:00] INFO: template[/var/opt/gitlab/gitlab-rails/etc/session_store.yml] owner changed to 0
[2025-07-12T20:44:11+03:00] INFO: template[/var/opt/gitlab/gitlab-rails/etc/session_store.yml] group changed to 991
[2025-07-12T20:44:11+03:00] INFO: template[/var/opt/gitlab/gitlab-rails/etc/session_store.yml] mode changed to 640

      [32m- change mode from '' to '0640'[0m
      [32m- change owner from '' to 'root'[0m
      [32m- change group from '' to 'git'[0m
    * link[Link /opt/gitlab/embedded/service/gitlab-rails/config/session_store.yml to /var/opt/gitlab/gitlab-rails/etc/session_store.yml] action create[2025-07-12T20:44:11+03:00] INFO: link[Link /opt/gitlab/embedded/service/gitlab-rails/config/session_store.yml to /var/opt/gitlab/gitlab-rails/etc/session_store.yml] created

      [32m- create symlink at /opt/gitlab/embedded/service/gitlab-rails/config/session_store.yml to /var/opt/gitlab/gitlab-rails/etc/session_store.yml[0m
  
  * templatesymlink[Create a smtp_settings.rb and create a symlink to Rails root] action delete
    * file[/var/opt/gitlab/gitlab-rails/etc/smtp_settings.rb] action delete (up to date)
    * link[/opt/gitlab/embedded/service/gitlab-rails/config/initializers/smtp_settings.rb] action delete (up to date)
     (up to date)
  * templatesymlink[Create a gitlab.yml and create a symlink to Rails root] action create
    * template[/var/opt/gitlab/gitlab-rails/etc/gitlab.yml] action create[2025-07-12T20:44:11+03:00] INFO: template[/var/opt/gitlab/gitlab-rails/etc/gitlab.yml] created file /var/opt/gitlab/gitlab-rails/etc/gitlab.yml

      [32m- create new file /var/opt/gitlab/gitlab-rails/etc/gitlab.yml[0m[2025-07-12T20:44:11+03:00] INFO: template[/var/opt/gitlab/gitlab-rails/etc/gitlab.yml] updated file contents /var/opt/gitlab/gitlab-rails/etc/gitlab.yml

      [32m- update content in file /var/opt/gitlab/gitlab-rails/etc/gitlab.yml from none to 90049e[0m
      [32m- suppressed sensitive resource[0m[2025-07-12T20:44:11+03:00] INFO: template[/var/opt/gitlab/gitlab-rails/etc/gitlab.yml] owner changed to 0
[2025-07-12T20:44:11+03:00] INFO: template[/var/opt/gitlab/gitlab-rails/etc/gitlab.yml] group changed to 991
[2025-07-12T20:44:11+03:00] INFO: template[/var/opt/gitlab/gitlab-rails/etc/gitlab.yml] mode changed to 640

      [32m- change mode from '' to '0640'[0m
      [32m- change owner from '' to 'root'[0m
      [32m- change group from '' to 'git'[0m
    * link[Link /opt/gitlab/embedded/service/gitlab-rails/config/gitlab.yml to /var/opt/gitlab/gitlab-rails/etc/gitlab.yml] action create[2025-07-12T20:44:11+03:00] INFO: link[Link /opt/gitlab/embedded/service/gitlab-rails/config/gitlab.yml to /var/opt/gitlab/gitlab-rails/etc/gitlab.yml] created

      [32m- create symlink at /opt/gitlab/embedded/service/gitlab-rails/config/gitlab.yml to /var/opt/gitlab/gitlab-rails/etc/gitlab.yml[0m
  
  * templatesymlink[Create a gitlab_workhorse_secret and create a symlink to Rails root] action create
    * template[/var/opt/gitlab/gitlab-rails/etc/gitlab_workhorse_secret] action create[2025-07-12T20:44:11+03:00] INFO: template[/var/opt/gitlab/gitlab-rails/etc/gitlab_workhorse_secret] created file /var/opt/gitlab/gitlab-rails/etc/gitlab_workhorse_secret

      [32m- create new file /var/opt/gitlab/gitlab-rails/etc/gitlab_workhorse_secret[0m[2025-07-12T20:44:11+03:00] INFO: template[/var/opt/gitlab/gitlab-rails/etc/gitlab_workhorse_secret] updated file contents /var/opt/gitlab/gitlab-rails/etc/gitlab_workhorse_secret

      [32m- update content in file /var/opt/gitlab/gitlab-rails/etc/gitlab_workhorse_secret from none to b0c8ce[0m
      [32m- suppressed sensitive resource[0m[2025-07-12T20:44:11+03:00] INFO: template[/var/opt/gitlab/gitlab-rails/etc/gitlab_workhorse_secret] owner changed to 0
[2025-07-12T20:44:11+03:00] INFO: template[/var/opt/gitlab/gitlab-rails/etc/gitlab_workhorse_secret] group changed to 0
[2025-07-12T20:44:11+03:00] INFO: template[/var/opt/gitlab/gitlab-rails/etc/gitlab_workhorse_secret] mode changed to 644

      [32m- change mode from '' to '0644'[0m
      [32m- change owner from '' to 'root'[0m
      [32m- change group from '' to 'root'[0m
    * link[Link /opt/gitlab/embedded/service/gitlab-rails/.gitlab_workhorse_secret to /var/opt/gitlab/gitlab-rails/etc/gitlab_workhorse_secret] action create[2025-07-12T20:44:11+03:00] INFO: link[Link /opt/gitlab/embedded/service/gitlab-rails/.gitlab_workhorse_secret to /var/opt/gitlab/gitlab-rails/etc/gitlab_workhorse_secret] created

      [32m- create symlink at /opt/gitlab/embedded/service/gitlab-rails/.gitlab_workhorse_secret to /var/opt/gitlab/gitlab-rails/etc/gitlab_workhorse_secret[0m
  
  * templatesymlink[Create a gitlab_shell_secret and create a symlink to Rails root] action create
    * template[/var/opt/gitlab/gitlab-rails/etc/gitlab_shell_secret] action create[2025-07-12T20:44:11+03:00] INFO: template[/var/opt/gitlab/gitlab-rails/etc/gitlab_shell_secret] created file /var/opt/gitlab/gitlab-rails/etc/gitlab_shell_secret

      [32m- create new file /var/opt/gitlab/gitlab-rails/etc/gitlab_shell_secret[0m[2025-07-12T20:44:11+03:00] INFO: template[/var/opt/gitlab/gitlab-rails/etc/gitlab_shell_secret] updated file contents /var/opt/gitlab/gitlab-rails/etc/gitlab_shell_secret

      [32m- update content in file /var/opt/gitlab/gitlab-rails/etc/gitlab_shell_secret from none to ee9499[0m
      [32m- suppressed sensitive resource[0m[2025-07-12T20:44:11+03:00] INFO: template[/var/opt/gitlab/gitlab-rails/etc/gitlab_shell_secret] owner changed to 0
[2025-07-12T20:44:11+03:00] INFO: template[/var/opt/gitlab/gitlab-rails/etc/gitlab_shell_secret] group changed to 0
[2025-07-12T20:44:11+03:00] INFO: template[/var/opt/gitlab/gitlab-rails/etc/gitlab_shell_secret] mode changed to 644

      [32m- change mode from '' to '0644'[0m
      [32m- change owner from '' to 'root'[0m
      [32m- change group from '' to 'root'[0m
    * link[Link /opt/gitlab/embedded/service/gitlab-rails/.gitlab_shell_secret to /var/opt/gitlab/gitlab-rails/etc/gitlab_shell_secret] action create[2025-07-12T20:44:11+03:00] INFO: link[Link /opt/gitlab/embedded/service/gitlab-rails/.gitlab_shell_secret to /var/opt/gitlab/gitlab-rails/etc/gitlab_shell_secret] created

      [32m- create symlink at /opt/gitlab/embedded/service/gitlab-rails/.gitlab_shell_secret to /var/opt/gitlab/gitlab-rails/etc/gitlab_shell_secret[0m
  
  * templatesymlink[Create a gitlab_incoming_email_secret and create a symlink to Rails root] action create (skipped due to only_if)
  * templatesymlink[Create a gitlab_service_desk_email_secret and create a symlink to Rails root] action create (skipped due to only_if)
  * templatesymlink[Create a gitlab_pages_secret and create a symlink to Rails root] action create[2025-07-12T20:44:11+03:00] WARN: only_if block for templatesymlink[Create a gitlab_pages_secret and create a symlink to Rails root] returned a string, did you mean to run a command?

    * template[/var/opt/gitlab/gitlab-rails/etc/gitlab_pages_secret] action create[2025-07-12T20:44:11+03:00] INFO: template[/var/opt/gitlab/gitlab-rails/etc/gitlab_pages_secret] created file /var/opt/gitlab/gitlab-rails/etc/gitlab_pages_secret

      [32m- create new file /var/opt/gitlab/gitlab-rails/etc/gitlab_pages_secret[0m[2025-07-12T20:44:11+03:00] INFO: template[/var/opt/gitlab/gitlab-rails/etc/gitlab_pages_secret] updated file contents /var/opt/gitlab/gitlab-rails/etc/gitlab_pages_secret

      [32m- update content in file /var/opt/gitlab/gitlab-rails/etc/gitlab_pages_secret from none to 81a4c8[0m
      [32m- suppressed sensitive resource[0m[2025-07-12T20:44:11+03:00] INFO: template[/var/opt/gitlab/gitlab-rails/etc/gitlab_pages_secret] owner changed to 0
[2025-07-12T20:44:11+03:00] INFO: template[/var/opt/gitlab/gitlab-rails/etc/gitlab_pages_secret] group changed to 0
[2025-07-12T20:44:11+03:00] INFO: template[/var/opt/gitlab/gitlab-rails/etc/gitlab_pages_secret] mode changed to 644

      [32m- change mode from '' to '0644'[0m
      [32m- change owner from '' to 'root'[0m
      [32m- change group from '' to 'root'[0m
    * link[Link /opt/gitlab/embedded/service/gitlab-rails/.gitlab_pages_secret to /var/opt/gitlab/gitlab-rails/etc/gitlab_pages_secret] action create[2025-07-12T20:44:11+03:00] INFO: link[Link /opt/gitlab/embedded/service/gitlab-rails/.gitlab_pages_secret to /var/opt/gitlab/gitlab-rails/etc/gitlab_pages_secret] created

      [32m- create symlink at /opt/gitlab/embedded/service/gitlab-rails/.gitlab_pages_secret to /var/opt/gitlab/gitlab-rails/etc/gitlab_pages_secret[0m
  
  * templatesymlink[Create a gitlab_kas_secret and create a symlink to Rails root] action create[2025-07-12T20:44:11+03:00] WARN: only_if block for templatesymlink[Create a gitlab_kas_secret and create a symlink to Rails root] returned a string, did you mean to run a command?

    * template[/var/opt/gitlab/gitlab-rails/etc/gitlab_kas_secret] action create[2025-07-12T20:44:11+03:00] INFO: template[/var/opt/gitlab/gitlab-rails/etc/gitlab_kas_secret] created file /var/opt/gitlab/gitlab-rails/etc/gitlab_kas_secret

      [32m- create new file /var/opt/gitlab/gitlab-rails/etc/gitlab_kas_secret[0m[2025-07-12T20:44:11+03:00] INFO: template[/var/opt/gitlab/gitlab-rails/etc/gitlab_kas_secret] updated file contents /var/opt/gitlab/gitlab-rails/etc/gitlab_kas_secret

      [32m- update content in file /var/opt/gitlab/gitlab-rails/etc/gitlab_kas_secret from none to f59b6a[0m
      [32m- suppressed sensitive resource[0m[2025-07-12T20:44:11+03:00] INFO: template[/var/opt/gitlab/gitlab-rails/etc/gitlab_kas_secret] owner changed to 0
[2025-07-12T20:44:11+03:00] INFO: template[/var/opt/gitlab/gitlab-rails/etc/gitlab_kas_secret] group changed to 0
[2025-07-12T20:44:11+03:00] INFO: template[/var/opt/gitlab/gitlab-rails/etc/gitlab_kas_secret] mode changed to 644

      [32m- change mode from '' to '0644'[0m
      [32m- change owner from '' to 'root'[0m
      [32m- change group from '' to 'root'[0m
    * link[Link /opt/gitlab/embedded/service/gitlab-rails/.gitlab_kas_secret to /var/opt/gitlab/gitlab-rails/etc/gitlab_kas_secret] action create[2025-07-12T20:44:11+03:00] INFO: link[Link /opt/gitlab/embedded/service/gitlab-rails/.gitlab_kas_secret to /var/opt/gitlab/gitlab-rails/etc/gitlab_kas_secret] created

      [32m- create symlink at /opt/gitlab/embedded/service/gitlab-rails/.gitlab_kas_secret to /var/opt/gitlab/gitlab-rails/etc/gitlab_kas_secret[0m
  
  * link[/opt/gitlab/embedded/service/gitlab-rails/config/initializers/relative_url.rb] action delete (up to date)
  * file[/var/opt/gitlab/gitlab-rails/etc/relative_url.rb] action delete (up to date)
  * env_dir[/opt/gitlab/etc/gitlab-rails/env] action create
    * directory[/opt/gitlab/etc/gitlab-rails/env] action create[2025-07-12T20:44:11+03:00] INFO: directory[/opt/gitlab/etc/gitlab-rails/env] created directory /opt/gitlab/etc/gitlab-rails/env

      [32m- create new directory /opt/gitlab/etc/gitlab-rails/env[0m
    * file[/opt/gitlab/etc/gitlab-rails/env/HOME] action create[2025-07-12T20:44:11+03:00] INFO: file[/opt/gitlab/etc/gitlab-rails/env/HOME] created file /opt/gitlab/etc/gitlab-rails/env/HOME

      [32m- create new file /opt/gitlab/etc/gitlab-rails/env/HOME[0m[2025-07-12T20:44:11+03:00] INFO: file[/opt/gitlab/etc/gitlab-rails/env/HOME] updated file contents /opt/gitlab/etc/gitlab-rails/env/HOME

      [32m- update content in file /opt/gitlab/etc/gitlab-rails/env/HOME from none to 205bb9[0m
      [32m- suppressed sensitive resource[0m
    * file[/opt/gitlab/etc/gitlab-rails/env/RAILS_ENV] action create[2025-07-12T20:44:11+03:00] INFO: file[/opt/gitlab/etc/gitlab-rails/env/RAILS_ENV] created file /opt/gitlab/etc/gitlab-rails/env/RAILS_ENV

      [32m- create new file /opt/gitlab/etc/gitlab-rails/env/RAILS_ENV[0m[2025-07-12T20:44:11+03:00] INFO: file[/opt/gitlab/etc/gitlab-rails/env/RAILS_ENV] updated file contents /opt/gitlab/etc/gitlab-rails/env/RAILS_ENV

      [32m- update content in file /opt/gitlab/etc/gitlab-rails/env/RAILS_ENV from none to ab8e18[0m
      [32m- suppressed sensitive resource[0m
    * file[/opt/gitlab/etc/gitlab-rails/env/BUNDLE_GEMFILE] action create[2025-07-12T20:44:11+03:00] INFO: file[/opt/gitlab/etc/gitlab-rails/env/BUNDLE_GEMFILE] created file /opt/gitlab/etc/gitlab-rails/env/BUNDLE_GEMFILE

      [32m- create new file /opt/gitlab/etc/gitlab-rails/env/BUNDLE_GEMFILE[0m[2025-07-12T20:44:11+03:00] INFO: file[/opt/gitlab/etc/gitlab-rails/env/BUNDLE_GEMFILE] updated file contents /opt/gitlab/etc/gitlab-rails/env/BUNDLE_GEMFILE

      [32m- update content in file /opt/gitlab/etc/gitlab-rails/env/BUNDLE_GEMFILE from none to 28d586[0m
      [32m- suppressed sensitive resource[0m
    * file[/opt/gitlab/etc/gitlab-rails/env/PUMA_WORKER_MAX_MEMORY] action create[2025-07-12T20:44:11+03:00] INFO: file[/opt/gitlab/etc/gitlab-rails/env/PUMA_WORKER_MAX_MEMORY] created file /opt/gitlab/etc/gitlab-rails/env/PUMA_WORKER_MAX_MEMORY

      [32m- create new file /opt/gitlab/etc/gitlab-rails/env/PUMA_WORKER_MAX_MEMORY[0m[2025-07-12T20:44:11+03:00] INFO: file[/opt/gitlab/etc/gitlab-rails/env/PUMA_WORKER_MAX_MEMORY] updated file contents /opt/gitlab/etc/gitlab-rails/env/PUMA_WORKER_MAX_MEMORY

      [32m- update content in file /opt/gitlab/etc/gitlab-rails/env/PUMA_WORKER_MAX_MEMORY from none to e3b0c4[0m
      [32m- suppressed sensitive resource[0m
    * file[/opt/gitlab/etc/gitlab-rails/env/SIDEKIQ_MEMORY_KILLER_MAX_RSS] action create[2025-07-12T20:44:11+03:00] INFO: file[/opt/gitlab/etc/gitlab-rails/env/SIDEKIQ_MEMORY_KILLER_MAX_RSS] created file /opt/gitlab/etc/gitlab-rails/env/SIDEKIQ_MEMORY_KILLER_MAX_RSS

      [32m- create new file /opt/gitlab/etc/gitlab-rails/env/SIDEKIQ_MEMORY_KILLER_MAX_RSS[0m[2025-07-12T20:44:11+03:00] INFO: file[/opt/gitlab/etc/gitlab-rails/env/SIDEKIQ_MEMORY_KILLER_MAX_RSS] updated file contents /opt/gitlab/etc/gitlab-rails/env/SIDEKIQ_MEMORY_KILLER_MAX_RSS

      [32m- update content in file /opt/gitlab/etc/gitlab-rails/env/SIDEKIQ_MEMORY_KILLER_MAX_RSS from none to dd80d7[0m
      [32m- suppressed sensitive resource[0m
    * file[/opt/gitlab/etc/gitlab-rails/env/PATH] action create[2025-07-12T20:44:11+03:00] INFO: file[/opt/gitlab/etc/gitlab-rails/env/PATH] created file /opt/gitlab/etc/gitlab-rails/env/PATH

      [32m- create new file /opt/gitlab/etc/gitlab-rails/env/PATH[0m[2025-07-12T20:44:11+03:00] INFO: file[/opt/gitlab/etc/gitlab-rails/env/PATH] updated file contents /opt/gitlab/etc/gitlab-rails/env/PATH

      [32m- update content in file /opt/gitlab/etc/gitlab-rails/env/PATH from none to d5dc07[0m
      [32m- suppressed sensitive resource[0m
    * file[/opt/gitlab/etc/gitlab-rails/env/ICU_DATA] action create[2025-07-12T20:44:11+03:00] INFO: file[/opt/gitlab/etc/gitlab-rails/env/ICU_DATA] created file /opt/gitlab/etc/gitlab-rails/env/ICU_DATA

      [32m- create new file /opt/gitlab/etc/gitlab-rails/env/ICU_DATA[0m[2025-07-12T20:44:11+03:00] INFO: file[/opt/gitlab/etc/gitlab-rails/env/ICU_DATA] updated file contents /opt/gitlab/etc/gitlab-rails/env/ICU_DATA

      [32m- update content in file /opt/gitlab/etc/gitlab-rails/env/ICU_DATA from none to a04260[0m
      [32m- suppressed sensitive resource[0m
    * file[/opt/gitlab/etc/gitlab-rails/env/PYTHONPATH] action create[2025-07-12T20:44:11+03:00] INFO: file[/opt/gitlab/etc/gitlab-rails/env/PYTHONPATH] created file /opt/gitlab/etc/gitlab-rails/env/PYTHONPATH

      [32m- create new file /opt/gitlab/etc/gitlab-rails/env/PYTHONPATH[0m[2025-07-12T20:44:11+03:00] INFO: file[/opt/gitlab/etc/gitlab-rails/env/PYTHONPATH] updated file contents /opt/gitlab/etc/gitlab-rails/env/PYTHONPATH

      [32m- update content in file /opt/gitlab/etc/gitlab-rails/env/PYTHONPATH from none to 98c9f4[0m
      [32m- suppressed sensitive resource[0m
    * file[/opt/gitlab/etc/gitlab-rails/env/EXECJS_RUNTIME] action create[2025-07-12T20:44:11+03:00] INFO: file[/opt/gitlab/etc/gitlab-rails/env/EXECJS_RUNTIME] created file /opt/gitlab/etc/gitlab-rails/env/EXECJS_RUNTIME

      [32m- create new file /opt/gitlab/etc/gitlab-rails/env/EXECJS_RUNTIME[0m[2025-07-12T20:44:11+03:00] INFO: file[/opt/gitlab/etc/gitlab-rails/env/EXECJS_RUNTIME] updated file contents /opt/gitlab/etc/gitlab-rails/env/EXECJS_RUNTIME

      [32m- update content in file /opt/gitlab/etc/gitlab-rails/env/EXECJS_RUNTIME from none to 75081b[0m
      [32m- suppressed sensitive resource[0m
    * file[/opt/gitlab/etc/gitlab-rails/env/TZ] action create[2025-07-12T20:44:11+03:00] INFO: file[/opt/gitlab/etc/gitlab-rails/env/TZ] created file /opt/gitlab/etc/gitlab-rails/env/TZ

      [32m- create new file /opt/gitlab/etc/gitlab-rails/env/TZ[0m[2025-07-12T20:44:11+03:00] INFO: file[/opt/gitlab/etc/gitlab-rails/env/TZ] updated file contents /opt/gitlab/etc/gitlab-rails/env/TZ

      [32m- update content in file /opt/gitlab/etc/gitlab-rails/env/TZ from none to 983a95[0m
      [32m- suppressed sensitive resource[0m
    * file[/opt/gitlab/etc/gitlab-rails/env/SSL_CERT_DIR] action create[2025-07-12T20:44:11+03:00] INFO: file[/opt/gitlab/etc/gitlab-rails/env/SSL_CERT_DIR] created file /opt/gitlab/etc/gitlab-rails/env/SSL_CERT_DIR

      [32m- create new file /opt/gitlab/etc/gitlab-rails/env/SSL_CERT_DIR[0m[2025-07-12T20:44:11+03:00] INFO: file[/opt/gitlab/etc/gitlab-rails/env/SSL_CERT_DIR] updated file contents /opt/gitlab/etc/gitlab-rails/env/SSL_CERT_DIR

      [32m- update content in file /opt/gitlab/etc/gitlab-rails/env/SSL_CERT_DIR from none to 4f45cf[0m
      [32m- suppressed sensitive resource[0m
    * file[/opt/gitlab/etc/gitlab-rails/env/SSL_CERT_FILE] action create[2025-07-12T20:44:11+03:00] INFO: file[/opt/gitlab/etc/gitlab-rails/env/SSL_CERT_FILE] created file /opt/gitlab/etc/gitlab-rails/env/SSL_CERT_FILE

      [32m- create new file /opt/gitlab/etc/gitlab-rails/env/SSL_CERT_FILE[0m[2025-07-12T20:44:11+03:00] INFO: file[/opt/gitlab/etc/gitlab-rails/env/SSL_CERT_FILE] updated file contents /opt/gitlab/etc/gitlab-rails/env/SSL_CERT_FILE

      [32m- update content in file /opt/gitlab/etc/gitlab-rails/env/SSL_CERT_FILE from none to f7ce84[0m
      [32m- suppressed sensitive resource[0m
  
  * link[/opt/gitlab/embedded/service/gitlab-rails/tmp] action create[2025-07-12T20:44:11+03:00] INFO: link[/opt/gitlab/embedded/service/gitlab-rails/tmp] created

    [32m- create symlink at /opt/gitlab/embedded/service/gitlab-rails/tmp to /var/opt/gitlab/gitlab-rails/tmp[0m
  * link[/opt/gitlab/embedded/service/gitlab-rails/public/uploads] action create[2025-07-12T20:44:11+03:00] INFO: link[/opt/gitlab/embedded/service/gitlab-rails/public/uploads] created

    [32m- create symlink at /opt/gitlab/embedded/service/gitlab-rails/public/uploads to /var/opt/gitlab/gitlab-rails/uploads[0m
  * link[/opt/gitlab/embedded/service/gitlab-rails/log] action create[2025-07-12T20:44:11+03:00] INFO: link[/opt/gitlab/embedded/service/gitlab-rails/log] created

    [32m- create symlink at /opt/gitlab/embedded/service/gitlab-rails/log to /var/log/gitlab/gitlab-rails[0m
  * link[/var/log/gitlab/gitlab-rails/sidekiq.log] action delete (skipped due to only_if)
  * file[/opt/gitlab/embedded/service/gitlab-rails/db/structure.sql] action create[2025-07-12T20:44:11+03:00] INFO: file[/opt/gitlab/embedded/service/gitlab-rails/db/structure.sql] owner changed to 994

    [32m- change owner from 'root' to 'git'[0m
  * remote_file[/var/opt/gitlab/gitlab-rails/VERSION] action create[2025-07-12T20:44:11+03:00] INFO: remote_file[/var/opt/gitlab/gitlab-rails/VERSION] created file /var/opt/gitlab/gitlab-rails/VERSION

    [32m- create new file /var/opt/gitlab/gitlab-rails/VERSION[0m[2025-07-12T20:44:11+03:00] INFO: remote_file[/var/opt/gitlab/gitlab-rails/VERSION] updated file contents /var/opt/gitlab/gitlab-rails/VERSION

    [32m- update content in file /var/opt/gitlab/gitlab-rails/VERSION from none to c82bcb[0m
    [37m--- /var/opt/gitlab/gitlab-rails/VERSION	2025-07-12 20:44:11.773835988 +0300[0m
    [37m+++ /var/opt/gitlab/gitlab-rails/.chef-VERSION20250712-17810-qc1vp	2025-07-12 20:44:11.769835988 +0300[0m
    [37m@@ -1 +1,2 @@[0m
    [37m+18.1.2[0m
  * remote_file[/var/opt/gitlab/gitlab-rails/REVISION] action create[2025-07-12T20:44:11+03:00] INFO: remote_file[/var/opt/gitlab/gitlab-rails/REVISION] created file /var/opt/gitlab/gitlab-rails/REVISION

    [32m- create new file /var/opt/gitlab/gitlab-rails/REVISION[0m[2025-07-12T20:44:11+03:00] INFO: remote_file[/var/opt/gitlab/gitlab-rails/REVISION] updated file contents /var/opt/gitlab/gitlab-rails/REVISION

    [32m- update content in file /var/opt/gitlab/gitlab-rails/REVISION from none to cfbfa5[0m
    [37m--- /var/opt/gitlab/gitlab-rails/REVISION	2025-07-12 20:44:11.777835988 +0300[0m
    [37m+++ /var/opt/gitlab/gitlab-rails/.chef-REVISION20250712-17810-cwqbo8	2025-07-12 20:44:11.777835988 +0300[0m
    [37m@@ -1 +1,2 @@[0m
    [37m+98bf90e2827[0m
  * version_file[Create version file for Rails] action create
    * file[/var/opt/gitlab/gitlab-rails/RUBY_VERSION] action create[2025-07-12T20:44:11+03:00] INFO: file[/var/opt/gitlab/gitlab-rails/RUBY_VERSION] created file /var/opt/gitlab/gitlab-rails/RUBY_VERSION

      [32m- create new file /var/opt/gitlab/gitlab-rails/RUBY_VERSION[0m[2025-07-12T20:44:11+03:00] INFO: file[/var/opt/gitlab/gitlab-rails/RUBY_VERSION] updated file contents /var/opt/gitlab/gitlab-rails/RUBY_VERSION

      [32m- update content in file /var/opt/gitlab/gitlab-rails/RUBY_VERSION from none to a57ad3[0m
      [37m--- /var/opt/gitlab/gitlab-rails/RUBY_VERSION	2025-07-12 20:44:11.821835988 +0300[0m
      [37m+++ /var/opt/gitlab/gitlab-rails/.chef-RUBY_VERSION20250712-17810-miie5j	2025-07-12 20:44:11.817835988 +0300[0m
      [37m@@ -1 +1,2 @@[0m
      [37m+ruby 3.2.5 (2024-07-26 revision 31d0f1a2e7) [x86_64-linux][0m
  
  * execute[clear the gitlab-rails cache] action nothing (skipped due to action :nothing)
  * file[/var/opt/gitlab/gitlab-rails/config.ru] action delete (up to date)
Recipe: gitlab::selinux
  * bash[Set proper security context on ssh files for selinux] action nothing (skipped due to action :nothing)
Recipe: gitlab::add_trusted_certs
  * directory[/etc/gitlab/trusted-certs] action create[2025-07-12T20:44:11+03:00] INFO: directory[/etc/gitlab/trusted-certs] created directory /etc/gitlab/trusted-certs

    [32m- create new directory /etc/gitlab/trusted-certs[0m[2025-07-12T20:44:11+03:00] INFO: directory[/etc/gitlab/trusted-certs] mode changed to 755

    [32m- change mode from '' to '0755'[0m
  * directory[/opt/gitlab/embedded/ssl/certs] action create (up to date)
  * file[/opt/gitlab/embedded/ssl/certs/README] action create[2025-07-12T20:44:11+03:00] INFO: file[/opt/gitlab/embedded/ssl/certs/README] created file /opt/gitlab/embedded/ssl/certs/README

    [32m- create new file /opt/gitlab/embedded/ssl/certs/README[0m[2025-07-12T20:44:11+03:00] INFO: file[/opt/gitlab/embedded/ssl/certs/README] updated file contents /opt/gitlab/embedded/ssl/certs/README

    [32m- update content in file /opt/gitlab/embedded/ssl/certs/README from none to 623059[0m
    [37m--- /opt/gitlab/embedded/ssl/certs/README	2025-07-12 20:44:11.833835988 +0300[0m
    [37m+++ /opt/gitlab/embedded/ssl/certs/.chef-README20250712-17810-o6pf44	2025-07-12 20:44:11.833835988 +0300[0m
    [37m@@ -1,3 +1,6 @@[0m
    [37m+This directory is managed by omnibus-gitlab.[0m
    [37m+ Any file placed in this directory will be ignored[0m
    [37m+. Place certificates in /etc/gitlab/trusted-certs.[0m[2025-07-12T20:44:11+03:00] INFO: file[/opt/gitlab/embedded/ssl/certs/README] mode changed to 644

    [32m- change mode from '' to '0644'[0m
  * ruby_block[Move existing certs and link to /opt/gitlab/embedded/ssl/certs] action run

  * Moving existing certificates found in /opt/gitlab/embedded/ssl/certs

  * Symlinking existing certificates found in /etc/gitlab/trusted-certs
[2025-07-12T20:44:11+03:00] INFO: ruby_block[Move existing certs and link to /opt/gitlab/embedded/ssl/certs] called

    [32m- execute the ruby block Move existing certs and link to /opt/gitlab/embedded/ssl/certs[0m
Recipe: gitlab::default
  * service[create a temporary puma service] action nothing (skipped due to action :nothing)
  * service[create a temporary sidekiq service] action nothing (skipped due to action :nothing)
  * service[create a temporary mailroom service] action nothing (skipped due to action :nothing)
Recipe: package::runit_systemd
  * directory[/usr/lib/systemd/system] action create (up to date)
  * template[/usr/lib/systemd/system/gitlab-runsvdir.service] action create[2025-07-12T20:44:11+03:00] INFO: template[/usr/lib/systemd/system/gitlab-runsvdir.service] created file /usr/lib/systemd/system/gitlab-runsvdir.service

    [32m- create new file /usr/lib/systemd/system/gitlab-runsvdir.service[0m[2025-07-12T20:44:11+03:00] INFO: template[/usr/lib/systemd/system/gitlab-runsvdir.service] updated file contents /usr/lib/systemd/system/gitlab-runsvdir.service

    [32m- update content in file /usr/lib/systemd/system/gitlab-runsvdir.service from none to 907bbd[0m
    [37m--- /usr/lib/systemd/system/gitlab-runsvdir.service	2025-07-12 20:44:11.881835988 +0300[0m
    [37m+++ /usr/lib/systemd/system/.chef-gitlab-runsvdir20250712-17810-ubu5h5.service	2025-07-12 20:44:11.881835988 +0300[0m
    [37m@@ -1,13 +1,26 @@[0m
    [37m+[Unit][0m
    [37m+Description=GitLab Runit supervision process[0m
    [37m+After=multi-user.target[0m
    [37m+[0m
    [37m+[Service][0m
    [37m+Slice=gitlab.slice[0m
    [37m+Delegate=memory cpu[0m
    [37m+ExecStart=/opt/gitlab/embedded/bin/runsvdir-start[0m
    [37m+Restart=always[0m
    [37m+TasksMax=4915[0m
    [37m+[0m
    [37m+[Install][0m
    [37m+WantedBy=multi-user.target[0m[2025-07-12T20:44:11+03:00] INFO: template[/usr/lib/systemd/system/gitlab-runsvdir.service] mode changed to 644

    [32m- change mode from '' to '0644'[0m
[2025-07-12T20:44:11+03:00] INFO: template[/usr/lib/systemd/system/gitlab-runsvdir.service] sending run action to execute[systemctl daemon-reload] (immediate)
  * execute[systemctl daemon-reload] action run[2025-07-12T20:44:12+03:00] INFO: execute[systemctl daemon-reload] ran successfully

    [32m- execute systemctl daemon-reload[0m
[2025-07-12T20:44:12+03:00] INFO: template[/usr/lib/systemd/system/gitlab-runsvdir.service] sending run action to execute[systemctl enable gitlab-runsvdir] (immediate)
  * execute[systemctl enable gitlab-runsvdir] action run
    [execute] Created symlink /etc/systemd/system/multi-user.target.wants/gitlab-runsvdir.service â†’ /lib/systemd/system/gitlab-runsvdir.service.
[2025-07-12T20:44:12+03:00] INFO: execute[systemctl enable gitlab-runsvdir] ran successfully
    [32m- execute systemctl enable gitlab-runsvdir[0m
[2025-07-12T20:44:12+03:00] INFO: template[/usr/lib/systemd/system/gitlab-runsvdir.service] sending run action to execute[systemctl start gitlab-runsvdir] (immediate)
  * execute[systemctl start gitlab-runsvdir] action run[2025-07-12T20:44:12+03:00] INFO: execute[systemctl start gitlab-runsvdir] ran successfully

    [32m- execute systemctl start gitlab-runsvdir[0m
  * file[/etc/systemd/system/default.target.wants/gitlab-runsvdir.service] action delete (up to date)
  * file[/etc/systemd/system/basic.target.wants/gitlab-runsvdir.service] action delete (up to date)
  * execute[systemctl daemon-reload] action nothing (skipped due to action :nothing)
  * execute[systemctl enable gitlab-runsvdir] action nothing (skipped due to action :nothing)
  * execute[systemctl start gitlab-runsvdir] action nothing (skipped due to action :nothing)
Recipe: gitlab::gitlab-shell
  * storage_directory[/var/opt/gitlab/.ssh] action create
    * ruby_block[directory resource: /var/opt/gitlab/.ssh] action run[2025-07-12T20:44:13+03:00] INFO: ruby_block[directory resource: /var/opt/gitlab/.ssh] called

      [32m- execute the ruby block directory resource: /var/opt/gitlab/.ssh[0m
  
  * directory[/var/opt/gitlab/gitlab-shell] action create[2025-07-12T20:44:13+03:00] INFO: directory[/var/opt/gitlab/gitlab-shell] created directory /var/opt/gitlab/gitlab-shell

    [32m- create new directory /var/opt/gitlab/gitlab-shell[0m[2025-07-12T20:44:13+03:00] INFO: directory[/var/opt/gitlab/gitlab-shell] owner changed to 994
[2025-07-12T20:44:13+03:00] INFO: directory[/var/opt/gitlab/gitlab-shell] mode changed to 700

    [32m- change mode from '' to '0700'[0m
    [32m- change owner from '' to 'git'[0m
  * directory[/var/log/gitlab/gitlab-shell] action create[2025-07-12T20:44:13+03:00] INFO: directory[/var/log/gitlab/gitlab-shell] created directory /var/log/gitlab/gitlab-shell

    [32m- create new directory /var/log/gitlab/gitlab-shell[0m[2025-07-12T20:44:13+03:00] INFO: directory[/var/log/gitlab/gitlab-shell] owner changed to 994
[2025-07-12T20:44:13+03:00] INFO: directory[/var/log/gitlab/gitlab-shell] mode changed to 700

    [32m- change mode from '' to '0700'[0m
    [32m- change owner from '' to 'git'[0m
  * bash[generate gitlab-sshd host keys] action run (skipped due to only_if)
  * templatesymlink[Create a config.yml and create a symlink to Rails root] action create
    * template[/var/opt/gitlab/gitlab-shell/config.yml] action create[2025-07-12T20:44:13+03:00] INFO: template[/var/opt/gitlab/gitlab-shell/config.yml] created file /var/opt/gitlab/gitlab-shell/config.yml

      [32m- create new file /var/opt/gitlab/gitlab-shell/config.yml[0m[2025-07-12T20:44:13+03:00] INFO: template[/var/opt/gitlab/gitlab-shell/config.yml] updated file contents /var/opt/gitlab/gitlab-shell/config.yml

      [32m- update content in file /var/opt/gitlab/gitlab-shell/config.yml from none to 08d6f5[0m
      [32m- suppressed sensitive resource[0m[2025-07-12T20:44:13+03:00] INFO: template[/var/opt/gitlab/gitlab-shell/config.yml] owner changed to 0
[2025-07-12T20:44:13+03:00] INFO: template[/var/opt/gitlab/gitlab-shell/config.yml] group changed to 991
[2025-07-12T20:44:13+03:00] INFO: template[/var/opt/gitlab/gitlab-shell/config.yml] mode changed to 640

      [32m- change mode from '' to '0640'[0m
      [32m- change owner from '' to 'root'[0m
      [32m- change group from '' to 'git'[0m
    * link[Link /opt/gitlab/embedded/service/gitlab-shell/config.yml to /var/opt/gitlab/gitlab-shell/config.yml] action create[2025-07-12T20:44:13+03:00] INFO: link[Link /opt/gitlab/embedded/service/gitlab-shell/config.yml to /var/opt/gitlab/gitlab-shell/config.yml] created

      [32m- create symlink at /opt/gitlab/embedded/service/gitlab-shell/config.yml to /var/opt/gitlab/gitlab-shell/config.yml[0m
  
  * link[/opt/gitlab/embedded/service/gitlab-shell/.gitlab_shell_secret] action create[2025-07-12T20:44:13+03:00] INFO: link[/opt/gitlab/embedded/service/gitlab-shell/.gitlab_shell_secret] created

    [32m- create symlink at /opt/gitlab/embedded/service/gitlab-shell/.gitlab_shell_secret to /opt/gitlab/embedded/service/gitlab-rails/.gitlab_shell_secret[0m
  * file[/var/opt/gitlab/.ssh/authorized_keys] action create_if_missing[2025-07-12T20:44:13+03:00] INFO: file[/var/opt/gitlab/.ssh/authorized_keys] created file /var/opt/gitlab/.ssh/authorized_keys

    [32m- create new file /var/opt/gitlab/.ssh/authorized_keys[0m[2025-07-12T20:44:13+03:00] INFO: file[/var/opt/gitlab/.ssh/authorized_keys] owner changed to 994
[2025-07-12T20:44:13+03:00] INFO: file[/var/opt/gitlab/.ssh/authorized_keys] group changed to 991
[2025-07-12T20:44:13+03:00] INFO: file[/var/opt/gitlab/.ssh/authorized_keys] mode changed to 600

    [32m- change mode from '' to '0600'[0m
    [32m- change owner from '' to 'git'[0m
    [32m- change group from '' to 'git'[0m
  * env_dir[/opt/gitlab/etc/gitlab-sshd/env] action nothing (skipped due to action :nothing)
  * service[gitlab-sshd] action nothing (skipped due to action :nothing)
  * runit_service[gitlab-sshd] action disable
    * ruby_block[disable gitlab-sshd] action run (skipped due to only_if)
     (up to date)
Recipe: package::sysctl
  * execute[reload all sysctl conf] action nothing (skipped due to action :nothing)
Recipe: logrotate::folders_and_configs
  * directory[/var/opt/gitlab/logrotate] action create[2025-07-12T20:44:13+03:00] INFO: directory[/var/opt/gitlab/logrotate] created directory /var/opt/gitlab/logrotate

    [32m- create new directory /var/opt/gitlab/logrotate[0m[2025-07-12T20:44:13+03:00] INFO: directory[/var/opt/gitlab/logrotate] mode changed to 700

    [32m- change mode from '' to '0700'[0m
  * directory[/var/opt/gitlab/logrotate/logrotate.d] action create[2025-07-12T20:44:13+03:00] INFO: directory[/var/opt/gitlab/logrotate/logrotate.d] created directory /var/opt/gitlab/logrotate/logrotate.d

    [32m- create new directory /var/opt/gitlab/logrotate/logrotate.d[0m[2025-07-12T20:44:13+03:00] INFO: directory[/var/opt/gitlab/logrotate/logrotate.d] mode changed to 700

    [32m- change mode from '' to '0700'[0m
  * directory[/var/log/gitlab/logrotate] action create[2025-07-12T20:44:13+03:00] INFO: directory[/var/log/gitlab/logrotate] created directory /var/log/gitlab/logrotate

    [32m- create new directory /var/log/gitlab/logrotate[0m[2025-07-12T20:44:13+03:00] INFO: directory[/var/log/gitlab/logrotate] owner changed to 0
[2025-07-12T20:44:13+03:00] INFO: directory[/var/log/gitlab/logrotate] mode changed to 700

    [32m- change mode from '' to '0700'[0m
    [32m- change owner from '' to 'root'[0m
  * template[/var/opt/gitlab/logrotate/logrotate.conf] action create[2025-07-12T20:44:13+03:00] INFO: template[/var/opt/gitlab/logrotate/logrotate.conf] created file /var/opt/gitlab/logrotate/logrotate.conf

    [32m- create new file /var/opt/gitlab/logrotate/logrotate.conf[0m[2025-07-12T20:44:13+03:00] INFO: template[/var/opt/gitlab/logrotate/logrotate.conf] updated file contents /var/opt/gitlab/logrotate/logrotate.conf

    [32m- update content in file /var/opt/gitlab/logrotate/logrotate.conf from none to c1c320[0m
    [37m--- /var/opt/gitlab/logrotate/logrotate.conf	2025-07-12 20:44:13.281835988 +0300[0m
    [37m+++ /var/opt/gitlab/logrotate/.chef-logrotate20250712-17810-japroc.conf	2025-07-12 20:44:13.281835988 +0300[0m
    [37m@@ -1,12 +1,24 @@[0m
    [37m+# Generated by 'gitlab-ctl reconfigure'.[0m
    [37m+# Modifications will be overwritten![0m
    [37m+[0m
    [37m+include /var/opt/gitlab/logrotate/logrotate.d/nginx[0m
    [37m+include /var/opt/gitlab/logrotate/logrotate.d/puma[0m
    [37m+include /var/opt/gitlab/logrotate/logrotate.d/gitlab-rails[0m
    [37m+include /var/opt/gitlab/logrotate/logrotate.d/gitlab-shell[0m
    [37m+include /var/opt/gitlab/logrotate/logrotate.d/gitlab-workhorse[0m
    [37m+include /var/opt/gitlab/logrotate/logrotate.d/gitlab-pages[0m
    [37m+include /var/opt/gitlab/logrotate/logrotate.d/gitlab-kas[0m
    [37m+include /var/opt/gitlab/logrotate/logrotate.d/gitaly[0m
    [37m+include /var/opt/gitlab/logrotate/logrotate.d/mailroom[0m[2025-07-12T20:44:13+03:00] INFO: template[/var/opt/gitlab/logrotate/logrotate.conf] mode changed to 644

    [32m- change mode from '' to '0644'[0m
  * template[/var/opt/gitlab/logrotate/logrotate.d/nginx] action create[2025-07-12T20:44:13+03:00] INFO: template[/var/opt/gitlab/logrotate/logrotate.d/nginx] created file /var/opt/gitlab/logrotate/logrotate.d/nginx

    [32m- create new file /var/opt/gitlab/logrotate/logrotate.d/nginx[0m[2025-07-12T20:44:13+03:00] INFO: template[/var/opt/gitlab/logrotate/logrotate.d/nginx] updated file contents /var/opt/gitlab/logrotate/logrotate.d/nginx

    [32m- update content in file /var/opt/gitlab/logrotate/logrotate.d/nginx from none to e17e19[0m
    [37m--- /var/opt/gitlab/logrotate/logrotate.d/nginx	2025-07-12 20:44:13.297835988 +0300[0m
    [37m+++ /var/opt/gitlab/logrotate/logrotate.d/.chef-nginx20250712-17810-qxof80	2025-07-12 20:44:13.297835988 +0300[0m
    [37m@@ -1,17 +1,34 @@[0m
    [37m+# Generated by gitlab-ctl reconfigure[0m
    [37m+# Modifications will be overwritten![0m
    [37m+[0m
    [37m+/var/log/gitlab/nginx/*.log {[0m
    [37m+  su root root[0m
    [37m+  daily[0m
    [37m+  [0m
    [37m+  [0m
    [37m+  rotate 30[0m
    [37m+  compress[0m
    [37m+  copytruncate[0m
    [37m+  missingok[0m
    [37m+  notifempty[0m
    [37m+  postrotate[0m
    [37m+    [0m
    [37m+  endscript[0m
    [37m+}[0m
  * template[/var/opt/gitlab/logrotate/logrotate.d/puma] action create[2025-07-12T20:44:13+03:00] INFO: template[/var/opt/gitlab/logrotate/logrotate.d/puma] created file /var/opt/gitlab/logrotate/logrotate.d/puma

    [32m- create new file /var/opt/gitlab/logrotate/logrotate.d/puma[0m[2025-07-12T20:44:13+03:00] INFO: template[/var/opt/gitlab/logrotate/logrotate.d/puma] updated file contents /var/opt/gitlab/logrotate/logrotate.d/puma

    [32m- update content in file /var/opt/gitlab/logrotate/logrotate.d/puma from none to 44ad27[0m
    [37m--- /var/opt/gitlab/logrotate/logrotate.d/puma	2025-07-12 20:44:13.305835988 +0300[0m
    [37m+++ /var/opt/gitlab/logrotate/logrotate.d/.chef-puma20250712-17810-dkjbcx	2025-07-12 20:44:13.305835988 +0300[0m
    [37m@@ -1,17 +1,34 @@[0m
    [37m+# Generated by gitlab-ctl reconfigure[0m
    [37m+# Modifications will be overwritten![0m
    [37m+[0m
    [37m+/var/log/gitlab/puma/*.log {[0m
    [37m+  su git git[0m
    [37m+  daily[0m
    [37m+  [0m
    [37m+  [0m
    [37m+  rotate 30[0m
    [37m+  compress[0m
    [37m+  copytruncate[0m
    [37m+  missingok[0m
    [37m+  notifempty[0m
    [37m+  postrotate[0m
    [37m+    [0m
    [37m+  endscript[0m
    [37m+}[0m
  * template[/var/opt/gitlab/logrotate/logrotate.d/gitlab-rails] action create[2025-07-12T20:44:13+03:00] INFO: template[/var/opt/gitlab/logrotate/logrotate.d/gitlab-rails] created file /var/opt/gitlab/logrotate/logrotate.d/gitlab-rails

    [32m- create new file /var/opt/gitlab/logrotate/logrotate.d/gitlab-rails[0m[2025-07-12T20:44:13+03:00] INFO: template[/var/opt/gitlab/logrotate/logrotate.d/gitlab-rails] updated file contents /var/opt/gitlab/logrotate/logrotate.d/gitlab-rails

    [32m- update content in file /var/opt/gitlab/logrotate/logrotate.d/gitlab-rails from none to 26254a[0m
    [37m--- /var/opt/gitlab/logrotate/logrotate.d/gitlab-rails	2025-07-12 20:44:13.317835988 +0300[0m
    [37m+++ /var/opt/gitlab/logrotate/logrotate.d/.chef-gitlab-rails20250712-17810-5q89in	2025-07-12 20:44:13.317835988 +0300[0m
    [37m@@ -1,17 +1,34 @@[0m
    [37m+# Generated by gitlab-ctl reconfigure[0m
    [37m+# Modifications will be overwritten![0m
    [37m+[0m
    [37m+/var/log/gitlab/gitlab-rails/*.log {[0m
    [37m+  su git git[0m
    [37m+  daily[0m
    [37m+  [0m
    [37m+  [0m
    [37m+  rotate 30[0m
    [37m+  compress[0m
    [37m+  copytruncate[0m
    [37m+  missingok[0m
    [37m+  notifempty[0m
    [37m+  postrotate[0m
    [37m+    [0m
    [37m+  endscript[0m
    [37m+}[0m
  * template[/var/opt/gitlab/logrotate/logrotate.d/gitlab-shell] action create[2025-07-12T20:44:13+03:00] INFO: template[/var/opt/gitlab/logrotate/logrotate.d/gitlab-shell] created file /var/opt/gitlab/logrotate/logrotate.d/gitlab-shell

    [32m- create new file /var/opt/gitlab/logrotate/logrotate.d/gitlab-shell[0m[2025-07-12T20:44:13+03:00] INFO: template[/var/opt/gitlab/logrotate/logrotate.d/gitlab-shell] updated file contents /var/opt/gitlab/logrotate/logrotate.d/gitlab-shell

    [32m- update content in file /var/opt/gitlab/logrotate/logrotate.d/gitlab-shell from none to 859f56[0m
    [37m--- /var/opt/gitlab/logrotate/logrotate.d/gitlab-shell	2025-07-12 20:44:13.325835988 +0300[0m
    [37m+++ /var/opt/gitlab/logrotate/logrotate.d/.chef-gitlab-shell20250712-17810-x6ez16	2025-07-12 20:44:13.325835988 +0300[0m
    [37m@@ -1,17 +1,34 @@[0m
    [37m+# Generated by gitlab-ctl reconfigure[0m
    [37m+# Modifications will be overwritten![0m
    [37m+[0m
    [37m+/var/log/gitlab/gitlab-shell/*.log {[0m
    [37m+  su git git[0m
    [37m+  daily[0m
    [37m+  [0m
    [37m+  [0m
    [37m+  rotate 30[0m
    [37m+  compress[0m
    [37m+  copytruncate[0m
    [37m+  missingok[0m
    [37m+  notifempty[0m
    [37m+  postrotate[0m
    [37m+    [0m
    [37m+  endscript[0m
    [37m+}[0m
  * template[/var/opt/gitlab/logrotate/logrotate.d/gitlab-workhorse] action create[2025-07-12T20:44:13+03:00] INFO: template[/var/opt/gitlab/logrotate/logrotate.d/gitlab-workhorse] created file /var/opt/gitlab/logrotate/logrotate.d/gitlab-workhorse

    [32m- create new file /var/opt/gitlab/logrotate/logrotate.d/gitlab-workhorse[0m[2025-07-12T20:44:13+03:00] INFO: template[/var/opt/gitlab/logrotate/logrotate.d/gitlab-workhorse] updated file contents /var/opt/gitlab/logrotate/logrotate.d/gitlab-workhorse

    [32m- update content in file /var/opt/gitlab/logrotate/logrotate.d/gitlab-workhorse from none to 3453f6[0m
    [37m--- /var/opt/gitlab/logrotate/logrotate.d/gitlab-workhorse	2025-07-12 20:44:13.329835988 +0300[0m
    [37m+++ /var/opt/gitlab/logrotate/logrotate.d/.chef-gitlab-workhorse20250712-17810-y7j4m7	2025-07-12 20:44:13.329835988 +0300[0m
    [37m@@ -1,17 +1,34 @@[0m
    [37m+# Generated by gitlab-ctl reconfigure[0m
    [37m+# Modifications will be overwritten![0m
    [37m+[0m
    [37m+/var/log/gitlab/gitlab-workhorse/*.log {[0m
    [37m+  su git git[0m
    [37m+  daily[0m
    [37m+  [0m
    [37m+  [0m
    [37m+  rotate 30[0m
    [37m+  compress[0m
    [37m+  copytruncate[0m
    [37m+  missingok[0m
    [37m+  notifempty[0m
    [37m+  postrotate[0m
    [37m+    [0m
    [37m+  endscript[0m
    [37m+}[0m
  * template[/var/opt/gitlab/logrotate/logrotate.d/gitlab-pages] action create[2025-07-12T20:44:13+03:00] INFO: template[/var/opt/gitlab/logrotate/logrotate.d/gitlab-pages] created file /var/opt/gitlab/logrotate/logrotate.d/gitlab-pages

    [32m- create new file /var/opt/gitlab/logrotate/logrotate.d/gitlab-pages[0m[2025-07-12T20:44:13+03:00] INFO: template[/var/opt/gitlab/logrotate/logrotate.d/gitlab-pages] updated file contents /var/opt/gitlab/logrotate/logrotate.d/gitlab-pages

    [32m- update content in file /var/opt/gitlab/logrotate/logrotate.d/gitlab-pages from none to 3c118a[0m
    [37m--- /var/opt/gitlab/logrotate/logrotate.d/gitlab-pages	2025-07-12 20:44:13.341835988 +0300[0m
    [37m+++ /var/opt/gitlab/logrotate/logrotate.d/.chef-gitlab-pages20250712-17810-lv5pri	2025-07-12 20:44:13.341835988 +0300[0m
    [37m@@ -1,17 +1,34 @@[0m
    [37m+# Generated by gitlab-ctl reconfigure[0m
    [37m+# Modifications will be overwritten![0m
    [37m+[0m
    [37m+/var/log/gitlab/gitlab-pages/*.log {[0m
    [37m+  su git git[0m
    [37m+  daily[0m
    [37m+  [0m
    [37m+  [0m
    [37m+  rotate 30[0m
    [37m+  compress[0m
    [37m+  copytruncate[0m
    [37m+  missingok[0m
    [37m+  notifempty[0m
    [37m+  postrotate[0m
    [37m+    [0m
    [37m+  endscript[0m
    [37m+}[0m
  * template[/var/opt/gitlab/logrotate/logrotate.d/gitlab-kas] action create[2025-07-12T20:44:13+03:00] INFO: template[/var/opt/gitlab/logrotate/logrotate.d/gitlab-kas] created file /var/opt/gitlab/logrotate/logrotate.d/gitlab-kas

    [32m- create new file /var/opt/gitlab/logrotate/logrotate.d/gitlab-kas[0m[2025-07-12T20:44:13+03:00] INFO: template[/var/opt/gitlab/logrotate/logrotate.d/gitlab-kas] updated file contents /var/opt/gitlab/logrotate/logrotate.d/gitlab-kas

    [32m- update content in file /var/opt/gitlab/logrotate/logrotate.d/gitlab-kas from none to 0ba4f0[0m
    [37m--- /var/opt/gitlab/logrotate/logrotate.d/gitlab-kas	2025-07-12 20:44:13.349835988 +0300[0m
    [37m+++ /var/opt/gitlab/logrotate/logrotate.d/.chef-gitlab-kas20250712-17810-dpu2hj	2025-07-12 20:44:13.349835988 +0300[0m
    [37m@@ -1,17 +1,34 @@[0m
    [37m+# Generated by gitlab-ctl reconfigure[0m
    [37m+# Modifications will be overwritten![0m
    [37m+[0m
    [37m+/var/log/gitlab/gitlab-kas/*.log {[0m
    [37m+  su git git[0m
    [37m+  daily[0m
    [37m+  [0m
    [37m+  [0m
    [37m+  rotate 30[0m
    [37m+  compress[0m
    [37m+  copytruncate[0m
    [37m+  missingok[0m
    [37m+  notifempty[0m
    [37m+  postrotate[0m
    [37m+    [0m
    [37m+  endscript[0m
    [37m+}[0m
  * template[/var/opt/gitlab/logrotate/logrotate.d/gitaly] action create[2025-07-12T20:44:13+03:00] INFO: template[/var/opt/gitlab/logrotate/logrotate.d/gitaly] created file /var/opt/gitlab/logrotate/logrotate.d/gitaly

    [32m- create new file /var/opt/gitlab/logrotate/logrotate.d/gitaly[0m[2025-07-12T20:44:13+03:00] INFO: template[/var/opt/gitlab/logrotate/logrotate.d/gitaly] updated file contents /var/opt/gitlab/logrotate/logrotate.d/gitaly

    [32m- update content in file /var/opt/gitlab/logrotate/logrotate.d/gitaly from none to 02bda7[0m
    [37m--- /var/opt/gitlab/logrotate/logrotate.d/gitaly	2025-07-12 20:44:13.357835988 +0300[0m
    [37m+++ /var/opt/gitlab/logrotate/logrotate.d/.chef-gitaly20250712-17810-h9fivp	2025-07-12 20:44:13.357835988 +0300[0m
    [37m@@ -1,17 +1,34 @@[0m
    [37m+# Generated by gitlab-ctl reconfigure[0m
    [37m+# Modifications will be overwritten![0m
    [37m+[0m
    [37m+/var/log/gitlab/gitaly/*.log {[0m
    [37m+  su git git[0m
    [37m+  daily[0m
    [37m+  [0m
    [37m+  [0m
    [37m+  rotate 30[0m
    [37m+  compress[0m
    [37m+  copytruncate[0m
    [37m+  missingok[0m
    [37m+  notifempty[0m
    [37m+  postrotate[0m
    [37m+    [0m
    [37m+  endscript[0m
    [37m+}[0m
  * template[/var/opt/gitlab/logrotate/logrotate.d/mailroom] action create[2025-07-12T20:44:13+03:00] INFO: template[/var/opt/gitlab/logrotate/logrotate.d/mailroom] created file /var/opt/gitlab/logrotate/logrotate.d/mailroom

    [32m- create new file /var/opt/gitlab/logrotate/logrotate.d/mailroom[0m[2025-07-12T20:44:13+03:00] INFO: template[/var/opt/gitlab/logrotate/logrotate.d/mailroom] updated file contents /var/opt/gitlab/logrotate/logrotate.d/mailroom

    [32m- update content in file /var/opt/gitlab/logrotate/logrotate.d/mailroom from none to 8fcea3[0m
    [37m--- /var/opt/gitlab/logrotate/logrotate.d/mailroom	2025-07-12 20:44:13.361835988 +0300[0m
    [37m+++ /var/opt/gitlab/logrotate/logrotate.d/.chef-mailroom20250712-17810-rqb79a	2025-07-12 20:44:13.361835988 +0300[0m
    [37m@@ -1,17 +1,34 @@[0m
    [37m+# Generated by gitlab-ctl reconfigure[0m
    [37m+# Modifications will be overwritten![0m
    [37m+[0m
    [37m+/var/log/gitlab/mailroom/*.log {[0m
    [37m+  su git git[0m
    [37m+  daily[0m
    [37m+  [0m
    [37m+  [0m
    [37m+  rotate 30[0m
    [37m+  compress[0m
    [37m+  copytruncate[0m
    [37m+  missingok[0m
    [37m+  notifempty[0m
    [37m+  postrotate[0m
    [37m+    [0m
    [37m+  endscript[0m
    [37m+}[0m
Recipe: logrotate::enable
  * service[logrotate] action nothing (skipped due to action :nothing)
  * runit_service[logrotate] action enable
    * ruby_block[restart_service] action nothing (skipped due to action :nothing)
    * ruby_block[restart_log_service] action nothing (skipped due to action :nothing)
    * ruby_block[reload_log_service] action nothing (skipped due to action :nothing)
    * directory[/opt/gitlab/sv/logrotate] action create[2025-07-12T20:44:13+03:00] INFO: directory[/opt/gitlab/sv/logrotate] created directory /opt/gitlab/sv/logrotate

      [32m- create new directory /opt/gitlab/sv/logrotate[0m[2025-07-12T20:44:13+03:00] INFO: directory[/opt/gitlab/sv/logrotate] owner changed to 0
[2025-07-12T20:44:13+03:00] INFO: directory[/opt/gitlab/sv/logrotate] group changed to 0
[2025-07-12T20:44:13+03:00] INFO: directory[/opt/gitlab/sv/logrotate] mode changed to 755

      [32m- change mode from '' to '0755'[0m
      [32m- change owner from '' to 'root'[0m
      [32m- change group from '' to 'root'[0m
    * template[/opt/gitlab/sv/logrotate/run] action create[2025-07-12T20:44:13+03:00] INFO: template[/opt/gitlab/sv/logrotate/run] created file /opt/gitlab/sv/logrotate/run

      [32m- create new file /opt/gitlab/sv/logrotate/run[0m[2025-07-12T20:44:13+03:00] INFO: template[/opt/gitlab/sv/logrotate/run] updated file contents /opt/gitlab/sv/logrotate/run

      [32m- update content in file /opt/gitlab/sv/logrotate/run from none to 07f1b6[0m
      [37m--- /opt/gitlab/sv/logrotate/run	2025-07-12 20:44:13.385835988 +0300[0m
      [37m+++ /opt/gitlab/sv/logrotate/.chef-run20250712-17810-m74tkc	2025-07-12 20:44:13.381835988 +0300[0m
      [37m@@ -1,10 +1,20 @@[0m
      [37m+#!/bin/sh[0m
      [37m+exec 2>&1[0m
      [37m+[0m
      [37m+cd /var/opt/gitlab/logrotate[0m
      [37m+[0m
      [37m+exec /opt/gitlab/embedded/bin/chpst -P /usr/bin/env \[0m
      [37m+  dir=/var/opt/gitlab/logrotate \[0m
      [37m+  pre_sleep=600 \[0m
      [37m+  post_sleep=3000 \[0m
      [37m+  /opt/gitlab/embedded/bin/gitlab-logrotate-wrapper[0m[2025-07-12T20:44:13+03:00] INFO: template[/opt/gitlab/sv/logrotate/run] owner changed to 0
[2025-07-12T20:44:13+03:00] INFO: template[/opt/gitlab/sv/logrotate/run] group changed to 0
[2025-07-12T20:44:13+03:00] INFO: template[/opt/gitlab/sv/logrotate/run] mode changed to 755

      [32m- change mode from '' to '0755'[0m
      [32m- change owner from '' to 'root'[0m
      [32m- change group from '' to 'root'[0m
    * directory[/opt/gitlab/sv/logrotate/log] action create[2025-07-12T20:44:13+03:00] INFO: directory[/opt/gitlab/sv/logrotate/log] created directory /opt/gitlab/sv/logrotate/log

      [32m- create new directory /opt/gitlab/sv/logrotate/log[0m[2025-07-12T20:44:13+03:00] INFO: directory[/opt/gitlab/sv/logrotate/log] owner changed to 0
[2025-07-12T20:44:13+03:00] INFO: directory[/opt/gitlab/sv/logrotate/log] group changed to 0
[2025-07-12T20:44:13+03:00] INFO: directory[/opt/gitlab/sv/logrotate/log] mode changed to 755

      [32m- change mode from '' to '0755'[0m
      [32m- change owner from '' to 'root'[0m
      [32m- change group from '' to 'root'[0m
    * directory[/opt/gitlab/sv/logrotate/log/main] action create[2025-07-12T20:44:13+03:00] INFO: directory[/opt/gitlab/sv/logrotate/log/main] created directory /opt/gitlab/sv/logrotate/log/main

      [32m- create new directory /opt/gitlab/sv/logrotate/log/main[0m[2025-07-12T20:44:13+03:00] INFO: directory[/opt/gitlab/sv/logrotate/log/main] owner changed to 0
[2025-07-12T20:44:13+03:00] INFO: directory[/opt/gitlab/sv/logrotate/log/main] group changed to 0
[2025-07-12T20:44:13+03:00] INFO: directory[/opt/gitlab/sv/logrotate/log/main] mode changed to 755

      [32m- change mode from '' to '0755'[0m
      [32m- change owner from '' to 'root'[0m
      [32m- change group from '' to 'root'[0m
    * template[/opt/gitlab/sv/logrotate/log/config] action create[2025-07-12T20:44:13+03:00] INFO: template[/opt/gitlab/sv/logrotate/log/config] created file /opt/gitlab/sv/logrotate/log/config

      [32m- create new file /opt/gitlab/sv/logrotate/log/config[0m[2025-07-12T20:44:13+03:00] INFO: template[/opt/gitlab/sv/logrotate/log/config] updated file contents /opt/gitlab/sv/logrotate/log/config

      [32m- update content in file /opt/gitlab/sv/logrotate/log/config from none to 623c00[0m
      [37m--- /opt/gitlab/sv/logrotate/log/config	2025-07-12 20:44:13.405835988 +0300[0m
      [37m+++ /opt/gitlab/sv/logrotate/log/.chef-config20250712-17810-ed1hyx	2025-07-12 20:44:13.405835988 +0300[0m
      [37m@@ -1,6 +1,12 @@[0m
      [37m+s209715200[0m
      [37m+n30[0m
      [37m+t86400[0m
      [37m+!gzip[0m
      [37m+[0m
      [37m+[0m[2025-07-12T20:44:13+03:00] INFO: template[/opt/gitlab/sv/logrotate/log/config] owner changed to 0
[2025-07-12T20:44:13+03:00] INFO: template[/opt/gitlab/sv/logrotate/log/config] group changed to 0
[2025-07-12T20:44:13+03:00] INFO: template[/opt/gitlab/sv/logrotate/log/config] mode changed to 644

      [32m- change mode from '' to '0644'[0m
      [32m- change owner from '' to 'root'[0m
      [32m- change group from '' to 'root'[0m
    * ruby_block[verify_chown_persisted_on_logrotate] action nothing (skipped due to action :nothing)
[2025-07-12T20:44:13+03:00] INFO: ruby_block[verify_chown_persisted_on_logrotate] sent create action to ruby_block[verify_chown_persisted_on_logrotate] (immediate at declaration time)
    * ruby_block[verify_chown_persisted_on_logrotate] action create[2025-07-12T20:44:13+03:00] INFO: ruby_block[verify_chown_persisted_on_logrotate] called

      [32m- execute the ruby block verify_chown_persisted_on_logrotate[0m
    * link[/var/log/gitlab/logrotate/config] action create[2025-07-12T20:44:13+03:00] INFO: link[/var/log/gitlab/logrotate/config] created

      [32m- create symlink at /var/log/gitlab/logrotate/config to /opt/gitlab/sv/logrotate/log/config[0m
    * template[/opt/gitlab/sv/logrotate/log/run] action create[2025-07-12T20:44:13+03:00] INFO: template[/opt/gitlab/sv/logrotate/log/run] created file /opt/gitlab/sv/logrotate/log/run

      [32m- create new file /opt/gitlab/sv/logrotate/log/run[0m[2025-07-12T20:44:13+03:00] INFO: template[/opt/gitlab/sv/logrotate/log/run] updated file contents /opt/gitlab/sv/logrotate/log/run

      [32m- update content in file /opt/gitlab/sv/logrotate/log/run from none to 637335[0m
      [37m--- /opt/gitlab/sv/logrotate/log/run	2025-07-12 20:44:13.421835988 +0300[0m
      [37m+++ /opt/gitlab/sv/logrotate/log/.chef-run20250712-17810-3pjaj	2025-07-12 20:44:13.421835988 +0300[0m
      [37m@@ -1,5 +1,10 @@[0m
      [37m+#!/bin/sh[0m
      [37m+exec chpst -P \[0m
      [37m+  -U root:root \[0m
      [37m+  -u root:root \[0m
      [37m+  svlogd -tt /var/log/gitlab/logrotate[0m[2025-07-12T20:44:13+03:00] INFO: template[/opt/gitlab/sv/logrotate/log/run] owner changed to 0
[2025-07-12T20:44:13+03:00] INFO: template[/opt/gitlab/sv/logrotate/log/run] group changed to 0
[2025-07-12T20:44:13+03:00] INFO: template[/opt/gitlab/sv/logrotate/log/run] mode changed to 755

      [32m- change mode from '' to '0755'[0m
      [32m- change owner from '' to 'root'[0m
      [32m- change group from '' to 'root'[0m
    * directory[/opt/gitlab/sv/logrotate/env] action create[2025-07-12T20:44:13+03:00] INFO: directory[/opt/gitlab/sv/logrotate/env] created directory /opt/gitlab/sv/logrotate/env

      [32m- create new directory /opt/gitlab/sv/logrotate/env[0m[2025-07-12T20:44:13+03:00] INFO: directory[/opt/gitlab/sv/logrotate/env] owner changed to 0
[2025-07-12T20:44:13+03:00] INFO: directory[/opt/gitlab/sv/logrotate/env] group changed to 0
[2025-07-12T20:44:13+03:00] INFO: directory[/opt/gitlab/sv/logrotate/env] mode changed to 755

      [32m- change mode from '' to '0755'[0m
      [32m- change owner from '' to 'root'[0m
      [32m- change group from '' to 'root'[0m
    * ruby_block[Delete unmanaged env files for logrotate service] action run (skipped due to only_if)
    * template[/opt/gitlab/sv/logrotate/check] action create (skipped due to only_if)
    * template[/opt/gitlab/sv/logrotate/finish] action create (skipped due to only_if)
    * directory[/opt/gitlab/sv/logrotate/control] action create[2025-07-12T20:44:13+03:00] INFO: directory[/opt/gitlab/sv/logrotate/control] created directory /opt/gitlab/sv/logrotate/control

      [32m- create new directory /opt/gitlab/sv/logrotate/control[0m[2025-07-12T20:44:13+03:00] INFO: directory[/opt/gitlab/sv/logrotate/control] owner changed to 0
[2025-07-12T20:44:13+03:00] INFO: directory[/opt/gitlab/sv/logrotate/control] group changed to 0
[2025-07-12T20:44:13+03:00] INFO: directory[/opt/gitlab/sv/logrotate/control] mode changed to 755

      [32m- change mode from '' to '0755'[0m
      [32m- change owner from '' to 'root'[0m
      [32m- change group from '' to 'root'[0m
    * template[/opt/gitlab/sv/logrotate/control/t] action create[2025-07-12T20:44:13+03:00] INFO: template[/opt/gitlab/sv/logrotate/control/t] created file /opt/gitlab/sv/logrotate/control/t

      [32m- create new file /opt/gitlab/sv/logrotate/control/t[0m[2025-07-12T20:44:13+03:00] INFO: template[/opt/gitlab/sv/logrotate/control/t] updated file contents /opt/gitlab/sv/logrotate/control/t

      [32m- update content in file /opt/gitlab/sv/logrotate/control/t from none to 8fa3fa[0m
      [37m--- /opt/gitlab/sv/logrotate/control/t	2025-07-12 20:44:13.445835988 +0300[0m
      [37m+++ /opt/gitlab/sv/logrotate/control/.chef-t20250712-17810-a22ozi	2025-07-12 20:44:13.445835988 +0300[0m
      [37m@@ -1,3 +1,6 @@[0m
      [37m+#!/bin/sh[0m
      [37m+echo "Received TERM from runit, sending to process group (-PID)"[0m
      [37m+kill -- -$(cat /opt/gitlab/service/logrotate/supervise/pid)[0m[2025-07-12T20:44:13+03:00] INFO: template[/opt/gitlab/sv/logrotate/control/t] owner changed to 0
[2025-07-12T20:44:13+03:00] INFO: template[/opt/gitlab/sv/logrotate/control/t] group changed to 0
[2025-07-12T20:44:13+03:00] INFO: template[/opt/gitlab/sv/logrotate/control/t] mode changed to 755

      [32m- change mode from '' to '0755'[0m
      [32m- change owner from '' to 'root'[0m
      [32m- change group from '' to 'root'[0m
    * link[/opt/gitlab/init/logrotate] action create[2025-07-12T20:44:13+03:00] INFO: link[/opt/gitlab/init/logrotate] created

      [32m- create symlink at /opt/gitlab/init/logrotate to /opt/gitlab/embedded/bin/sv[0m
    * file[/opt/gitlab/sv/logrotate/down] action nothing (skipped due to action :nothing)
[2025-07-12T20:44:13+03:00] INFO: template[/opt/gitlab/sv/logrotate/run] sending run action to ruby_block[restart_service] (delayed)
    * ruby_block[restart_service] action run (skipped due to only_if)
[2025-07-12T20:44:13+03:00] INFO: template[/opt/gitlab/sv/logrotate/log/config] sending create action to ruby_block[reload_log_service] (delayed)
    * ruby_block[reload_log_service] action create
      * ruby_block[restart_service] action nothing (skipped due to action :nothing)
      * ruby_block[restart_log_service] action nothing (skipped due to action :nothing)
      * ruby_block[reload_log_service] action nothing (skipped due to action :nothing)
      * directory[/opt/gitlab/sv/logrotate] action create (up to date)
      * template[/opt/gitlab/sv/logrotate/run] action create (up to date)
      * directory[/opt/gitlab/sv/logrotate/log] action create (up to date)
      * directory[/opt/gitlab/sv/logrotate/log/main] action create (up to date)
      * template[/opt/gitlab/sv/logrotate/log/config] action create (up to date)
      * ruby_block[verify_chown_persisted_on_logrotate] action nothing (skipped due to action :nothing)
      * link[/var/log/gitlab/logrotate/config] action create (up to date)
      * template[/opt/gitlab/sv/logrotate/log/run] action create (up to date)
      * directory[/opt/gitlab/sv/logrotate/env] action create (up to date)
      * ruby_block[Delete unmanaged env files for logrotate service] action run (skipped due to only_if)
      * template[/opt/gitlab/sv/logrotate/check] action create (skipped due to only_if)
      * template[/opt/gitlab/sv/logrotate/finish] action create (skipped due to only_if)
      * directory[/opt/gitlab/sv/logrotate/control] action create (up to date)
      * template[/opt/gitlab/sv/logrotate/control/t] action create (up to date)
      * link[/opt/gitlab/init/logrotate] action create (up to date)
      * file[/opt/gitlab/sv/logrotate/down] action nothing (skipped due to action :nothing)
      * directory[/opt/gitlab/service] action create (up to date)
      * link[/opt/gitlab/service/logrotate] action create[2025-07-12T20:44:13+03:00] INFO: link[/opt/gitlab/service/logrotate] created

        [32m- create symlink at /opt/gitlab/service/logrotate to /opt/gitlab/sv/logrotate[0m
      * ruby_block[wait for logrotate service socket] action run[2025-07-12T20:44:18+03:00] INFO: ruby_block[wait for logrotate service socket] called

        [32m- execute the ruby block wait for logrotate service socket[0m
      * file[/var/log/gitlab/logrotate/current] action touch (skipped due to only_if)
[2025-07-12T20:44:19+03:00] INFO: ruby_block[reload_log_service] called
      [32m- execute the ruby block reload_log_service[0m
[2025-07-12T20:44:19+03:00] INFO: template[/opt/gitlab/sv/logrotate/log/run] sending run action to ruby_block[restart_log_service] (delayed)
    * ruby_block[restart_log_service] action run
      * ruby_block[restart_service] action nothing (skipped due to action :nothing)
      * ruby_block[restart_log_service] action nothing (skipped due to action :nothing)
      * ruby_block[reload_log_service] action nothing (skipped due to action :nothing)
      * directory[/opt/gitlab/sv/logrotate] action create (up to date)
      * template[/opt/gitlab/sv/logrotate/run] action create (up to date)
      * directory[/opt/gitlab/sv/logrotate/log] action create (up to date)
      * directory[/opt/gitlab/sv/logrotate/log/main] action create (up to date)
      * template[/opt/gitlab/sv/logrotate/log/config] action create (up to date)
      * ruby_block[verify_chown_persisted_on_logrotate] action nothing (skipped due to action :nothing)
      * link[/var/log/gitlab/logrotate/config] action create (up to date)
      * template[/opt/gitlab/sv/logrotate/log/run] action create (up to date)
      * directory[/opt/gitlab/sv/logrotate/env] action create (up to date)
      * ruby_block[Delete unmanaged env files for logrotate service] action run (skipped due to only_if)
      * template[/opt/gitlab/sv/logrotate/check] action create (skipped due to only_if)
      * template[/opt/gitlab/sv/logrotate/finish] action create (skipped due to only_if)
      * directory[/opt/gitlab/sv/logrotate/control] action create (up to date)
      * template[/opt/gitlab/sv/logrotate/control/t] action create (up to date)
      * link[/opt/gitlab/init/logrotate] action create (up to date)
      * file[/opt/gitlab/sv/logrotate/down] action nothing (skipped due to action :nothing)
      * directory[/opt/gitlab/service] action create (up to date)
      * link[/opt/gitlab/service/logrotate] action create (up to date)
      * ruby_block[wait for logrotate service socket] action run (skipped due to not_if)
      * file[/var/log/gitlab/logrotate/current] action touch (skipped due to only_if)
[2025-07-12T20:44:20+03:00] INFO: ruby_block[restart_log_service] called
      [32m- execute the ruby block restart_log_service[0m
    * directory[/opt/gitlab/service] action create (up to date)
    * link[/opt/gitlab/service/logrotate] action create (up to date)
    * ruby_block[wait for logrotate service socket] action run (skipped due to not_if)
    * file[/var/log/gitlab/logrotate/current] action touch (skipped due to only_if)
  
  * execute[/opt/gitlab/bin/gitlab-ctl start logrotate] action run
    [execute] ok: run: logrotate: (pid 18378) 4s
[2025-07-12T20:44:21+03:00] INFO: execute[/opt/gitlab/bin/gitlab-ctl start logrotate] ran successfully
    [32m- execute /opt/gitlab/bin/gitlab-ctl start logrotate[0m
Recipe: redis::enable
  * redis_service[redis] action create[2025-07-12T20:44:21+03:00] WARN: redis does not have a log_group or default logdir mode defined. Setting to 0700.

    * account[user and group for redis] action create
      * group[user and group for redis] action create[2025-07-12T20:44:21+03:00] INFO: group[user and group for redis] created

        [32m- create group gitlab-redis[0m
      * linux_user[user and group for redis] action create[2025-07-12T20:44:21+03:00] INFO: linux_user[user and group for redis] created

        [32m- create user gitlab-redis[0m
    
    * group[Socket group] action create (up to date)
    * directory[/var/opt/gitlab/redis] action create[2025-07-12T20:44:21+03:00] INFO: directory[/var/opt/gitlab/redis] created directory /var/opt/gitlab/redis

      [32m- create new directory /var/opt/gitlab/redis[0m[2025-07-12T20:44:21+03:00] INFO: directory[/var/opt/gitlab/redis] owner changed to 993
[2025-07-12T20:44:21+03:00] INFO: directory[/var/opt/gitlab/redis] group changed to 991
[2025-07-12T20:44:21+03:00] INFO: directory[/var/opt/gitlab/redis] mode changed to 750

      [32m- change mode from '' to '0750'[0m
      [32m- change owner from '' to 'gitlab-redis'[0m
      [32m- change group from '' to 'git'[0m
    * directory[/var/log/gitlab/redis] action create[2025-07-12T20:44:21+03:00] INFO: directory[/var/log/gitlab/redis] created directory /var/log/gitlab/redis

      [32m- create new directory /var/log/gitlab/redis[0m[2025-07-12T20:44:21+03:00] INFO: directory[/var/log/gitlab/redis] owner changed to 993
[2025-07-12T20:44:21+03:00] INFO: directory[/var/log/gitlab/redis] mode changed to 700

      [32m- change mode from '' to '0700'[0m
      [32m- change owner from '' to 'gitlab-redis'[0m
    * template[/var/opt/gitlab/redis/redis.conf] action create[2025-07-12T20:44:21+03:00] INFO: template[/var/opt/gitlab/redis/redis.conf] created file /var/opt/gitlab/redis/redis.conf

      [32m- create new file /var/opt/gitlab/redis/redis.conf[0m[2025-07-12T20:44:21+03:00] INFO: template[/var/opt/gitlab/redis/redis.conf] updated file contents /var/opt/gitlab/redis/redis.conf

      [32m- update content in file /var/opt/gitlab/redis/redis.conf from none to df6658[0m
      [32m- suppressed sensitive resource[0m[2025-07-12T20:44:21+03:00] INFO: template[/var/opt/gitlab/redis/redis.conf] owner changed to 993
[2025-07-12T20:44:21+03:00] INFO: template[/var/opt/gitlab/redis/redis.conf] mode changed to 644

      [32m- change mode from '' to '0644'[0m
      [32m- change owner from '' to 'gitlab-redis'[0m
    * service[redis] action nothing (skipped due to action :nothing)
    * runit_service[redis] action enable
      * ruby_block[restart_service] action nothing (skipped due to action :nothing)
      * ruby_block[restart_log_service] action nothing (skipped due to action :nothing)
      * ruby_block[reload_log_service] action nothing (skipped due to action :nothing)
      * directory[/opt/gitlab/sv/redis] action create[2025-07-12T20:44:21+03:00] INFO: directory[/opt/gitlab/sv/redis] created directory /opt/gitlab/sv/redis

        [32m- create new directory /opt/gitlab/sv/redis[0m[2025-07-12T20:44:21+03:00] INFO: directory[/opt/gitlab/sv/redis] owner changed to 0
[2025-07-12T20:44:21+03:00] INFO: directory[/opt/gitlab/sv/redis] group changed to 0
[2025-07-12T20:44:21+03:00] INFO: directory[/opt/gitlab/sv/redis] mode changed to 755

        [32m- change mode from '' to '0755'[0m
        [32m- change owner from '' to 'root'[0m
        [32m- change group from '' to 'root'[0m
      * template[/opt/gitlab/sv/redis/run] action create[2025-07-12T20:44:21+03:00] INFO: template[/opt/gitlab/sv/redis/run] created file /opt/gitlab/sv/redis/run

        [32m- create new file /opt/gitlab/sv/redis/run[0m[2025-07-12T20:44:21+03:00] INFO: template[/opt/gitlab/sv/redis/run] updated file contents /opt/gitlab/sv/redis/run

        [32m- update content in file /opt/gitlab/sv/redis/run from none to 577d2c[0m
        [37m--- /opt/gitlab/sv/redis/run	2025-07-12 20:44:21.857835988 +0300[0m
        [37m+++ /opt/gitlab/sv/redis/.chef-run20250712-17810-1uux5o	2025-07-12 20:44:21.857835988 +0300[0m
        [37m@@ -1,10 +1,20 @@[0m
        [37m+#!/bin/sh[0m
        [37m+exec 2>&1[0m
        [37m+[0m
        [37m+sleep 0[0m
        [37m+umask 077[0m
        [37m+exec chpst -P \[0m
        [37m+  -U gitlab-redis:gitlab-redis \[0m
        [37m+  -u gitlab-redis:gitlab-redis \[0m
        [37m+  /opt/gitlab/embedded/bin/redis-server \[0m
        [37m+  /var/opt/gitlab/redis/redis.conf[0m[2025-07-12T20:44:21+03:00] INFO: template[/opt/gitlab/sv/redis/run] owner changed to 0
[2025-07-12T20:44:21+03:00] INFO: template[/opt/gitlab/sv/redis/run] group changed to 0
[2025-07-12T20:44:21+03:00] INFO: template[/opt/gitlab/sv/redis/run] mode changed to 755

        [32m- change mode from '' to '0755'[0m
        [32m- change owner from '' to 'root'[0m
        [32m- change group from '' to 'root'[0m
      * directory[/opt/gitlab/sv/redis/log] action create[2025-07-12T20:44:21+03:00] INFO: directory[/opt/gitlab/sv/redis/log] created directory /opt/gitlab/sv/redis/log

        [32m- create new directory /opt/gitlab/sv/redis/log[0m[2025-07-12T20:44:21+03:00] INFO: directory[/opt/gitlab/sv/redis/log] owner changed to 0
[2025-07-12T20:44:21+03:00] INFO: directory[/opt/gitlab/sv/redis/log] group changed to 0
[2025-07-12T20:44:21+03:00] INFO: directory[/opt/gitlab/sv/redis/log] mode changed to 755

        [32m- change mode from '' to '0755'[0m
        [32m- change owner from '' to 'root'[0m
        [32m- change group from '' to 'root'[0m
      * directory[/opt/gitlab/sv/redis/log/main] action create[2025-07-12T20:44:21+03:00] INFO: directory[/opt/gitlab/sv/redis/log/main] created directory /opt/gitlab/sv/redis/log/main

        [32m- create new directory /opt/gitlab/sv/redis/log/main[0m[2025-07-12T20:44:21+03:00] INFO: directory[/opt/gitlab/sv/redis/log/main] owner changed to 0
[2025-07-12T20:44:21+03:00] INFO: directory[/opt/gitlab/sv/redis/log/main] group changed to 0
[2025-07-12T20:44:21+03:00] INFO: directory[/opt/gitlab/sv/redis/log/main] mode changed to 755

        [32m- change mode from '' to '0755'[0m
        [32m- change owner from '' to 'root'[0m
        [32m- change group from '' to 'root'[0m
      * template[/opt/gitlab/sv/redis/log/config] action create[2025-07-12T20:44:21+03:00] INFO: template[/opt/gitlab/sv/redis/log/config] created file /opt/gitlab/sv/redis/log/config

        [32m- create new file /opt/gitlab/sv/redis/log/config[0m[2025-07-12T20:44:21+03:00] INFO: template[/opt/gitlab/sv/redis/log/config] updated file contents /opt/gitlab/sv/redis/log/config

        [32m- update content in file /opt/gitlab/sv/redis/log/config from none to 623c00[0m
        [37m--- /opt/gitlab/sv/redis/log/config	2025-07-12 20:44:21.877835988 +0300[0m
        [37m+++ /opt/gitlab/sv/redis/log/.chef-config20250712-17810-4y4im3	2025-07-12 20:44:21.877835988 +0300[0m
        [37m@@ -1,6 +1,12 @@[0m
        [37m+s209715200[0m
        [37m+n30[0m
        [37m+t86400[0m
        [37m+!gzip[0m
        [37m+[0m
        [37m+[0m[2025-07-12T20:44:21+03:00] INFO: template[/opt/gitlab/sv/redis/log/config] owner changed to 0
[2025-07-12T20:44:21+03:00] INFO: template[/opt/gitlab/sv/redis/log/config] group changed to 0
[2025-07-12T20:44:21+03:00] INFO: template[/opt/gitlab/sv/redis/log/config] mode changed to 644

        [32m- change mode from '' to '0644'[0m
        [32m- change owner from '' to 'root'[0m
        [32m- change group from '' to 'root'[0m
      * ruby_block[verify_chown_persisted_on_redis] action nothing (skipped due to action :nothing)
[2025-07-12T20:44:21+03:00] INFO: ruby_block[verify_chown_persisted_on_redis] sent create action to ruby_block[verify_chown_persisted_on_redis] (immediate at declaration time)
      * ruby_block[verify_chown_persisted_on_redis] action create[2025-07-12T20:44:21+03:00] INFO: ruby_block[verify_chown_persisted_on_redis] called

        [32m- execute the ruby block verify_chown_persisted_on_redis[0m
      * link[/var/log/gitlab/redis/config] action create[2025-07-12T20:44:21+03:00] INFO: link[/var/log/gitlab/redis/config] created

        [32m- create symlink at /var/log/gitlab/redis/config to /opt/gitlab/sv/redis/log/config[0m
      * template[/opt/gitlab/sv/redis/log/run] action create[2025-07-12T20:44:21+03:00] INFO: template[/opt/gitlab/sv/redis/log/run] created file /opt/gitlab/sv/redis/log/run

        [32m- create new file /opt/gitlab/sv/redis/log/run[0m[2025-07-12T20:44:21+03:00] INFO: template[/opt/gitlab/sv/redis/log/run] updated file contents /opt/gitlab/sv/redis/log/run

        [32m- update content in file /opt/gitlab/sv/redis/log/run from none to 4890e6[0m
        [37m--- /opt/gitlab/sv/redis/log/run	2025-07-12 20:44:21.893835988 +0300[0m
        [37m+++ /opt/gitlab/sv/redis/log/.chef-run20250712-17810-vbj9lb	2025-07-12 20:44:21.889835988 +0300[0m
        [37m@@ -1,5 +1,10 @@[0m
        [37m+#!/bin/sh[0m
        [37m+exec chpst -P \[0m
        [37m+  -U root:root \[0m
        [37m+  -u root:root \[0m
        [37m+  svlogd -tt /var/log/gitlab/redis[0m[2025-07-12T20:44:21+03:00] INFO: template[/opt/gitlab/sv/redis/log/run] owner changed to 0
[2025-07-12T20:44:21+03:00] INFO: template[/opt/gitlab/sv/redis/log/run] group changed to 0
[2025-07-12T20:44:21+03:00] INFO: template[/opt/gitlab/sv/redis/log/run] mode changed to 755

        [32m- change mode from '' to '0755'[0m
        [32m- change owner from '' to 'root'[0m
        [32m- change group from '' to 'root'[0m
      * directory[/opt/gitlab/sv/redis/env] action create[2025-07-12T20:44:21+03:00] INFO: directory[/opt/gitlab/sv/redis/env] created directory /opt/gitlab/sv/redis/env

        [32m- create new directory /opt/gitlab/sv/redis/env[0m[2025-07-12T20:44:21+03:00] INFO: directory[/opt/gitlab/sv/redis/env] owner changed to 0
[2025-07-12T20:44:21+03:00] INFO: directory[/opt/gitlab/sv/redis/env] group changed to 0
[2025-07-12T20:44:21+03:00] INFO: directory[/opt/gitlab/sv/redis/env] mode changed to 755

        [32m- change mode from '' to '0755'[0m
        [32m- change owner from '' to 'root'[0m
        [32m- change group from '' to 'root'[0m
      * ruby_block[Delete unmanaged env files for redis service] action run (skipped due to only_if)
      * template[/opt/gitlab/sv/redis/check] action create (skipped due to only_if)
      * template[/opt/gitlab/sv/redis/finish] action create (skipped due to only_if)
      * directory[/opt/gitlab/sv/redis/control] action create[2025-07-12T20:44:21+03:00] INFO: directory[/opt/gitlab/sv/redis/control] created directory /opt/gitlab/sv/redis/control

        [32m- create new directory /opt/gitlab/sv/redis/control[0m[2025-07-12T20:44:21+03:00] INFO: directory[/opt/gitlab/sv/redis/control] owner changed to 0
[2025-07-12T20:44:21+03:00] INFO: directory[/opt/gitlab/sv/redis/control] group changed to 0
[2025-07-12T20:44:21+03:00] INFO: directory[/opt/gitlab/sv/redis/control] mode changed to 755

        [32m- change mode from '' to '0755'[0m
        [32m- change owner from '' to 'root'[0m
        [32m- change group from '' to 'root'[0m
      * link[/opt/gitlab/init/redis] action create[2025-07-12T20:44:21+03:00] INFO: link[/opt/gitlab/init/redis] created

        [32m- create symlink at /opt/gitlab/init/redis to /opt/gitlab/embedded/bin/sv[0m
      * file[/opt/gitlab/sv/redis/down] action nothing (skipped due to action :nothing)
[2025-07-12T20:44:21+03:00] INFO: template[/opt/gitlab/sv/redis/run] sending run action to ruby_block[restart_service] (delayed)
      * ruby_block[restart_service] action run (skipped due to only_if)
[2025-07-12T20:44:21+03:00] INFO: template[/opt/gitlab/sv/redis/log/config] sending create action to ruby_block[reload_log_service] (delayed)
      * ruby_block[reload_log_service] action create
        * ruby_block[restart_service] action nothing (skipped due to action :nothing)
        * ruby_block[restart_log_service] action nothing (skipped due to action :nothing)
        * ruby_block[reload_log_service] action nothing (skipped due to action :nothing)
        * directory[/opt/gitlab/sv/redis] action create (up to date)
        * template[/opt/gitlab/sv/redis/run] action create (up to date)
        * directory[/opt/gitlab/sv/redis/log] action create (up to date)
        * directory[/opt/gitlab/sv/redis/log/main] action create (up to date)
        * template[/opt/gitlab/sv/redis/log/config] action create (up to date)
        * ruby_block[verify_chown_persisted_on_redis] action nothing (skipped due to action :nothing)
        * link[/var/log/gitlab/redis/config] action create (up to date)
        * template[/opt/gitlab/sv/redis/log/run] action create (up to date)
        * directory[/opt/gitlab/sv/redis/env] action create (up to date)
        * ruby_block[Delete unmanaged env files for redis service] action run (skipped due to only_if)
        * template[/opt/gitlab/sv/redis/check] action create (skipped due to only_if)
        * template[/opt/gitlab/sv/redis/finish] action create (skipped due to only_if)
        * directory[/opt/gitlab/sv/redis/control] action create (up to date)
        * link[/opt/gitlab/init/redis] action create (up to date)
        * file[/opt/gitlab/sv/redis/down] action nothing (skipped due to action :nothing)
        * directory[/opt/gitlab/service] action create (up to date)
        * link[/opt/gitlab/service/redis] action create[2025-07-12T20:44:21+03:00] INFO: link[/opt/gitlab/service/redis] created

          [32m- create symlink at /opt/gitlab/service/redis to /opt/gitlab/sv/redis[0m
        * ruby_block[wait for redis service socket] action run[2025-07-12T20:44:24+03:00] INFO: ruby_block[wait for redis service socket] called

          [32m- execute the ruby block wait for redis service socket[0m
        * file[/var/log/gitlab/redis/current] action touch (skipped due to only_if)
[2025-07-12T20:44:25+03:00] INFO: ruby_block[reload_log_service] called
        [32m- execute the ruby block reload_log_service[0m
[2025-07-12T20:44:25+03:00] INFO: template[/opt/gitlab/sv/redis/log/run] sending run action to ruby_block[restart_log_service] (delayed)
      * ruby_block[restart_log_service] action run
        * ruby_block[restart_service] action nothing (skipped due to action :nothing)
        * ruby_block[restart_log_service] action nothing (skipped due to action :nothing)
        * ruby_block[reload_log_service] action nothing (skipped due to action :nothing)
        * directory[/opt/gitlab/sv/redis] action create (up to date)
        * template[/opt/gitlab/sv/redis/run] action create (up to date)
        * directory[/opt/gitlab/sv/redis/log] action create (up to date)
        * directory[/opt/gitlab/sv/redis/log/main] action create (up to date)
        * template[/opt/gitlab/sv/redis/log/config] action create (up to date)
        * ruby_block[verify_chown_persisted_on_redis] action nothing (skipped due to action :nothing)
        * link[/var/log/gitlab/redis/config] action create (up to date)
        * template[/opt/gitlab/sv/redis/log/run] action create (up to date)
        * directory[/opt/gitlab/sv/redis/env] action create (up to date)
        * ruby_block[Delete unmanaged env files for redis service] action run (skipped due to only_if)
        * template[/opt/gitlab/sv/redis/check] action create (skipped due to only_if)
        * template[/opt/gitlab/sv/redis/finish] action create (skipped due to only_if)
        * directory[/opt/gitlab/sv/redis/control] action create (up to date)
        * link[/opt/gitlab/init/redis] action create (up to date)
        * file[/opt/gitlab/sv/redis/down] action nothing (skipped due to action :nothing)
        * directory[/opt/gitlab/service] action create (up to date)
        * link[/opt/gitlab/service/redis] action create (up to date)
        * ruby_block[wait for redis service socket] action run (skipped due to not_if)
        * file[/var/log/gitlab/redis/current] action touch (skipped due to only_if)
[2025-07-12T20:44:25+03:00] INFO: ruby_block[restart_log_service] called
        [32m- execute the ruby block restart_log_service[0m
      * directory[/opt/gitlab/service] action create (up to date)
      * link[/opt/gitlab/service/redis] action create (up to date)
      * ruby_block[wait for redis service socket] action run (skipped due to not_if)
      * file[/var/log/gitlab/redis/current] action touch (skipped due to only_if)
    
    * execute[/opt/gitlab/bin/gitlab-ctl start redis] action run
      [execute] ok: run: redis: (pid 18416) 3s
[2025-07-12T20:44:26+03:00] INFO: execute[/opt/gitlab/bin/gitlab-ctl start redis] ran successfully
      [32m- execute /opt/gitlab/bin/gitlab-ctl start redis[0m
    * ruby_block[warn pending redis restart] action run (skipped due to only_if)
  
  * template[/opt/gitlab/etc/gitlab-redis-cli-rc] action create[2025-07-12T20:44:26+03:00] INFO: template[/opt/gitlab/etc/gitlab-redis-cli-rc] created file /opt/gitlab/etc/gitlab-redis-cli-rc

    [32m- create new file /opt/gitlab/etc/gitlab-redis-cli-rc[0m[2025-07-12T20:44:26+03:00] INFO: template[/opt/gitlab/etc/gitlab-redis-cli-rc] updated file contents /opt/gitlab/etc/gitlab-redis-cli-rc

    [32m- update content in file /opt/gitlab/etc/gitlab-redis-cli-rc from none to 0fbe6f[0m
    [37m--- /opt/gitlab/etc/gitlab-redis-cli-rc	2025-07-12 20:44:26.357835988 +0300[0m
    [37m+++ /opt/gitlab/etc/.chef-gitlab-redis-cli-rc20250712-17810-14ovcc	2025-07-12 20:44:26.357835988 +0300[0m
    [37m@@ -1,10 +1,20 @@[0m
    [37m+redis_dir='/var/opt/gitlab/redis'[0m
    [37m+redis_host=''[0m
    [37m+redis_port='0'[0m
    [37m+redis_tls_port=''[0m
    [37m+redis_tls_auth_clients='optional'[0m
    [37m+redis_tls_cacert_file='/opt/gitlab/embedded/ssl/certs/cacert.pem'[0m
    [37m+redis_tls_cacert_dir='/opt/gitlab/embedded/ssl/certs/'[0m
    [37m+redis_tls_cert_file=''[0m
    [37m+redis_tls_key_file=''[0m
    [37m+redis_socket='/var/opt/gitlab/redis/redis.socket'[0m[2025-07-12T20:44:26+03:00] INFO: template[/opt/gitlab/etc/gitlab-redis-cli-rc] owner changed to 0
[2025-07-12T20:44:26+03:00] INFO: template[/opt/gitlab/etc/gitlab-redis-cli-rc] group changed to 0

    [32m- change owner from '' to 'root'[0m
    [32m- change group from '' to 'root'[0m
Recipe: gitaly::enable
  * directory[/var/opt/gitlab/gitaly] action create[2025-07-12T20:44:26+03:00] INFO: directory[/var/opt/gitlab/gitaly] created directory /var/opt/gitlab/gitaly

    [32m- create new directory /var/opt/gitlab/gitaly[0m[2025-07-12T20:44:26+03:00] INFO: directory[/var/opt/gitlab/gitaly] owner changed to 994
[2025-07-12T20:44:26+03:00] INFO: directory[/var/opt/gitlab/gitaly] mode changed to 700

    [32m- change mode from '' to '0700'[0m
    [32m- change owner from '' to 'git'[0m
  * directory[/var/opt/gitlab/gitaly/run] action create[2025-07-12T20:44:26+03:00] INFO: directory[/var/opt/gitlab/gitaly/run] created directory /var/opt/gitlab/gitaly/run

    [32m- create new directory /var/opt/gitlab/gitaly/run[0m[2025-07-12T20:44:26+03:00] INFO: directory[/var/opt/gitlab/gitaly/run] owner changed to 994
[2025-07-12T20:44:26+03:00] INFO: directory[/var/opt/gitlab/gitaly/run] mode changed to 700

    [32m- change mode from '' to '0700'[0m
    [32m- change owner from '' to 'git'[0m
  * directory[/var/log/gitlab/gitaly] action create[2025-07-12T20:44:26+03:00] INFO: directory[/var/log/gitlab/gitaly] created directory /var/log/gitlab/gitaly

    [32m- create new directory /var/log/gitlab/gitaly[0m[2025-07-12T20:44:26+03:00] INFO: directory[/var/log/gitlab/gitaly] owner changed to 994
[2025-07-12T20:44:26+03:00] INFO: directory[/var/log/gitlab/gitaly] mode changed to 700

    [32m- change mode from '' to '0700'[0m
    [32m- change owner from '' to 'git'[0m
  * directory[/var/opt/gitlab/gitaly/internal_sockets] action delete (up to date)
  * env_dir[/opt/gitlab/etc/gitaly/env] action create
    * directory[/opt/gitlab/etc/gitaly/env] action create[2025-07-12T20:44:26+03:00] INFO: directory[/opt/gitlab/etc/gitaly/env] created directory /opt/gitlab/etc/gitaly/env

      [32m- create new directory /opt/gitlab/etc/gitaly/env[0m
    * file[/opt/gitlab/etc/gitaly/env/HOME] action create[2025-07-12T20:44:26+03:00] INFO: file[/opt/gitlab/etc/gitaly/env/HOME] created file /opt/gitlab/etc/gitaly/env/HOME

      [32m- create new file /opt/gitlab/etc/gitaly/env/HOME[0m[2025-07-12T20:44:26+03:00] INFO: file[/opt/gitlab/etc/gitaly/env/HOME] updated file contents /opt/gitlab/etc/gitaly/env/HOME

      [32m- update content in file /opt/gitlab/etc/gitaly/env/HOME from none to 205bb9[0m
      [32m- suppressed sensitive resource[0m
    * file[/opt/gitlab/etc/gitaly/env/PATH] action create[2025-07-12T20:44:26+03:00] INFO: file[/opt/gitlab/etc/gitaly/env/PATH] created file /opt/gitlab/etc/gitaly/env/PATH

      [32m- create new file /opt/gitlab/etc/gitaly/env/PATH[0m[2025-07-12T20:44:26+03:00] INFO: file[/opt/gitlab/etc/gitaly/env/PATH] updated file contents /opt/gitlab/etc/gitaly/env/PATH

      [32m- update content in file /opt/gitlab/etc/gitaly/env/PATH from none to d5dc07[0m
      [32m- suppressed sensitive resource[0m
    * file[/opt/gitlab/etc/gitaly/env/TZ] action create[2025-07-12T20:44:26+03:00] INFO: file[/opt/gitlab/etc/gitaly/env/TZ] created file /opt/gitlab/etc/gitaly/env/TZ

      [32m- create new file /opt/gitlab/etc/gitaly/env/TZ[0m[2025-07-12T20:44:26+03:00] INFO: file[/opt/gitlab/etc/gitaly/env/TZ] updated file contents /opt/gitlab/etc/gitaly/env/TZ

      [32m- update content in file /opt/gitlab/etc/gitaly/env/TZ from none to 983a95[0m
      [32m- suppressed sensitive resource[0m
    * file[/opt/gitlab/etc/gitaly/env/PYTHONPATH] action create[2025-07-12T20:44:26+03:00] INFO: file[/opt/gitlab/etc/gitaly/env/PYTHONPATH] created file /opt/gitlab/etc/gitaly/env/PYTHONPATH

      [32m- create new file /opt/gitlab/etc/gitaly/env/PYTHONPATH[0m[2025-07-12T20:44:26+03:00] INFO: file[/opt/gitlab/etc/gitaly/env/PYTHONPATH] updated file contents /opt/gitlab/etc/gitaly/env/PYTHONPATH

      [32m- update content in file /opt/gitlab/etc/gitaly/env/PYTHONPATH from none to 98c9f4[0m
      [32m- suppressed sensitive resource[0m
    * file[/opt/gitlab/etc/gitaly/env/ICU_DATA] action create[2025-07-12T20:44:26+03:00] INFO: file[/opt/gitlab/etc/gitaly/env/ICU_DATA] created file /opt/gitlab/etc/gitaly/env/ICU_DATA

      [32m- create new file /opt/gitlab/etc/gitaly/env/ICU_DATA[0m[2025-07-12T20:44:26+03:00] INFO: file[/opt/gitlab/etc/gitaly/env/ICU_DATA] updated file contents /opt/gitlab/etc/gitaly/env/ICU_DATA

      [32m- update content in file /opt/gitlab/etc/gitaly/env/ICU_DATA from none to a04260[0m
      [32m- suppressed sensitive resource[0m
    * file[/opt/gitlab/etc/gitaly/env/SSL_CERT_DIR] action create[2025-07-12T20:44:26+03:00] INFO: file[/opt/gitlab/etc/gitaly/env/SSL_CERT_DIR] created file /opt/gitlab/etc/gitaly/env/SSL_CERT_DIR

      [32m- create new file /opt/gitlab/etc/gitaly/env/SSL_CERT_DIR[0m[2025-07-12T20:44:26+03:00] INFO: file[/opt/gitlab/etc/gitaly/env/SSL_CERT_DIR] updated file contents /opt/gitlab/etc/gitaly/env/SSL_CERT_DIR

      [32m- update content in file /opt/gitlab/etc/gitaly/env/SSL_CERT_DIR from none to 4f45cf[0m
      [32m- suppressed sensitive resource[0m
    * file[/opt/gitlab/etc/gitaly/env/GITALY_PID_FILE] action create[2025-07-12T20:44:26+03:00] INFO: file[/opt/gitlab/etc/gitaly/env/GITALY_PID_FILE] created file /opt/gitlab/etc/gitaly/env/GITALY_PID_FILE

      [32m- create new file /opt/gitlab/etc/gitaly/env/GITALY_PID_FILE[0m[2025-07-12T20:44:26+03:00] INFO: file[/opt/gitlab/etc/gitaly/env/GITALY_PID_FILE] updated file contents /opt/gitlab/etc/gitaly/env/GITALY_PID_FILE

      [32m- update content in file /opt/gitlab/etc/gitaly/env/GITALY_PID_FILE from none to e82748[0m
      [32m- suppressed sensitive resource[0m
    * file[/opt/gitlab/etc/gitaly/env/WRAPPER_JSON_LOGGING] action create[2025-07-12T20:44:26+03:00] INFO: file[/opt/gitlab/etc/gitaly/env/WRAPPER_JSON_LOGGING] created file /opt/gitlab/etc/gitaly/env/WRAPPER_JSON_LOGGING

      [32m- create new file /opt/gitlab/etc/gitaly/env/WRAPPER_JSON_LOGGING[0m[2025-07-12T20:44:26+03:00] INFO: file[/opt/gitlab/etc/gitaly/env/WRAPPER_JSON_LOGGING] updated file contents /opt/gitlab/etc/gitaly/env/WRAPPER_JSON_LOGGING

      [32m- update content in file /opt/gitlab/etc/gitaly/env/WRAPPER_JSON_LOGGING from none to b5bea4[0m
      [32m- suppressed sensitive resource[0m
  
  * file[/var/opt/gitlab/gitaly/.gitlab_secret] action create[2025-07-12T20:44:26+03:00] INFO: file[/var/opt/gitlab/gitaly/.gitlab_secret] created file /var/opt/gitlab/gitaly/.gitlab_secret

    [32m- create new file /var/opt/gitlab/gitaly/.gitlab_secret[0m[2025-07-12T20:44:26+03:00] INFO: file[/var/opt/gitlab/gitaly/.gitlab_secret] updated file contents /var/opt/gitlab/gitaly/.gitlab_secret

    [32m- update content in file /var/opt/gitlab/gitaly/.gitlab_secret from none to 490738[0m
    [32m- suppressed sensitive resource[0m[2025-07-12T20:44:26+03:00] INFO: file[/var/opt/gitlab/gitaly/.gitlab_secret] owner changed to 0
[2025-07-12T20:44:26+03:00] INFO: file[/var/opt/gitlab/gitaly/.gitlab_secret] group changed to 0
[2025-07-12T20:44:26+03:00] INFO: file[/var/opt/gitlab/gitaly/.gitlab_secret] mode changed to 644

    [32m- change mode from '' to '0644'[0m
    [32m- change owner from '' to 'root'[0m
    [32m- change group from '' to 'root'[0m
  * template[Create Gitaly config.toml] action create[2025-07-12T20:44:26+03:00] INFO: template[Create Gitaly config.toml] created file /var/opt/gitlab/gitaly/config.toml

    [32m- create new file /var/opt/gitlab/gitaly/config.toml[0m[2025-07-12T20:44:26+03:00] INFO: template[Create Gitaly config.toml] updated file contents /var/opt/gitlab/gitaly/config.toml

    [32m- update content in file /var/opt/gitlab/gitaly/config.toml from none to f64239[0m
    [32m- suppressed sensitive resource[0m[2025-07-12T20:44:26+03:00] INFO: template[Create Gitaly config.toml] owner changed to 0
[2025-07-12T20:44:26+03:00] INFO: template[Create Gitaly config.toml] group changed to 991
[2025-07-12T20:44:26+03:00] INFO: template[Create Gitaly config.toml] mode changed to 640

    [32m- change mode from '' to '0640'[0m
    [32m- change owner from '' to 'root'[0m
    [32m- change group from '' to 'git'[0m
  * service[gitaly] action nothing (skipped due to action :nothing)
  * runit_service[gitaly] action enable
    * ruby_block[restart_service] action nothing (skipped due to action :nothing)
    * ruby_block[restart_log_service] action nothing (skipped due to action :nothing)
    * ruby_block[reload_log_service] action nothing (skipped due to action :nothing)
    * directory[/opt/gitlab/sv/gitaly] action create[2025-07-12T20:44:26+03:00] INFO: directory[/opt/gitlab/sv/gitaly] created directory /opt/gitlab/sv/gitaly

      [32m- create new directory /opt/gitlab/sv/gitaly[0m[2025-07-12T20:44:26+03:00] INFO: directory[/opt/gitlab/sv/gitaly] owner changed to 0
[2025-07-12T20:44:26+03:00] INFO: directory[/opt/gitlab/sv/gitaly] group changed to 0
[2025-07-12T20:44:26+03:00] INFO: directory[/opt/gitlab/sv/gitaly] mode changed to 755

      [32m- change mode from '' to '0755'[0m
      [32m- change owner from '' to 'root'[0m
      [32m- change group from '' to 'root'[0m
    * template[/opt/gitlab/sv/gitaly/run] action create[2025-07-12T20:44:26+03:00] INFO: template[/opt/gitlab/sv/gitaly/run] created file /opt/gitlab/sv/gitaly/run

      [32m- create new file /opt/gitlab/sv/gitaly/run[0m[2025-07-12T20:44:26+03:00] INFO: template[/opt/gitlab/sv/gitaly/run] updated file contents /opt/gitlab/sv/gitaly/run

      [32m- update content in file /opt/gitlab/sv/gitaly/run from none to 783ef0[0m
      [37m--- /opt/gitlab/sv/gitaly/run	2025-07-12 20:44:26.457835988 +0300[0m
      [37m+++ /opt/gitlab/sv/gitaly/.chef-run20250712-17810-zn8x59	2025-07-12 20:44:26.457835988 +0300[0m
      [37m@@ -1,19 +1,38 @@[0m
      [37m+#!/bin/sh[0m
      [37m+[0m
      [37m+# Attempt to change ulimit before the set -e flag, ignore failures[0m
      [37m+ulimit -n 15000[0m
      [37m+[0m
      [37m+set -e # fail on errors[0m
      [37m+[0m
      [37m+# Redirect stderr -> stdout[0m
      [37m+exec 2>&1[0m
      [37m+[0m
      [37m+[0m
      [37m+[0m
      [37m+[0m
      [37m+cd /var/opt/gitlab/gitaly[0m
      [37m+[0m
      [37m+exec chpst -e /opt/gitlab/etc/gitaly/env -P \[0m
      [37m+  -U git:git \[0m
      [37m+  -u git:git \[0m
      [37m+  /opt/gitlab/embedded/bin/gitaly-wrapper /opt/gitlab/embedded/bin/gitaly serve /var/opt/gitlab/gitaly/config.toml[0m[2025-07-12T20:44:26+03:00] INFO: template[/opt/gitlab/sv/gitaly/run] owner changed to 0
[2025-07-12T20:44:26+03:00] INFO: template[/opt/gitlab/sv/gitaly/run] group changed to 0
[2025-07-12T20:44:26+03:00] INFO: template[/opt/gitlab/sv/gitaly/run] mode changed to 755

      [32m- change mode from '' to '0755'[0m
      [32m- change owner from '' to 'root'[0m
      [32m- change group from '' to 'root'[0m
    * directory[/opt/gitlab/sv/gitaly/log] action create[2025-07-12T20:44:26+03:00] INFO: directory[/opt/gitlab/sv/gitaly/log] created directory /opt/gitlab/sv/gitaly/log

      [32m- create new directory /opt/gitlab/sv/gitaly/log[0m[2025-07-12T20:44:26+03:00] INFO: directory[/opt/gitlab/sv/gitaly/log] owner changed to 0
[2025-07-12T20:44:26+03:00] INFO: directory[/opt/gitlab/sv/gitaly/log] group changed to 0
[2025-07-12T20:44:26+03:00] INFO: directory[/opt/gitlab/sv/gitaly/log] mode changed to 755

      [32m- change mode from '' to '0755'[0m
      [32m- change owner from '' to 'root'[0m
      [32m- change group from '' to 'root'[0m
    * directory[/opt/gitlab/sv/gitaly/log/main] action create[2025-07-12T20:44:26+03:00] INFO: directory[/opt/gitlab/sv/gitaly/log/main] created directory /opt/gitlab/sv/gitaly/log/main

      [32m- create new directory /opt/gitlab/sv/gitaly/log/main[0m[2025-07-12T20:44:26+03:00] INFO: directory[/opt/gitlab/sv/gitaly/log/main] owner changed to 0
[2025-07-12T20:44:26+03:00] INFO: directory[/opt/gitlab/sv/gitaly/log/main] group changed to 0
[2025-07-12T20:44:26+03:00] INFO: directory[/opt/gitlab/sv/gitaly/log/main] mode changed to 755

      [32m- change mode from '' to '0755'[0m
      [32m- change owner from '' to 'root'[0m
      [32m- change group from '' to 'root'[0m
    * template[/opt/gitlab/sv/gitaly/log/config] action create[2025-07-12T20:44:26+03:00] INFO: template[/opt/gitlab/sv/gitaly/log/config] created file /opt/gitlab/sv/gitaly/log/config

      [32m- create new file /opt/gitlab/sv/gitaly/log/config[0m[2025-07-12T20:44:26+03:00] INFO: template[/opt/gitlab/sv/gitaly/log/config] updated file contents /opt/gitlab/sv/gitaly/log/config

      [32m- update content in file /opt/gitlab/sv/gitaly/log/config from none to 623c00[0m
      [37m--- /opt/gitlab/sv/gitaly/log/config	2025-07-12 20:44:26.477835988 +0300[0m
      [37m+++ /opt/gitlab/sv/gitaly/log/.chef-config20250712-17810-2os3jj	2025-07-12 20:44:26.477835988 +0300[0m
      [37m@@ -1,6 +1,12 @@[0m
      [37m+s209715200[0m
      [37m+n30[0m
      [37m+t86400[0m
      [37m+!gzip[0m
      [37m+[0m
      [37m+[0m[2025-07-12T20:44:26+03:00] INFO: template[/opt/gitlab/sv/gitaly/log/config] owner changed to 0
[2025-07-12T20:44:26+03:00] INFO: template[/opt/gitlab/sv/gitaly/log/config] group changed to 0
[2025-07-12T20:44:26+03:00] INFO: template[/opt/gitlab/sv/gitaly/log/config] mode changed to 644

      [32m- change mode from '' to '0644'[0m
      [32m- change owner from '' to 'root'[0m
      [32m- change group from '' to 'root'[0m
    * ruby_block[verify_chown_persisted_on_gitaly] action nothing (skipped due to action :nothing)
[2025-07-12T20:44:26+03:00] INFO: ruby_block[verify_chown_persisted_on_gitaly] sent create action to ruby_block[verify_chown_persisted_on_gitaly] (immediate at declaration time)
    * ruby_block[verify_chown_persisted_on_gitaly] action create[2025-07-12T20:44:26+03:00] INFO: ruby_block[verify_chown_persisted_on_gitaly] called

      [32m- execute the ruby block verify_chown_persisted_on_gitaly[0m
    * link[/var/log/gitlab/gitaly/config] action create[2025-07-12T20:44:26+03:00] INFO: link[/var/log/gitlab/gitaly/config] created

      [32m- create symlink at /var/log/gitlab/gitaly/config to /opt/gitlab/sv/gitaly/log/config[0m
    * template[/opt/gitlab/sv/gitaly/log/run] action create[2025-07-12T20:44:26+03:00] INFO: template[/opt/gitlab/sv/gitaly/log/run] created file /opt/gitlab/sv/gitaly/log/run

      [32m- create new file /opt/gitlab/sv/gitaly/log/run[0m[2025-07-12T20:44:26+03:00] INFO: template[/opt/gitlab/sv/gitaly/log/run] updated file contents /opt/gitlab/sv/gitaly/log/run

      [32m- update content in file /opt/gitlab/sv/gitaly/log/run from none to 209571[0m
      [37m--- /opt/gitlab/sv/gitaly/log/run	2025-07-12 20:44:26.493835988 +0300[0m
      [37m+++ /opt/gitlab/sv/gitaly/log/.chef-run20250712-17810-29rkc0	2025-07-12 20:44:26.489835988 +0300[0m
      [37m@@ -1,5 +1,10 @@[0m
      [37m+#!/bin/sh[0m
      [37m+exec chpst -P \[0m
      [37m+  -U root:root \[0m
      [37m+  -u root:root \[0m
      [37m+  svlogd /var/log/gitlab/gitaly[0m[2025-07-12T20:44:26+03:00] INFO: template[/opt/gitlab/sv/gitaly/log/run] owner changed to 0
[2025-07-12T20:44:26+03:00] INFO: template[/opt/gitlab/sv/gitaly/log/run] group changed to 0
[2025-07-12T20:44:26+03:00] INFO: template[/opt/gitlab/sv/gitaly/log/run] mode changed to 755

      [32m- change mode from '' to '0755'[0m
      [32m- change owner from '' to 'root'[0m
      [32m- change group from '' to 'root'[0m
    * directory[/opt/gitlab/sv/gitaly/env] action create[2025-07-12T20:44:26+03:00] INFO: directory[/opt/gitlab/sv/gitaly/env] created directory /opt/gitlab/sv/gitaly/env

      [32m- create new directory /opt/gitlab/sv/gitaly/env[0m[2025-07-12T20:44:26+03:00] INFO: directory[/opt/gitlab/sv/gitaly/env] owner changed to 0
[2025-07-12T20:44:26+03:00] INFO: directory[/opt/gitlab/sv/gitaly/env] group changed to 0
[2025-07-12T20:44:26+03:00] INFO: directory[/opt/gitlab/sv/gitaly/env] mode changed to 755

      [32m- change mode from '' to '0755'[0m
      [32m- change owner from '' to 'root'[0m
      [32m- change group from '' to 'root'[0m
    * ruby_block[Delete unmanaged env files for gitaly service] action run (skipped due to only_if)
    * template[/opt/gitlab/sv/gitaly/check] action create (skipped due to only_if)
    * template[/opt/gitlab/sv/gitaly/finish] action create (skipped due to only_if)
    * directory[/opt/gitlab/sv/gitaly/control] action create[2025-07-12T20:44:26+03:00] INFO: directory[/opt/gitlab/sv/gitaly/control] created directory /opt/gitlab/sv/gitaly/control

      [32m- create new directory /opt/gitlab/sv/gitaly/control[0m[2025-07-12T20:44:26+03:00] INFO: directory[/opt/gitlab/sv/gitaly/control] owner changed to 0
[2025-07-12T20:44:26+03:00] INFO: directory[/opt/gitlab/sv/gitaly/control] group changed to 0
[2025-07-12T20:44:26+03:00] INFO: directory[/opt/gitlab/sv/gitaly/control] mode changed to 755

      [32m- change mode from '' to '0755'[0m
      [32m- change owner from '' to 'root'[0m
      [32m- change group from '' to 'root'[0m
    * link[/opt/gitlab/init/gitaly] action create[2025-07-12T20:44:26+03:00] INFO: link[/opt/gitlab/init/gitaly] created

      [32m- create symlink at /opt/gitlab/init/gitaly to /opt/gitlab/embedded/bin/sv[0m
    * file[/opt/gitlab/sv/gitaly/down] action nothing (skipped due to action :nothing)
[2025-07-12T20:44:26+03:00] INFO: template[/opt/gitlab/sv/gitaly/run] sending run action to ruby_block[restart_service] (delayed)
    * ruby_block[restart_service] action run (skipped due to only_if)
[2025-07-12T20:44:26+03:00] INFO: template[/opt/gitlab/sv/gitaly/log/config] sending create action to ruby_block[reload_log_service] (delayed)
    * ruby_block[reload_log_service] action create
      * ruby_block[restart_service] action nothing (skipped due to action :nothing)
      * ruby_block[restart_log_service] action nothing (skipped due to action :nothing)
      * ruby_block[reload_log_service] action nothing (skipped due to action :nothing)
      * directory[/opt/gitlab/sv/gitaly] action create (up to date)
      * template[/opt/gitlab/sv/gitaly/run] action create (up to date)
      * directory[/opt/gitlab/sv/gitaly/log] action create (up to date)
      * directory[/opt/gitlab/sv/gitaly/log/main] action create (up to date)
      * template[/opt/gitlab/sv/gitaly/log/config] action create (up to date)
      * ruby_block[verify_chown_persisted_on_gitaly] action nothing (skipped due to action :nothing)
      * link[/var/log/gitlab/gitaly/config] action create (up to date)
      * template[/opt/gitlab/sv/gitaly/log/run] action create (up to date)
      * directory[/opt/gitlab/sv/gitaly/env] action create (up to date)
      * ruby_block[Delete unmanaged env files for gitaly service] action run (skipped due to only_if)
      * template[/opt/gitlab/sv/gitaly/check] action create (skipped due to only_if)
      * template[/opt/gitlab/sv/gitaly/finish] action create (skipped due to only_if)
      * directory[/opt/gitlab/sv/gitaly/control] action create (up to date)
      * link[/opt/gitlab/init/gitaly] action create (up to date)
      * file[/opt/gitlab/sv/gitaly/down] action nothing (skipped due to action :nothing)
      * directory[/opt/gitlab/service] action create (up to date)
      * link[/opt/gitlab/service/gitaly] action create[2025-07-12T20:44:26+03:00] INFO: link[/opt/gitlab/service/gitaly] created

        [32m- create symlink at /opt/gitlab/service/gitaly to /opt/gitlab/sv/gitaly[0m
      * ruby_block[wait for gitaly service socket] action run[2025-07-12T20:44:30+03:00] INFO: ruby_block[wait for gitaly service socket] called

        [32m- execute the ruby block wait for gitaly service socket[0m
      * file[/var/log/gitlab/gitaly/current] action touch (skipped due to only_if)
[2025-07-12T20:44:30+03:00] INFO: ruby_block[reload_log_service] called
      [32m- execute the ruby block reload_log_service[0m
[2025-07-12T20:44:30+03:00] INFO: template[/opt/gitlab/sv/gitaly/log/run] sending run action to ruby_block[restart_log_service] (delayed)
    * ruby_block[restart_log_service] action run
      * ruby_block[restart_service] action nothing (skipped due to action :nothing)
      * ruby_block[restart_log_service] action nothing (skipped due to action :nothing)
      * ruby_block[reload_log_service] action nothing (skipped due to action :nothing)
      * directory[/opt/gitlab/sv/gitaly] action create (up to date)
      * template[/opt/gitlab/sv/gitaly/run] action create (up to date)
      * directory[/opt/gitlab/sv/gitaly/log] action create (up to date)
      * directory[/opt/gitlab/sv/gitaly/log/main] action create (up to date)
      * template[/opt/gitlab/sv/gitaly/log/config] action create (up to date)
      * ruby_block[verify_chown_persisted_on_gitaly] action nothing (skipped due to action :nothing)
      * link[/var/log/gitlab/gitaly/config] action create (up to date)
      * template[/opt/gitlab/sv/gitaly/log/run] action create (up to date)
      * directory[/opt/gitlab/sv/gitaly/env] action create (up to date)
      * ruby_block[Delete unmanaged env files for gitaly service] action run (skipped due to only_if)
      * template[/opt/gitlab/sv/gitaly/check] action create (skipped due to only_if)
      * template[/opt/gitlab/sv/gitaly/finish] action create (skipped due to only_if)
      * directory[/opt/gitlab/sv/gitaly/control] action create (up to date)
      * link[/opt/gitlab/init/gitaly] action create (up to date)
      * file[/opt/gitlab/sv/gitaly/down] action nothing (skipped due to action :nothing)
      * directory[/opt/gitlab/service] action create (up to date)
      * link[/opt/gitlab/service/gitaly] action create (up to date)
      * ruby_block[wait for gitaly service socket] action run (skipped due to not_if)
      * file[/var/log/gitlab/gitaly/current] action touch (skipped due to only_if)
[2025-07-12T20:44:32+03:00] INFO: ruby_block[restart_log_service] called
      [32m- execute the ruby block restart_log_service[0m
    * directory[/opt/gitlab/service] action create (up to date)
    * link[/opt/gitlab/service/gitaly] action create (up to date)
    * ruby_block[wait for gitaly service socket] action run (skipped due to not_if)
    * file[/var/log/gitlab/gitaly/current] action touch (skipped due to only_if)
  
  * execute[/opt/gitlab/bin/gitlab-ctl start gitaly] action run
    [execute] ok: run: gitaly: (pid 18454) 3s
[2025-07-12T20:44:33+03:00] INFO: execute[/opt/gitlab/bin/gitlab-ctl start gitaly] ran successfully
    [32m- execute /opt/gitlab/bin/gitlab-ctl start gitaly[0m
  * version_file[Create version file for Gitaly] action create
    * file[/var/opt/gitlab/gitaly/VERSION] action create[2025-07-12T20:44:35+03:00] INFO: file[/var/opt/gitlab/gitaly/VERSION] created file /var/opt/gitlab/gitaly/VERSION

      [32m- create new file /var/opt/gitlab/gitaly/VERSION[0m[2025-07-12T20:44:35+03:00] INFO: file[/var/opt/gitlab/gitaly/VERSION] updated file contents /var/opt/gitlab/gitaly/VERSION

      [32m- update content in file /var/opt/gitlab/gitaly/VERSION from none to 76116f[0m
      [37m--- /var/opt/gitlab/gitaly/VERSION	2025-07-12 20:44:35.021835988 +0300[0m
      [37m+++ /var/opt/gitlab/gitaly/.chef-VERSION20250712-17810-xf8pgk	2025-07-12 20:44:35.021835988 +0300[0m
      [37m@@ -1 +1,2 @@[0m
      [37m+sha256:fe7e669ce76eee9cdb4cbeca295546f81c9c99b667d5e06fe2d20117fa68ab88[0m
  
  * consul_service[gitaly] action delete
    * file[/var/opt/gitlab/consul/config.d/gitaly-service.json] action delete (up to date)
     (up to date)
Recipe: postgresql::bin
  * ruby_block[check_postgresql_version] action run (skipped due to not_if)
  * ruby_block[check_postgresql_version_is_deprecated] action run (skipped due to not_if)
  * ruby_block[Link postgresql bin files to the correct version] action run[2025-07-12T20:44:35+03:00] INFO: ruby_block[Link postgresql bin files to the correct version] called

    [32m- execute the ruby block Link postgresql bin files to the correct version[0m
  * template[/opt/gitlab/etc/gitlab-psql-rc] action create[2025-07-12T20:44:35+03:00] INFO: template[/opt/gitlab/etc/gitlab-psql-rc] created file /opt/gitlab/etc/gitlab-psql-rc

    [32m- create new file /opt/gitlab/etc/gitlab-psql-rc[0m[2025-07-12T20:44:35+03:00] INFO: template[/opt/gitlab/etc/gitlab-psql-rc] updated file contents /opt/gitlab/etc/gitlab-psql-rc

    [32m- update content in file /opt/gitlab/etc/gitlab-psql-rc from none to b7b8fc[0m
    [32m- suppressed sensitive resource[0m[2025-07-12T20:44:35+03:00] INFO: template[/opt/gitlab/etc/gitlab-psql-rc] owner changed to 0
[2025-07-12T20:44:35+03:00] INFO: template[/opt/gitlab/etc/gitlab-psql-rc] group changed to 0

    [32m- change owner from '' to 'root'[0m
    [32m- change group from '' to 'root'[0m
Recipe: postgresql::user
  * account[Postgresql user and group] action create
    * group[Postgresql user and group] action create[2025-07-12T20:44:35+03:00] INFO: group[Postgresql user and group] created

      [32m- create group gitlab-psql[0m
    * linux_user[Postgresql user and group] action create[2025-07-12T20:44:35+03:00] INFO: linux_user[Postgresql user and group] created

      [32m- create user gitlab-psql[0m
  
  * directory[/var/opt/gitlab/postgresql] action create[2025-07-12T20:44:35+03:00] INFO: directory[/var/opt/gitlab/postgresql] created directory /var/opt/gitlab/postgresql

    [32m- create new directory /var/opt/gitlab/postgresql[0m[2025-07-12T20:44:35+03:00] INFO: directory[/var/opt/gitlab/postgresql] owner changed to 992
[2025-07-12T20:44:35+03:00] INFO: directory[/var/opt/gitlab/postgresql] group changed to 989
[2025-07-12T20:44:35+03:00] INFO: directory[/var/opt/gitlab/postgresql] mode changed to 2775

    [32m- change mode from '' to '02775'[0m
    [32m- change owner from '' to 'gitlab-psql'[0m
    [32m- change group from '' to 'gitlab-psql'[0m
  * file[/var/opt/gitlab/postgresql/.profile] action create[2025-07-12T20:44:35+03:00] INFO: file[/var/opt/gitlab/postgresql/.profile] created file /var/opt/gitlab/postgresql/.profile

    [32m- create new file /var/opt/gitlab/postgresql/.profile[0m[2025-07-12T20:44:35+03:00] INFO: file[/var/opt/gitlab/postgresql/.profile] updated file contents /var/opt/gitlab/postgresql/.profile

    [32m- update content in file /var/opt/gitlab/postgresql/.profile from none to 3b0387[0m
    [37m--- /var/opt/gitlab/postgresql/.profile	2025-07-12 20:44:35.337835988 +0300[0m
    [37m+++ /var/opt/gitlab/postgresql/.chef-.profile20250712-17810-zvt6i3.profile	2025-07-12 20:44:35.337835988 +0300[0m
    [37m@@ -1 +1,2 @@[0m
    [37m+PATH=/opt/gitlab/embedded/bin:/opt/gitlab/bin:$PATH[0m[2025-07-12T20:44:35+03:00] INFO: file[/var/opt/gitlab/postgresql/.profile] owner changed to 992
[2025-07-12T20:44:35+03:00] INFO: file[/var/opt/gitlab/postgresql/.profile] mode changed to 600

    [32m- change mode from '' to '0600'[0m
    [32m- change owner from '' to 'gitlab-psql'[0m
Recipe: postgresql::sysctl
  * gitlab_sysctl[kernel.shmmax] action create
    * directory[create /etc/sysctl.d for kernel.shmmax] action create (up to date)
    * file[create /opt/gitlab/embedded/etc/90-omnibus-gitlab-kernel.shmmax.conf kernel.shmmax] action create[2025-07-12T20:44:35+03:00] INFO: file[create /opt/gitlab/embedded/etc/90-omnibus-gitlab-kernel.shmmax.conf kernel.shmmax] created file /opt/gitlab/embedded/etc/90-omnibus-gitlab-kernel.shmmax.conf

      [32m- create new file /opt/gitlab/embedded/etc/90-omnibus-gitlab-kernel.shmmax.conf[0m[2025-07-12T20:44:35+03:00] INFO: file[create /opt/gitlab/embedded/etc/90-omnibus-gitlab-kernel.shmmax.conf kernel.shmmax] updated file contents /opt/gitlab/embedded/etc/90-omnibus-gitlab-kernel.shmmax.conf

      [32m- update content in file /opt/gitlab/embedded/etc/90-omnibus-gitlab-kernel.shmmax.conf from none to 75a195[0m
      [37m--- /opt/gitlab/embedded/etc/90-omnibus-gitlab-kernel.shmmax.conf	2025-07-12 20:44:35.353835988 +0300[0m
      [37m+++ /opt/gitlab/embedded/etc/.chef-90-omnibus-gitlab-kernel20250712-17810-muuwnd.shmmax.conf	2025-07-12 20:44:35.353835988 +0300[0m
      [37m@@ -1 +1,2 @@[0m
      [37m+kernel.shmmax = 17179869184[0m
    * link[/etc/sysctl.d/90-omnibus-gitlab-kernel.shmmax.conf] action create[2025-07-12T20:44:35+03:00] INFO: link[/etc/sysctl.d/90-omnibus-gitlab-kernel.shmmax.conf] created

      [32m- create symlink at /etc/sysctl.d/90-omnibus-gitlab-kernel.shmmax.conf to /opt/gitlab/embedded/etc/90-omnibus-gitlab-kernel.shmmax.conf[0m
[2025-07-12T20:44:35+03:00] INFO: link[/etc/sysctl.d/90-omnibus-gitlab-kernel.shmmax.conf] not queuing delayed action run on execute[load sysctl conf kernel.shmmax] (delayed), as it's already been queued
[2025-07-12T20:44:35+03:00] INFO: link[/etc/sysctl.d/90-omnibus-gitlab-kernel.shmmax.conf] not queuing delayed action run on execute[reload all sysctl conf] (delayed), as it's already been queued
    * execute[load sysctl conf kernel.shmmax] action nothing (skipped due to action :nothing)
[2025-07-12T20:44:35+03:00] INFO: file[create /opt/gitlab/embedded/etc/90-omnibus-gitlab-kernel.shmmax.conf kernel.shmmax] sending run action to execute[load sysctl conf kernel.shmmax] (delayed)
    * execute[load sysctl conf kernel.shmmax] action run
      [execute] kernel.shmmax = 17179869184
[2025-07-12T20:44:35+03:00] INFO: execute[load sysctl conf kernel.shmmax] ran successfully
      [32m- execute sysctl -e -p /opt/gitlab/embedded/etc/90-omnibus-gitlab-kernel.shmmax.conf[0m
  
  * gitlab_sysctl[kernel.shmall] action create
    * directory[create /etc/sysctl.d for kernel.shmall] action create (up to date)
    * file[create /opt/gitlab/embedded/etc/90-omnibus-gitlab-kernel.shmall.conf kernel.shmall] action create[2025-07-12T20:44:35+03:00] INFO: file[create /opt/gitlab/embedded/etc/90-omnibus-gitlab-kernel.shmall.conf kernel.shmall] created file /opt/gitlab/embedded/etc/90-omnibus-gitlab-kernel.shmall.conf

      [32m- create new file /opt/gitlab/embedded/etc/90-omnibus-gitlab-kernel.shmall.conf[0m[2025-07-12T20:44:35+03:00] INFO: file[create /opt/gitlab/embedded/etc/90-omnibus-gitlab-kernel.shmall.conf kernel.shmall] updated file contents /opt/gitlab/embedded/etc/90-omnibus-gitlab-kernel.shmall.conf

      [32m- update content in file /opt/gitlab/embedded/etc/90-omnibus-gitlab-kernel.shmall.conf from none to 6d765d[0m
      [37m--- /opt/gitlab/embedded/etc/90-omnibus-gitlab-kernel.shmall.conf	2025-07-12 20:44:35.405835988 +0300[0m
      [37m+++ /opt/gitlab/embedded/etc/.chef-90-omnibus-gitlab-kernel20250712-17810-vhy07d.shmall.conf	2025-07-12 20:44:35.405835988 +0300[0m
      [37m@@ -1 +1,2 @@[0m
      [37m+kernel.shmall = 4194304[0m
[2025-07-12T20:44:35+03:00] INFO: file[create /opt/gitlab/embedded/etc/90-omnibus-gitlab-kernel.shmall.conf kernel.shmall] not queuing delayed action run on execute[reload all sysctl conf] (delayed), as it's already been queued
    * link[/etc/sysctl.d/90-omnibus-gitlab-kernel.shmall.conf] action create[2025-07-12T20:44:35+03:00] INFO: link[/etc/sysctl.d/90-omnibus-gitlab-kernel.shmall.conf] created

      [32m- create symlink at /etc/sysctl.d/90-omnibus-gitlab-kernel.shmall.conf to /opt/gitlab/embedded/etc/90-omnibus-gitlab-kernel.shmall.conf[0m
[2025-07-12T20:44:35+03:00] INFO: link[/etc/sysctl.d/90-omnibus-gitlab-kernel.shmall.conf] not queuing delayed action run on execute[load sysctl conf kernel.shmall] (delayed), as it's already been queued
[2025-07-12T20:44:35+03:00] INFO: link[/etc/sysctl.d/90-omnibus-gitlab-kernel.shmall.conf] not queuing delayed action run on execute[reload all sysctl conf] (delayed), as it's already been queued
    * execute[load sysctl conf kernel.shmall] action nothing (skipped due to action :nothing)
[2025-07-12T20:44:35+03:00] INFO: file[create /opt/gitlab/embedded/etc/90-omnibus-gitlab-kernel.shmall.conf kernel.shmall] sending run action to execute[load sysctl conf kernel.shmall] (delayed)
    * execute[load sysctl conf kernel.shmall] action run
      [execute] kernel.shmall = 4194304
[2025-07-12T20:44:35+03:00] INFO: execute[load sysctl conf kernel.shmall] ran successfully
      [32m- execute sysctl -e -p /opt/gitlab/embedded/etc/90-omnibus-gitlab-kernel.shmall.conf[0m
  
  * gitlab_sysctl[kernel.sem] action create
    * directory[create /etc/sysctl.d for kernel.sem] action create (up to date)
    * file[create /opt/gitlab/embedded/etc/90-omnibus-gitlab-kernel.sem.conf kernel.sem] action create[2025-07-12T20:44:35+03:00] INFO: file[create /opt/gitlab/embedded/etc/90-omnibus-gitlab-kernel.sem.conf kernel.sem] created file /opt/gitlab/embedded/etc/90-omnibus-gitlab-kernel.sem.conf

      [32m- create new file /opt/gitlab/embedded/etc/90-omnibus-gitlab-kernel.sem.conf[0m[2025-07-12T20:44:35+03:00] INFO: file[create /opt/gitlab/embedded/etc/90-omnibus-gitlab-kernel.sem.conf kernel.sem] updated file contents /opt/gitlab/embedded/etc/90-omnibus-gitlab-kernel.sem.conf

      [32m- update content in file /opt/gitlab/embedded/etc/90-omnibus-gitlab-kernel.sem.conf from none to 3b0a60[0m
      [37m--- /opt/gitlab/embedded/etc/90-omnibus-gitlab-kernel.sem.conf	2025-07-12 20:44:35.461835988 +0300[0m
      [37m+++ /opt/gitlab/embedded/etc/.chef-90-omnibus-gitlab-kernel20250712-17810-7dv8g2.sem.conf	2025-07-12 20:44:35.461835988 +0300[0m
      [37m@@ -1 +1,2 @@[0m
      [37m+kernel.sem = 250 32000 32 275[0m
[2025-07-12T20:44:35+03:00] INFO: file[create /opt/gitlab/embedded/etc/90-omnibus-gitlab-kernel.sem.conf kernel.sem] not queuing delayed action run on execute[reload all sysctl conf] (delayed), as it's already been queued
    * link[/etc/sysctl.d/90-omnibus-gitlab-kernel.sem.conf] action create[2025-07-12T20:44:35+03:00] INFO: link[/etc/sysctl.d/90-omnibus-gitlab-kernel.sem.conf] created

      [32m- create symlink at /etc/sysctl.d/90-omnibus-gitlab-kernel.sem.conf to /opt/gitlab/embedded/etc/90-omnibus-gitlab-kernel.sem.conf[0m
[2025-07-12T20:44:35+03:00] INFO: link[/etc/sysctl.d/90-omnibus-gitlab-kernel.sem.conf] not queuing delayed action run on execute[load sysctl conf kernel.sem] (delayed), as it's already been queued
[2025-07-12T20:44:35+03:00] INFO: link[/etc/sysctl.d/90-omnibus-gitlab-kernel.sem.conf] not queuing delayed action run on execute[reload all sysctl conf] (delayed), as it's already been queued
    * execute[load sysctl conf kernel.sem] action nothing (skipped due to action :nothing)
[2025-07-12T20:44:35+03:00] INFO: file[create /opt/gitlab/embedded/etc/90-omnibus-gitlab-kernel.sem.conf kernel.sem] sending run action to execute[load sysctl conf kernel.sem] (delayed)
    * execute[load sysctl conf kernel.sem] action run
      [execute] kernel.sem = 250 32000 32 275
[2025-07-12T20:44:35+03:00] INFO: execute[load sysctl conf kernel.sem] ran successfully
      [32m- execute sysctl -e -p /opt/gitlab/embedded/etc/90-omnibus-gitlab-kernel.sem.conf[0m
  
Recipe: postgresql::enable
  * directory[/var/opt/gitlab/postgresql] action create (up to date)
  * directory[/var/opt/gitlab/postgresql/data] action create[2025-07-12T20:44:35+03:00] INFO: directory[/var/opt/gitlab/postgresql/data] created directory /var/opt/gitlab/postgresql/data

    [32m- create new directory /var/opt/gitlab/postgresql/data[0m[2025-07-12T20:44:35+03:00] INFO: directory[/var/opt/gitlab/postgresql/data] owner changed to 992
[2025-07-12T20:44:35+03:00] INFO: directory[/var/opt/gitlab/postgresql/data] mode changed to 700

    [32m- change mode from '' to '0700'[0m
    [32m- change owner from '' to 'gitlab-psql'[0m
  * directory[/var/opt/gitlab/postgresql/data] action create (up to date)
  * directory[/var/log/gitlab/postgresql] action create[2025-07-12T20:44:35+03:00] INFO: directory[/var/log/gitlab/postgresql] created directory /var/log/gitlab/postgresql

    [32m- create new directory /var/log/gitlab/postgresql[0m[2025-07-12T20:44:35+03:00] INFO: directory[/var/log/gitlab/postgresql] owner changed to 992
[2025-07-12T20:44:35+03:00] INFO: directory[/var/log/gitlab/postgresql] mode changed to 700

    [32m- change mode from '' to '0700'[0m
    [32m- change owner from '' to 'gitlab-psql'[0m
  * execute[/opt/gitlab/embedded/bin/initdb -D /var/opt/gitlab/postgresql/data -E UTF8] action run
    [execute] The files belonging to this database system will be owned by user "gitlab-psql".
              This user must also own the server process.
              
              The database cluster will be initialized with locale "en_US.UTF-8".
              The default text search configuration will be set to "english".
              
              Data page checksums are disabled.
              
              fixing permissions on existing directory /var/opt/gitlab/postgresql/data ... ok
              creating subdirectories ... ok
              selecting dynamic shared memory implementation ... posix
              selecting default max_connections ... 100
              selecting default shared_buffers ... 128MB
              selecting default time zone ... Europe/Moscow
              creating configuration files ... ok
              running bootstrap script ... ok
              performing post-bootstrap initialization ... ok
              syncing data to disk ... ok
              
              
              Success. You can now start the database server using:
              
                  /opt/gitlab/embedded/bin/pg_ctl -D /var/opt/gitlab/postgresql/data -l logfile start
              
              initdb: warning: enabling "trust" authentication for local connections
              initdb: hint: You can change this by editing pg_hba.conf or using the option -A, or --auth-local and --auth-host, the next time you run initdb.
[2025-07-12T20:44:37+03:00] INFO: execute[/opt/gitlab/embedded/bin/initdb -D /var/opt/gitlab/postgresql/data -E UTF8] ran successfully
    [32m- execute /opt/gitlab/embedded/bin/initdb -D /var/opt/gitlab/postgresql/data -E UTF8[0m
  * file[/var/opt/gitlab/postgresql/data/server.crt] action create[2025-07-12T20:44:37+03:00] INFO: file[/var/opt/gitlab/postgresql/data/server.crt] created file /var/opt/gitlab/postgresql/data/server.crt

    [32m- create new file /var/opt/gitlab/postgresql/data/server.crt[0m[2025-07-12T20:44:37+03:00] INFO: file[/var/opt/gitlab/postgresql/data/server.crt] updated file contents /var/opt/gitlab/postgresql/data/server.crt

    [32m- update content in file /var/opt/gitlab/postgresql/data/server.crt from none to 3e88cf[0m
    [32m- suppressed sensitive resource[0m[2025-07-12T20:44:37+03:00] INFO: file[/var/opt/gitlab/postgresql/data/server.crt] owner changed to 992
[2025-07-12T20:44:37+03:00] INFO: file[/var/opt/gitlab/postgresql/data/server.crt] group changed to 989
[2025-07-12T20:44:37+03:00] INFO: file[/var/opt/gitlab/postgresql/data/server.crt] mode changed to 400

    [32m- change mode from '' to '0400'[0m
    [32m- change owner from '' to 'gitlab-psql'[0m
    [32m- change group from '' to 'gitlab-psql'[0m
  * file[/var/opt/gitlab/postgresql/data/server.key] action create[2025-07-12T20:44:37+03:00] INFO: file[/var/opt/gitlab/postgresql/data/server.key] created file /var/opt/gitlab/postgresql/data/server.key

    [32m- create new file /var/opt/gitlab/postgresql/data/server.key[0m[2025-07-12T20:44:37+03:00] INFO: file[/var/opt/gitlab/postgresql/data/server.key] updated file contents /var/opt/gitlab/postgresql/data/server.key

    [32m- update content in file /var/opt/gitlab/postgresql/data/server.key from none to 8a00c5[0m
    [32m- suppressed sensitive resource[0m[2025-07-12T20:44:37+03:00] INFO: file[/var/opt/gitlab/postgresql/data/server.key] owner changed to 992
[2025-07-12T20:44:37+03:00] INFO: file[/var/opt/gitlab/postgresql/data/server.key] group changed to 989
[2025-07-12T20:44:37+03:00] INFO: file[/var/opt/gitlab/postgresql/data/server.key] mode changed to 400

    [32m- change mode from '' to '0400'[0m
    [32m- change owner from '' to 'gitlab-psql'[0m
    [32m- change group from '' to 'gitlab-psql'[0m
  * postgresql_config[gitlab] action create
    * template[/var/opt/gitlab/postgresql/data/postgresql.conf] action create[2025-07-12T20:44:37+03:00] INFO: template[/var/opt/gitlab/postgresql/data/postgresql.conf] backed up to /opt/gitlab/embedded/cookbooks/cache/backup/var/opt/gitlab/postgresql/data/postgresql.conf.chef-20250712204437.244061
[2025-07-12T20:44:37+03:00] INFO: template[/var/opt/gitlab/postgresql/data/postgresql.conf] updated file contents /var/opt/gitlab/postgresql/data/postgresql.conf

      [32m- update content in file /var/opt/gitlab/postgresql/data/postgresql.conf from f3dac7 to 8fae77[0m
      [37m--- /var/opt/gitlab/postgresql/data/postgresql.conf	2025-07-12 20:44:35.693835988 +0300[0m
      [37m+++ /var/opt/gitlab/postgresql/data/.chef-postgresql20250712-17810-yxv9ro.conf	2025-07-12 20:44:37.221835988 +0300[0m
      [37m@@ -1,3 +1,7 @@[0m
      [37m+# This file is managed by gitlab-ctl. Manual changes will be[0m
      [37m+# erased! To change the contents below, edit /etc/gitlab/gitlab.rb[0m
      [37m+# and run `sudo gitlab-ctl reconfigure`.[0m
      [37m+[0m
      [37m # -----------------------------[0m
      [37m # PostgreSQL configuration file[0m
      [37m # -----------------------------[0m
      [37m@@ -16,19 +20,18 @@[0m
      [37m #[0m
      [37m # This file is read on server startup and when the server receives a SIGHUP[0m
      [37m # signal.  If you edit the file on a running system, you have to SIGHUP the[0m
      [37m-# server for the changes to take effect, run "pg_ctl reload", or execute[0m
      [37m-# "SELECT pg_reload_conf()".  Some parameters, which are marked below,[0m
      [37m-# require a server shutdown and restart to take effect.[0m
      [37m+# server for the changes to take effect, or use "pg_ctl reload".  Some[0m
      [37m+# parameters, which are marked below, require a server shutdown and restart to[0m
      [37m+# take effect.[0m
      [37m #[0m
      [37m # Any parameter can also be given as a command-line option to the server, e.g.,[0m
      [37m # "postgres -c log_connections=on".  Some parameters can be changed at run time[0m
      [37m # with the "SET" SQL command.[0m
      [37m #[0m
      [37m-# Memory units:  B  = bytes            Time units:  us  = microseconds[0m
      [37m-#                kB = kilobytes                     ms  = milliseconds[0m
      [37m+# Memory units:  kB = kilobytes        Time units:  ms  = milliseconds[0m
      [37m #                MB = megabytes                     s   = seconds[0m
      [37m #                GB = gigabytes                     min = minutes[0m
      [37m-#                TB = terabytes                     h   = hours[0m
      [37m+#                                                   h   = hours[0m
      [37m #                                                   d   = days[0m
      [37m [0m
      [37m [0m
      [37m@@ -39,16 +42,16 @@[0m
      [37m # The default values of these variables are driven from the -D command-line[0m
      [37m # option or PGDATA environment variable, represented here as ConfigDir.[0m
      [37m [0m
      [37m-#data_directory = 'ConfigDir'		# use data in another directory[0m
      [37m-					# (change requires restart)[0m
      [37m-#hba_file = 'ConfigDir/pg_hba.conf'	# host-based authentication file[0m
      [37m-					# (change requires restart)[0m
      [37m-#ident_file = 'ConfigDir/pg_ident.conf'	# ident configuration file[0m
      [37m-					# (change requires restart)[0m
      [37m+#data_directory = 'ConfigDir'   # use data in another directory[0m
      [37m+          # (change requires restart)[0m
      [37m+#hba_file = 'ConfigDir/pg_hba.conf' # host-based authentication file[0m
      [37m+          # (change requires restart)[0m
      [37m+#ident_file = 'ConfigDir/pg_ident.conf' # ident configuration file[0m
      [37m+          # (change requires restart)[0m
      [37m [0m
      [37m # If external_pid_file is not explicitly set, no extra PID file is written.[0m
      [37m-#external_pid_file = ''			# write an extra PID file[0m
      [37m-					# (change requires restart)[0m
      [37m+#external_pid_file = '(none)'   # write an extra PID file[0m
      [37m+          # (change requires restart)[0m
      [37m [0m
      [37m [0m
      [37m #------------------------------------------------------------------------------[0m
      [37m@@ -57,68 +60,57 @@[0m
      [37m [0m
      [37m # - Connection Settings -[0m
      [37m [0m
      [37m-#listen_addresses = 'localhost'		# what IP address(es) to listen on;[0m
      [37m-					# comma-separated list of addresses;[0m
      [37m-					# defaults to 'localhost'; use '*' for all[0m
      [37m-					# (change requires restart)[0m
      [37m-#port = 5432				# (change requires restart)[0m
      [37m-max_connections = 100			# (change requires restart)[0m
      [37m-#reserved_connections = 0		# (change requires restart)[0m
      [37m-#superuser_reserved_connections = 3	# (change requires restart)[0m
      [37m-#unix_socket_directories = '/tmp'	# comma-separated list of directories[0m
      [37m-					# (change requires restart)[0m
      [37m-#unix_socket_group = ''			# (change requires restart)[0m
      [37m-#unix_socket_permissions = 0777		# begin with 0 to use octal notation[0m
      [37m-					# (change requires restart)[0m
      [37m-#bonjour = off				# advertise server via Bonjour[0m
      [37m-					# (change requires restart)[0m
      [37m-#bonjour_name = ''			# defaults to the computer name[0m
      [37m-					# (change requires restart)[0m
      [37m+listen_addresses = ''    # what IP address(es) to listen on;[0m
      [37m+          # comma-separated list of addresses;[0m
      [37m+          # defaults to 'localhost', '*' = all[0m
      [37m+          # (change requires restart)[0m
      [37m+port = 5432        # (change requires restart)[0m
      [37m+max_connections = 400      # (change requires restart)[0m
      [37m+# Note:  Increasing max_connections costs ~400 bytes of shared memory per[0m
      [37m+# connection slot, plus lock space (see max_locks_per_transaction).[0m
      [37m+#superuser_reserved_connections = 3 # (change requires restart)[0m
      [37m+unix_socket_directories = '/var/opt/gitlab/postgresql'   # (change requires restart)[0m
      [37m+#unix_socket_group = ''     # (change requires restart)[0m
      [37m+#unix_socket_permissions = 0777   # begin with 0 to use octal notation[0m
      [37m+          # (change requires restart)[0m
      [37m+#bonjour = off        # advertise server via Bonjour[0m
      [37m+          # (change requires restart)[0m
      [37m+#bonjour_name = ''      # defaults to the computer name[0m
      [37m+          # (change requires restart)[0m
      [37m [0m
      [37m-# - TCP settings -[0m
      [37m-# see "man tcp" for details[0m
      [37m+# - Security and Authentication -[0m
      [37m [0m
      [37m-#tcp_keepalives_idle = 0		# TCP_KEEPIDLE, in seconds;[0m
      [37m-					# 0 selects the system default[0m
      [37m-#tcp_keepalives_interval = 0		# TCP_KEEPINTVL, in seconds;[0m
      [37m-					# 0 selects the system default[0m
      [37m-#tcp_keepalives_count = 0		# TCP_KEEPCNT;[0m
      [37m-					# 0 selects the system default[0m
      [37m-#tcp_user_timeout = 0			# TCP_USER_TIMEOUT, in milliseconds;[0m
      [37m-					# 0 selects the system default[0m
      [37m+#authentication_timeout = 1min    # 1s-600s[0m
      [37m [0m
      [37m-#client_connection_check_interval = 0	# time between checks for client[0m
      [37m-					# disconnection while running queries;[0m
      [37m-					# 0 for never[0m
      [37m+# change requires restart[0m
      [37m+ssl = on[0m
      [37m [0m
      [37m-# - Authentication -[0m
      [37m+# allowed SSL ciphers[0m
      [37m+ssl_ciphers = 'HIGH:MEDIUM:+3DES:!aNULL:!SSLv3:!TLSv1'[0m
      [37m [0m
      [37m-#authentication_timeout = 1min		# 1s-600s[0m
      [37m-#password_encryption = scram-sha-256	# scram-sha-256 or md5[0m
      [37m-#scram_iterations = 4096[0m
      [37m+ssl_cert_file = 'server.crt'[0m
      [37m+ssl_key_file = 'server.key'[0m
      [37m+ssl_ca_file = '/opt/gitlab/embedded/ssl/certs/cacert.pem'[0m
      [37m+[0m
      [37m+[0m
      [37m+#ssl_renegotiation_limit = 512MB  # amount of data between renegotiations[0m
      [37m+#password_encryption = on[0m
      [37m #db_user_namespace = off[0m
      [37m [0m
      [37m-# GSSAPI using Kerberos[0m
      [37m-#krb_server_keyfile = 'FILE:${sysconfdir}/krb5.keytab'[0m
      [37m+# Kerberos and GSSAPI[0m
      [37m+#krb_server_keyfile = ''[0m
      [37m+#krb_srvname = 'postgres'   # (Kerberos only)[0m
      [37m #krb_caseins_users = off[0m
      [37m-#gss_accept_delegation = off[0m
      [37m [0m
      [37m-# - SSL -[0m
      [37m+# - TCP Keepalives -[0m
      [37m+# see "man 7 tcp" for details[0m
      [37m [0m
      [37m-#ssl = off[0m
      [37m-#ssl_ca_file = ''[0m
      [37m-#ssl_cert_file = 'server.crt'[0m
      [37m-#ssl_crl_file = ''[0m
      [37m-#ssl_crl_dir = ''[0m
      [37m-#ssl_key_file = 'server.key'[0m
      [37m-#ssl_ciphers = 'HIGH:MEDIUM:+3DES:!aNULL' # allowed SSL ciphers[0m
      [37m-#ssl_prefer_server_ciphers = on[0m
      [37m-#ssl_ecdh_curve = 'prime256v1'[0m
      [37m-#ssl_min_protocol_version = 'TLSv1.2'[0m
      [37m-#ssl_max_protocol_version = ''[0m
      [37m-#ssl_dh_params_file = ''[0m
      [37m-#ssl_passphrase_command = ''[0m
      [37m-#ssl_passphrase_command_supports_reload = off[0m
      [37m+#tcp_keepalives_idle = 0    # TCP_KEEPIDLE, in seconds;[0m
      [37m+          # 0 selects the system default[0m
      [37m+#tcp_keepalives_interval = 0    # TCP_KEEPINTVL, in seconds;[0m
      [37m+          # 0 selects the system default[0m
      [37m+#tcp_keepalives_count = 0   # TCP_KEEPCNT;[0m
      [37m+          # 0 selects the system default[0m
      [37m [0m
      [37m [0m
      [37m #------------------------------------------------------------------------------[0m
      [37m@@ -127,630 +119,290 @@[0m
      [37m [0m
      [37m # - Memory -[0m
      [37m [0m
      [37m-shared_buffers = 128MB			# min 128kB[0m
      [37m-					# (change requires restart)[0m
      [37m-#huge_pages = try			# on, off, or try[0m
      [37m-					# (change requires restart)[0m
      [37m-#huge_page_size = 0			# zero for system default[0m
      [37m-					# (change requires restart)[0m
      [37m-#temp_buffers = 8MB			# min 800kB[0m
      [37m-#max_prepared_transactions = 0		# zero disables the feature[0m
      [37m-					# (change requires restart)[0m
      [37m-# Caution: it is not advisable to set max_prepared_transactions nonzero unless[0m
      [37m-# you actively intend to use prepared transactions.[0m
      [37m-#work_mem = 4MB				# min 64kB[0m
      [37m-#hash_mem_multiplier = 2.0		# 1-1000.0 multiplier on hash table work_mem[0m
      [37m-#maintenance_work_mem = 64MB		# min 1MB[0m
      [37m-#autovacuum_work_mem = -1		# min 1MB, or -1 to use maintenance_work_mem[0m
      [37m-#logical_decoding_work_mem = 64MB	# min 64kB[0m
      [37m-#max_stack_depth = 2MB			# min 100kB[0m
      [37m-#shared_memory_type = mmap		# the default is the first option[0m
      [37m-					# supported by the operating system:[0m
      [37m-					#   mmap[0m
      [37m-					#   sysv[0m
      [37m-					#   windows[0m
      [37m-					# (change requires restart)[0m
      [37m-dynamic_shared_memory_type = posix	# the default is usually the first option[0m
      [37m-					# supported by the operating system:[0m
      [37m-					#   posix[0m
      [37m-					#   sysv[0m
      [37m-					#   windows[0m
      [37m-					#   mmap[0m
      [37m-					# (change requires restart)[0m
      [37m-#min_dynamic_shared_memory = 0MB	# (change requires restart)[0m
      [37m-#vacuum_buffer_usage_limit = 256kB	# size of vacuum and analyze buffer access strategy ring;[0m
      [37m-					# 0 to disable vacuum buffer access strategy;[0m
      [37m-					# range 128kB to 16GB[0m
      [37m+shared_buffers = 978MB # min 128kB[0m
      [37m+          # (change requires restart)[0m
      [37m+#temp_buffers = 8MB     # min 800kB[0m
      [37m+#max_prepared_transactions = 0    # zero disables the feature[0m
      [37m+          # (change requires restart)[0m
      [37m+# Note:  Increasing max_prepared_transactions costs ~600 bytes of shared memory[0m
      [37m+# per transaction slot, plus lock space (see max_locks_per_transaction).[0m
      [37m+# It is not advisable to set max_prepared_transactions nonzero unless you[0m
      [37m+# actively intend to use prepared transactions.[0m
      [37m+#max_stack_depth = 2MB      # min 100kB[0m
      [37m [0m
      [37m-# - Disk -[0m
      [37m+# - Kernel Resource Usage -[0m
      [37m [0m
      [37m-#temp_file_limit = -1			# limits per-process temp file space[0m
      [37m-					# in kilobytes, or -1 for no limit[0m
      [37m+#max_files_per_process = 1000   # min 25[0m
      [37m+          # (change requires restart)[0m
      [37m+shared_preload_libraries = ''    # (change requires restart)[0m
      [37m [0m
      [37m-# - Kernel Resources -[0m
      [37m-[0m
      [37m-#max_files_per_process = 1000		# min 64[0m
      [37m-					# (change requires restart)[0m
      [37m-[0m
      [37m # - Cost-Based Vacuum Delay -[0m
      [37m [0m
      [37m-#vacuum_cost_delay = 0			# 0-100 milliseconds (0 disables)[0m
      [37m-#vacuum_cost_page_hit = 1		# 0-10000 credits[0m
      [37m-#vacuum_cost_page_miss = 2		# 0-10000 credits[0m
      [37m-#vacuum_cost_page_dirty = 20		# 0-10000 credits[0m
      [37m-#vacuum_cost_limit = 200		# 1-10000 credits[0m
      [37m+#vacuum_cost_delay = 0ms    # 0-100 milliseconds[0m
      [37m+#vacuum_cost_page_hit = 1   # 0-10000 credits[0m
      [37m+#vacuum_cost_page_miss = 10   # 0-10000 credits[0m
      [37m+#vacuum_cost_page_dirty = 20    # 0-10000 credits[0m
      [37m+#vacuum_cost_limit = 200    # 1-10000 credits[0m
      [37m [0m
      [37m # - Background Writer -[0m
      [37m [0m
      [37m-#bgwriter_delay = 200ms			# 10-10000ms between rounds[0m
      [37m-#bgwriter_lru_maxpages = 100		# max buffers written/round, 0 disables[0m
      [37m-#bgwriter_lru_multiplier = 2.0		# 0-10.0 multiplier on buffers scanned/round[0m
      [37m-#bgwriter_flush_after = 512kB		# measured in pages, 0 disables[0m
      [37m+#bgwriter_delay = 200ms     # 10-10000ms between rounds[0m
      [37m+#bgwriter_lru_maxpages = 100    # 0-1000 max buffers written/round[0m
      [37m+#bgwriter_lru_multiplier = 2.0    # 0-10.0 multipler on buffers scanned/round[0m
      [37m [0m
      [37m # - Asynchronous Behavior -[0m
      [37m [0m
      [37m-#backend_flush_after = 0		# measured in pages, 0 disables[0m
      [37m-#effective_io_concurrency = 1		# 1-1000; 0 disables prefetching[0m
      [37m-#maintenance_io_concurrency = 10	# 1-1000; 0 disables prefetching[0m
      [37m-#max_worker_processes = 8		# (change requires restart)[0m
      [37m-#max_parallel_workers_per_gather = 2	# limited by max_parallel_workers[0m
      [37m-#max_parallel_maintenance_workers = 2	# limited by max_parallel_workers[0m
      [37m-#max_parallel_workers = 8		# number of max_worker_processes that[0m
      [37m-					# can be used in parallel operations[0m
      [37m-#parallel_leader_participation = on[0m
      [37m-#old_snapshot_threshold = -1		# 1min-60d; -1 disables; 0 is immediate[0m
      [37m-					# (change requires restart)[0m
      [37m+#effective_io_concurrency = 1   # 1-1000. 0 disables prefetching[0m
      [37m [0m
      [37m [0m
      [37m #------------------------------------------------------------------------------[0m
      [37m-# WRITE-AHEAD LOG[0m
      [37m+# WRITE AHEAD LOG[0m
      [37m #------------------------------------------------------------------------------[0m
      [37m [0m
      [37m # - Settings -[0m
      [37m [0m
      [37m-#wal_level = replica			# minimal, replica, or logical[0m
      [37m-					# (change requires restart)[0m
      [37m-#fsync = on				# flush data to disk for crash safety[0m
      [37m-					# (turning this off can cause[0m
      [37m-					# unrecoverable data corruption)[0m
      [37m-#synchronous_commit = on		# synchronization level;[0m
      [37m-					# off, local, remote_write, remote_apply, or on[0m
      [37m-#wal_sync_method = fsync		# the default is the first option[0m
      [37m-					# supported by the operating system:[0m
      [37m-					#   open_datasync[0m
      [37m-					#   fdatasync (default on Linux and FreeBSD)[0m
      [37m-					#   fsync[0m
      [37m-					#   fsync_writethrough[0m
      [37m-					#   open_sync[0m
      [37m-#full_page_writes = on			# recover from partial page writes[0m
      [37m-#wal_log_hints = off			# also do full page writes of non-critical updates[0m
      [37m-					# (change requires restart)[0m
      [37m-#wal_compression = off			# enables compression of full-page writes;[0m
      [37m-					# off, pglz, lz4, zstd, or on[0m
      [37m-#wal_init_zero = on			# zero-fill new WAL files[0m
      [37m-#wal_recycle = on			# recycle WAL files[0m
      [37m-#wal_buffers = -1			# min 32kB, -1 sets based on shared_buffers[0m
      [37m-					# (change requires restart)[0m
      [37m-#wal_writer_delay = 200ms		# 1-10000 milliseconds[0m
      [37m-#wal_writer_flush_after = 1MB		# measured in pages, 0 disables[0m
      [37m-#wal_skip_threshold = 2MB[0m
      [37m+wal_level = minimal[0m
      [37m+wal_log_hints = off      # also do full page writes of non-critical updates[0m
      [37m+          # (change requires restart)[0m
      [37m+#fsync = on       # turns forced synchronization on or off[0m
      [37m+#wal_sync_method = fsync    # the default is the first option[0m
      [37m+          # supported by the operating system:[0m
      [37m+          #   open_datasync[0m
      [37m+          #   fdatasync (default on Linux)[0m
      [37m+          #   fsync[0m
      [37m+          #   fsync_writethrough[0m
      [37m+          #   open_sync[0m
      [37m+#full_page_writes = on      # recover from partial page writes[0m
      [37m+wal_buffers = -1 # -1     # min 32kB, -1 sets based on shared_buffers[0m
      [37m+          # (change requires restart)[0m
      [37m+#wal_writer_delay = 200ms   # 1-10000 milliseconds[0m
      [37m [0m
      [37m-#commit_delay = 0			# range 0-100000, in microseconds[0m
      [37m-#commit_siblings = 5			# range 1-1000[0m
      [37m+#commit_delay = 0     # range 0-100000, in microseconds[0m
      [37m+#commit_siblings = 5      # range 1-1000[0m
      [37m [0m
      [37m-# - Checkpoints -[0m
      [37m-[0m
      [37m-#checkpoint_timeout = 5min		# range 30s-1d[0m
      [37m-#checkpoint_completion_target = 0.9	# checkpoint target duration, 0.0 - 1.0[0m
      [37m-#checkpoint_flush_after = 256kB		# measured in pages, 0 disables[0m
      [37m-#checkpoint_warning = 30s		# 0 disables[0m
      [37m-max_wal_size = 1GB[0m
      [37m min_wal_size = 80MB[0m
      [37m+max_wal_size = 1GB[0m
      [37m [0m
      [37m-# - Prefetching during recovery -[0m
      [37m+# The number of replication slots to reserve.[0m
      [37m+max_replication_slots = 0[0m
      [37m [0m
      [37m-#recovery_prefetch = try		# prefetch pages referenced in the WAL?[0m
      [37m-#wal_decode_buffer_size = 512kB		# lookahead window used for prefetching[0m
      [37m-					# (change requires restart)[0m
      [37m [0m
      [37m # - Archiving -[0m
      [37m [0m
      [37m-#archive_mode = off		# enables archiving; off, on, or always[0m
      [37m-				# (change requires restart)[0m
      [37m-#archive_library = ''		# library to use to archive a WAL file[0m
      [37m-				# (empty string indicates archive_command should[0m
      [37m-				# be used)[0m
      [37m-#archive_command = ''		# command to use to archive a WAL file[0m
      [37m-				# placeholders: %p = path of file to archive[0m
      [37m-				#               %f = file name only[0m
      [37m-				# e.g. 'test ! -f /mnt/server/archivedir/%f && cp %p /mnt/server/archivedir/%f'[0m
      [37m-#archive_timeout = 0		# force a WAL file switch after this[0m
      [37m-				# number of seconds; 0 disables[0m
      [37m+archive_mode = off   # allows archiving to be done[0m
      [37m+        # (change requires restart, also requires 'wal_level' of 'hot_standby' OR 'replica')[0m
      [37m [0m
      [37m-# - Archive Recovery -[0m
      [37m-[0m
      [37m-# These are only used in recovery mode.[0m
      [37m-[0m
      [37m-#restore_command = ''		# command to use to restore an archived WAL file[0m
      [37m-				# placeholders: %p = path of file to restore[0m
      [37m-				#               %f = file name only[0m
      [37m-				# e.g. 'cp /mnt/server/archivedir/%f %p'[0m
      [37m-#archive_cleanup_command = ''	# command to execute at every restartpoint[0m
      [37m-#recovery_end_command = ''	# command to execute at completion of recovery[0m
      [37m-[0m
      [37m-# - Recovery Target -[0m
      [37m-[0m
      [37m-# Set these only when performing a targeted recovery.[0m
      [37m-[0m
      [37m-#recovery_target = ''		# 'immediate' to end recovery as soon as a[0m
      [37m-                                # consistent state is reached[0m
      [37m-				# (change requires restart)[0m
      [37m-#recovery_target_name = ''	# the named restore point to which recovery will proceed[0m
      [37m-				# (change requires restart)[0m
      [37m-#recovery_target_time = ''	# the time stamp up to which recovery will proceed[0m
      [37m-				# (change requires restart)[0m
      [37m-#recovery_target_xid = ''	# the transaction ID up to which recovery will proceed[0m
      [37m-				# (change requires restart)[0m
      [37m-#recovery_target_lsn = ''	# the WAL LSN up to which recovery will proceed[0m
      [37m-				# (change requires restart)[0m
      [37m-#recovery_target_inclusive = on # Specifies whether to stop:[0m
      [37m-				# just after the specified recovery target (on)[0m
      [37m-				# just before the recovery target (off)[0m
      [37m-				# (change requires restart)[0m
      [37m-#recovery_target_timeline = 'latest'	# 'current', 'latest', or timeline ID[0m
      [37m-				# (change requires restart)[0m
      [37m-#recovery_target_action = 'pause'	# 'pause', 'promote', 'shutdown'[0m
      [37m-				# (change requires restart)[0m
      [37m-[0m
      [37m-[0m
      [37m #------------------------------------------------------------------------------[0m
      [37m # REPLICATION[0m
      [37m #------------------------------------------------------------------------------[0m
      [37m [0m
      [37m-# - Sending Servers -[0m
      [37m+# - Master Server -[0m
      [37m [0m
      [37m-# Set these on the primary and on any standby that will send replication data.[0m
      [37m+# These settings are ignored on a standby server[0m
      [37m [0m
      [37m-#max_wal_senders = 10		# max number of walsender processes[0m
      [37m-				# (change requires restart)[0m
      [37m-#max_replication_slots = 10	# max number of replication slots[0m
      [37m-				# (change requires restart)[0m
      [37m-#wal_keep_size = 0		# in megabytes; 0 disables[0m
      [37m-#max_slot_wal_keep_size = -1	# in megabytes; -1 disables[0m
      [37m-#wal_sender_timeout = 60s	# in milliseconds; 0 disables[0m
      [37m-#track_commit_timestamp = off	# collect timestamp of transaction commit[0m
      [37m-				# (change requires restart)[0m
      [37m+max_wal_senders = 0[0m
      [37m+        # (change requires restart)[0m
      [37m+#wal_sender_delay = 1s    # walsender cycle time, 1-10000 milliseconds[0m
      [37m+#vacuum_defer_cleanup_age = 0 # number of xacts by which cleanup is delayed[0m
      [37m+#replication_timeout = 60s  # in milliseconds; 0 disables[0m
      [37m+#synchronous_standby_names = '' # standby servers that provide sync rep[0m
      [37m+        # comma-separated list of application_name[0m
      [37m+        # from standby(s); '*' = all[0m
      [37m [0m
      [37m-# - Primary Server -[0m
      [37m-[0m
      [37m-# These settings are ignored on a standby server.[0m
      [37m-[0m
      [37m-#synchronous_standby_names = ''	# standby servers that provide sync rep[0m
      [37m-				# method to choose sync standbys, number of sync standbys,[0m
      [37m-				# and comma-separated list of application_name[0m
      [37m-				# from standby(s); '*' = all[0m
      [37m-[0m
      [37m # - Standby Servers -[0m
      [37m [0m
      [37m-# These settings are ignored on a primary server.[0m
      [37m+# These settings are ignored on a master server[0m
      [37m [0m
      [37m-#primary_conninfo = ''			# connection string to sending server[0m
      [37m-#primary_slot_name = ''			# replication slot on sending server[0m
      [37m-#hot_standby = on			# "off" disallows queries during recovery[0m
      [37m-					# (change requires restart)[0m
      [37m-#max_standby_archive_delay = 30s	# max delay before canceling queries[0m
      [37m-					# when reading WAL from archive;[0m
      [37m-					# -1 allows indefinite delay[0m
      [37m-#max_standby_streaming_delay = 30s	# max delay before canceling queries[0m
      [37m-					# when reading streaming WAL;[0m
      [37m-					# -1 allows indefinite delay[0m
      [37m-#wal_receiver_create_temp_slot = off	# create temp slot if primary_slot_name[0m
      [37m-					# is not set[0m
      [37m-#wal_receiver_status_interval = 10s	# send replies at least this often[0m
      [37m-					# 0 disables[0m
      [37m-#hot_standby_feedback = off		# send info from standby to prevent[0m
      [37m-					# query conflicts[0m
      [37m-#wal_receiver_timeout = 60s		# time that receiver waits for[0m
      [37m-					# communication from primary[0m
      [37m-					# in milliseconds; 0 disables[0m
      [37m-#wal_retrieve_retry_interval = 5s	# time to wait before retrying to[0m
      [37m-					# retrieve WAL after a failed attempt[0m
      [37m-#recovery_min_apply_delay = 0		# minimum delay for applying changes during recovery[0m
      [37m+hot_standby = off[0m
      [37m+          # (change requires restart)[0m
      [37m+#wal_receiver_status_interval = 10s # send replies at least this often[0m
      [37m+          # 0 disables[0m
      [37m [0m
      [37m-# - Subscribers -[0m
      [37m-[0m
      [37m-# These settings are ignored on a publisher.[0m
      [37m-[0m
      [37m-#max_logical_replication_workers = 4	# taken from max_worker_processes[0m
      [37m-					# (change requires restart)[0m
      [37m-#max_sync_workers_per_subscription = 2	# taken from max_logical_replication_workers[0m
      [37m-#max_parallel_apply_workers_per_subscription = 2	# taken from max_logical_replication_workers[0m
      [37m-[0m
      [37m-[0m
      [37m #------------------------------------------------------------------------------[0m
      [37m # QUERY TUNING[0m
      [37m #------------------------------------------------------------------------------[0m
      [37m [0m
      [37m # - Planner Method Configuration -[0m
      [37m [0m
      [37m-#enable_async_append = on[0m
      [37m #enable_bitmapscan = on[0m
      [37m-#enable_gathermerge = on[0m
      [37m #enable_hashagg = on[0m
      [37m #enable_hashjoin = on[0m
      [37m-#enable_incremental_sort = on[0m
      [37m #enable_indexscan = on[0m
      [37m-#enable_indexonlyscan = on[0m
      [37m #enable_material = on[0m
      [37m-#enable_memoize = on[0m
      [37m #enable_mergejoin = on[0m
      [37m #enable_nestloop = on[0m
      [37m-#enable_parallel_append = on[0m
      [37m-#enable_parallel_hash = on[0m
      [37m-#enable_partition_pruning = on[0m
      [37m-#enable_partitionwise_join = off[0m
      [37m-#enable_partitionwise_aggregate = off[0m
      [37m-#enable_presorted_aggregate = on[0m
      [37m #enable_seqscan = on[0m
      [37m #enable_sort = on[0m
      [37m #enable_tidscan = on[0m
      [37m [0m
      [37m # - Planner Cost Constants -[0m
      [37m [0m
      [37m-#seq_page_cost = 1.0			# measured on an arbitrary scale[0m
      [37m-#random_page_cost = 4.0			# same scale as above[0m
      [37m-#cpu_tuple_cost = 0.01			# same scale as above[0m
      [37m-#cpu_index_tuple_cost = 0.005		# same scale as above[0m
      [37m-#cpu_operator_cost = 0.0025		# same scale as above[0m
      [37m-#parallel_setup_cost = 1000.0	# same scale as above[0m
      [37m-#parallel_tuple_cost = 0.1		# same scale as above[0m
      [37m-#min_parallel_table_scan_size = 8MB[0m
      [37m-#min_parallel_index_scan_size = 512kB[0m
      [37m-#effective_cache_size = 4GB[0m
      [37m+#cpu_tuple_cost = 0.01      # same scale as above[0m
      [37m+#cpu_index_tuple_cost = 0.005   # same scale as above[0m
      [37m+#cpu_operator_cost = 0.0025   # same scale as above[0m
      [37m [0m
      [37m-#jit_above_cost = 100000		# perform JIT compilation if available[0m
      [37m-					# and query more expensive than this;[0m
      [37m-					# -1 disables[0m
      [37m-#jit_inline_above_cost = 500000		# inline small functions if query is[0m
      [37m-					# more expensive than this; -1 disables[0m
      [37m-#jit_optimize_above_cost = 500000	# use expensive JIT optimizations if[0m
      [37m-					# query is more expensive than this;[0m
      [37m-					# -1 disables[0m
      [37m-[0m
      [37m # - Genetic Query Optimizer -[0m
      [37m [0m
      [37m #geqo = on[0m
      [37m #geqo_threshold = 12[0m
      [37m-#geqo_effort = 5			# range 1-10[0m
      [37m-#geqo_pool_size = 0			# selects default based on effort[0m
      [37m-#geqo_generations = 0			# selects default based on effort[0m
      [37m-#geqo_selection_bias = 2.0		# range 1.5-2.0[0m
      [37m-#geqo_seed = 0.0			# range 0.0-1.0[0m
      [37m+#geqo_effort = 5      # range 1-10[0m
      [37m+#geqo_pool_size = 0     # selects default based on effort[0m
      [37m+#geqo_generations = 0     # selects default based on effort[0m
      [37m+#geqo_selection_bias = 2.0    # range 1.5-2.0[0m
      [37m+#geqo_seed = 0.0      # range 0.0-1.0[0m
      [37m [0m
      [37m # - Other Planner Options -[0m
      [37m [0m
      [37m-#default_statistics_target = 100	# range 1-10000[0m
      [37m-#constraint_exclusion = partition	# on, off, or partition[0m
      [37m-#cursor_tuple_fraction = 0.1		# range 0.0-1.0[0m
      [37m+#default_statistics_target = 100  # range 1-10000[0m
      [37m+#constraint_exclusion = partition # on, off, or partition[0m
      [37m+#cursor_tuple_fraction = 0.1    # range 0.0-1.0[0m
      [37m #from_collapse_limit = 8[0m
      [37m-#jit = on				# allow JIT compilation[0m
      [37m-#join_collapse_limit = 8		# 1 disables collapsing of explicit[0m
      [37m-					# JOIN clauses[0m
      [37m-#plan_cache_mode = auto			# auto, force_generic_plan or[0m
      [37m-					# force_custom_plan[0m
      [37m-#recursive_worktable_factor = 10.0	# range 0.001-1000000[0m
      [37m+#join_collapse_limit = 8    # 1 disables collapsing of explicit[0m
      [37m+          # JOIN clauses[0m
      [37m [0m
      [37m [0m
      [37m #------------------------------------------------------------------------------[0m
      [37m-# REPORTING AND LOGGING[0m
      [37m+# ERROR REPORTING AND LOGGING[0m
      [37m #------------------------------------------------------------------------------[0m
      [37m [0m
      [37m-# - Where to Log -[0m
      [37m [0m
      [37m-#log_destination = 'stderr'		# Valid values are combinations of[0m
      [37m-					# stderr, csvlog, jsonlog, syslog, and[0m
      [37m-					# eventlog, depending on platform.[0m
      [37m-					# csvlog and jsonlog require[0m
      [37m-					# logging_collector to be on.[0m
      [37m-[0m
      [37m-# This is used when logging to stderr:[0m
      [37m-#logging_collector = off		# Enable capturing of stderr, jsonlog,[0m
      [37m-					# and csvlog into log files. Required[0m
      [37m-					# to be on for csvlogs and jsonlogs.[0m
      [37m-					# (change requires restart)[0m
      [37m-[0m
      [37m-# These are only used if logging_collector is on:[0m
      [37m-#log_directory = 'log'			# directory where log files are written,[0m
      [37m-					# can be absolute or relative to PGDATA[0m
      [37m-#log_filename = 'postgresql-%Y-%m-%d_%H%M%S.log'	# log file name pattern,[0m
      [37m-					# can include strftime() escapes[0m
      [37m-#log_file_mode = 0600			# creation mode for log files,[0m
      [37m-					# begin with 0 to use octal notation[0m
      [37m-#log_rotation_age = 1d			# Automatic rotation of logfiles will[0m
      [37m-					# happen after that time.  0 disables.[0m
      [37m-#log_rotation_size = 10MB		# Automatic rotation of logfiles will[0m
      [37m-					# happen after that much log output.[0m
      [37m-					# 0 disables.[0m
      [37m-#log_truncate_on_rotation = off		# If on, an existing log file with the[0m
      [37m-					# same name as the new log file will be[0m
      [37m-					# truncated rather than appended to.[0m
      [37m-					# But such truncation only occurs on[0m
      [37m-					# time-driven rotation, not on restarts[0m
      [37m-					# or size-driven rotation.  Default is[0m
      [37m-					# off, meaning append to existing files[0m
      [37m-					# in all cases.[0m
      [37m-[0m
      [37m # These are relevant when logging to syslog:[0m
      [37m #syslog_facility = 'LOCAL0'[0m
      [37m #syslog_ident = 'postgres'[0m
      [37m-#syslog_sequence_numbers = on[0m
      [37m-#syslog_split_messages = on[0m
      [37m [0m
      [37m-# This is only relevant when logging to eventlog (Windows):[0m
      [37m-# (change requires restart)[0m
      [37m-#event_source = 'PostgreSQL'[0m
      [37m+#silent_mode = off      # Run server silently.[0m
      [37m+          # DO NOT USE without syslog or[0m
      [37m+          # logging_collector[0m
      [37m+          # (change requires restart)[0m
      [37m [0m
      [37m+[0m
      [37m # - When to Log -[0m
      [37m [0m
      [37m-#log_min_messages = warning		# values in order of decreasing detail:[0m
      [37m-					#   debug5[0m
      [37m-					#   debug4[0m
      [37m-					#   debug3[0m
      [37m-					#   debug2[0m
      [37m-					#   debug1[0m
      [37m-					#   info[0m
      [37m-					#   notice[0m
      [37m-					#   warning[0m
      [37m-					#   error[0m
      [37m-					#   log[0m
      [37m-					#   fatal[0m
      [37m-					#   panic[0m
      [37m+#client_min_messages = notice   # values in order of decreasing detail:[0m
      [37m+          #   debug5[0m
      [37m+          #   debug4[0m
      [37m+          #   debug3[0m
      [37m+          #   debug2[0m
      [37m+          #   debug1[0m
      [37m+          #   log[0m
      [37m+          #   notice[0m
      [37m+          #   warning[0m
      [37m+          #   error[0m
      [37m [0m
      [37m-#log_min_error_statement = error	# values in order of decreasing detail:[0m
      [37m-					#   debug5[0m
      [37m-					#   debug4[0m
      [37m-					#   debug3[0m
      [37m-					#   debug2[0m
      [37m-					#   debug1[0m
      [37m-					#   info[0m
      [37m-					#   notice[0m
      [37m-					#   warning[0m
      [37m-					#   error[0m
      [37m-					#   log[0m
      [37m-					#   fatal[0m
      [37m-					#   panic (effectively off)[0m
      [37m+#log_min_messages = warning   # values in order of decreasing detail:[0m
      [37m+          #   debug5[0m
      [37m+          #   debug4[0m
      [37m+          #   debug3[0m
      [37m+          #   debug2[0m
      [37m+          #   debug1[0m
      [37m+          #   info[0m
      [37m+          #   notice[0m
      [37m+          #   warning[0m
      [37m+          #   error[0m
      [37m+          #   log[0m
      [37m+          #   fatal[0m
      [37m+          #   panic[0m
      [37m [0m
      [37m-#log_min_duration_statement = -1	# -1 is disabled, 0 logs all statements[0m
      [37m-					# and their durations, > 0 logs only[0m
      [37m-					# statements running at least this number[0m
      [37m-					# of milliseconds[0m
      [37m+#log_min_error_statement = error  # values in order of decreasing detail:[0m
      [37m+          #   debug5[0m
      [37m+          #   debug4[0m
      [37m+          #   debug3[0m
      [37m+          #   debug2[0m
      [37m+          #   debug1[0m
      [37m+          #   info[0m
      [37m+          #   notice[0m
      [37m+          #   warning[0m
      [37m+          #   error[0m
      [37m+          #   log[0m
      [37m+          #   fatal[0m
      [37m+          #   panic (effectively off)[0m
      [37m [0m
      [37m-#log_min_duration_sample = -1		# -1 is disabled, 0 logs a sample of statements[0m
      [37m-					# and their durations, > 0 logs only a sample of[0m
      [37m-					# statements running at least this number[0m
      [37m-					# of milliseconds;[0m
      [37m-					# sample fraction is determined by log_statement_sample_rate[0m
      [37m-[0m
      [37m-#log_statement_sample_rate = 1.0	# fraction of logged statements exceeding[0m
      [37m-					# log_min_duration_sample to be logged;[0m
      [37m-					# 1.0 logs all such statements, 0.0 never logs[0m
      [37m-[0m
      [37m-[0m
      [37m-#log_transaction_sample_rate = 0.0	# fraction of transactions whose statements[0m
      [37m-					# are logged regardless of their duration; 1.0 logs all[0m
      [37m-					# statements from all transactions, 0.0 never logs[0m
      [37m-[0m
      [37m-#log_startup_progress_interval = 10s	# Time between progress updates for[0m
      [37m-					# long-running startup operations.[0m
      [37m-					# 0 disables the feature, > 0 indicates[0m
      [37m-					# the interval in milliseconds.[0m
      [37m-[0m
      [37m # - What to Log -[0m
      [37m [0m
      [37m #debug_print_parse = off[0m
      [37m #debug_print_rewritten = off[0m
      [37m #debug_print_plan = off[0m
      [37m #debug_pretty_print = on[0m
      [37m-#log_autovacuum_min_duration = 10min	# log autovacuum activity;[0m
      [37m-					# -1 disables, 0 logs all actions and[0m
      [37m-					# their durations, > 0 logs only[0m
      [37m-					# actions running at least this number[0m
      [37m-					# of milliseconds.[0m
      [37m-#log_checkpoints = on[0m
      [37m #log_connections = off[0m
      [37m #log_disconnections = off[0m
      [37m #log_duration = off[0m
      [37m-#log_error_verbosity = default		# terse, default, or verbose messages[0m
      [37m+#log_error_verbosity = default    # terse, default, or verbose messages[0m
      [37m #log_hostname = off[0m
      [37m-#log_line_prefix = '%m [%p] '		# special values:[0m
      [37m-					#   %a = application name[0m
      [37m-					#   %u = user name[0m
      [37m-					#   %d = database name[0m
      [37m-					#   %r = remote host and port[0m
      [37m-					#   %h = remote host[0m
      [37m-					#   %b = backend type[0m
      [37m-					#   %p = process ID[0m
      [37m-					#   %P = process ID of parallel group leader[0m
      [37m-					#   %t = timestamp without milliseconds[0m
      [37m-					#   %m = timestamp with milliseconds[0m
      [37m-					#   %n = timestamp with milliseconds (as a Unix epoch)[0m
      [37m-					#   %Q = query ID (0 if none or not computed)[0m
      [37m-					#   %i = command tag[0m
      [37m-					#   %e = SQL state[0m
      [37m-					#   %c = session ID[0m
      [37m-					#   %l = session line number[0m
      [37m-					#   %s = session start timestamp[0m
      [37m-					#   %v = virtual transaction ID[0m
      [37m-					#   %x = transaction ID (0 if none)[0m
      [37m-					#   %q = stop here in non-session[0m
      [37m-					#        processes[0m
      [37m-					#   %% = '%'[0m
      [37m-					# e.g. '<%u%%%d> '[0m
      [37m-#log_lock_waits = off			# log lock waits >= deadlock_timeout[0m
      [37m-#log_recovery_conflict_waits = off	# log standby recovery conflict waits[0m
      [37m-					# >= deadlock_timeout[0m
      [37m-#log_parameter_max_length = -1		# when logging statements, limit logged[0m
      [37m-					# bind-parameter values to N bytes;[0m
      [37m-					# -1 means print in full, 0 disables[0m
      [37m-#log_parameter_max_length_on_error = 0	# when logging an error, limit logged[0m
      [37m-					# bind-parameter values to N bytes;[0m
      [37m-					# -1 means print in full, 0 disables[0m
      [37m-#log_statement = 'none'			# none, ddl, mod, all[0m
      [37m-#log_replication_commands = off[0m
      [37m-#log_temp_files = -1			# log temporary files equal or larger[0m
      [37m-					# than the specified size in kilobytes;[0m
      [37m-					# -1 disables, 0 logs all temp files[0m
      [37m-log_timezone = 'Europe/Moscow'[0m
      [37m+#log_lock_waits = off     # log lock waits >= deadlock_timeout[0m
      [37m+#log_statement = 'none'     # none, ddl, mod, all[0m
      [37m+#log_timezone = '(defaults to server environment setting)'[0m
      [37m [0m
      [37m-# - Process Title -[0m
      [37m [0m
      [37m-#cluster_name = ''			# added to process titles if nonempty[0m
      [37m-					# (change requires restart)[0m
      [37m-#update_process_title = on[0m
      [37m-[0m
      [37m-[0m
      [37m #------------------------------------------------------------------------------[0m
      [37m-# STATISTICS[0m
      [37m+# RUNTIME STATISTICS[0m
      [37m #------------------------------------------------------------------------------[0m
      [37m [0m
      [37m-# - Cumulative Query and Index Statistics -[0m
      [37m+# - Query/Index Statistics Collector -[0m
      [37m [0m
      [37m #track_activities = on[0m
      [37m-#track_activity_query_size = 1024	# (change requires restart)[0m
      [37m #track_counts = on[0m
      [37m-#track_io_timing = off[0m
      [37m-#track_wal_io_timing = off[0m
      [37m-#track_functions = none			# none, pl, all[0m
      [37m-#stats_fetch_consistency = cache	# cache, none, snapshot[0m
      [37m+#track_functions = none     # none, pl, all[0m
      [37m+track_activity_query_size = 1024 # (change requires restart)[0m
      [37m+#update_process_title = on[0m
      [37m+#stats_temp_directory = 'pg_stat_tmp'[0m
      [37m [0m
      [37m [0m
      [37m-# - Monitoring -[0m
      [37m+# - Statistics Monitoring -[0m
      [37m [0m
      [37m-#compute_query_id = auto[0m
      [37m-#log_statement_stats = off[0m
      [37m #log_parser_stats = off[0m
      [37m #log_planner_stats = off[0m
      [37m #log_executor_stats = off[0m
      [37m+#log_statement_stats = off[0m
      [37m [0m
      [37m [0m
      [37m #------------------------------------------------------------------------------[0m
      [37m-# AUTOVACUUM[0m
      [37m+# AUTOVACUUM PARAMETERS[0m
      [37m #------------------------------------------------------------------------------[0m
      [37m [0m
      [37m-#autovacuum = on			# Enable autovacuum subprocess?  'on'[0m
      [37m-					# requires track_counts to also be on.[0m
      [37m-#autovacuum_max_workers = 3		# max number of autovacuum subprocesses[0m
      [37m-					# (change requires restart)[0m
      [37m-#autovacuum_naptime = 1min		# time between autovacuum runs[0m
      [37m-#autovacuum_vacuum_threshold = 50	# min number of row updates before[0m
      [37m-					# vacuum[0m
      [37m-#autovacuum_vacuum_insert_threshold = 1000	# min number of row inserts[0m
      [37m-					# before vacuum; -1 disables insert[0m
      [37m-					# vacuums[0m
      [37m-#autovacuum_analyze_threshold = 50	# min number of row updates before[0m
      [37m-					# analyze[0m
      [37m-#autovacuum_vacuum_scale_factor = 0.2	# fraction of table size before vacuum[0m
      [37m-#autovacuum_vacuum_insert_scale_factor = 0.2	# fraction of inserts over table[0m
      [37m-					# size before insert vacuum[0m
      [37m-#autovacuum_analyze_scale_factor = 0.1	# fraction of table size before analyze[0m
      [37m-#autovacuum_freeze_max_age = 200000000	# maximum XID age before forced vacuum[0m
      [37m-					# (change requires restart)[0m
      [37m-#autovacuum_multixact_freeze_max_age = 400000000	# maximum multixact age[0m
      [37m-					# before forced vacuum[0m
      [37m-					# (change requires restart)[0m
      [37m-#autovacuum_vacuum_cost_delay = 2ms	# default vacuum cost delay for[0m
      [37m-					# autovacuum, in milliseconds;[0m
      [37m-					# -1 means use vacuum_cost_delay[0m
      [37m-#autovacuum_vacuum_cost_limit = -1	# default vacuum cost limit for[0m
      [37m-					# autovacuum, -1 means use[0m
      [37m-					# vacuum_cost_limit[0m
      [37m-[0m
      [37m-[0m
      [37m+autovacuum_max_workers = 3 # max number of autovacuum subprocesses[0m
      [37m+          # (change requires restart)[0m
      [37m+autovacuum_freeze_max_age = 200000000  # maximum XID age before forced vacuum[0m
      [37m+          # (change requires restart)[0m
      [37m #------------------------------------------------------------------------------[0m
      [37m # CLIENT CONNECTION DEFAULTS[0m
      [37m #------------------------------------------------------------------------------[0m
      [37m [0m
      [37m # - Statement Behavior -[0m
      [37m [0m
      [37m-#client_min_messages = notice		# values in order of decreasing detail:[0m
      [37m-					#   debug5[0m
      [37m-					#   debug4[0m
      [37m-					#   debug3[0m
      [37m-					#   debug2[0m
      [37m-					#   debug1[0m
      [37m-					#   log[0m
      [37m-					#   notice[0m
      [37m-					#   warning[0m
      [37m-					#   error[0m
      [37m-#search_path = '"$user", public'	# schema names[0m
      [37m-#row_security = on[0m
      [37m-#default_table_access_method = 'heap'[0m
      [37m-#default_tablespace = ''		# a tablespace name, '' uses the default[0m
      [37m-#default_toast_compression = 'pglz'	# 'pglz' or 'lz4'[0m
      [37m-#temp_tablespaces = ''			# a list of tablespace names, '' uses[0m
      [37m-					# only default tablespace[0m
      [37m+#search_path = '"$user",public'   # schema names[0m
      [37m+#default_tablespace = ''    # a tablespace name, '' uses the default[0m
      [37m+#temp_tablespaces = ''      # a list of tablespace names, '' uses[0m
      [37m+          # only default tablespace[0m
      [37m #check_function_bodies = on[0m
      [37m #default_transaction_isolation = 'read committed'[0m
      [37m #default_transaction_read_only = off[0m
      [37m #default_transaction_deferrable = off[0m
      [37m #session_replication_role = 'origin'[0m
      [37m-#statement_timeout = 0			# in milliseconds, 0 is disabled[0m
      [37m-#lock_timeout = 0			# in milliseconds, 0 is disabled[0m
      [37m-#idle_in_transaction_session_timeout = 0	# in milliseconds, 0 is disabled[0m
      [37m-#idle_session_timeout = 0		# in milliseconds, 0 is disabled[0m
      [37m-#vacuum_freeze_table_age = 150000000[0m
      [37m #vacuum_freeze_min_age = 50000000[0m
      [37m-#vacuum_failsafe_age = 1600000000[0m
      [37m-#vacuum_multixact_freeze_table_age = 150000000[0m
      [37m-#vacuum_multixact_freeze_min_age = 5000000[0m
      [37m-#vacuum_multixact_failsafe_age = 1600000000[0m
      [37m-#bytea_output = 'hex'			# hex, escape[0m
      [37m+#vacuum_freeze_table_age = 150000000[0m
      [37m+#bytea_output = 'hex'     # hex, escape[0m
      [37m #xmlbinary = 'base64'[0m
      [37m #xmloption = 'content'[0m
      [37m-#gin_pending_list_limit = 4MB[0m
      [37m-#createrole_self_grant = ''		# set and/or inherit[0m
      [37m [0m
      [37m # - Locale and Formatting -[0m
      [37m [0m
      [37m-datestyle = 'iso, mdy'[0m
      [37m #intervalstyle = 'postgres'[0m
      [37m-timezone = 'Europe/Moscow'[0m
      [37m+#timezone = '(defaults to server environment setting)'[0m
      [37m #timezone_abbreviations = 'Default'     # Select the set of available time zone[0m
      [37m-					# abbreviations.  Currently, there are[0m
      [37m-					#   Default[0m
      [37m-					#   Australia (historical usage)[0m
      [37m-					#   India[0m
      [37m-					# You can create your own file in[0m
      [37m-					# share/timezonesets/.[0m
      [37m-#extra_float_digits = 1			# min -15, max 3; any value >0 actually[0m
      [37m-					# selects precise output mode[0m
      [37m-#client_encoding = sql_ascii		# actually, defaults to database[0m
      [37m-					# encoding[0m
      [37m+          # abbreviations.  Currently, there are[0m
      [37m+          #   Default[0m
      [37m+          #   Australia[0m
      [37m+          #   India[0m
      [37m+          # You can create your own file in[0m
      [37m+          # share/timezonesets/.[0m
      [37m+#extra_float_digits = 0     # min -15, max 3[0m
      [37m+#client_encoding = sql_ascii    # actually, defaults to database[0m
      [37m+          # encoding[0m
      [37m [0m
      [37m-# These settings are initialized by initdb, but they can be changed.[0m
      [37m-lc_messages = 'en_US.UTF-8'		# locale for system error message[0m
      [37m-					# strings[0m
      [37m-lc_monetary = 'en_US.UTF-8'		# locale for monetary formatting[0m
      [37m-lc_numeric = 'en_US.UTF-8'		# locale for number formatting[0m
      [37m-lc_time = 'en_US.UTF-8'			# locale for time formatting[0m
      [37m-[0m
      [37m-#icu_validation_level = warning		# report ICU locale validation[0m
      [37m-					# errors at the given level[0m
      [37m-[0m
      [37m-# default configuration for text search[0m
      [37m-default_text_search_config = 'pg_catalog.english'[0m
      [37m-[0m
      [37m-# - Shared Library Preloading -[0m
      [37m-[0m
      [37m-#local_preload_libraries = ''[0m
      [37m-#session_preload_libraries = ''[0m
      [37m-#shared_preload_libraries = ''	# (change requires restart)[0m
      [37m-#jit_provider = 'llvmjit'		# JIT library to use[0m
      [37m-[0m
      [37m # - Other Defaults -[0m
      [37m [0m
      [37m #dynamic_library_path = '$libdir'[0m
      [37m-#gin_fuzzy_search_limit = 0[0m
      [37m+#local_preload_libraries = ''[0m
      [37m [0m
      [37m [0m
      [37m #------------------------------------------------------------------------------[0m
      [37m@@ -758,27 +410,27 @@[0m
      [37m #------------------------------------------------------------------------------[0m
      [37m [0m
      [37m #deadlock_timeout = 1s[0m
      [37m-#max_locks_per_transaction = 64		# min 10[0m
      [37m-					# (change requires restart)[0m
      [37m-#max_pred_locks_per_transaction = 64	# min 10[0m
      [37m-					# (change requires restart)[0m
      [37m-#max_pred_locks_per_relation = -2	# negative values mean[0m
      [37m-					# (max_pred_locks_per_transaction[0m
      [37m-					#  / -max_pred_locks_per_relation) - 1[0m
      [37m-#max_pred_locks_per_page = 2            # min 0[0m
      [37m+max_locks_per_transaction = 128   # min 10[0m
      [37m+          # (change requires restart)[0m
      [37m+# Note:  Each lock table slot uses ~270 bytes of shared memory, and there are[0m
      [37m+# max_locks_per_transaction * (max_connections + max_prepared_transactions)[0m
      [37m+# lock table slots.[0m
      [37m+#max_pred_locks_per_transaction = 64  # min 10[0m
      [37m+          # (change requires restart)[0m
      [37m [0m
      [37m-[0m
      [37m #------------------------------------------------------------------------------[0m
      [37m-# VERSION AND PLATFORM COMPATIBILITY[0m
      [37m+# VERSION/PLATFORM COMPATIBILITY[0m
      [37m #------------------------------------------------------------------------------[0m
      [37m [0m
      [37m # - Previous PostgreSQL Versions -[0m
      [37m [0m
      [37m #array_nulls = on[0m
      [37m-#backslash_quote = safe_encoding	# on, off, or safe_encoding[0m
      [37m+#backslash_quote = safe_encoding  # on, off, or safe_encoding[0m
      [37m+#default_with_oids = off[0m
      [37m #escape_string_warning = on[0m
      [37m #lo_compat_privileges = off[0m
      [37m #quote_all_identifiers = off[0m
      [37m+#sql_inheritance = on[0m
      [37m #standard_conforming_strings = on[0m
      [37m #synchronize_seqscans = on[0m
      [37m [0m
      [37m@@ -791,31 +443,15 @@[0m
      [37m # ERROR HANDLING[0m
      [37m #------------------------------------------------------------------------------[0m
      [37m [0m
      [37m-#exit_on_error = off			# terminate session on any error?[0m
      [37m-#restart_after_crash = on		# reinitialize after backend crash?[0m
      [37m-#data_sync_retry = off			# retry or panic on failure to fsync[0m
      [37m-					# data?[0m
      [37m-					# (change requires restart)[0m
      [37m-#recovery_init_sync_method = fsync	# fsync, syncfs (Linux 5.8+)[0m
      [37m+#exit_on_error = off        # terminate session on any error?[0m
      [37m+#restart_after_crash = on     # reinitialize after backend crash?[0m
      [37m [0m
      [37m [0m
      [37m #------------------------------------------------------------------------------[0m
      [37m-# CONFIG FILE INCLUDES[0m
      [37m-#------------------------------------------------------------------------------[0m
      [37m-[0m
      [37m-# These options allow settings to be loaded from files other than the[0m
      [37m-# default postgresql.conf.  Note that these are directives, not variable[0m
      [37m-# assignments, so they can usefully be given more than once.[0m
      [37m-[0m
      [37m-#include_dir = '...'			# include files ending in '.conf' from[0m
      [37m-					# a directory, e.g., 'conf.d'[0m
      [37m-#include_if_exists = '...'		# include file only if it exists[0m
      [37m-#include = '...'			# include file[0m
      [37m-[0m
      [37m-[0m
      [37m-#------------------------------------------------------------------------------[0m
      [37m # CUSTOMIZED OPTIONS[0m
      [37m #------------------------------------------------------------------------------[0m
      [37m [0m
      [37m-# Add settings for extensions here[0m
      [37m+#custom_variable_classes = ''   # list of custom variable class names[0m
      [37m+[0m
      [37m+include 'runtime.conf'[0m[2025-07-12T20:44:37+03:00] INFO: template[/var/opt/gitlab/postgresql/data/postgresql.conf] mode changed to 644

      [32m- change mode from '0600' to '0644'[0m
    * template[/var/opt/gitlab/postgresql/data/runtime.conf] action create[2025-07-12T20:44:37+03:00] INFO: template[/var/opt/gitlab/postgresql/data/runtime.conf] created file /var/opt/gitlab/postgresql/data/runtime.conf

      [32m- create new file /var/opt/gitlab/postgresql/data/runtime.conf[0m[2025-07-12T20:44:37+03:00] INFO: template[/var/opt/gitlab/postgresql/data/runtime.conf] updated file contents /var/opt/gitlab/postgresql/data/runtime.conf

      [32m- update content in file /var/opt/gitlab/postgresql/data/runtime.conf from none to cd1a82[0m
      [37m--- /var/opt/gitlab/postgresql/data/runtime.conf	2025-07-12 20:44:37.301835988 +0300[0m
      [37m+++ /var/opt/gitlab/postgresql/data/.chef-runtime20250712-17810-5vn2d6.conf	2025-07-12 20:44:37.301835988 +0300[0m
      [37m@@ -1,138 +1,276 @@[0m
      [37m+# This file is managed by gitlab-ctl. Manual changes will be[0m
      [37m+# erased! To change the contents below, edit /etc/gitlab/gitlab.rb[0m
      [37m+# and run `sudo gitlab-ctl reconfigure`.[0m
      [37m+[0m
      [37m+# Changing variables in this file should only require a reload of PostgreSQL[0m
      [37m+# As the gitlab-psql user, run:[0m
      [37m+# /opt/gitlab/embedded/bin/pg_ctl reload -D /var/opt/gitlab/postgresql/data[0m
      [37m+work_mem = 16MB				# min 64kB[0m
      [37m+maintenance_work_mem = 16MB # 16MB    # min 1MB[0m
      [37m+synchronous_commit = on # synchronization level; on, off, or local[0m
      [37m+synchronous_standby_names = ''[0m
      [37m+[0m
      [37m+# - Checkpoints -[0m
      [37m+min_wal_size = 80MB[0m
      [37m+max_wal_size = 1GB[0m
      [37m+[0m
      [37m+checkpoint_timeout = 5min		# range 30s-1h, default 5min[0m
      [37m+checkpoint_completion_target = 0.9	# checkpoint target duration, 0.0 - 1.0, default 0.5[0m
      [37m+checkpoint_warning = 30s		# 0 disables, default 30s[0m
      [37m+[0m
      [37m+# - Logging -[0m
      [37m+log_directory = '/var/log/gitlab/postgresql'[0m
      [37m+[0m
      [37m+# - Archiving -[0m
      [37m+archive_command = ''   # command to use to archive a logfile segment[0m
      [37m+archive_timeout = 0    # force a logfile segment switch after this[0m
      [37m+        # number of seconds; 0 disables[0m
      [37m+[0m
      [37m+# - Replication[0m
      [37m+wal_keep_size = 160[0m
      [37m+[0m
      [37m+max_standby_archive_delay = 30s # max delay before canceling queries[0m
      [37m+          # when reading WAL from archive;[0m
      [37m+          # -1 allows indefinite delay[0m
      [37m+max_standby_streaming_delay = 30s # max delay before canceling queries[0m
      [37m+          # when reading streaming WAL;[0m
      [37m+          # -1 allows indefinite delay[0m
      [37m+[0m
      [37m+hot_standby_feedback = off   # send info from standby to prevent[0m
      [37m+          # query conflicts[0m
      [37m+[0m
      [37m+# - Planner Cost Constants -[0m
      [37m+#seq_page_cost = 1.0      # measured on an arbitrary scale[0m
      [37m+random_page_cost = 2.0     # same scale as above[0m
      [37m+[0m
      [37m+effective_cache_size = 1957MB # Default 128MB[0m
      [37m+[0m
      [37m+log_min_duration_statement = 1000  # -1 is disabled, 0 logs all statements[0m
      [37m+          # and their durations, > 0 logs only[0m
      [37m+          # statements running at least this number[0m
      [37m+          # of milliseconds[0m
      [37m+[0m
      [37m+log_checkpoints = off[0m
      [37m+[0m
      [37m+log_connections = off[0m
      [37m+[0m
      [37m+log_disconnections = off[0m
      [37m+[0m
      [37m+log_line_prefix = '' # default '', special values:[0m
      [37m+          #   %a = application name[0m
      [37m+          #   %u = user name[0m
      [37m+          #   %d = database name[0m
      [37m+          #   %r = remote host and port[0m
      [37m+          #   %h = remote host[0m
      [37m+          #   %p = process ID[0m
      [37m+          #   %t = timestamp without milliseconds[0m
      [37m+          #   %m = timestamp with milliseconds[0m
      [37m+          #   %i = command tag[0m
      [37m+          #   %e = SQL state[0m
      [37m+          #   %c = session ID[0m
      [37m+          #   %l = session line number[0m
      [37m+          #   %s = session start timestamp[0m
      [37m+          #   %v = virtual transaction ID[0m
      [37m+          #   %x = transaction ID (0 if none)[0m
      [37m+          #   %q = stop here in non-session[0m
      [37m+          #        processes[0m
      [37m+          #   %% = '%'[0m
      [37m+[0m
      [37m+log_temp_files = -1      # log temporary files equal or larger[0m
      [37m+          # than the specified size in kilobytes;[0m
      [37m+          # -1 disables, 0 logs all temp files[0m
      [37m+[0m
      [37m+[0m
      [37m+# - Autovacuum parameters -[0m
      [37m+autovacuum = on # Enable autovacuum subprocess?  'on'[0m
      [37m+          # requires track_counts to also be on.[0m
      [37m+[0m
      [37m+log_autovacuum_min_duration = -1 # -1 disables, 0 logs all actions and[0m
      [37m+          # their durations, > 0 logs only[0m
      [37m+          # actions running at least this number[0m
      [37m+          # of milliseconds.[0m
      [37m+[0m
      [37m+autovacuum_naptime = 1min # time between autovacuum runs[0m
      [37m+autovacuum_vacuum_threshold = 50 # min number of row updates before[0m
      [37m+          # vacuum[0m
      [37m+autovacuum_analyze_threshold = 50 # min number of row updates before[0m
      [37m+          # analyze[0m
      [37m+autovacuum_vacuum_scale_factor = 0.02 # fraction of table size before vacuum[0m
      [37m+autovacuum_analyze_scale_factor = 0.01 # fraction of table size before analyze[0m
      [37m+autovacuum_vacuum_cost_delay = 20ms # default vacuum cost delay for[0m
      [37m+          # autovacuum, in milliseconds;[0m
      [37m+          # -1 means use vacuum_cost_delay[0m
      [37m+autovacuum_vacuum_cost_limit = -1 # default vacuum cost limit for[0m
      [37m+          # autovacuum, -1 means use[0m
      [37m+          # vacuum_cost_limit[0m
      [37m+[0m
      [37m+# Parameters for gathering statistics[0m
      [37m+default_statistics_target = 1000[0m
      [37m+[0m
      [37m+# - Client connection timeouts[0m
      [37m+statement_timeout = 60000[0m
      [37m+[0m
      [37m+idle_in_transaction_session_timeout = 60000[0m
      [37m+[0m
      [37m+# IO settings[0m
      [37m+effective_io_concurrency = 1[0m
      [37m+track_io_timing = 'off'[0m
      [37m+[0m
      [37m+# Parallel worker settings[0m
      [37m+max_worker_processes = 8[0m
      [37m+max_parallel_workers_per_gather = 0[0m
      [37m+[0m
      [37m+# Deadlock handling and logging[0m
      [37m+deadlock_timeout = '5s'[0m
      [37m+log_lock_waits = 1[0m
      [37m+[0m
      [37m+# - Locale and Formatting -[0m
      [37m+datestyle = 'iso, mdy'[0m
      [37m+[0m
      [37m+# These settings are initialized by initdb, but they can be changed.[0m
      [37m+lc_messages = 'C'     # locale for system error message[0m
      [37m+          # strings[0m
      [37m+lc_monetary = 'C'     # locale for monetary formatting[0m
      [37m+lc_numeric = 'C'      # locale for number formatting[0m
      [37m+lc_time = 'C'       # locale for time formatting[0m
      [37m+[0m
      [37m+# default configuration for text search[0m
      [37m+default_text_search_config = 'pg_catalog.english'[0m[2025-07-12T20:44:37+03:00] INFO: template[/var/opt/gitlab/postgresql/data/runtime.conf] owner changed to 992
[2025-07-12T20:44:37+03:00] INFO: template[/var/opt/gitlab/postgresql/data/runtime.conf] mode changed to 644

      [32m- change mode from '' to '0644'[0m
      [32m- change owner from '' to 'gitlab-psql'[0m
    * template[/var/opt/gitlab/postgresql/data/pg_hba.conf] action create[2025-07-12T20:44:37+03:00] INFO: template[/var/opt/gitlab/postgresql/data/pg_hba.conf] backed up to /opt/gitlab/embedded/cookbooks/cache/backup/var/opt/gitlab/postgresql/data/pg_hba.conf.chef-20250712204437.322549
[2025-07-12T20:44:37+03:00] INFO: template[/var/opt/gitlab/postgresql/data/pg_hba.conf] updated file contents /var/opt/gitlab/postgresql/data/pg_hba.conf

      [32m- update content in file /var/opt/gitlab/postgresql/data/pg_hba.conf from 056ad9 to 40e348[0m
      [37m--- /var/opt/gitlab/postgresql/data/pg_hba.conf	2025-07-12 20:44:35.693835988 +0300[0m
      [37m+++ /var/opt/gitlab/postgresql/data/.chef-pg_hba20250712-17810-xtxj1f.conf	2025-07-12 20:44:37.317835988 +0300[0m
      [37m@@ -1,127 +1,74 @@[0m
      [37m+# This file is managed by gitlab-ctl. Manual changes will be[0m
      [37m+# erased! To change the contents below, edit /etc/gitlab/gitlab.rb[0m
      [37m+# and run `sudo gitlab-ctl reconfigure`.[0m
      [37m+[0m
      [37m # PostgreSQL Client Authentication Configuration File[0m
      [37m # ===================================================[0m
      [37m #[0m
      [37m-# Refer to the "Client Authentication" section in the PostgreSQL[0m
      [37m-# documentation for a complete description of this file.  A short[0m
      [37m-# synopsis follows.[0m
      [37m+# Refer to the "Client Authentication" section in the[0m
      [37m+# PostgreSQL documentation for a complete description[0m
      [37m+# of this file.  A short synopsis follows.[0m
      [37m #[0m
      [37m-# ----------------------[0m
      [37m-# Authentication Records[0m
      [37m-# ----------------------[0m
      [37m-#[0m
      [37m # This file controls: which hosts are allowed to connect, how clients[0m
      [37m # are authenticated, which PostgreSQL user names they can use, which[0m
      [37m # databases they can access.  Records take one of these forms:[0m
      [37m #[0m
      [37m-# local         DATABASE  USER  METHOD  [OPTIONS][0m
      [37m-# host          DATABASE  USER  ADDRESS  METHOD  [OPTIONS][0m
      [37m-# hostssl       DATABASE  USER  ADDRESS  METHOD  [OPTIONS][0m
      [37m-# hostnossl     DATABASE  USER  ADDRESS  METHOD  [OPTIONS][0m
      [37m-# hostgssenc    DATABASE  USER  ADDRESS  METHOD  [OPTIONS][0m
      [37m-# hostnogssenc  DATABASE  USER  ADDRESS  METHOD  [OPTIONS][0m
      [37m+# local      DATABASE  USER  METHOD  [OPTION][0m
      [37m+# host       DATABASE  USER  CIDR-ADDRESS  METHOD  [OPTION][0m
      [37m+# hostssl    DATABASE  USER  CIDR-ADDRESS  METHOD  [OPTION][0m
      [37m+# hostnossl  DATABASE  USER  CIDR-ADDRESS  METHOD  [OPTION][0m
      [37m #[0m
      [37m # (The uppercase items must be replaced by actual values.)[0m
      [37m #[0m
      [37m-# The first field is the connection type:[0m
      [37m-# - "local" is a Unix-domain socket[0m
      [37m-# - "host" is a TCP/IP socket (encrypted or not)[0m
      [37m-# - "hostssl" is a TCP/IP socket that is SSL-encrypted[0m
      [37m-# - "hostnossl" is a TCP/IP socket that is not SSL-encrypted[0m
      [37m-# - "hostgssenc" is a TCP/IP socket that is GSSAPI-encrypted[0m
      [37m-# - "hostnogssenc" is a TCP/IP socket that is not GSSAPI-encrypted[0m
      [37m+# The first field is the connection type: "local" is a Unix-domain socket,[0m
      [37m+# "host" is either a plain or SSL-encrypted TCP/IP socket, "hostssl" is an[0m
      [37m+# SSL-encrypted TCP/IP socket, and "hostnossl" is a plain TCP/IP socket.[0m
      [37m #[0m
      [37m-# DATABASE can be "all", "sameuser", "samerole", "replication", a[0m
      [37m-# database name, a regular expression (if it starts with a slash (/))[0m
      [37m-# or a comma-separated list thereof.  The "all" keyword does not match[0m
      [37m-# "replication".  Access to replication must be enabled in a separate[0m
      [37m-# record (see example below).[0m
      [37m+# DATABASE can be "all", "sameuser", "samerole", a database name, or[0m
      [37m+# a comma-separated list thereof.[0m
      [37m #[0m
      [37m-# USER can be "all", a user name, a group name prefixed with "+", a[0m
      [37m-# regular expression (if it starts with a slash (/)) or a comma-separated[0m
      [37m-# list thereof.  In both the DATABASE and USER fields you can also write[0m
      [37m-# a file name prefixed with "@" to include names from a separate file.[0m
      [37m+# USER can be "all", a user name, a group name prefixed with "+", or[0m
      [37m+# a comma-separated list thereof.  In both the DATABASE and USER fields[0m
      [37m+# you can also write a file name prefixed with "@" to include names from[0m
      [37m+# a separate file.[0m
      [37m #[0m
      [37m-# ADDRESS specifies the set of hosts the record matches.  It can be a[0m
      [37m-# host name, or it is made up of an IP address and a CIDR mask that is[0m
      [37m-# an integer (between 0 and 32 (IPv4) or 128 (IPv6) inclusive) that[0m
      [37m-# specifies the number of significant bits in the mask.  A host name[0m
      [37m-# that starts with a dot (.) matches a suffix of the actual host name.[0m
      [37m-# Alternatively, you can write an IP address and netmask in separate[0m
      [37m-# columns to specify the set of hosts.  Instead of a CIDR-address, you[0m
      [37m-# can write "samehost" to match any of the server's own IP addresses,[0m
      [37m-# or "samenet" to match any address in any subnet that the server is[0m
      [37m-# directly connected to.[0m
      [37m+# CIDR-ADDRESS specifies the set of hosts the record matches.[0m
      [37m+# It is made up of an IP address and a CIDR mask that is an integer[0m
      [37m+# (between 0 and 32 (IPv4) or 128 (IPv6) inclusive) that specifies[0m
      [37m+# the number of significant bits in the mask.  Alternatively, you can write[0m
      [37m+# an IP address and netmask in separate columns to specify the set of hosts.[0m
      [37m #[0m
      [37m-# METHOD can be "trust", "reject", "md5", "password", "scram-sha-256",[0m
      [37m-# "gss", "sspi", "ident", "peer", "pam", "ldap", "radius" or "cert".[0m
      [37m-# Note that "password" sends passwords in clear text; "md5" or[0m
      [37m-# "scram-sha-256" are preferred since they send encrypted passwords.[0m
      [37m+# METHOD can be "trust", "reject", "md5", "crypt", "password", "gss", "sspi",[0m
      [37m+# "krb5", "ident", "pam" or "ldap".  Note that "password" sends passwords[0m
      [37m+# in clear text; "md5" is preferred since it sends encrypted passwords.[0m
      [37m #[0m
      [37m-# OPTIONS are a set of options for the authentication in the format[0m
      [37m-# NAME=VALUE.  The available options depend on the different[0m
      [37m-# authentication methods -- refer to the "Client Authentication"[0m
      [37m-# section in the documentation for a list of which options are[0m
      [37m-# available for which authentication methods.[0m
      [37m+# OPTION is the ident map or the name of the PAM service, depending on METHOD.[0m
      [37m #[0m
      [37m-# Database and user names containing spaces, commas, quotes and other[0m
      [37m-# special characters must be quoted.  Quoting one of the keywords[0m
      [37m-# "all", "sameuser", "samerole" or "replication" makes the name lose[0m
      [37m-# its special character, and just match a database or username with[0m
      [37m-# that name.[0m
      [37m+# Database and user names containing spaces, commas, quotes and other special[0m
      [37m+# characters must be quoted. Quoting one of the keywords "all", "sameuser" or[0m
      [37m+# "samerole" makes the name lose its special character, and just match a[0m
      [37m+# database or username with that name.[0m
      [37m #[0m
      [37m-# ---------------[0m
      [37m-# Include Records[0m
      [37m-# ---------------[0m
      [37m-#[0m
      [37m-# This file allows the inclusion of external files or directories holding[0m
      [37m-# more records, using the following keywords:[0m
      [37m-#[0m
      [37m-# include           FILE[0m
      [37m-# include_if_exists FILE[0m
      [37m-# include_dir       DIRECTORY[0m
      [37m-#[0m
      [37m-# FILE is the file name to include, and DIR is the directory name containing[0m
      [37m-# the file(s) to include.  Any file in a directory will be loaded if suffixed[0m
      [37m-# with ".conf".  The files of a directory are ordered by name.[0m
      [37m-# include_if_exists ignores missing files.  FILE and DIRECTORY can be[0m
      [37m-# specified as a relative or an absolute path, and can be double-quoted if[0m
      [37m-# they contain spaces.[0m
      [37m-#[0m
      [37m-# -------------[0m
      [37m-# Miscellaneous[0m
      [37m-# -------------[0m
      [37m-#[0m
      [37m-# This file is read on server startup and when the server receives a[0m
      [37m-# SIGHUP signal.  If you edit the file on a running system, you have to[0m
      [37m-# SIGHUP the server for the changes to take effect, run "pg_ctl reload",[0m
      [37m-# or execute "SELECT pg_reload_conf()".[0m
      [37m-#[0m
      [37m-# ----------------------------------[0m
      [37m+# This file is read on server startup and when the postmaster receives[0m
      [37m+# a SIGHUP signal.  If you edit the file on a running system, you have[0m
      [37m+# to SIGHUP the postmaster for the changes to take effect.  You can use[0m
      [37m+# "pg_ctl reload" to do that.[0m
      [37m+[0m
      [37m # Put your actual configuration here[0m
      [37m # ----------------------------------[0m
      [37m #[0m
      [37m # If you want to allow non-local connections, you need to add more[0m
      [37m-# "host" records.  In that case you will also need to make PostgreSQL[0m
      [37m-# listen on a non-local interface via the listen_addresses[0m
      [37m-# configuration parameter, or via the -i or -h command line switches.[0m
      [37m+# "host" records. In that case you will also need to make PostgreSQL listen[0m
      [37m+# on a non-local interface via the listen_addresses configuration parameter,[0m
      [37m+# or via the -i or -h command line switches.[0m
      [37m+#[0m
      [37m [0m
      [37m-# CAUTION: Configuring the system for local "trust" authentication[0m
      [37m-# allows any local user to connect as any PostgreSQL user, including[0m
      [37m-# the database superuser.  If you do not trust all your local users,[0m
      [37m-# use another authentication method.[0m
      [37m [0m
      [37m+# TYPE  DATABASE    USER        CIDR-ADDRESS          METHOD[0m
      [37m [0m
      [37m-# TYPE  DATABASE        USER            ADDRESS                 METHOD[0m
      [37m-[0m
      [37m # "local" is for Unix domain socket connections only[0m
      [37m-local   all             all                                     trust[0m
      [37m-# IPv4 local connections:[0m
      [37m-host    all             all             127.0.0.1/32            trust[0m
      [37m-# IPv6 local connections:[0m
      [37m-host    all             all             ::1/128                 trust[0m
      [37m-# Allow replication connections from localhost, by a user with the[0m
      [37m-# replication privilege.[0m
      [37m-local   replication     all                                     trust[0m
      [37m-host    replication     all             127.0.0.1/32            trust[0m
      [37m-host    replication     all             ::1/128                 trust[0m
      [37m+local   all         all                               peer map=gitlab[0m
      [37m+[0m
      [37m+[0m
      [37m+[0m[2025-07-12T20:44:37+03:00] INFO: template[/var/opt/gitlab/postgresql/data/pg_hba.conf] mode changed to 644

      [32m- change mode from '0600' to '0644'[0m
    * template[/var/opt/gitlab/postgresql/data/pg_ident.conf] action create[2025-07-12T20:44:37+03:00] INFO: template[/var/opt/gitlab/postgresql/data/pg_ident.conf] backed up to /opt/gitlab/embedded/cookbooks/cache/backup/var/opt/gitlab/postgresql/data/pg_ident.conf.chef-20250712204437.344348
[2025-07-12T20:44:37+03:00] INFO: template[/var/opt/gitlab/postgresql/data/pg_ident.conf] updated file contents /var/opt/gitlab/postgresql/data/pg_ident.conf

      [32m- update content in file /var/opt/gitlab/postgresql/data/pg_ident.conf from b4dfef to 5399a1[0m
      [37m--- /var/opt/gitlab/postgresql/data/pg_ident.conf	2025-07-12 20:44:35.693835988 +0300[0m
      [37m+++ /var/opt/gitlab/postgresql/data/.chef-pg_ident20250712-17810-e14iyz.conf	2025-07-12 20:44:37.337835988 +0300[0m
      [37m@@ -1,10 +1,6 @@[0m
      [37m # PostgreSQL User Name Maps[0m
      [37m # =========================[0m
      [37m #[0m
      [37m-# ---------------[0m
      [37m-# Mapping Records[0m
      [37m-# ---------------[0m
      [37m-#[0m
      [37m # Refer to the PostgreSQL documentation, chapter "Client[0m
      [37m # Authentication" for a complete description.  A short synopsis[0m
      [37m # follows.[0m
      [37m@@ -29,38 +25,12 @@[0m
      [37m # will be substituted for \1 (backslash-one) if present in[0m
      [37m # PG-USERNAME.[0m
      [37m #[0m
      [37m-# PG-USERNAME can be "all", a user name, a group name prefixed with "+", or[0m
      [37m-# a regular expression (if it starts with a slash (/)).  If it is a regular[0m
      [37m-# expression, the substring matching with \1 has no effect.[0m
      [37m-#[0m
      [37m # Multiple maps may be specified in this file and used by pg_hba.conf.[0m
      [37m #[0m
      [37m # No map names are defined in the default configuration.  If all[0m
      [37m # system user names and PostgreSQL user names are the same, you don't[0m
      [37m # need anything in this file.[0m
      [37m #[0m
      [37m-# ---------------[0m
      [37m-# Include Records[0m
      [37m-# ---------------[0m
      [37m-#[0m
      [37m-# This file allows the inclusion of external files or directories holding[0m
      [37m-# more records, using the following keywords:[0m
      [37m-#[0m
      [37m-# include           FILE[0m
      [37m-# include_if_exists FILE[0m
      [37m-# include_dir       DIRECTORY[0m
      [37m-#[0m
      [37m-# FILE is the file name to include, and DIR is the directory name containing[0m
      [37m-# the file(s) to include.  Any file in a directory will be loaded if suffixed[0m
      [37m-# with ".conf".  The files of a directory are ordered by name.[0m
      [37m-# include_if_exists ignores missing files.  FILE and DIRECTORY can be[0m
      [37m-# specified as a relative or an absolute path, and can be double-quoted if[0m
      [37m-# they contain spaces.[0m
      [37m-#[0m
      [37m-# -------------------------------[0m
      [37m-# Miscellaneous[0m
      [37m-# -------------------------------[0m
      [37m-#[0m
      [37m # This file is read on server startup and when the postmaster receives[0m
      [37m # a SIGHUP signal.  If you edit the file on a running system, you have[0m
      [37m # to SIGHUP the postmaster for the changes to take effect.  You can[0m
      [37m@@ -70,4 +40,8 @@[0m
      [37m # ----------------------------------[0m
      [37m [0m
      [37m # MAPNAME       SYSTEM-USERNAME         PG-USERNAME[0m
      [37m+gitlab  git  gitlab[0m
      [37m+gitlab  mattermost  gitlab_mattermost[0m
      [37m+# Default to a 1-1 mapping between system usernames and Postgres usernames[0m
      [37m+gitlab  /^(.*)$  \1[0m[2025-07-12T20:44:37+03:00] INFO: template[/var/opt/gitlab/postgresql/data/pg_ident.conf] mode changed to 644

      [32m- change mode from '0600' to '0644'[0m
  
Recipe: postgresql::standalone
  * service[postgresql] action nothing (skipped due to action :nothing)
  * runit_service[postgresql] action enable
    * ruby_block[restart_service] action nothing (skipped due to action :nothing)
    * ruby_block[restart_log_service] action nothing (skipped due to action :nothing)
    * ruby_block[reload_log_service] action nothing (skipped due to action :nothing)
    * directory[/opt/gitlab/sv/postgresql] action create[2025-07-12T20:44:37+03:00] INFO: directory[/opt/gitlab/sv/postgresql] created directory /opt/gitlab/sv/postgresql

      [32m- create new directory /opt/gitlab/sv/postgresql[0m[2025-07-12T20:44:37+03:00] INFO: directory[/opt/gitlab/sv/postgresql] owner changed to 0
[2025-07-12T20:44:37+03:00] INFO: directory[/opt/gitlab/sv/postgresql] group changed to 0
[2025-07-12T20:44:37+03:00] INFO: directory[/opt/gitlab/sv/postgresql] mode changed to 755

      [32m- change mode from '' to '0755'[0m
      [32m- change owner from '' to 'root'[0m
      [32m- change group from '' to 'root'[0m
    * template[/opt/gitlab/sv/postgresql/run] action create[2025-07-12T20:44:37+03:00] INFO: template[/opt/gitlab/sv/postgresql/run] created file /opt/gitlab/sv/postgresql/run

      [32m- create new file /opt/gitlab/sv/postgresql/run[0m[2025-07-12T20:44:37+03:00] INFO: template[/opt/gitlab/sv/postgresql/run] updated file contents /opt/gitlab/sv/postgresql/run

      [32m- update content in file /opt/gitlab/sv/postgresql/run from none to dc5689[0m
      [37m--- /opt/gitlab/sv/postgresql/run	2025-07-12 20:44:37.361835988 +0300[0m
      [37m+++ /opt/gitlab/sv/postgresql/.chef-run20250712-17810-ggiqrm	2025-07-12 20:44:37.361835988 +0300[0m
      [37m@@ -1,4 +1,8 @@[0m
      [37m+#!/bin/sh[0m
      [37m+exec 2>&1[0m
      [37m+[0m
      [37m+exec chpst -P -U gitlab-psql:gitlab-psql -u gitlab-psql:gitlab-psql /opt/gitlab/embedded/bin/postgres -D /var/opt/gitlab/postgresql/data[0m[2025-07-12T20:44:37+03:00] INFO: template[/opt/gitlab/sv/postgresql/run] owner changed to 0
[2025-07-12T20:44:37+03:00] INFO: template[/opt/gitlab/sv/postgresql/run] group changed to 0
[2025-07-12T20:44:37+03:00] INFO: template[/opt/gitlab/sv/postgresql/run] mode changed to 755

      [32m- change mode from '' to '0755'[0m
      [32m- change owner from '' to 'root'[0m
      [32m- change group from '' to 'root'[0m
    * directory[/opt/gitlab/sv/postgresql/log] action create[2025-07-12T20:44:37+03:00] INFO: directory[/opt/gitlab/sv/postgresql/log] created directory /opt/gitlab/sv/postgresql/log

      [32m- create new directory /opt/gitlab/sv/postgresql/log[0m[2025-07-12T20:44:37+03:00] INFO: directory[/opt/gitlab/sv/postgresql/log] owner changed to 0
[2025-07-12T20:44:37+03:00] INFO: directory[/opt/gitlab/sv/postgresql/log] group changed to 0
[2025-07-12T20:44:37+03:00] INFO: directory[/opt/gitlab/sv/postgresql/log] mode changed to 755

      [32m- change mode from '' to '0755'[0m
      [32m- change owner from '' to 'root'[0m
      [32m- change group from '' to 'root'[0m
    * directory[/opt/gitlab/sv/postgresql/log/main] action create[2025-07-12T20:44:37+03:00] INFO: directory[/opt/gitlab/sv/postgresql/log/main] created directory /opt/gitlab/sv/postgresql/log/main

      [32m- create new directory /opt/gitlab/sv/postgresql/log/main[0m[2025-07-12T20:44:37+03:00] INFO: directory[/opt/gitlab/sv/postgresql/log/main] owner changed to 0
[2025-07-12T20:44:37+03:00] INFO: directory[/opt/gitlab/sv/postgresql/log/main] group changed to 0
[2025-07-12T20:44:37+03:00] INFO: directory[/opt/gitlab/sv/postgresql/log/main] mode changed to 755

      [32m- change mode from '' to '0755'[0m
      [32m- change owner from '' to 'root'[0m
      [32m- change group from '' to 'root'[0m
    * template[/opt/gitlab/sv/postgresql/log/config] action create[2025-07-12T20:44:37+03:00] INFO: template[/opt/gitlab/sv/postgresql/log/config] created file /opt/gitlab/sv/postgresql/log/config

      [32m- create new file /opt/gitlab/sv/postgresql/log/config[0m[2025-07-12T20:44:37+03:00] INFO: template[/opt/gitlab/sv/postgresql/log/config] updated file contents /opt/gitlab/sv/postgresql/log/config

      [32m- update content in file /opt/gitlab/sv/postgresql/log/config from none to 623c00[0m
      [37m--- /opt/gitlab/sv/postgresql/log/config	2025-07-12 20:44:37.381835988 +0300[0m
      [37m+++ /opt/gitlab/sv/postgresql/log/.chef-config20250712-17810-d3o9uz	2025-07-12 20:44:37.381835988 +0300[0m
      [37m@@ -1,6 +1,12 @@[0m
      [37m+s209715200[0m
      [37m+n30[0m
      [37m+t86400[0m
      [37m+!gzip[0m
      [37m+[0m
      [37m+[0m[2025-07-12T20:44:37+03:00] INFO: template[/opt/gitlab/sv/postgresql/log/config] owner changed to 0
[2025-07-12T20:44:37+03:00] INFO: template[/opt/gitlab/sv/postgresql/log/config] group changed to 0
[2025-07-12T20:44:37+03:00] INFO: template[/opt/gitlab/sv/postgresql/log/config] mode changed to 644

      [32m- change mode from '' to '0644'[0m
      [32m- change owner from '' to 'root'[0m
      [32m- change group from '' to 'root'[0m
    * ruby_block[verify_chown_persisted_on_postgresql] action nothing (skipped due to action :nothing)
[2025-07-12T20:44:37+03:00] INFO: ruby_block[verify_chown_persisted_on_postgresql] sent create action to ruby_block[verify_chown_persisted_on_postgresql] (immediate at declaration time)
    * ruby_block[verify_chown_persisted_on_postgresql] action create[2025-07-12T20:44:37+03:00] INFO: ruby_block[verify_chown_persisted_on_postgresql] called

      [32m- execute the ruby block verify_chown_persisted_on_postgresql[0m
    * link[/var/log/gitlab/postgresql/config] action create[2025-07-12T20:44:37+03:00] INFO: link[/var/log/gitlab/postgresql/config] created

      [32m- create symlink at /var/log/gitlab/postgresql/config to /opt/gitlab/sv/postgresql/log/config[0m
    * template[/opt/gitlab/sv/postgresql/log/run] action create[2025-07-12T20:44:37+03:00] INFO: template[/opt/gitlab/sv/postgresql/log/run] created file /opt/gitlab/sv/postgresql/log/run

      [32m- create new file /opt/gitlab/sv/postgresql/log/run[0m[2025-07-12T20:44:37+03:00] INFO: template[/opt/gitlab/sv/postgresql/log/run] updated file contents /opt/gitlab/sv/postgresql/log/run

      [32m- update content in file /opt/gitlab/sv/postgresql/log/run from none to 9c7bfd[0m
      [37m--- /opt/gitlab/sv/postgresql/log/run	2025-07-12 20:44:37.397835988 +0300[0m
      [37m+++ /opt/gitlab/sv/postgresql/log/.chef-run20250712-17810-h5sk92	2025-07-12 20:44:37.397835988 +0300[0m
      [37m@@ -1,5 +1,10 @@[0m
      [37m+#!/bin/sh[0m
      [37m+exec chpst -P \[0m
      [37m+  -U root:root \[0m
      [37m+  -u root:root \[0m
      [37m+  svlogd -tt /var/log/gitlab/postgresql[0m[2025-07-12T20:44:37+03:00] INFO: template[/opt/gitlab/sv/postgresql/log/run] owner changed to 0
[2025-07-12T20:44:37+03:00] INFO: template[/opt/gitlab/sv/postgresql/log/run] group changed to 0
[2025-07-12T20:44:37+03:00] INFO: template[/opt/gitlab/sv/postgresql/log/run] mode changed to 755

      [32m- change mode from '' to '0755'[0m
      [32m- change owner from '' to 'root'[0m
      [32m- change group from '' to 'root'[0m
    * directory[/opt/gitlab/sv/postgresql/env] action create[2025-07-12T20:44:37+03:00] INFO: directory[/opt/gitlab/sv/postgresql/env] created directory /opt/gitlab/sv/postgresql/env

      [32m- create new directory /opt/gitlab/sv/postgresql/env[0m[2025-07-12T20:44:37+03:00] INFO: directory[/opt/gitlab/sv/postgresql/env] owner changed to 0
[2025-07-12T20:44:37+03:00] INFO: directory[/opt/gitlab/sv/postgresql/env] group changed to 0
[2025-07-12T20:44:37+03:00] INFO: directory[/opt/gitlab/sv/postgresql/env] mode changed to 755

      [32m- change mode from '' to '0755'[0m
      [32m- change owner from '' to 'root'[0m
      [32m- change group from '' to 'root'[0m
    * ruby_block[Delete unmanaged env files for postgresql service] action run (skipped due to only_if)
    * template[/opt/gitlab/sv/postgresql/check] action create (skipped due to only_if)
    * template[/opt/gitlab/sv/postgresql/finish] action create (skipped due to only_if)
    * directory[/opt/gitlab/sv/postgresql/control] action create[2025-07-12T20:44:37+03:00] INFO: directory[/opt/gitlab/sv/postgresql/control] created directory /opt/gitlab/sv/postgresql/control

      [32m- create new directory /opt/gitlab/sv/postgresql/control[0m[2025-07-12T20:44:37+03:00] INFO: directory[/opt/gitlab/sv/postgresql/control] owner changed to 0
[2025-07-12T20:44:37+03:00] INFO: directory[/opt/gitlab/sv/postgresql/control] group changed to 0
[2025-07-12T20:44:37+03:00] INFO: directory[/opt/gitlab/sv/postgresql/control] mode changed to 755

      [32m- change mode from '' to '0755'[0m
      [32m- change owner from '' to 'root'[0m
      [32m- change group from '' to 'root'[0m
    * template[/opt/gitlab/sv/postgresql/control/t] action create[2025-07-12T20:44:37+03:00] INFO: template[/opt/gitlab/sv/postgresql/control/t] created file /opt/gitlab/sv/postgresql/control/t

      [32m- create new file /opt/gitlab/sv/postgresql/control/t[0m[2025-07-12T20:44:37+03:00] INFO: template[/opt/gitlab/sv/postgresql/control/t] updated file contents /opt/gitlab/sv/postgresql/control/t

      [32m- update content in file /opt/gitlab/sv/postgresql/control/t from none to 05ae12[0m
      [37m--- /opt/gitlab/sv/postgresql/control/t	2025-07-12 20:44:37.421835988 +0300[0m
      [37m+++ /opt/gitlab/sv/postgresql/control/.chef-t20250712-17810-h0e6i6	2025-07-12 20:44:37.421835988 +0300[0m
      [37m@@ -1,3 +1,6 @@[0m
      [37m+#!/bin/sh[0m
      [37m+echo "received TERM from runit, sending INT instead to force quit connections"[0m
      [37m+/opt/gitlab/embedded/bin/sv interrupt postgresql[0m[2025-07-12T20:44:37+03:00] INFO: template[/opt/gitlab/sv/postgresql/control/t] owner changed to 0
[2025-07-12T20:44:37+03:00] INFO: template[/opt/gitlab/sv/postgresql/control/t] group changed to 0
[2025-07-12T20:44:37+03:00] INFO: template[/opt/gitlab/sv/postgresql/control/t] mode changed to 755

      [32m- change mode from '' to '0755'[0m
      [32m- change owner from '' to 'root'[0m
      [32m- change group from '' to 'root'[0m
    * link[/opt/gitlab/init/postgresql] action create[2025-07-12T20:44:37+03:00] INFO: link[/opt/gitlab/init/postgresql] created

      [32m- create symlink at /opt/gitlab/init/postgresql to /opt/gitlab/embedded/bin/sv[0m
    * file[/opt/gitlab/sv/postgresql/down] action nothing (skipped due to action :nothing)
[2025-07-12T20:44:37+03:00] INFO: template[/opt/gitlab/sv/postgresql/run] sending run action to ruby_block[restart_service] (delayed)
    * ruby_block[restart_service] action run (skipped due to only_if)
[2025-07-12T20:44:37+03:00] INFO: template[/opt/gitlab/sv/postgresql/log/config] sending create action to ruby_block[reload_log_service] (delayed)
    * ruby_block[reload_log_service] action create
      * ruby_block[restart_service] action nothing (skipped due to action :nothing)
      * ruby_block[restart_log_service] action nothing (skipped due to action :nothing)
      * ruby_block[reload_log_service] action nothing (skipped due to action :nothing)
      * directory[/opt/gitlab/sv/postgresql] action create (up to date)
      * template[/opt/gitlab/sv/postgresql/run] action create (up to date)
      * directory[/opt/gitlab/sv/postgresql/log] action create (up to date)
      * directory[/opt/gitlab/sv/postgresql/log/main] action create (up to date)
      * template[/opt/gitlab/sv/postgresql/log/config] action create (up to date)
      * ruby_block[verify_chown_persisted_on_postgresql] action nothing (skipped due to action :nothing)
      * link[/var/log/gitlab/postgresql/config] action create (up to date)
      * template[/opt/gitlab/sv/postgresql/log/run] action create (up to date)
      * directory[/opt/gitlab/sv/postgresql/env] action create (up to date)
      * ruby_block[Delete unmanaged env files for postgresql service] action run (skipped due to only_if)
      * template[/opt/gitlab/sv/postgresql/check] action create (skipped due to only_if)
      * template[/opt/gitlab/sv/postgresql/finish] action create (skipped due to only_if)
      * directory[/opt/gitlab/sv/postgresql/control] action create (up to date)
      * template[/opt/gitlab/sv/postgresql/control/t] action create (up to date)
      * link[/opt/gitlab/init/postgresql] action create (up to date)
      * file[/opt/gitlab/sv/postgresql/down] action nothing (skipped due to action :nothing)
      * directory[/opt/gitlab/service] action create (up to date)
      * link[/opt/gitlab/service/postgresql] action create[2025-07-12T20:44:37+03:00] INFO: link[/opt/gitlab/service/postgresql] created

        [32m- create symlink at /opt/gitlab/service/postgresql to /opt/gitlab/sv/postgresql[0m
      * ruby_block[wait for postgresql service socket] action run[2025-07-12T20:44:41+03:00] INFO: ruby_block[wait for postgresql service socket] called

        [32m- execute the ruby block wait for postgresql service socket[0m
      * directory[/opt/gitlab/service/postgresql/supervise] action create[2025-07-12T20:44:41+03:00] INFO: directory[/opt/gitlab/service/postgresql/supervise] mode changed to 755

        [32m- change mode from '0700' to '0755'[0m
      * directory[/opt/gitlab/service/postgresql/log/supervise] action create[2025-07-12T20:44:41+03:00] INFO: directory[/opt/gitlab/service/postgresql/log/supervise] mode changed to 755

        [32m- change mode from '0700' to '0755'[0m
      * file[/opt/gitlab/service/postgresql/supervise/ok] action touch[2025-07-12T20:44:41+03:00] INFO: file[/opt/gitlab/service/postgresql/supervise/ok] created file /opt/gitlab/service/postgresql/supervise/ok

        [32m- create new file /opt/gitlab/service/postgresql/supervise/ok[0m[2025-07-12T20:44:41+03:00] INFO: file[/opt/gitlab/service/postgresql/supervise/ok] owner changed to 992
[2025-07-12T20:44:41+03:00] INFO: file[/opt/gitlab/service/postgresql/supervise/ok] group changed to 989

        [32m- change owner from '' to 'gitlab-psql'[0m
        [32m- change group from '' to 'gitlab-psql'[0m[2025-07-12T20:44:41+03:00] INFO: file[/opt/gitlab/service/postgresql/supervise/ok] updated atime and mtime to 2025-07-12 20:44:41 +0300

        [32m- update utime on file /opt/gitlab/service/postgresql/supervise/ok[0m
      * file[/opt/gitlab/service/postgresql/log/supervise/ok] action touch[2025-07-12T20:44:41+03:00] INFO: file[/opt/gitlab/service/postgresql/log/supervise/ok] created file /opt/gitlab/service/postgresql/log/supervise/ok

        [32m- create new file /opt/gitlab/service/postgresql/log/supervise/ok[0m[2025-07-12T20:44:41+03:00] INFO: file[/opt/gitlab/service/postgresql/log/supervise/ok] owner changed to 992
[2025-07-12T20:44:41+03:00] INFO: file[/opt/gitlab/service/postgresql/log/supervise/ok] group changed to 989

        [32m- change owner from '' to 'gitlab-psql'[0m
        [32m- change group from '' to 'gitlab-psql'[0m[2025-07-12T20:44:41+03:00] INFO: file[/opt/gitlab/service/postgresql/log/supervise/ok] updated atime and mtime to 2025-07-12 20:44:41 +0300

        [32m- update utime on file /opt/gitlab/service/postgresql/log/supervise/ok[0m
      * file[/opt/gitlab/service/postgresql/supervise/status] action touch[2025-07-12T20:44:41+03:00] INFO: file[/opt/gitlab/service/postgresql/supervise/status] owner changed to 992
[2025-07-12T20:44:41+03:00] INFO: file[/opt/gitlab/service/postgresql/supervise/status] group changed to 989

        [32m- change owner from 'root' to 'gitlab-psql'[0m
        [32m- change group from 'root' to 'gitlab-psql'[0m[2025-07-12T20:44:41+03:00] INFO: file[/opt/gitlab/service/postgresql/supervise/status] updated atime and mtime to 2025-07-12 20:44:41 +0300

        [32m- update utime on file /opt/gitlab/service/postgresql/supervise/status[0m
      * file[/opt/gitlab/service/postgresql/log/supervise/status] action touch[2025-07-12T20:44:41+03:00] INFO: file[/opt/gitlab/service/postgresql/log/supervise/status] owner changed to 992
[2025-07-12T20:44:41+03:00] INFO: file[/opt/gitlab/service/postgresql/log/supervise/status] group changed to 989

        [32m- change owner from 'root' to 'gitlab-psql'[0m
        [32m- change group from 'root' to 'gitlab-psql'[0m[2025-07-12T20:44:41+03:00] INFO: file[/opt/gitlab/service/postgresql/log/supervise/status] updated atime and mtime to 2025-07-12 20:44:41 +0300

        [32m- update utime on file /opt/gitlab/service/postgresql/log/supervise/status[0m
      * file[/opt/gitlab/service/postgresql/supervise/control] action touch[2025-07-12T20:44:41+03:00] INFO: file[/opt/gitlab/service/postgresql/supervise/control] created file /opt/gitlab/service/postgresql/supervise/control

        [32m- create new file /opt/gitlab/service/postgresql/supervise/control[0m[2025-07-12T20:44:41+03:00] INFO: file[/opt/gitlab/service/postgresql/supervise/control] owner changed to 992
[2025-07-12T20:44:41+03:00] INFO: file[/opt/gitlab/service/postgresql/supervise/control] group changed to 989

        [32m- change owner from '' to 'gitlab-psql'[0m
        [32m- change group from '' to 'gitlab-psql'[0m[2025-07-12T20:44:41+03:00] INFO: file[/opt/gitlab/service/postgresql/supervise/control] updated atime and mtime to 2025-07-12 20:44:41 +0300

        [32m- update utime on file /opt/gitlab/service/postgresql/supervise/control[0m
      * file[/opt/gitlab/service/postgresql/log/supervise/control] action touch[2025-07-12T20:44:41+03:00] INFO: file[/opt/gitlab/service/postgresql/log/supervise/control] created file /opt/gitlab/service/postgresql/log/supervise/control

        [32m- create new file /opt/gitlab/service/postgresql/log/supervise/control[0m[2025-07-12T20:44:41+03:00] INFO: file[/opt/gitlab/service/postgresql/log/supervise/control] owner changed to 992
[2025-07-12T20:44:41+03:00] INFO: file[/opt/gitlab/service/postgresql/log/supervise/control] group changed to 989

        [32m- change owner from '' to 'gitlab-psql'[0m
        [32m- change group from '' to 'gitlab-psql'[0m[2025-07-12T20:44:41+03:00] INFO: file[/opt/gitlab/service/postgresql/log/supervise/control] updated atime and mtime to 2025-07-12 20:44:41 +0300

        [32m- update utime on file /opt/gitlab/service/postgresql/log/supervise/control[0m
      * file[/var/log/gitlab/postgresql/current] action touch (skipped due to only_if)
[2025-07-12T20:44:41+03:00] INFO: ruby_block[reload_log_service] called
      [32m- execute the ruby block reload_log_service[0m
[2025-07-12T20:44:41+03:00] INFO: template[/opt/gitlab/sv/postgresql/log/run] sending run action to ruby_block[restart_log_service] (delayed)
    * ruby_block[restart_log_service] action run
      * ruby_block[restart_service] action nothing (skipped due to action :nothing)
      * ruby_block[restart_log_service] action nothing (skipped due to action :nothing)
      * ruby_block[reload_log_service] action nothing (skipped due to action :nothing)
      * directory[/opt/gitlab/sv/postgresql] action create (up to date)
      * template[/opt/gitlab/sv/postgresql/run] action create (up to date)
      * directory[/opt/gitlab/sv/postgresql/log] action create (up to date)
      * directory[/opt/gitlab/sv/postgresql/log/main] action create (up to date)
      * template[/opt/gitlab/sv/postgresql/log/config] action create (up to date)
      * ruby_block[verify_chown_persisted_on_postgresql] action nothing (skipped due to action :nothing)
      * link[/var/log/gitlab/postgresql/config] action create (up to date)
      * template[/opt/gitlab/sv/postgresql/log/run] action create (up to date)
      * directory[/opt/gitlab/sv/postgresql/env] action create (up to date)
      * ruby_block[Delete unmanaged env files for postgresql service] action run (skipped due to only_if)
      * template[/opt/gitlab/sv/postgresql/check] action create (skipped due to only_if)
      * template[/opt/gitlab/sv/postgresql/finish] action create (skipped due to only_if)
      * directory[/opt/gitlab/sv/postgresql/control] action create (up to date)
      * template[/opt/gitlab/sv/postgresql/control/t] action create (up to date)
      * link[/opt/gitlab/init/postgresql] action create (up to date)
      * file[/opt/gitlab/sv/postgresql/down] action nothing (skipped due to action :nothing)
      * directory[/opt/gitlab/service] action create (up to date)
      * link[/opt/gitlab/service/postgresql] action create (up to date)
      * ruby_block[wait for postgresql service socket] action run (skipped due to not_if)
      * directory[/opt/gitlab/service/postgresql/supervise] action create (up to date)
      * directory[/opt/gitlab/service/postgresql/log/supervise] action create (up to date)
      * file[/opt/gitlab/service/postgresql/supervise/ok] action touch (skipped due to only_if)
      * file[/opt/gitlab/service/postgresql/log/supervise/ok] action touch (skipped due to only_if)
      * file[/opt/gitlab/service/postgresql/supervise/status] action touch (skipped due to only_if)
      * file[/opt/gitlab/service/postgresql/log/supervise/status] action touch[2025-07-12T20:44:41+03:00] INFO: file[/opt/gitlab/service/postgresql/log/supervise/status] owner changed to 992
[2025-07-12T20:44:41+03:00] INFO: file[/opt/gitlab/service/postgresql/log/supervise/status] group changed to 989

        [32m- change owner from 'root' to 'gitlab-psql'[0m
        [32m- change group from 'root' to 'gitlab-psql'[0m[2025-07-12T20:44:41+03:00] INFO: file[/opt/gitlab/service/postgresql/log/supervise/status] updated atime and mtime to 2025-07-12 20:44:41 +0300

        [32m- update utime on file /opt/gitlab/service/postgresql/log/supervise/status[0m
      * file[/opt/gitlab/service/postgresql/supervise/control] action touch (skipped due to only_if)
      * file[/opt/gitlab/service/postgresql/log/supervise/control] action touch (skipped due to only_if)
      * file[/var/log/gitlab/postgresql/current] action touch (skipped due to only_if)
[2025-07-12T20:44:42+03:00] INFO: ruby_block[restart_log_service] called
      [32m- execute the ruby block restart_log_service[0m
    * directory[/opt/gitlab/service] action create (up to date)
    * link[/opt/gitlab/service/postgresql] action create (up to date)
    * ruby_block[wait for postgresql service socket] action run (skipped due to not_if)
    * directory[/opt/gitlab/service/postgresql/supervise] action create (up to date)
    * directory[/opt/gitlab/service/postgresql/log/supervise] action create (up to date)
    * file[/opt/gitlab/service/postgresql/supervise/ok] action touch (skipped due to only_if)
    * file[/opt/gitlab/service/postgresql/log/supervise/ok] action touch (skipped due to only_if)
    * file[/opt/gitlab/service/postgresql/supervise/status] action touch (skipped due to only_if)
    * file[/opt/gitlab/service/postgresql/log/supervise/status] action touch[2025-07-12T20:44:42+03:00] INFO: file[/opt/gitlab/service/postgresql/log/supervise/status] owner changed to 992
[2025-07-12T20:44:42+03:00] INFO: file[/opt/gitlab/service/postgresql/log/supervise/status] group changed to 989

      [32m- change owner from 'root' to 'gitlab-psql'[0m
      [32m- change group from 'root' to 'gitlab-psql'[0m[2025-07-12T20:44:42+03:00] INFO: file[/opt/gitlab/service/postgresql/log/supervise/status] updated atime and mtime to 2025-07-12 20:44:42 +0300

      [32m- update utime on file /opt/gitlab/service/postgresql/log/supervise/status[0m
    * file[/opt/gitlab/service/postgresql/supervise/control] action touch (skipped due to only_if)
    * file[/opt/gitlab/service/postgresql/log/supervise/control] action touch (skipped due to only_if)
    * file[/var/log/gitlab/postgresql/current] action touch (skipped due to only_if)
  
  * execute[/opt/gitlab/bin/gitlab-ctl start postgresql] action run
    [execute] ok: run: postgresql: (pid 18528) 2s
[2025-07-12T20:44:43+03:00] INFO: execute[/opt/gitlab/bin/gitlab-ctl start postgresql] ran successfully
    [32m- execute /opt/gitlab/bin/gitlab-ctl start postgresql[0m
  * database_objects[postgresql] action create
    * postgresql_user[gitlab] action create
      * execute[create gitlab postgresql user] action run
        [execute] CREATE ROLE
[2025-07-12T20:44:43+03:00] INFO: execute[create gitlab postgresql user] ran successfully
        [32m- execute /opt/gitlab/bin/gitlab-psql -d template1 -c "CREATE USER \"gitlab\""[0m
    
    * postgresql_user[gitlab_replicator] action create
      * execute[create gitlab_replicator postgresql user] action run
        [execute] CREATE ROLE
[2025-07-12T20:44:43+03:00] INFO: execute[create gitlab_replicator postgresql user] ran successfully
        [32m- execute /opt/gitlab/bin/gitlab-psql -d template1 -c "CREATE USER \"gitlab_replicator\""[0m
      * execute[set options for gitlab_replicator postgresql user] action run
        [execute] ALTER ROLE
[2025-07-12T20:44:44+03:00] INFO: execute[set options for gitlab_replicator postgresql user] ran successfully
        [32m- execute /opt/gitlab/bin/gitlab-psql -d template1 -c "ALTER USER \"gitlab_replicator\" replication"[0m
    
    * postgresql_database[gitlabhq_production] action create
      * execute[create database gitlabhq_production] action run[2025-07-12T20:44:44+03:00] INFO: execute[create database gitlabhq_production] ran successfully

        [32m- execute /opt/gitlab/embedded/bin/createdb --port 5432 -h /var/opt/gitlab/postgresql -O gitlab gitlabhq_production[0m
    
    * postgresql_extension[pg_trgm] action enable
      * postgresql_query[enable pg_trgm extension] action run
        * execute[enable pg_trgm extension (postgresql)] action run
          [execute] CREATE EXTENSION
[2025-07-12T20:44:44+03:00] INFO: execute[enable pg_trgm extension (postgresql)] ran successfully
          [32m- execute /opt/gitlab/bin/gitlab-psql -d gitlabhq_production -c "CREATE EXTENSION IF NOT EXISTS pg_trgm"[0m
      
    
    * postgresql_extension[btree_gist] action enable
      * postgresql_query[enable btree_gist extension] action run
        * execute[enable btree_gist extension (postgresql)] action run
          [execute] CREATE EXTENSION
[2025-07-12T20:44:44+03:00] INFO: execute[enable btree_gist extension (postgresql)] ran successfully
          [32m- execute /opt/gitlab/bin/gitlab-psql -d gitlabhq_production -c "CREATE EXTENSION IF NOT EXISTS btree_gist"[0m
      
    
    * postgresql_database[gitlabhq_production] action create
      * execute[create database gitlabhq_production] action run (skipped due to not_if)
       (up to date)
    * postgresql_extension[pg_trgm] action enable
      * postgresql_query[enable pg_trgm extension] action run (skipped due to only_if)
       (up to date)
    * postgresql_extension[btree_gist] action enable
      * postgresql_query[enable btree_gist extension] action run (skipped due to only_if)
       (up to date)
  
  * version_file[Create version file for PostgreSQL] action create
    * file[/var/opt/gitlab/postgresql/VERSION] action create[2025-07-12T20:44:45+03:00] INFO: file[/var/opt/gitlab/postgresql/VERSION] created file /var/opt/gitlab/postgresql/VERSION

      [32m- create new file /var/opt/gitlab/postgresql/VERSION[0m[2025-07-12T20:44:45+03:00] INFO: file[/var/opt/gitlab/postgresql/VERSION] updated file contents /var/opt/gitlab/postgresql/VERSION

      [32m- update content in file /var/opt/gitlab/postgresql/VERSION from none to bc429b[0m
      [37m--- /var/opt/gitlab/postgresql/VERSION	2025-07-12 20:44:45.393835988 +0300[0m
      [37m+++ /var/opt/gitlab/postgresql/.chef-VERSION20250712-17810-5vlswu	2025-07-12 20:44:45.393835988 +0300[0m
      [37m@@ -1 +1,2 @@[0m
      [37m+postgres (PostgreSQL) 16.8[0m
  
  * ruby_block[warn pending postgresql restart] action run (skipped due to only_if)
  * execute[reload postgresql] action nothing (skipped due to action :nothing)
  * execute[start postgresql] action nothing (skipped due to action :nothing)
Recipe: praefect::disable
  * service[praefect] action nothing (skipped due to action :nothing)
  * runit_service[praefect] action disable
    * ruby_block[disable praefect] action run (skipped due to only_if)
     (up to date)
  * consul_service[praefect] action delete
    * file[/var/opt/gitlab/consul/config.d/praefect-service.json] action delete (up to date)
     (up to date)
Recipe: gitlab-kas::enable
  * directory[/var/opt/gitlab/gitlab-kas] action create[2025-07-12T20:44:45+03:00] INFO: directory[/var/opt/gitlab/gitlab-kas] created directory /var/opt/gitlab/gitlab-kas

    [32m- create new directory /var/opt/gitlab/gitlab-kas[0m[2025-07-12T20:44:45+03:00] INFO: directory[/var/opt/gitlab/gitlab-kas] owner changed to 994
[2025-07-12T20:44:45+03:00] INFO: directory[/var/opt/gitlab/gitlab-kas] mode changed to 700

    [32m- change mode from '' to '0700'[0m
    [32m- change owner from '' to 'git'[0m
  * directory[/opt/gitlab/etc/gitlab-kas] action create[2025-07-12T20:44:45+03:00] INFO: directory[/opt/gitlab/etc/gitlab-kas] created directory /opt/gitlab/etc/gitlab-kas

    [32m- create new directory /opt/gitlab/etc/gitlab-kas[0m[2025-07-12T20:44:45+03:00] INFO: directory[/opt/gitlab/etc/gitlab-kas] owner changed to 994
[2025-07-12T20:44:45+03:00] INFO: directory[/opt/gitlab/etc/gitlab-kas] mode changed to 700

    [32m- change mode from '' to '0700'[0m
    [32m- change owner from '' to 'git'[0m
  * directory[/var/log/gitlab/gitlab-kas] action create[2025-07-12T20:44:45+03:00] INFO: directory[/var/log/gitlab/gitlab-kas] created directory /var/log/gitlab/gitlab-kas

    [32m- create new directory /var/log/gitlab/gitlab-kas[0m[2025-07-12T20:44:45+03:00] INFO: directory[/var/log/gitlab/gitlab-kas] owner changed to 994
[2025-07-12T20:44:45+03:00] INFO: directory[/var/log/gitlab/gitlab-kas] mode changed to 700

    [32m- change mode from '' to '0700'[0m
    [32m- change owner from '' to 'git'[0m
  * version_file[Create version file for Gitlab KAS] action create
    * file[/var/opt/gitlab/gitlab-kas/VERSION] action create[2025-07-12T20:44:45+03:00] INFO: file[/var/opt/gitlab/gitlab-kas/VERSION] created file /var/opt/gitlab/gitlab-kas/VERSION

      [32m- create new file /var/opt/gitlab/gitlab-kas/VERSION[0m[2025-07-12T20:44:45+03:00] INFO: file[/var/opt/gitlab/gitlab-kas/VERSION] updated file contents /var/opt/gitlab/gitlab-kas/VERSION

      [32m- update content in file /var/opt/gitlab/gitlab-kas/VERSION from none to 7a6820[0m
      [37m--- /var/opt/gitlab/gitlab-kas/VERSION	2025-07-12 20:44:45.905835988 +0300[0m
      [37m+++ /var/opt/gitlab/gitlab-kas/.chef-VERSION20250712-17810-m3qu5h	2025-07-12 20:44:45.905835988 +0300[0m
      [37m@@ -1 +1,2 @@[0m
      [37m+kas version v18.1.2, git ref: v18.1.2[0m
  
  * file[/var/opt/gitlab/gitlab-kas/authentication_secret_file] action create[2025-07-12T20:44:45+03:00] INFO: file[/var/opt/gitlab/gitlab-kas/authentication_secret_file] created file /var/opt/gitlab/gitlab-kas/authentication_secret_file

    [32m- create new file /var/opt/gitlab/gitlab-kas/authentication_secret_file[0m[2025-07-12T20:44:45+03:00] INFO: file[/var/opt/gitlab/gitlab-kas/authentication_secret_file] updated file contents /var/opt/gitlab/gitlab-kas/authentication_secret_file

    [32m- update content in file /var/opt/gitlab/gitlab-kas/authentication_secret_file from none to dbe9f3[0m
    [37m--- /var/opt/gitlab/gitlab-kas/authentication_secret_file	2025-07-12 20:44:45.913835988 +0300[0m
    [37m+++ /var/opt/gitlab/gitlab-kas/.chef-authentication_secret_file20250712-17810-vc7xgp	2025-07-12 20:44:45.913835988 +0300[0m
    [37m@@ -1 +1,2 @@[0m
    [37m+NGFmYjViNTY3MDA2ZWM0MmU3Zjk4NzJmYzZhNTQzN2U=[0m[2025-07-12T20:44:45+03:00] INFO: file[/var/opt/gitlab/gitlab-kas/authentication_secret_file] owner changed to 0
[2025-07-12T20:44:45+03:00] INFO: file[/var/opt/gitlab/gitlab-kas/authentication_secret_file] group changed to 991
[2025-07-12T20:44:45+03:00] INFO: file[/var/opt/gitlab/gitlab-kas/authentication_secret_file] mode changed to 640

    [32m- change mode from '' to '0640'[0m
    [32m- change owner from '' to 'root'[0m
    [32m- change group from '' to 'git'[0m
  * file[/var/opt/gitlab/gitlab-kas/private_api_authentication_secret_file] action create[2025-07-12T20:44:45+03:00] INFO: file[/var/opt/gitlab/gitlab-kas/private_api_authentication_secret_file] created file /var/opt/gitlab/gitlab-kas/private_api_authentication_secret_file

    [32m- create new file /var/opt/gitlab/gitlab-kas/private_api_authentication_secret_file[0m[2025-07-12T20:44:45+03:00] INFO: file[/var/opt/gitlab/gitlab-kas/private_api_authentication_secret_file] updated file contents /var/opt/gitlab/gitlab-kas/private_api_authentication_secret_file

    [32m- update content in file /var/opt/gitlab/gitlab-kas/private_api_authentication_secret_file from none to bfab66[0m
    [37m--- /var/opt/gitlab/gitlab-kas/private_api_authentication_secret_file	2025-07-12 20:44:45.921835988 +0300[0m
    [37m+++ /var/opt/gitlab/gitlab-kas/.chef-private_api_authentication_secret_file20250712-17810-wvnfq4	2025-07-12 20:44:45.921835988 +0300[0m
    [37m@@ -1 +1,2 @@[0m
    [37m+ZDc2YWE2OTA3MzAzNGRjMjBiY2ZkMzU1YzA5MjdlMzg=[0m[2025-07-12T20:44:45+03:00] INFO: file[/var/opt/gitlab/gitlab-kas/private_api_authentication_secret_file] owner changed to 0
[2025-07-12T20:44:45+03:00] INFO: file[/var/opt/gitlab/gitlab-kas/private_api_authentication_secret_file] group changed to 991
[2025-07-12T20:44:45+03:00] INFO: file[/var/opt/gitlab/gitlab-kas/private_api_authentication_secret_file] mode changed to 640

    [32m- change mode from '' to '0640'[0m
    [32m- change owner from '' to 'root'[0m
    [32m- change group from '' to 'git'[0m
  * file[/var/opt/gitlab/gitlab-kas/websocket_token_secret_file] action create[2025-07-12T20:44:45+03:00] INFO: file[/var/opt/gitlab/gitlab-kas/websocket_token_secret_file] created file /var/opt/gitlab/gitlab-kas/websocket_token_secret_file

    [32m- create new file /var/opt/gitlab/gitlab-kas/websocket_token_secret_file[0m[2025-07-12T20:44:45+03:00] INFO: file[/var/opt/gitlab/gitlab-kas/websocket_token_secret_file] updated file contents /var/opt/gitlab/gitlab-kas/websocket_token_secret_file

    [32m- update content in file /var/opt/gitlab/gitlab-kas/websocket_token_secret_file from none to b721a4[0m
    [37m--- /var/opt/gitlab/gitlab-kas/websocket_token_secret_file	2025-07-12 20:44:45.925835988 +0300[0m
    [37m+++ /var/opt/gitlab/gitlab-kas/.chef-websocket_token_secret_file20250712-17810-wbmhxn	2025-07-12 20:44:45.925835988 +0300[0m
    [37m@@ -1 +1,2 @@[0m
    [37m+B2qaeJY/EUOKLc8Gak9EghOlxFMrfbhfVXjDMJVug0ENmljsnrzjR5VJdJG1fB8r7E12WWXN5ZkSQpmFcTr8rKawP9c6booA[0m[2025-07-12T20:44:45+03:00] INFO: file[/var/opt/gitlab/gitlab-kas/websocket_token_secret_file] owner changed to 0
[2025-07-12T20:44:45+03:00] INFO: file[/var/opt/gitlab/gitlab-kas/websocket_token_secret_file] group changed to 991
[2025-07-12T20:44:45+03:00] INFO: file[/var/opt/gitlab/gitlab-kas/websocket_token_secret_file] mode changed to 640

    [32m- change mode from '' to '0640'[0m
    [32m- change owner from '' to 'root'[0m
    [32m- change group from '' to 'git'[0m
  * file[/var/opt/gitlab/gitlab-kas/redis_password_file] action create (skipped due to only_if)
  * file[/var/opt/gitlab/gitlab-kas/redis_sentinels_password_file] action create (skipped due to only_if)
  * template[/var/opt/gitlab/gitlab-kas/gitlab-kas-config.yml] action create[2025-07-12T20:44:45+03:00] INFO: template[/var/opt/gitlab/gitlab-kas/gitlab-kas-config.yml] created file /var/opt/gitlab/gitlab-kas/gitlab-kas-config.yml

    [32m- create new file /var/opt/gitlab/gitlab-kas/gitlab-kas-config.yml[0m[2025-07-12T20:44:45+03:00] INFO: template[/var/opt/gitlab/gitlab-kas/gitlab-kas-config.yml] updated file contents /var/opt/gitlab/gitlab-kas/gitlab-kas-config.yml

    [32m- update content in file /var/opt/gitlab/gitlab-kas/gitlab-kas-config.yml from none to 037cf0[0m
    [37m--- /var/opt/gitlab/gitlab-kas/gitlab-kas-config.yml	2025-07-12 20:44:45.945835988 +0300[0m
    [37m+++ /var/opt/gitlab/gitlab-kas/.chef-gitlab-kas-config20250712-17810-g36ql0.yml	2025-07-12 20:44:45.945835988 +0300[0m
    [37m@@ -1,43 +1,86 @@[0m
    [37m+agent:[0m
    [37m+  listen:[0m
    [37m+    address: localhost:8150[0m
    [37m+    network: tcp[0m
    [37m+    websocket: true[0m
    [37m+  configuration:[0m
    [37m+    poll_period: 300s[0m
    [37m+  kubernetes_api:[0m
    [37m+    listen:[0m
    [37m+      address: localhost:8154[0m
    [37m+    url_path_prefix: /[0m
    [37m+    websocket_token_secret_file: /var/opt/gitlab/gitlab-kas/websocket_token_secret_file[0m
    [37m+  info_cache_ttl: 300s[0m
    [37m+  info_cache_error_ttl: 60s[0m
    [37m+gitlab:[0m
    [37m+  address: http://gitlab.example.com[0m
    [37m+  external_url: http://gitlab.example.com[0m
    [37m+  authentication_secret_file: /var/opt/gitlab/gitlab-kas/authentication_secret_file[0m
    [37m+observability:[0m
    [37m+  listen:[0m
    [37m+    address: localhost:8151[0m
    [37m+    network: tcp[0m
    [37m+  usage_reporting_period: 60s[0m
    [37m+  logging:[0m
    [37m+    level: info[0m
    [37m+    grpc_level: error[0m
    [37m+redis:[0m
    [37m+  network: unix[0m
    [37m+  tls:[0m
    [37m+    enabled: false[0m
    [37m+  server:[0m
    [37m+    address: '/var/opt/gitlab/redis/redis.socket'[0m
    [37m+api:[0m
    [37m+  listen:[0m
    [37m+    network: tcp[0m
    [37m+    address: localhost:8153[0m
    [37m+    authentication_secret_file: /var/opt/gitlab/gitlab-kas/authentication_secret_file[0m
    [37m+private_api:[0m
    [37m+  listen:[0m
    [37m+    network: tcp[0m
    [37m+    address: localhost:8155[0m
    [37m+    authentication_secret_file: /var/opt/gitlab/gitlab-kas/private_api_authentication_secret_file[0m
    [37m+config:[0m[2025-07-12T20:44:45+03:00] INFO: template[/var/opt/gitlab/gitlab-kas/gitlab-kas-config.yml] owner changed to 0
[2025-07-12T20:44:45+03:00] INFO: template[/var/opt/gitlab/gitlab-kas/gitlab-kas-config.yml] group changed to 991
[2025-07-12T20:44:45+03:00] INFO: template[/var/opt/gitlab/gitlab-kas/gitlab-kas-config.yml] mode changed to 640

    [32m- change mode from '' to '0640'[0m
    [32m- change owner from '' to 'root'[0m
    [32m- change group from '' to 'git'[0m
  * env_dir[/opt/gitlab/etc/gitlab-kas/env] action create
    * directory[/opt/gitlab/etc/gitlab-kas/env] action create[2025-07-12T20:44:45+03:00] INFO: directory[/opt/gitlab/etc/gitlab-kas/env] created directory /opt/gitlab/etc/gitlab-kas/env

      [32m- create new directory /opt/gitlab/etc/gitlab-kas/env[0m
    * file[/opt/gitlab/etc/gitlab-kas/env/SSL_CERT_DIR] action create[2025-07-12T20:44:45+03:00] INFO: file[/opt/gitlab/etc/gitlab-kas/env/SSL_CERT_DIR] created file /opt/gitlab/etc/gitlab-kas/env/SSL_CERT_DIR

      [32m- create new file /opt/gitlab/etc/gitlab-kas/env/SSL_CERT_DIR[0m[2025-07-12T20:44:45+03:00] INFO: file[/opt/gitlab/etc/gitlab-kas/env/SSL_CERT_DIR] updated file contents /opt/gitlab/etc/gitlab-kas/env/SSL_CERT_DIR

      [32m- update content in file /opt/gitlab/etc/gitlab-kas/env/SSL_CERT_DIR from none to 4f45cf[0m
      [32m- suppressed sensitive resource[0m
  
  * service[gitlab-kas] action nothing (skipped due to action :nothing)
  * runit_service[gitlab-kas] action enable
    * ruby_block[restart_service] action nothing (skipped due to action :nothing)
    * ruby_block[restart_log_service] action nothing (skipped due to action :nothing)
    * ruby_block[reload_log_service] action nothing (skipped due to action :nothing)
    * directory[/opt/gitlab/sv/gitlab-kas] action create[2025-07-12T20:44:45+03:00] INFO: directory[/opt/gitlab/sv/gitlab-kas] created directory /opt/gitlab/sv/gitlab-kas

      [32m- create new directory /opt/gitlab/sv/gitlab-kas[0m[2025-07-12T20:44:45+03:00] INFO: directory[/opt/gitlab/sv/gitlab-kas] owner changed to 0
[2025-07-12T20:44:45+03:00] INFO: directory[/opt/gitlab/sv/gitlab-kas] group changed to 0
[2025-07-12T20:44:45+03:00] INFO: directory[/opt/gitlab/sv/gitlab-kas] mode changed to 755

      [32m- change mode from '' to '0755'[0m
      [32m- change owner from '' to 'root'[0m
      [32m- change group from '' to 'root'[0m
    * template[/opt/gitlab/sv/gitlab-kas/run] action create[2025-07-12T20:44:45+03:00] INFO: template[/opt/gitlab/sv/gitlab-kas/run] created file /opt/gitlab/sv/gitlab-kas/run

      [32m- create new file /opt/gitlab/sv/gitlab-kas/run[0m[2025-07-12T20:44:45+03:00] INFO: template[/opt/gitlab/sv/gitlab-kas/run] updated file contents /opt/gitlab/sv/gitlab-kas/run

      [32m- update content in file /opt/gitlab/sv/gitlab-kas/run from none to ac037b[0m
      [37m--- /opt/gitlab/sv/gitlab-kas/run	2025-07-12 20:44:45.977835988 +0300[0m
      [37m+++ /opt/gitlab/sv/gitlab-kas/.chef-run20250712-17810-osykuo	2025-07-12 20:44:45.977835988 +0300[0m
      [37m@@ -1,11 +1,22 @@[0m
      [37m+#!/bin/bash[0m
      [37m+[0m
      [37m+# Let runit capture all script error messages[0m
      [37m+exec 2>&1[0m
      [37m+[0m
      [37m+[0m
      [37m+[0m
      [37m+exec chpst -e /opt/gitlab/etc/gitlab-kas/env -P \[0m
      [37m+  -u git:git \[0m
      [37m+  -U git:git \[0m
      [37m+  /opt/gitlab/embedded/bin/gitlab-kas --configuration-file /var/opt/gitlab/gitlab-kas/gitlab-kas-config.yml[0m[2025-07-12T20:44:45+03:00] INFO: template[/opt/gitlab/sv/gitlab-kas/run] owner changed to 0
[2025-07-12T20:44:45+03:00] INFO: template[/opt/gitlab/sv/gitlab-kas/run] group changed to 0
[2025-07-12T20:44:45+03:00] INFO: template[/opt/gitlab/sv/gitlab-kas/run] mode changed to 755

      [32m- change mode from '' to '0755'[0m
      [32m- change owner from '' to 'root'[0m
      [32m- change group from '' to 'root'[0m
    * directory[/opt/gitlab/sv/gitlab-kas/log] action create[2025-07-12T20:44:45+03:00] INFO: directory[/opt/gitlab/sv/gitlab-kas/log] created directory /opt/gitlab/sv/gitlab-kas/log

      [32m- create new directory /opt/gitlab/sv/gitlab-kas/log[0m[2025-07-12T20:44:45+03:00] INFO: directory[/opt/gitlab/sv/gitlab-kas/log] owner changed to 0
[2025-07-12T20:44:45+03:00] INFO: directory[/opt/gitlab/sv/gitlab-kas/log] group changed to 0
[2025-07-12T20:44:45+03:00] INFO: directory[/opt/gitlab/sv/gitlab-kas/log] mode changed to 755

      [32m- change mode from '' to '0755'[0m
      [32m- change owner from '' to 'root'[0m
      [32m- change group from '' to 'root'[0m
    * directory[/opt/gitlab/sv/gitlab-kas/log/main] action create[2025-07-12T20:44:45+03:00] INFO: directory[/opt/gitlab/sv/gitlab-kas/log/main] created directory /opt/gitlab/sv/gitlab-kas/log/main

      [32m- create new directory /opt/gitlab/sv/gitlab-kas/log/main[0m[2025-07-12T20:44:45+03:00] INFO: directory[/opt/gitlab/sv/gitlab-kas/log/main] owner changed to 0
[2025-07-12T20:44:45+03:00] INFO: directory[/opt/gitlab/sv/gitlab-kas/log/main] group changed to 0
[2025-07-12T20:44:45+03:00] INFO: directory[/opt/gitlab/sv/gitlab-kas/log/main] mode changed to 755

      [32m- change mode from '' to '0755'[0m
      [32m- change owner from '' to 'root'[0m
      [32m- change group from '' to 'root'[0m
    * template[/opt/gitlab/sv/gitlab-kas/log/config] action create[2025-07-12T20:44:45+03:00] INFO: template[/opt/gitlab/sv/gitlab-kas/log/config] created file /opt/gitlab/sv/gitlab-kas/log/config

      [32m- create new file /opt/gitlab/sv/gitlab-kas/log/config[0m[2025-07-12T20:44:46+03:00] INFO: template[/opt/gitlab/sv/gitlab-kas/log/config] updated file contents /opt/gitlab/sv/gitlab-kas/log/config

      [32m- update content in file /opt/gitlab/sv/gitlab-kas/log/config from none to 623c00[0m
      [37m--- /opt/gitlab/sv/gitlab-kas/log/config	2025-07-12 20:44:45.997835988 +0300[0m
      [37m+++ /opt/gitlab/sv/gitlab-kas/log/.chef-config20250712-17810-34njqs	2025-07-12 20:44:45.997835988 +0300[0m
      [37m@@ -1,6 +1,12 @@[0m
      [37m+s209715200[0m
      [37m+n30[0m
      [37m+t86400[0m
      [37m+!gzip[0m
      [37m+[0m
      [37m+[0m[2025-07-12T20:44:46+03:00] INFO: template[/opt/gitlab/sv/gitlab-kas/log/config] owner changed to 0
[2025-07-12T20:44:46+03:00] INFO: template[/opt/gitlab/sv/gitlab-kas/log/config] group changed to 0
[2025-07-12T20:44:46+03:00] INFO: template[/opt/gitlab/sv/gitlab-kas/log/config] mode changed to 644

      [32m- change mode from '' to '0644'[0m
      [32m- change owner from '' to 'root'[0m
      [32m- change group from '' to 'root'[0m
    * ruby_block[verify_chown_persisted_on_gitlab-kas] action nothing (skipped due to action :nothing)
[2025-07-12T20:44:46+03:00] INFO: ruby_block[verify_chown_persisted_on_gitlab-kas] sent create action to ruby_block[verify_chown_persisted_on_gitlab-kas] (immediate at declaration time)
    * ruby_block[verify_chown_persisted_on_gitlab-kas] action create[2025-07-12T20:44:46+03:00] INFO: ruby_block[verify_chown_persisted_on_gitlab-kas] called

      [32m- execute the ruby block verify_chown_persisted_on_gitlab-kas[0m
    * link[/var/log/gitlab/gitlab-kas/config] action create[2025-07-12T20:44:46+03:00] INFO: link[/var/log/gitlab/gitlab-kas/config] created

      [32m- create symlink at /var/log/gitlab/gitlab-kas/config to /opt/gitlab/sv/gitlab-kas/log/config[0m
    * template[/opt/gitlab/sv/gitlab-kas/log/run] action create[2025-07-12T20:44:46+03:00] INFO: template[/opt/gitlab/sv/gitlab-kas/log/run] created file /opt/gitlab/sv/gitlab-kas/log/run

      [32m- create new file /opt/gitlab/sv/gitlab-kas/log/run[0m[2025-07-12T20:44:46+03:00] INFO: template[/opt/gitlab/sv/gitlab-kas/log/run] updated file contents /opt/gitlab/sv/gitlab-kas/log/run

      [32m- update content in file /opt/gitlab/sv/gitlab-kas/log/run from none to 22436c[0m
      [37m--- /opt/gitlab/sv/gitlab-kas/log/run	2025-07-12 20:44:46.009835988 +0300[0m
      [37m+++ /opt/gitlab/sv/gitlab-kas/log/.chef-run20250712-17810-9jk0av	2025-07-12 20:44:46.009835988 +0300[0m
      [37m@@ -1,5 +1,10 @@[0m
      [37m+#!/bin/sh[0m
      [37m+exec chpst -P \[0m
      [37m+  -U root:root \[0m
      [37m+  -u root:root \[0m
      [37m+  svlogd -tt /var/log/gitlab/gitlab-kas[0m[2025-07-12T20:44:46+03:00] INFO: template[/opt/gitlab/sv/gitlab-kas/log/run] owner changed to 0
[2025-07-12T20:44:46+03:00] INFO: template[/opt/gitlab/sv/gitlab-kas/log/run] group changed to 0
[2025-07-12T20:44:46+03:00] INFO: template[/opt/gitlab/sv/gitlab-kas/log/run] mode changed to 755

      [32m- change mode from '' to '0755'[0m
      [32m- change owner from '' to 'root'[0m
      [32m- change group from '' to 'root'[0m
    * directory[/opt/gitlab/sv/gitlab-kas/env] action create[2025-07-12T20:44:46+03:00] INFO: directory[/opt/gitlab/sv/gitlab-kas/env] created directory /opt/gitlab/sv/gitlab-kas/env

      [32m- create new directory /opt/gitlab/sv/gitlab-kas/env[0m[2025-07-12T20:44:46+03:00] INFO: directory[/opt/gitlab/sv/gitlab-kas/env] owner changed to 0
[2025-07-12T20:44:46+03:00] INFO: directory[/opt/gitlab/sv/gitlab-kas/env] group changed to 0
[2025-07-12T20:44:46+03:00] INFO: directory[/opt/gitlab/sv/gitlab-kas/env] mode changed to 755

      [32m- change mode from '' to '0755'[0m
      [32m- change owner from '' to 'root'[0m
      [32m- change group from '' to 'root'[0m
    * ruby_block[Delete unmanaged env files for gitlab-kas service] action run (skipped due to only_if)
    * template[/opt/gitlab/sv/gitlab-kas/check] action create (skipped due to only_if)
    * template[/opt/gitlab/sv/gitlab-kas/finish] action create (skipped due to only_if)
    * directory[/opt/gitlab/sv/gitlab-kas/control] action create[2025-07-12T20:44:46+03:00] INFO: directory[/opt/gitlab/sv/gitlab-kas/control] created directory /opt/gitlab/sv/gitlab-kas/control

      [32m- create new directory /opt/gitlab/sv/gitlab-kas/control[0m[2025-07-12T20:44:46+03:00] INFO: directory[/opt/gitlab/sv/gitlab-kas/control] owner changed to 0
[2025-07-12T20:44:46+03:00] INFO: directory[/opt/gitlab/sv/gitlab-kas/control] group changed to 0
[2025-07-12T20:44:46+03:00] INFO: directory[/opt/gitlab/sv/gitlab-kas/control] mode changed to 755

      [32m- change mode from '' to '0755'[0m
      [32m- change owner from '' to 'root'[0m
      [32m- change group from '' to 'root'[0m
    * link[/opt/gitlab/init/gitlab-kas] action create[2025-07-12T20:44:46+03:00] INFO: link[/opt/gitlab/init/gitlab-kas] created

      [32m- create symlink at /opt/gitlab/init/gitlab-kas to /opt/gitlab/embedded/bin/sv[0m
    * file[/opt/gitlab/sv/gitlab-kas/down] action nothing (skipped due to action :nothing)
[2025-07-12T20:44:46+03:00] INFO: template[/opt/gitlab/sv/gitlab-kas/run] sending run action to ruby_block[restart_service] (delayed)
    * ruby_block[restart_service] action run (skipped due to only_if)
[2025-07-12T20:44:46+03:00] INFO: template[/opt/gitlab/sv/gitlab-kas/log/config] sending create action to ruby_block[reload_log_service] (delayed)
    * ruby_block[reload_log_service] action create
      * ruby_block[restart_service] action nothing (skipped due to action :nothing)
      * ruby_block[restart_log_service] action nothing (skipped due to action :nothing)
      * ruby_block[reload_log_service] action nothing (skipped due to action :nothing)
      * directory[/opt/gitlab/sv/gitlab-kas] action create (up to date)
      * template[/opt/gitlab/sv/gitlab-kas/run] action create (up to date)
      * directory[/opt/gitlab/sv/gitlab-kas/log] action create (up to date)
      * directory[/opt/gitlab/sv/gitlab-kas/log/main] action create (up to date)
      * template[/opt/gitlab/sv/gitlab-kas/log/config] action create (up to date)
      * ruby_block[verify_chown_persisted_on_gitlab-kas] action nothing (skipped due to action :nothing)
      * link[/var/log/gitlab/gitlab-kas/config] action create (up to date)
      * template[/opt/gitlab/sv/gitlab-kas/log/run] action create (up to date)
      * directory[/opt/gitlab/sv/gitlab-kas/env] action create (up to date)
      * ruby_block[Delete unmanaged env files for gitlab-kas service] action run (skipped due to only_if)
      * template[/opt/gitlab/sv/gitlab-kas/check] action create (skipped due to only_if)
      * template[/opt/gitlab/sv/gitlab-kas/finish] action create (skipped due to only_if)
      * directory[/opt/gitlab/sv/gitlab-kas/control] action create (up to date)
      * link[/opt/gitlab/init/gitlab-kas] action create (up to date)
      * file[/opt/gitlab/sv/gitlab-kas/down] action nothing (skipped due to action :nothing)
      * directory[/opt/gitlab/service] action create (up to date)
      * link[/opt/gitlab/service/gitlab-kas] action create[2025-07-12T20:44:46+03:00] INFO: link[/opt/gitlab/service/gitlab-kas] created

        [32m- create symlink at /opt/gitlab/service/gitlab-kas to /opt/gitlab/sv/gitlab-kas[0m
      * ruby_block[wait for gitlab-kas service socket] action run[2025-07-12T20:44:47+03:00] INFO: ruby_block[wait for gitlab-kas service socket] called

        [32m- execute the ruby block wait for gitlab-kas service socket[0m
      * file[/var/log/gitlab/gitlab-kas/current] action touch (skipped due to only_if)
[2025-07-12T20:44:47+03:00] INFO: ruby_block[reload_log_service] called
      [32m- execute the ruby block reload_log_service[0m
[2025-07-12T20:44:47+03:00] INFO: template[/opt/gitlab/sv/gitlab-kas/log/run] sending run action to ruby_block[restart_log_service] (delayed)
    * ruby_block[restart_log_service] action run
      * ruby_block[restart_service] action nothing (skipped due to action :nothing)
      * ruby_block[restart_log_service] action nothing (skipped due to action :nothing)
      * ruby_block[reload_log_service] action nothing (skipped due to action :nothing)
      * directory[/opt/gitlab/sv/gitlab-kas] action create (up to date)
      * template[/opt/gitlab/sv/gitlab-kas/run] action create (up to date)
      * directory[/opt/gitlab/sv/gitlab-kas/log] action create (up to date)
      * directory[/opt/gitlab/sv/gitlab-kas/log/main] action create (up to date)
      * template[/opt/gitlab/sv/gitlab-kas/log/config] action create (up to date)
      * ruby_block[verify_chown_persisted_on_gitlab-kas] action nothing (skipped due to action :nothing)
      * link[/var/log/gitlab/gitlab-kas/config] action create (up to date)
      * template[/opt/gitlab/sv/gitlab-kas/log/run] action create (up to date)
      * directory[/opt/gitlab/sv/gitlab-kas/env] action create (up to date)
      * ruby_block[Delete unmanaged env files for gitlab-kas service] action run (skipped due to only_if)
      * template[/opt/gitlab/sv/gitlab-kas/check] action create (skipped due to only_if)
      * template[/opt/gitlab/sv/gitlab-kas/finish] action create (skipped due to only_if)
      * directory[/opt/gitlab/sv/gitlab-kas/control] action create (up to date)
      * link[/opt/gitlab/init/gitlab-kas] action create (up to date)
      * file[/opt/gitlab/sv/gitlab-kas/down] action nothing (skipped due to action :nothing)
      * directory[/opt/gitlab/service] action create (up to date)
      * link[/opt/gitlab/service/gitlab-kas] action create (up to date)
      * ruby_block[wait for gitlab-kas service socket] action run (skipped due to not_if)
      * file[/var/log/gitlab/gitlab-kas/current] action touch (skipped due to only_if)
[2025-07-12T20:44:48+03:00] INFO: ruby_block[restart_log_service] called
      [32m- execute the ruby block restart_log_service[0m
    * directory[/opt/gitlab/service] action create (up to date)
    * link[/opt/gitlab/service/gitlab-kas] action create (up to date)
    * ruby_block[wait for gitlab-kas service socket] action run (skipped due to not_if)
    * file[/var/log/gitlab/gitlab-kas/current] action touch (skipped due to only_if)
  
Recipe: gitlab::database_migrations
  * ruby_block[check remote PG version] action nothing (skipped due to action :nothing)
  * rails_migration[gitlab-rails] action run[2025-07-12T20:44:48+03:00] WARN: gitlab-rails does not have a log_group or default logdir mode defined. Setting to 0700.

    * bash_hide_env[migrate gitlab-rails database] action run
      [execute] Running db:schema:load rake task
                psql:/opt/gitlab/embedded/service/gitlab-rails/db/structure.sql:9: NOTICE:  extension "btree_gist" already exists, skipping
                psql:/opt/gitlab/embedded/service/gitlab-rails/db/structure.sql:11: NOTICE:  extension "pg_trgm" already exists, skipping
                
                == Seed from /opt/gitlab/embedded/service/gitlab-rails/db/fixtures/production/001_application_settings.rb
                Creating the default ApplicationSetting record.
                == /opt/gitlab/embedded/service/gitlab-rails/db/fixtures/production/001_application_settings.rb took 7.26 seconds
                
                == Seed from /opt/gitlab/embedded/service/gitlab-rails/db/fixtures/production/002_default_organization.rb
                
                OK
                == /opt/gitlab/embedded/service/gitlab-rails/db/fixtures/production/002_default_organization.rb took 0.07 seconds
                
                == Seed from /opt/gitlab/embedded/service/gitlab-rails/db/fixtures/production/003_admin.rb
                Administrator account created:
                
                login:    root
                password: ******
                
                == /opt/gitlab/embedded/service/gitlab-rails/db/fixtures/production/003_admin.rb took 1.46 seconds
                
                == Seed from /opt/gitlab/embedded/service/gitlab-rails/db/fixtures/production/004_create_base_work_item_types.rb
                
                OK
                == /opt/gitlab/embedded/service/gitlab-rails/db/fixtures/production/004_create_base_work_item_types.rb took 0.06 seconds
                
                == Seed from /opt/gitlab/embedded/service/gitlab-rails/db/fixtures/production/005_add_security_training_providers.rb
                
                OK
                == /opt/gitlab/embedded/service/gitlab-rails/db/fixtures/production/005_add_security_training_providers.rb took 0.02 seconds
                
                == Seed from /opt/gitlab/embedded/service/gitlab-rails/db/fixtures/production/010_settings.rb
                Saved CI JWT signing key
                Saved CI Job Token signing key
                == /opt/gitlab/embedded/service/gitlab-rails/db/fixtures/production/010_settings.rb took 0.76 seconds
                
                == Seed from /opt/gitlab/embedded/service/gitlab-rails/db/fixtures/production/020_create_work_item_hierarchy_restrictions.rb
                
                OK
                == /opt/gitlab/embedded/service/gitlab-rails/db/fixtures/production/020_create_work_item_hierarchy_restrictions.rb took 0.06 seconds
                
                == Seed from /opt/gitlab/embedded/service/gitlab-rails/db/fixtures/production/040_create_work_item_related_link_restrictions.rb
                
                OK
                == /opt/gitlab/embedded/service/gitlab-rails/db/fixtures/production/040_create_work_item_related_link_restrictions.rb took 0.04 seconds
                == Seeding took 9.73 seconds
                Running gitlab:clickhouse:migrate:main rake task
                The 'main' ClickHouse database is not configured, skipping migrations
[2025-07-12T20:46:09+03:00] INFO: bash_hide_env[migrate gitlab-rails database] ran successfully
      [32m- execute "bash" [0m
  
[2025-07-12T20:46:09+03:00] INFO: rails_migration[gitlab-rails] sending run action to execute[clear the gitlab-rails cache] (immediate)
Recipe: gitlab::gitlab-rails
  * execute[clear the gitlab-rails cache] action run[2025-07-12T20:46:38+03:00] INFO: execute[clear the gitlab-rails cache] ran successfully

    [32m- execute /opt/gitlab/bin/gitlab-rake cache:clear[0m
[2025-07-12T20:46:38+03:00] INFO: rails_migration[gitlab-rails] sending run action to ruby_block[check remote PG version] (immediate)
Recipe: gitlab::database_migrations
  * ruby_block[check remote PG version] action run (skipped due to only_if)
Recipe: crond::disable
  * service[crond] action nothing (skipped due to action :nothing)
  * runit_service[crond] action disable
    * ruby_block[disable crond] action run (skipped due to only_if)
     (up to date)
Recipe: gitlab::puma
  * directory[/opt/gitlab/var/puma] action create[2025-07-12T20:46:38+03:00] INFO: directory[/opt/gitlab/var/puma] created directory /opt/gitlab/var/puma

    [32m- create new directory /opt/gitlab/var/puma[0m[2025-07-12T20:46:38+03:00] INFO: directory[/opt/gitlab/var/puma] owner changed to 994
[2025-07-12T20:46:38+03:00] INFO: directory[/opt/gitlab/var/puma] mode changed to 700

    [32m- change mode from '' to '0700'[0m
    [32m- change owner from '' to 'git'[0m
  * directory[/var/log/gitlab/puma] action create[2025-07-12T20:46:38+03:00] INFO: directory[/var/log/gitlab/puma] created directory /var/log/gitlab/puma

    [32m- create new directory /var/log/gitlab/puma[0m[2025-07-12T20:46:38+03:00] INFO: directory[/var/log/gitlab/puma] owner changed to 994
[2025-07-12T20:46:38+03:00] INFO: directory[/var/log/gitlab/puma] mode changed to 700

    [32m- change mode from '' to '0700'[0m
    [32m- change owner from '' to 'git'[0m
  * directory[/var/opt/gitlab/gitlab-rails/sockets] action create[2025-07-12T20:46:38+03:00] INFO: directory[/var/opt/gitlab/gitlab-rails/sockets] created directory /var/opt/gitlab/gitlab-rails/sockets

    [32m- create new directory /var/opt/gitlab/gitlab-rails/sockets[0m[2025-07-12T20:46:38+03:00] INFO: directory[/var/opt/gitlab/gitlab-rails/sockets] owner changed to 994
[2025-07-12T20:46:38+03:00] INFO: directory[/var/opt/gitlab/gitlab-rails/sockets] group changed to 992
[2025-07-12T20:46:38+03:00] INFO: directory[/var/opt/gitlab/gitlab-rails/sockets] mode changed to 750

    [32m- change mode from '' to '0750'[0m
    [32m- change owner from '' to 'git'[0m
    [32m- change group from '' to 'gitlab-www'[0m
  * puma_config[/var/opt/gitlab/gitlab-rails/etc/puma.rb] action create
    * directory[/var/opt/gitlab/gitlab-rails/etc] action create (up to date)
    * template[/var/opt/gitlab/gitlab-rails/etc/puma.rb] action create[2025-07-12T20:46:38+03:00] INFO: template[/var/opt/gitlab/gitlab-rails/etc/puma.rb] created file /var/opt/gitlab/gitlab-rails/etc/puma.rb

      [32m- create new file /var/opt/gitlab/gitlab-rails/etc/puma.rb[0m[2025-07-12T20:46:38+03:00] INFO: template[/var/opt/gitlab/gitlab-rails/etc/puma.rb] updated file contents /var/opt/gitlab/gitlab-rails/etc/puma.rb

      [32m- update content in file /var/opt/gitlab/gitlab-rails/etc/puma.rb from none to 16649d[0m
      [37m--- /var/opt/gitlab/gitlab-rails/etc/puma.rb	2025-07-12 20:46:38.741835988 +0300[0m
      [37m+++ /var/opt/gitlab/gitlab-rails/etc/.chef-puma20250712-17810-lmzci7.rb	2025-07-12 20:46:38.741835988 +0300[0m
      [37m@@ -1,100 +1,200 @@[0m
      [37m+# frozen_string_literal: true[0m
      [37m+[0m
      [37m+# This file is managed by gitlab-ctl. Manual changes will be[0m
      [37m+# erased! To change the contents below, edit /etc/gitlab/gitlab.rb[0m
      [37m+# and run `sudo gitlab-ctl reconfigure`.[0m
      [37m+[0m
      [37m+# Load "path" as a rackup file.[0m
      [37m+#[0m
      [37m+# The default is "config.ru".[0m
      [37m+#[0m
      [37m+environment 'production'[0m
      [37m+rackup '/opt/gitlab/embedded/service/gitlab-rails/config.ru'[0m
      [37m+pidfile '/opt/gitlab/var/puma/puma.pid'[0m
      [37m+state_path '/opt/gitlab/var/puma/puma.state'[0m
      [37m+[0m
      [37m+stdout_redirect '/var/log/gitlab/puma/puma_stdout.log', '/var/log/gitlab/puma/puma_stderr.log', true[0m
      [37m+[0m
      [37m+# Configure "min" to be the minimum number of threads to use to answer[0m
      [37m+# requests and "max" the maximum.[0m
      [37m+#[0m
      [37m+# The default is "0, 16".[0m
      [37m+#[0m
      [37m+threads 4, 4[0m
      [37m+[0m
      [37m+# By default, workers accept all requests and queue them to pass to handlers.[0m
      [37m+# When false, workers accept the number of simultaneous requests configured.[0m
      [37m+#[0m
      [37m+# Queueing requests generally improves performance, but can cause deadlocks if[0m
      [37m+# the app is waiting on a request to itself. See https://github.com/puma/puma/issues/612[0m
      [37m+#[0m
      [37m+# When set to false this may require a reverse proxy to handle slow clients and[0m
      [37m+# queue requests before they reach puma. This is due to disabling HTTP keepalive[0m
      [37m+queue_requests false[0m
      [37m+[0m
      [37m+# Bind the server to "url". "tcp://", "unix://" and "ssl://" are the only[0m
      [37m+# accepted protocols.[0m
      [37m+bind 'unix:///var/opt/gitlab/gitlab-rails/sockets/gitlab.socket'[0m
      [37m+[0m
      [37m+bind 'tcp://127.0.0.1:8080'[0m
      [37m+[0m
      [37m+[0m
      [37m+directory '/var/opt/gitlab/gitlab-rails/working'[0m
      [37m+[0m
      [37m+workers 2[0m
      [37m+[0m
      [37m+require "/opt/gitlab/embedded/service/gitlab-rails/lib/gitlab/cluster/lifecycle_events"[0m
      [37m+[0m
      [37m+on_restart do[0m
      [37m+  # Signal application hooks that we're about to restart[0m
      [37m+  Gitlab::Cluster::LifecycleEvents.do_before_master_restart[0m
      [37m+end[0m
      [37m+[0m
      [37m+options = { workers: 2 }[0m
      [37m+[0m
      [37m+before_fork do[0m
      [37m+  # Signal application hooks that we're about to fork[0m
      [37m+  Gitlab::Cluster::LifecycleEvents.do_before_fork[0m
      [37m+end[0m
      [37m+[0m
      [37m+Gitlab::Cluster::LifecycleEvents.set_puma_options options[0m
      [37m+on_worker_boot do[0m
      [37m+  # Signal application hooks of worker start[0m
      [37m+  Gitlab::Cluster::LifecycleEvents.do_worker_start[0m
      [37m+end[0m
      [37m+[0m
      [37m+on_worker_shutdown do[0m
      [37m+  # Signal application hooks that a worker is shutting down[0m
      [37m+  Gitlab::Cluster::LifecycleEvents.do_worker_stop[0m
      [37m+end[0m
      [37m+[0m
      [37m+# Preload the application before starting the workers; this conflicts with[0m
      [37m+# phased restart feature. (off by default)[0m
      [37m+[0m
      [37m+preload_app![0m
      [37m+[0m
      [37m+tag 'gitlab-puma-worker'[0m
      [37m+[0m
      [37m+# Verifies that all workers have checked in to the master process within[0m
      [37m+# the given timeout. If not the worker process will be restarted. Default[0m
      [37m+# value is 60 seconds.[0m
      [37m+#[0m
      [37m+worker_timeout 60[0m
      [37m+[0m
      [37m+# https://github.com/puma/puma/blob/master/5.0-Upgrade.md#lower-latency-better-throughput[0m
      [37m+wait_for_less_busy_worker ENV.fetch('PUMA_WAIT_FOR_LESS_BUSY_WORKER', 0.001).to_f[0m
      [37m+[0m
      [37m+# Use customised JSON formatter for Puma log[0m
      [37m+require "/opt/gitlab/embedded/service/gitlab-rails/lib/gitlab/puma_logging/json_formatter"[0m
      [37m+[0m
      [37m+json_formatter = Gitlab::PumaLogging::JSONFormatter.new[0m
      [37m+log_formatter do |str|[0m
      [37m+    json_formatter.call(str)[0m
      [37m+end[0m
      [37m+[0m
      [37m+require "/opt/gitlab/embedded/service/gitlab-rails/lib/gitlab/puma/error_handler"[0m
      [37m+error_handler = Gitlab::Puma::ErrorHandler.new(ENV['RAILS_ENV'] == 'production')[0m
      [37m+[0m
      [37m+lowlevel_error_handler do |ex, env, status_code|[0m
      [37m+  error_handler.execute(ex, env, status_code)[0m
      [37m+end[0m[2025-07-12T20:46:38+03:00] INFO: template[/var/opt/gitlab/gitlab-rails/etc/puma.rb] owner changed to 0
[2025-07-12T20:46:38+03:00] INFO: template[/var/opt/gitlab/gitlab-rails/etc/puma.rb] group changed to 0
[2025-07-12T20:46:38+03:00] INFO: template[/var/opt/gitlab/gitlab-rails/etc/puma.rb] mode changed to 644

      [32m- change mode from '' to '0644'[0m
      [32m- change owner from '' to 'root'[0m
      [32m- change group from '' to 'root'[0m
  
  * service[puma] action nothing (skipped due to action :nothing)
  * runit_service[puma] action enable
    * ruby_block[restart_service] action nothing (skipped due to action :nothing)
    * ruby_block[restart_log_service] action nothing (skipped due to action :nothing)
    * ruby_block[reload_log_service] action nothing (skipped due to action :nothing)
    * directory[/opt/gitlab/sv/puma] action create[2025-07-12T20:46:38+03:00] INFO: directory[/opt/gitlab/sv/puma] created directory /opt/gitlab/sv/puma

      [32m- create new directory /opt/gitlab/sv/puma[0m[2025-07-12T20:46:38+03:00] INFO: directory[/opt/gitlab/sv/puma] owner changed to 0
[2025-07-12T20:46:38+03:00] INFO: directory[/opt/gitlab/sv/puma] group changed to 0
[2025-07-12T20:46:38+03:00] INFO: directory[/opt/gitlab/sv/puma] mode changed to 755

      [32m- change mode from '' to '0755'[0m
      [32m- change owner from '' to 'root'[0m
      [32m- change group from '' to 'root'[0m
    * template[/opt/gitlab/sv/puma/run] action create[2025-07-12T20:46:38+03:00] INFO: template[/opt/gitlab/sv/puma/run] created file /opt/gitlab/sv/puma/run

      [32m- create new file /opt/gitlab/sv/puma/run[0m[2025-07-12T20:46:38+03:00] INFO: template[/opt/gitlab/sv/puma/run] updated file contents /opt/gitlab/sv/puma/run

      [32m- update content in file /opt/gitlab/sv/puma/run from none to 8957ef[0m
      [37m--- /opt/gitlab/sv/puma/run	2025-07-12 20:46:38.793835988 +0300[0m
      [37m+++ /opt/gitlab/sv/puma/.chef-run20250712-17810-251ojf	2025-07-12 20:46:38.793835988 +0300[0m
      [37m@@ -1,24 +1,48 @@[0m
      [37m+#!/bin/bash[0m
      [37m+[0m
      [37m+# Let runit capture all script error messages[0m
      [37m+exec 2>&1[0m
      [37m+[0m
      [37m+# Setup run directory.[0m
      [37m+mkdir -p /run/gitlab/puma[0m
      [37m+chmod 0700 /run/gitlab/puma[0m
      [37m+chown git /run/gitlab/puma[0m
      [37m+export prometheus_run_dir='/run/gitlab/puma'[0m
      [37m+[0m
      [37m+[0m
      [37m+[0m
      [37m+rubyopt="-W:no-experimental"[0m
      [37m+[0m
      [37m+exec chpst -P \[0m
      [37m+  -u git:git \[0m
      [37m+  -U git:git \[0m
      [37m+  -e /opt/gitlab/etc/gitlab-rails/env \[0m
      [37m+  /usr/bin/env \[0m
      [37m+    RUBYOPT="${rubyopt}" \[0m
      [37m+    prometheus_multiproc_dir="${prometheus_run_dir}" \[0m
      [37m+    ACTION_CABLE_WORKER_POOL_SIZE=4 \[0m
      [37m+    /opt/gitlab/embedded/bin/bundle exec puma -C /var/opt/gitlab/gitlab-rails/etc/puma.rb[0m[2025-07-12T20:46:38+03:00] INFO: template[/opt/gitlab/sv/puma/run] owner changed to 0
[2025-07-12T20:46:38+03:00] INFO: template[/opt/gitlab/sv/puma/run] group changed to 0
[2025-07-12T20:46:38+03:00] INFO: template[/opt/gitlab/sv/puma/run] mode changed to 755

      [32m- change mode from '' to '0755'[0m
      [32m- change owner from '' to 'root'[0m
      [32m- change group from '' to 'root'[0m
    * directory[/opt/gitlab/sv/puma/log] action create[2025-07-12T20:46:38+03:00] INFO: directory[/opt/gitlab/sv/puma/log] created directory /opt/gitlab/sv/puma/log

      [32m- create new directory /opt/gitlab/sv/puma/log[0m[2025-07-12T20:46:38+03:00] INFO: directory[/opt/gitlab/sv/puma/log] owner changed to 0
[2025-07-12T20:46:38+03:00] INFO: directory[/opt/gitlab/sv/puma/log] group changed to 0
[2025-07-12T20:46:38+03:00] INFO: directory[/opt/gitlab/sv/puma/log] mode changed to 755

      [32m- change mode from '' to '0755'[0m
      [32m- change owner from '' to 'root'[0m
      [32m- change group from '' to 'root'[0m
    * directory[/opt/gitlab/sv/puma/log/main] action create[2025-07-12T20:46:38+03:00] INFO: directory[/opt/gitlab/sv/puma/log/main] created directory /opt/gitlab/sv/puma/log/main

      [32m- create new directory /opt/gitlab/sv/puma/log/main[0m[2025-07-12T20:46:38+03:00] INFO: directory[/opt/gitlab/sv/puma/log/main] owner changed to 0
[2025-07-12T20:46:38+03:00] INFO: directory[/opt/gitlab/sv/puma/log/main] group changed to 0
[2025-07-12T20:46:38+03:00] INFO: directory[/opt/gitlab/sv/puma/log/main] mode changed to 755

      [32m- change mode from '' to '0755'[0m
      [32m- change owner from '' to 'root'[0m
      [32m- change group from '' to 'root'[0m
    * template[/opt/gitlab/sv/puma/log/config] action create[2025-07-12T20:46:38+03:00] INFO: template[/opt/gitlab/sv/puma/log/config] created file /opt/gitlab/sv/puma/log/config

      [32m- create new file /opt/gitlab/sv/puma/log/config[0m[2025-07-12T20:46:38+03:00] INFO: template[/opt/gitlab/sv/puma/log/config] updated file contents /opt/gitlab/sv/puma/log/config

      [32m- update content in file /opt/gitlab/sv/puma/log/config from none to 623c00[0m
      [37m--- /opt/gitlab/sv/puma/log/config	2025-07-12 20:46:38.825835988 +0300[0m
      [37m+++ /opt/gitlab/sv/puma/log/.chef-config20250712-17810-ara9c7	2025-07-12 20:46:38.825835988 +0300[0m
      [37m@@ -1,6 +1,12 @@[0m
      [37m+s209715200[0m
      [37m+n30[0m
      [37m+t86400[0m
      [37m+!gzip[0m
      [37m+[0m
      [37m+[0m[2025-07-12T20:46:38+03:00] INFO: template[/opt/gitlab/sv/puma/log/config] owner changed to 0
[2025-07-12T20:46:38+03:00] INFO: template[/opt/gitlab/sv/puma/log/config] group changed to 0
[2025-07-12T20:46:38+03:00] INFO: template[/opt/gitlab/sv/puma/log/config] mode changed to 644

      [32m- change mode from '' to '0644'[0m
      [32m- change owner from '' to 'root'[0m
      [32m- change group from '' to 'root'[0m
    * ruby_block[verify_chown_persisted_on_puma] action nothing (skipped due to action :nothing)
[2025-07-12T20:46:38+03:00] INFO: ruby_block[verify_chown_persisted_on_puma] sent create action to ruby_block[verify_chown_persisted_on_puma] (immediate at declaration time)
    * ruby_block[verify_chown_persisted_on_puma] action create[2025-07-12T20:46:38+03:00] INFO: ruby_block[verify_chown_persisted_on_puma] called

      [32m- execute the ruby block verify_chown_persisted_on_puma[0m
    * link[/var/log/gitlab/puma/config] action create[2025-07-12T20:46:38+03:00] INFO: link[/var/log/gitlab/puma/config] created

      [32m- create symlink at /var/log/gitlab/puma/config to /opt/gitlab/sv/puma/log/config[0m
    * template[/opt/gitlab/sv/puma/log/run] action create[2025-07-12T20:46:38+03:00] INFO: template[/opt/gitlab/sv/puma/log/run] created file /opt/gitlab/sv/puma/log/run

      [32m- create new file /opt/gitlab/sv/puma/log/run[0m[2025-07-12T20:46:38+03:00] INFO: template[/opt/gitlab/sv/puma/log/run] updated file contents /opt/gitlab/sv/puma/log/run

      [32m- update content in file /opt/gitlab/sv/puma/log/run from none to b9d2d5[0m
      [37m--- /opt/gitlab/sv/puma/log/run	2025-07-12 20:46:38.849835988 +0300[0m
      [37m+++ /opt/gitlab/sv/puma/log/.chef-run20250712-17810-3h35l1	2025-07-12 20:46:38.849835988 +0300[0m
      [37m@@ -1,5 +1,10 @@[0m
      [37m+#!/bin/sh[0m
      [37m+exec chpst -P \[0m
      [37m+  -U root:root \[0m
      [37m+  -u root:root \[0m
      [37m+  svlogd -tt /var/log/gitlab/puma[0m[2025-07-12T20:46:38+03:00] INFO: template[/opt/gitlab/sv/puma/log/run] owner changed to 0
[2025-07-12T20:46:38+03:00] INFO: template[/opt/gitlab/sv/puma/log/run] group changed to 0
[2025-07-12T20:46:38+03:00] INFO: template[/opt/gitlab/sv/puma/log/run] mode changed to 755

      [32m- change mode from '' to '0755'[0m
      [32m- change owner from '' to 'root'[0m
      [32m- change group from '' to 'root'[0m
    * directory[/opt/gitlab/sv/puma/env] action create[2025-07-12T20:46:38+03:00] INFO: directory[/opt/gitlab/sv/puma/env] created directory /opt/gitlab/sv/puma/env

      [32m- create new directory /opt/gitlab/sv/puma/env[0m[2025-07-12T20:46:38+03:00] INFO: directory[/opt/gitlab/sv/puma/env] owner changed to 0
[2025-07-12T20:46:38+03:00] INFO: directory[/opt/gitlab/sv/puma/env] group changed to 0
[2025-07-12T20:46:38+03:00] INFO: directory[/opt/gitlab/sv/puma/env] mode changed to 755

      [32m- change mode from '' to '0755'[0m
      [32m- change owner from '' to 'root'[0m
      [32m- change group from '' to 'root'[0m
    * ruby_block[Delete unmanaged env files for puma service] action run (skipped due to only_if)
    * template[/opt/gitlab/sv/puma/check] action create (skipped due to only_if)
    * template[/opt/gitlab/sv/puma/finish] action create (skipped due to only_if)
    * directory[/opt/gitlab/sv/puma/control] action create[2025-07-12T20:46:38+03:00] INFO: directory[/opt/gitlab/sv/puma/control] created directory /opt/gitlab/sv/puma/control

      [32m- create new directory /opt/gitlab/sv/puma/control[0m[2025-07-12T20:46:38+03:00] INFO: directory[/opt/gitlab/sv/puma/control] owner changed to 0
[2025-07-12T20:46:38+03:00] INFO: directory[/opt/gitlab/sv/puma/control] group changed to 0
[2025-07-12T20:46:38+03:00] INFO: directory[/opt/gitlab/sv/puma/control] mode changed to 755

      [32m- change mode from '' to '0755'[0m
      [32m- change owner from '' to 'root'[0m
      [32m- change group from '' to 'root'[0m
    * template[/opt/gitlab/sv/puma/control/t] action create[2025-07-12T20:46:38+03:00] INFO: template[/opt/gitlab/sv/puma/control/t] created file /opt/gitlab/sv/puma/control/t

      [32m- create new file /opt/gitlab/sv/puma/control/t[0m[2025-07-12T20:46:38+03:00] INFO: template[/opt/gitlab/sv/puma/control/t] updated file contents /opt/gitlab/sv/puma/control/t

      [32m- update content in file /opt/gitlab/sv/puma/control/t from none to d8e9e7[0m
      [37m--- /opt/gitlab/sv/puma/control/t	2025-07-12 20:46:38.881835988 +0300[0m
      [37m+++ /opt/gitlab/sv/puma/control/.chef-t20250712-17810-o3yn3t	2025-07-12 20:46:38.881835988 +0300[0m
      [37m@@ -1,3 +1,6 @@[0m
      [37m+#!/bin/sh[0m
      [37m+echo "Received TERM from runit, sending to process group (-PID)"[0m
      [37m+kill -- -$(cat /opt/gitlab/service/puma/supervise/pid)[0m[2025-07-12T20:46:38+03:00] INFO: template[/opt/gitlab/sv/puma/control/t] owner changed to 0
[2025-07-12T20:46:38+03:00] INFO: template[/opt/gitlab/sv/puma/control/t] group changed to 0
[2025-07-12T20:46:38+03:00] INFO: template[/opt/gitlab/sv/puma/control/t] mode changed to 755

      [32m- change mode from '' to '0755'[0m
      [32m- change owner from '' to 'root'[0m
      [32m- change group from '' to 'root'[0m
    * template[/opt/gitlab/sv/puma/control/h] action create[2025-07-12T20:46:38+03:00] INFO: template[/opt/gitlab/sv/puma/control/h] created file /opt/gitlab/sv/puma/control/h

      [32m- create new file /opt/gitlab/sv/puma/control/h[0m[2025-07-12T20:46:38+03:00] INFO: template[/opt/gitlab/sv/puma/control/h] updated file contents /opt/gitlab/sv/puma/control/h

      [32m- update content in file /opt/gitlab/sv/puma/control/h from none to 22e721[0m
      [37m--- /opt/gitlab/sv/puma/control/h	2025-07-12 20:46:38.893835988 +0300[0m
      [37m+++ /opt/gitlab/sv/puma/control/.chef-h20250712-17810-fqmwyd	2025-07-12 20:46:38.893835988 +0300[0m
      [37m@@ -1,47 +1,94 @@[0m
      [37m+#!/bin/sh[0m
      [37m+[0m
      [37m+# This control handler is meant to be invoked by omnibus-gitlab via Runit[0m
      [37m+[0m
      [37m+# Let runit capture all script error messages[0m
      [37m+exec 2>&1[0m
      [37m+[0m
      [37m+PID=$(cat /opt/gitlab/service/puma/supervise/pid)[0m
      [37m+[0m
      [37m+readonly puma_graceful_shutdown_sec=90[0m
      [37m+readonly puma_forceful_shutdown_sec=20[0m
      [37m+readonly puma_kill_shutdown_sec=10[0m
      [37m+[0m
      [37m+echo "Received HUP from runit, sending INT signal to perform graceful restart"[0m
      [37m+[0m
      [37m+signal() {[0m
      [37m+  local pid="$1"[0m
      [37m+  local signal="$2"[0m
      [37m+  local tries="$3"[0m
      [37m+[0m
      [37m+  echo "Sending $signal signal to Puma $pid..."[0m
      [37m+  kill "-$signal" "$pid"[0m
      [37m+[0m
      [37m+  for i in $(seq 1 "$tries"); do[0m
      [37m+    echo "Waiting for Puma $pid to exit ($i)..."[0m
      [37m+    if ! kill -0 "$pid"; then[0m
      [37m+      echo "Puma $pid did exit."[0m
      [37m+      return 0[0m
      [37m+    fi[0m
      [37m+[0m
      [37m+    sleep 1[0m
      [37m+  done[0m
      [37m+[0m
      [37m+  echo "Puma $pid did not exit after $signal."[0m
      [37m+  return 1[0m
      [37m+}[0m
      [37m+[0m
      [37m+([0m
      [37m+  # we run it in subshell, as `runit` requires[0m
      [37m+  # the process it runs to exit in order to reap[0m
      [37m+  # the service[0m
      [37m+  signal "$PID" "INT" "$puma_graceful_shutdown_sec" ||[0m
      [37m+  signal "$PID" "TERM" "$puma_forceful_shutdown_sec" ||[0m
      [37m+  signal "$PID" "KILL" "$puma_kill_shutdown_sec"[0m
      [37m+) &[0m
      [37m+[0m
      [37m+exit 0[0m[2025-07-12T20:46:38+03:00] INFO: template[/opt/gitlab/sv/puma/control/h] owner changed to 0
[2025-07-12T20:46:38+03:00] INFO: template[/opt/gitlab/sv/puma/control/h] group changed to 0
[2025-07-12T20:46:38+03:00] INFO: template[/opt/gitlab/sv/puma/control/h] mode changed to 755

      [32m- change mode from '' to '0755'[0m
      [32m- change owner from '' to 'root'[0m
      [32m- change group from '' to 'root'[0m
    * link[/opt/gitlab/init/puma] action create[2025-07-12T20:46:38+03:00] INFO: link[/opt/gitlab/init/puma] created

      [32m- create symlink at /opt/gitlab/init/puma to /opt/gitlab/embedded/bin/sv[0m
    * file[/opt/gitlab/sv/puma/down] action nothing (skipped due to action :nothing)
[2025-07-12T20:46:38+03:00] INFO: template[/opt/gitlab/sv/puma/run] sending run action to ruby_block[restart_service] (delayed)
    * ruby_block[restart_service] action run (skipped due to only_if)
[2025-07-12T20:46:38+03:00] INFO: template[/opt/gitlab/sv/puma/log/config] sending create action to ruby_block[reload_log_service] (delayed)
    * ruby_block[reload_log_service] action create
      * ruby_block[restart_service] action nothing (skipped due to action :nothing)
      * ruby_block[restart_log_service] action nothing (skipped due to action :nothing)
      * ruby_block[reload_log_service] action nothing (skipped due to action :nothing)
      * directory[/opt/gitlab/sv/puma] action create (up to date)
      * template[/opt/gitlab/sv/puma/run] action create (up to date)
      * directory[/opt/gitlab/sv/puma/log] action create (up to date)
      * directory[/opt/gitlab/sv/puma/log/main] action create (up to date)
      * template[/opt/gitlab/sv/puma/log/config] action create (up to date)
      * ruby_block[verify_chown_persisted_on_puma] action nothing (skipped due to action :nothing)
      * link[/var/log/gitlab/puma/config] action create (up to date)
      * template[/opt/gitlab/sv/puma/log/run] action create (up to date)
      * directory[/opt/gitlab/sv/puma/env] action create (up to date)
      * ruby_block[Delete unmanaged env files for puma service] action run (skipped due to only_if)
      * template[/opt/gitlab/sv/puma/check] action create (skipped due to only_if)
      * template[/opt/gitlab/sv/puma/finish] action create (skipped due to only_if)
      * directory[/opt/gitlab/sv/puma/control] action create (up to date)
      * template[/opt/gitlab/sv/puma/control/t] action create (up to date)
      * template[/opt/gitlab/sv/puma/control/h] action create (up to date)
      * link[/opt/gitlab/init/puma] action create (up to date)
      * file[/opt/gitlab/sv/puma/down] action nothing (skipped due to action :nothing)
      * directory[/opt/gitlab/service] action create (up to date)
      * link[/opt/gitlab/service/puma] action create[2025-07-12T20:46:38+03:00] INFO: link[/opt/gitlab/service/puma] created

        [32m- create symlink at /opt/gitlab/service/puma to /opt/gitlab/sv/puma[0m
      * ruby_block[wait for puma service socket] action run[2025-07-12T20:46:44+03:00] INFO: ruby_block[wait for puma service socket] called

        [32m- execute the ruby block wait for puma service socket[0m
      * file[/var/log/gitlab/puma/current] action touch (skipped due to only_if)
[2025-07-12T20:46:45+03:00] INFO: ruby_block[reload_log_service] called
      [32m- execute the ruby block reload_log_service[0m
[2025-07-12T20:46:45+03:00] INFO: template[/opt/gitlab/sv/puma/log/run] sending run action to ruby_block[restart_log_service] (delayed)
    * ruby_block[restart_log_service] action run
      * ruby_block[restart_service] action nothing (skipped due to action :nothing)
      * ruby_block[restart_log_service] action nothing (skipped due to action :nothing)
      * ruby_block[reload_log_service] action nothing (skipped due to action :nothing)
      * directory[/opt/gitlab/sv/puma] action create (up to date)
      * template[/opt/gitlab/sv/puma/run] action create (up to date)
      * directory[/opt/gitlab/sv/puma/log] action create (up to date)
      * directory[/opt/gitlab/sv/puma/log/main] action create (up to date)
      * template[/opt/gitlab/sv/puma/log/config] action create (up to date)
      * ruby_block[verify_chown_persisted_on_puma] action nothing (skipped due to action :nothing)
      * link[/var/log/gitlab/puma/config] action create (up to date)
      * template[/opt/gitlab/sv/puma/log/run] action create (up to date)
      * directory[/opt/gitlab/sv/puma/env] action create (up to date)
      * ruby_block[Delete unmanaged env files for puma service] action run (skipped due to only_if)
      * template[/opt/gitlab/sv/puma/check] action create (skipped due to only_if)
      * template[/opt/gitlab/sv/puma/finish] action create (skipped due to only_if)
      * directory[/opt/gitlab/sv/puma/control] action create (up to date)
      * template[/opt/gitlab/sv/puma/control/t] action create (up to date)
      * template[/opt/gitlab/sv/puma/control/h] action create (up to date)
      * link[/opt/gitlab/init/puma] action create (up to date)
      * file[/opt/gitlab/sv/puma/down] action nothing (skipped due to action :nothing)
      * directory[/opt/gitlab/service] action create (up to date)
      * link[/opt/gitlab/service/puma] action create (up to date)
      * ruby_block[wait for puma service socket] action run (skipped due to not_if)
      * file[/var/log/gitlab/puma/current] action touch (skipped due to only_if)
[2025-07-12T20:46:45+03:00] INFO: ruby_block[restart_log_service] called
      [32m- execute the ruby block restart_log_service[0m
    * directory[/opt/gitlab/service] action create (up to date)
    * link[/opt/gitlab/service/puma] action create (up to date)
    * ruby_block[wait for puma service socket] action run (skipped due to not_if)
    * file[/var/log/gitlab/puma/current] action touch (skipped due to only_if)
  
  * execute[/opt/gitlab/bin/gitlab-ctl start puma] action run
    [execute] ok: run: puma: (pid 18773) 3s
[2025-07-12T20:46:46+03:00] INFO: execute[/opt/gitlab/bin/gitlab-ctl start puma] ran successfully
    [32m- execute /opt/gitlab/bin/gitlab-ctl start puma[0m
  * consul_service[rails] action delete
    * file[/var/opt/gitlab/consul/config.d/rails-service.json] action delete (up to date)
     (up to date)
  * gitlab_sysctl[net.core.somaxconn] action create
    * directory[create /etc/sysctl.d for net.core.somaxconn] action create (up to date)
    * file[create /opt/gitlab/embedded/etc/90-omnibus-gitlab-net.core.somaxconn.conf net.core.somaxconn] action create[2025-07-12T20:46:46+03:00] INFO: file[create /opt/gitlab/embedded/etc/90-omnibus-gitlab-net.core.somaxconn.conf net.core.somaxconn] created file /opt/gitlab/embedded/etc/90-omnibus-gitlab-net.core.somaxconn.conf

      [32m- create new file /opt/gitlab/embedded/etc/90-omnibus-gitlab-net.core.somaxconn.conf[0m[2025-07-12T20:46:46+03:00] INFO: file[create /opt/gitlab/embedded/etc/90-omnibus-gitlab-net.core.somaxconn.conf net.core.somaxconn] updated file contents /opt/gitlab/embedded/etc/90-omnibus-gitlab-net.core.somaxconn.conf

      [32m- update content in file /opt/gitlab/embedded/etc/90-omnibus-gitlab-net.core.somaxconn.conf from none to fa63fe[0m
      [37m--- /opt/gitlab/embedded/etc/90-omnibus-gitlab-net.core.somaxconn.conf	2025-07-12 20:46:46.529835988 +0300[0m
      [37m+++ /opt/gitlab/embedded/etc/.chef-90-omnibus-gitlab-net20250712-17810-sp6xmx.core.somaxconn.conf	2025-07-12 20:46:46.529835988 +0300[0m
      [37m@@ -1 +1,2 @@[0m
      [37m+net.core.somaxconn = 2048[0m
[2025-07-12T20:46:46+03:00] INFO: file[create /opt/gitlab/embedded/etc/90-omnibus-gitlab-net.core.somaxconn.conf net.core.somaxconn] not queuing delayed action run on execute[reload all sysctl conf] (delayed), as it's already been queued
    * link[/etc/sysctl.d/90-omnibus-gitlab-net.core.somaxconn.conf] action create[2025-07-12T20:46:46+03:00] INFO: link[/etc/sysctl.d/90-omnibus-gitlab-net.core.somaxconn.conf] created

      [32m- create symlink at /etc/sysctl.d/90-omnibus-gitlab-net.core.somaxconn.conf to /opt/gitlab/embedded/etc/90-omnibus-gitlab-net.core.somaxconn.conf[0m
[2025-07-12T20:46:46+03:00] INFO: link[/etc/sysctl.d/90-omnibus-gitlab-net.core.somaxconn.conf] not queuing delayed action run on execute[load sysctl conf net.core.somaxconn] (delayed), as it's already been queued
[2025-07-12T20:46:46+03:00] INFO: link[/etc/sysctl.d/90-omnibus-gitlab-net.core.somaxconn.conf] not queuing delayed action run on execute[reload all sysctl conf] (delayed), as it's already been queued
    * execute[load sysctl conf net.core.somaxconn] action nothing (skipped due to action :nothing)
[2025-07-12T20:46:46+03:00] INFO: file[create /opt/gitlab/embedded/etc/90-omnibus-gitlab-net.core.somaxconn.conf net.core.somaxconn] sending run action to execute[load sysctl conf net.core.somaxconn] (delayed)
    * execute[load sysctl conf net.core.somaxconn] action run
      [execute] net.core.somaxconn = 2048
[2025-07-12T20:46:46+03:00] INFO: execute[load sysctl conf net.core.somaxconn] ran successfully
      [32m- execute sysctl -e -p /opt/gitlab/embedded/etc/90-omnibus-gitlab-net.core.somaxconn.conf[0m
  
Recipe: gitlab::sidekiq
  * sidekiq_service[sidekiq] action enable[2025-07-12T20:46:46+03:00] WARN: sidekiq does not have a log_group or default logdir mode defined. Setting to 0700.

    * directory[/var/log/gitlab/sidekiq] action create[2025-07-12T20:46:46+03:00] INFO: directory[/var/log/gitlab/sidekiq] created directory /var/log/gitlab/sidekiq

      [32m- create new directory /var/log/gitlab/sidekiq[0m[2025-07-12T20:46:46+03:00] INFO: directory[/var/log/gitlab/sidekiq] owner changed to 994
[2025-07-12T20:46:46+03:00] INFO: directory[/var/log/gitlab/sidekiq] mode changed to 700

      [32m- change mode from '' to '0700'[0m
      [32m- change owner from '' to 'git'[0m
    * service[sidekiq] action nothing (skipped due to action :nothing)
    * runit_service[sidekiq] action enable
      * ruby_block[restart_service] action nothing (skipped due to action :nothing)
      * ruby_block[restart_log_service] action nothing (skipped due to action :nothing)
      * ruby_block[reload_log_service] action nothing (skipped due to action :nothing)
      * directory[/opt/gitlab/sv/sidekiq] action create[2025-07-12T20:46:46+03:00] INFO: directory[/opt/gitlab/sv/sidekiq] created directory /opt/gitlab/sv/sidekiq

        [32m- create new directory /opt/gitlab/sv/sidekiq[0m[2025-07-12T20:46:46+03:00] INFO: directory[/opt/gitlab/sv/sidekiq] owner changed to 0
[2025-07-12T20:46:46+03:00] INFO: directory[/opt/gitlab/sv/sidekiq] group changed to 0
[2025-07-12T20:46:46+03:00] INFO: directory[/opt/gitlab/sv/sidekiq] mode changed to 755

        [32m- change mode from '' to '0755'[0m
        [32m- change owner from '' to 'root'[0m
        [32m- change group from '' to 'root'[0m
      * template[/opt/gitlab/sv/sidekiq/run] action create[2025-07-12T20:46:46+03:00] INFO: template[/opt/gitlab/sv/sidekiq/run] created file /opt/gitlab/sv/sidekiq/run

        [32m- create new file /opt/gitlab/sv/sidekiq/run[0m[2025-07-12T20:46:46+03:00] INFO: template[/opt/gitlab/sv/sidekiq/run] updated file contents /opt/gitlab/sv/sidekiq/run

        [32m- update content in file /opt/gitlab/sv/sidekiq/run from none to db7d0f[0m
        [37m--- /opt/gitlab/sv/sidekiq/run	2025-07-12 20:46:46.597835988 +0300[0m
        [37m+++ /opt/gitlab/sv/sidekiq/.chef-run20250712-17810-zmim91	2025-07-12 20:46:46.597835988 +0300[0m
        [37m@@ -1,30 +1,60 @@[0m
        [37m+#!/bin/sh[0m
        [37m+[0m
        [37m+cd /var/opt/gitlab/gitlab-rails/working[0m
        [37m+[0m
        [37m+exec 2>&1[0m
        [37m+# Setup run directory.[0m
        [37m+mkdir -p /run/gitlab/sidekiq[0m
        [37m+rm /run/gitlab/sidekiq/*.db 2> /dev/null[0m
        [37m+chmod 0700 /run/gitlab/sidekiq[0m
        [37m+chown git /run/gitlab/sidekiq[0m
        [37m+export prometheus_run_dir='/run/gitlab/sidekiq'[0m
        [37m+[0m
        [37m+[0m
        [37m+[0m
        [37m+rubyopt="-W:no-experimental"[0m
        [37m+[0m
        [37m+exec chpst -e /opt/gitlab/etc/gitlab-rails/env -P \[0m
        [37m+  -U git:git \[0m
        [37m+  -u git:git \[0m
        [37m+  /usr/bin/env \[0m
        [37m+    RUBYOPT="${rubyopt}" \[0m
        [37m+    prometheus_multiproc_dir="${prometheus_run_dir}" \[0m
        [37m+    /opt/gitlab/embedded/service/gitlab-rails/bin/sidekiq-cluster \[0m
        [37m+      -e production \[0m
        [37m+      -r /opt/gitlab/embedded/service/gitlab-rails \[0m
        [37m+      -c 20 \[0m
        [37m+      --timeout 25 \[0m
        [37m+        "*" \[0m
        [37m+[0m
        [37m+# Do not remove this line; it prevents trouble with the trailing backslashes above.[0m[2025-07-12T20:46:46+03:00] INFO: template[/opt/gitlab/sv/sidekiq/run] owner changed to 0
[2025-07-12T20:46:46+03:00] INFO: template[/opt/gitlab/sv/sidekiq/run] group changed to 0
[2025-07-12T20:46:46+03:00] INFO: template[/opt/gitlab/sv/sidekiq/run] mode changed to 755

        [32m- change mode from '' to '0755'[0m
        [32m- change owner from '' to 'root'[0m
        [32m- change group from '' to 'root'[0m
      * directory[/opt/gitlab/sv/sidekiq/log] action create[2025-07-12T20:46:46+03:00] INFO: directory[/opt/gitlab/sv/sidekiq/log] created directory /opt/gitlab/sv/sidekiq/log

        [32m- create new directory /opt/gitlab/sv/sidekiq/log[0m[2025-07-12T20:46:46+03:00] INFO: directory[/opt/gitlab/sv/sidekiq/log] owner changed to 0
[2025-07-12T20:46:46+03:00] INFO: directory[/opt/gitlab/sv/sidekiq/log] group changed to 0
[2025-07-12T20:46:46+03:00] INFO: directory[/opt/gitlab/sv/sidekiq/log] mode changed to 755

        [32m- change mode from '' to '0755'[0m
        [32m- change owner from '' to 'root'[0m
        [32m- change group from '' to 'root'[0m
      * directory[/opt/gitlab/sv/sidekiq/log/main] action create[2025-07-12T20:46:46+03:00] INFO: directory[/opt/gitlab/sv/sidekiq/log/main] created directory /opt/gitlab/sv/sidekiq/log/main

        [32m- create new directory /opt/gitlab/sv/sidekiq/log/main[0m[2025-07-12T20:46:46+03:00] INFO: directory[/opt/gitlab/sv/sidekiq/log/main] owner changed to 0
[2025-07-12T20:46:46+03:00] INFO: directory[/opt/gitlab/sv/sidekiq/log/main] group changed to 0
[2025-07-12T20:46:46+03:00] INFO: directory[/opt/gitlab/sv/sidekiq/log/main] mode changed to 755

        [32m- change mode from '' to '0755'[0m
        [32m- change owner from '' to 'root'[0m
        [32m- change group from '' to 'root'[0m
      * template[/opt/gitlab/sv/sidekiq/log/config] action create[2025-07-12T20:46:46+03:00] INFO: template[/opt/gitlab/sv/sidekiq/log/config] created file /opt/gitlab/sv/sidekiq/log/config

        [32m- create new file /opt/gitlab/sv/sidekiq/log/config[0m[2025-07-12T20:46:46+03:00] INFO: template[/opt/gitlab/sv/sidekiq/log/config] updated file contents /opt/gitlab/sv/sidekiq/log/config

        [32m- update content in file /opt/gitlab/sv/sidekiq/log/config from none to 623c00[0m
        [37m--- /opt/gitlab/sv/sidekiq/log/config	2025-07-12 20:46:46.621835988 +0300[0m
        [37m+++ /opt/gitlab/sv/sidekiq/log/.chef-config20250712-17810-fkbq22	2025-07-12 20:46:46.621835988 +0300[0m
        [37m@@ -1,6 +1,12 @@[0m
        [37m+s209715200[0m
        [37m+n30[0m
        [37m+t86400[0m
        [37m+!gzip[0m
        [37m+[0m
        [37m+[0m[2025-07-12T20:46:46+03:00] INFO: template[/opt/gitlab/sv/sidekiq/log/config] owner changed to 0
[2025-07-12T20:46:46+03:00] INFO: template[/opt/gitlab/sv/sidekiq/log/config] group changed to 0
[2025-07-12T20:46:46+03:00] INFO: template[/opt/gitlab/sv/sidekiq/log/config] mode changed to 644

        [32m- change mode from '' to '0644'[0m
        [32m- change owner from '' to 'root'[0m
        [32m- change group from '' to 'root'[0m
      * ruby_block[verify_chown_persisted_on_sidekiq] action nothing (skipped due to action :nothing)
[2025-07-12T20:46:46+03:00] INFO: ruby_block[verify_chown_persisted_on_sidekiq] sent create action to ruby_block[verify_chown_persisted_on_sidekiq] (immediate at declaration time)
      * ruby_block[verify_chown_persisted_on_sidekiq] action create[2025-07-12T20:46:46+03:00] INFO: ruby_block[verify_chown_persisted_on_sidekiq] called

        [32m- execute the ruby block verify_chown_persisted_on_sidekiq[0m
      * link[/var/log/gitlab/sidekiq/config] action create[2025-07-12T20:46:46+03:00] INFO: link[/var/log/gitlab/sidekiq/config] created

        [32m- create symlink at /var/log/gitlab/sidekiq/config to /opt/gitlab/sv/sidekiq/log/config[0m
      * template[/opt/gitlab/sv/sidekiq/log/run] action create[2025-07-12T20:46:46+03:00] INFO: template[/opt/gitlab/sv/sidekiq/log/run] created file /opt/gitlab/sv/sidekiq/log/run

        [32m- create new file /opt/gitlab/sv/sidekiq/log/run[0m[2025-07-12T20:46:46+03:00] INFO: template[/opt/gitlab/sv/sidekiq/log/run] updated file contents /opt/gitlab/sv/sidekiq/log/run

        [32m- update content in file /opt/gitlab/sv/sidekiq/log/run from none to 421ac5[0m
        [37m--- /opt/gitlab/sv/sidekiq/log/run	2025-07-12 20:46:46.641835988 +0300[0m
        [37m+++ /opt/gitlab/sv/sidekiq/log/.chef-run20250712-17810-nvawth	2025-07-12 20:46:46.641835988 +0300[0m
        [37m@@ -1,5 +1,10 @@[0m
        [37m+#!/bin/sh[0m
        [37m+exec chpst -P \[0m
        [37m+  -U root:root \[0m
        [37m+  -u root:root \[0m
        [37m+  svlogd /var/log/gitlab/sidekiq[0m[2025-07-12T20:46:46+03:00] INFO: template[/opt/gitlab/sv/sidekiq/log/run] owner changed to 0
[2025-07-12T20:46:46+03:00] INFO: template[/opt/gitlab/sv/sidekiq/log/run] group changed to 0
[2025-07-12T20:46:46+03:00] INFO: template[/opt/gitlab/sv/sidekiq/log/run] mode changed to 755

        [32m- change mode from '' to '0755'[0m
        [32m- change owner from '' to 'root'[0m
        [32m- change group from '' to 'root'[0m
      * directory[/opt/gitlab/sv/sidekiq/env] action create[2025-07-12T20:46:46+03:00] INFO: directory[/opt/gitlab/sv/sidekiq/env] created directory /opt/gitlab/sv/sidekiq/env

        [32m- create new directory /opt/gitlab/sv/sidekiq/env[0m[2025-07-12T20:46:46+03:00] INFO: directory[/opt/gitlab/sv/sidekiq/env] owner changed to 0
[2025-07-12T20:46:46+03:00] INFO: directory[/opt/gitlab/sv/sidekiq/env] group changed to 0
[2025-07-12T20:46:46+03:00] INFO: directory[/opt/gitlab/sv/sidekiq/env] mode changed to 755

        [32m- change mode from '' to '0755'[0m
        [32m- change owner from '' to 'root'[0m
        [32m- change group from '' to 'root'[0m
      * ruby_block[Delete unmanaged env files for sidekiq service] action run (skipped due to only_if)
      * template[/opt/gitlab/sv/sidekiq/check] action create (skipped due to only_if)
      * template[/opt/gitlab/sv/sidekiq/finish] action create (skipped due to only_if)
      * directory[/opt/gitlab/sv/sidekiq/control] action create[2025-07-12T20:46:46+03:00] INFO: directory[/opt/gitlab/sv/sidekiq/control] created directory /opt/gitlab/sv/sidekiq/control

        [32m- create new directory /opt/gitlab/sv/sidekiq/control[0m[2025-07-12T20:46:46+03:00] INFO: directory[/opt/gitlab/sv/sidekiq/control] owner changed to 0
[2025-07-12T20:46:46+03:00] INFO: directory[/opt/gitlab/sv/sidekiq/control] group changed to 0
[2025-07-12T20:46:46+03:00] INFO: directory[/opt/gitlab/sv/sidekiq/control] mode changed to 755

        [32m- change mode from '' to '0755'[0m
        [32m- change owner from '' to 'root'[0m
        [32m- change group from '' to 'root'[0m
      * link[/opt/gitlab/init/sidekiq] action create[2025-07-12T20:46:46+03:00] INFO: link[/opt/gitlab/init/sidekiq] created

        [32m- create symlink at /opt/gitlab/init/sidekiq to /opt/gitlab/embedded/bin/sv[0m
      * file[/opt/gitlab/sv/sidekiq/down] action nothing (skipped due to action :nothing)
[2025-07-12T20:46:46+03:00] INFO: template[/opt/gitlab/sv/sidekiq/run] sending run action to ruby_block[restart_service] (delayed)
      * ruby_block[restart_service] action run (skipped due to only_if)
[2025-07-12T20:46:46+03:00] INFO: template[/opt/gitlab/sv/sidekiq/log/config] sending create action to ruby_block[reload_log_service] (delayed)
      * ruby_block[reload_log_service] action create
        * ruby_block[restart_service] action nothing (skipped due to action :nothing)
        * ruby_block[restart_log_service] action nothing (skipped due to action :nothing)
        * ruby_block[reload_log_service] action nothing (skipped due to action :nothing)
        * directory[/opt/gitlab/sv/sidekiq] action create (up to date)
        * template[/opt/gitlab/sv/sidekiq/run] action create (up to date)
        * directory[/opt/gitlab/sv/sidekiq/log] action create (up to date)
        * directory[/opt/gitlab/sv/sidekiq/log/main] action create (up to date)
        * template[/opt/gitlab/sv/sidekiq/log/config] action create (up to date)
        * ruby_block[verify_chown_persisted_on_sidekiq] action nothing (skipped due to action :nothing)
        * link[/var/log/gitlab/sidekiq/config] action create (up to date)
        * template[/opt/gitlab/sv/sidekiq/log/run] action create (up to date)
        * directory[/opt/gitlab/sv/sidekiq/env] action create (up to date)
        * ruby_block[Delete unmanaged env files for sidekiq service] action run (skipped due to only_if)
        * template[/opt/gitlab/sv/sidekiq/check] action create (skipped due to only_if)
        * template[/opt/gitlab/sv/sidekiq/finish] action create (skipped due to only_if)
        * directory[/opt/gitlab/sv/sidekiq/control] action create (up to date)
        * link[/opt/gitlab/init/sidekiq] action create (up to date)
        * file[/opt/gitlab/sv/sidekiq/down] action nothing (skipped due to action :nothing)
        * directory[/opt/gitlab/service] action create (up to date)
        * link[/opt/gitlab/service/sidekiq] action create[2025-07-12T20:46:46+03:00] INFO: link[/opt/gitlab/service/sidekiq] created

          [32m- create symlink at /opt/gitlab/service/sidekiq to /opt/gitlab/sv/sidekiq[0m
        * ruby_block[wait for sidekiq service socket] action run[2025-07-12T20:46:50+03:00] INFO: ruby_block[wait for sidekiq service socket] called

          [32m- execute the ruby block wait for sidekiq service socket[0m
        * file[/var/log/gitlab/sidekiq/current] action touch (skipped due to only_if)
[2025-07-12T20:46:51+03:00] INFO: ruby_block[reload_log_service] called
        [32m- execute the ruby block reload_log_service[0m
[2025-07-12T20:46:51+03:00] INFO: template[/opt/gitlab/sv/sidekiq/log/run] sending run action to ruby_block[restart_log_service] (delayed)
      * ruby_block[restart_log_service] action run
        * ruby_block[restart_service] action nothing (skipped due to action :nothing)
        * ruby_block[restart_log_service] action nothing (skipped due to action :nothing)
        * ruby_block[reload_log_service] action nothing (skipped due to action :nothing)
        * directory[/opt/gitlab/sv/sidekiq] action create (up to date)
        * template[/opt/gitlab/sv/sidekiq/run] action create (up to date)
        * directory[/opt/gitlab/sv/sidekiq/log] action create (up to date)
        * directory[/opt/gitlab/sv/sidekiq/log/main] action create (up to date)
        * template[/opt/gitlab/sv/sidekiq/log/config] action create (up to date)
        * ruby_block[verify_chown_persisted_on_sidekiq] action nothing (skipped due to action :nothing)
        * link[/var/log/gitlab/sidekiq/config] action create (up to date)
        * template[/opt/gitlab/sv/sidekiq/log/run] action create (up to date)
        * directory[/opt/gitlab/sv/sidekiq/env] action create (up to date)
        * ruby_block[Delete unmanaged env files for sidekiq service] action run (skipped due to only_if)
        * template[/opt/gitlab/sv/sidekiq/check] action create (skipped due to only_if)
        * template[/opt/gitlab/sv/sidekiq/finish] action create (skipped due to only_if)
        * directory[/opt/gitlab/sv/sidekiq/control] action create (up to date)
        * link[/opt/gitlab/init/sidekiq] action create (up to date)
        * file[/opt/gitlab/sv/sidekiq/down] action nothing (skipped due to action :nothing)
        * directory[/opt/gitlab/service] action create (up to date)
        * link[/opt/gitlab/service/sidekiq] action create (up to date)
        * ruby_block[wait for sidekiq service socket] action run (skipped due to not_if)
        * file[/var/log/gitlab/sidekiq/current] action touch (skipped due to only_if)
[2025-07-12T20:46:53+03:00] INFO: ruby_block[restart_log_service] called
        [32m- execute the ruby block restart_log_service[0m
      * directory[/opt/gitlab/service] action create (up to date)
      * link[/opt/gitlab/service/sidekiq] action create (up to date)
      * ruby_block[wait for sidekiq service socket] action run (skipped due to not_if)
      * file[/var/log/gitlab/sidekiq/current] action touch (skipped due to only_if)
    
    * execute[/opt/gitlab/bin/gitlab-ctl start sidekiq] action run
      [execute] ok: run: sidekiq: (pid 18790) 5s
[2025-07-12T20:46:54+03:00] INFO: execute[/opt/gitlab/bin/gitlab-ctl start sidekiq] ran successfully
      [32m- execute /opt/gitlab/bin/gitlab-ctl start sidekiq[0m
  
  * consul_service[sidekiq] action delete
    * file[/var/opt/gitlab/consul/config.d/sidekiq-service.json] action delete (up to date)
     (up to date)
Recipe: gitlab::gitlab-workhorse
  * directory[/var/opt/gitlab/gitlab-workhorse] action create[2025-07-12T20:46:54+03:00] INFO: directory[/var/opt/gitlab/gitlab-workhorse] created directory /var/opt/gitlab/gitlab-workhorse

    [32m- create new directory /var/opt/gitlab/gitlab-workhorse[0m[2025-07-12T20:46:54+03:00] INFO: directory[/var/opt/gitlab/gitlab-workhorse] owner changed to 994
[2025-07-12T20:46:54+03:00] INFO: directory[/var/opt/gitlab/gitlab-workhorse] group changed to 992
[2025-07-12T20:46:54+03:00] INFO: directory[/var/opt/gitlab/gitlab-workhorse] mode changed to 750

    [32m- change mode from '' to '0750'[0m
    [32m- change owner from '' to 'git'[0m
    [32m- change group from '' to 'gitlab-www'[0m
  * directory[/var/opt/gitlab/gitlab-workhorse/sockets] action create[2025-07-12T20:46:54+03:00] INFO: directory[/var/opt/gitlab/gitlab-workhorse/sockets] created directory /var/opt/gitlab/gitlab-workhorse/sockets

    [32m- create new directory /var/opt/gitlab/gitlab-workhorse/sockets[0m[2025-07-12T20:46:54+03:00] INFO: directory[/var/opt/gitlab/gitlab-workhorse/sockets] owner changed to 994
[2025-07-12T20:46:54+03:00] INFO: directory[/var/opt/gitlab/gitlab-workhorse/sockets] group changed to 992
[2025-07-12T20:46:54+03:00] INFO: directory[/var/opt/gitlab/gitlab-workhorse/sockets] mode changed to 750

    [32m- change mode from '' to '0750'[0m
    [32m- change owner from '' to 'git'[0m
    [32m- change group from '' to 'gitlab-www'[0m
  * directory[/var/log/gitlab/gitlab-workhorse] action create[2025-07-12T20:46:54+03:00] INFO: directory[/var/log/gitlab/gitlab-workhorse] created directory /var/log/gitlab/gitlab-workhorse

    [32m- create new directory /var/log/gitlab/gitlab-workhorse[0m[2025-07-12T20:46:54+03:00] INFO: directory[/var/log/gitlab/gitlab-workhorse] owner changed to 994
[2025-07-12T20:46:54+03:00] INFO: directory[/var/log/gitlab/gitlab-workhorse] mode changed to 700

    [32m- change mode from '' to '0700'[0m
    [32m- change owner from '' to 'git'[0m
  * directory[/opt/gitlab/etc/gitlab-workhorse] action create[2025-07-12T20:46:54+03:00] INFO: directory[/opt/gitlab/etc/gitlab-workhorse] created directory /opt/gitlab/etc/gitlab-workhorse

    [32m- create new directory /opt/gitlab/etc/gitlab-workhorse[0m[2025-07-12T20:46:54+03:00] INFO: directory[/opt/gitlab/etc/gitlab-workhorse] owner changed to 994
[2025-07-12T20:46:54+03:00] INFO: directory[/opt/gitlab/etc/gitlab-workhorse] mode changed to 700

    [32m- change mode from '' to '0700'[0m
    [32m- change owner from '' to 'git'[0m
  * env_dir[/opt/gitlab/etc/gitlab-workhorse/env] action create
    * directory[/opt/gitlab/etc/gitlab-workhorse/env] action create[2025-07-12T20:46:54+03:00] INFO: directory[/opt/gitlab/etc/gitlab-workhorse/env] created directory /opt/gitlab/etc/gitlab-workhorse/env

      [32m- create new directory /opt/gitlab/etc/gitlab-workhorse/env[0m
    * file[/opt/gitlab/etc/gitlab-workhorse/env/PATH] action create[2025-07-12T20:46:54+03:00] INFO: file[/opt/gitlab/etc/gitlab-workhorse/env/PATH] created file /opt/gitlab/etc/gitlab-workhorse/env/PATH

      [32m- create new file /opt/gitlab/etc/gitlab-workhorse/env/PATH[0m[2025-07-12T20:46:54+03:00] INFO: file[/opt/gitlab/etc/gitlab-workhorse/env/PATH] updated file contents /opt/gitlab/etc/gitlab-workhorse/env/PATH

      [32m- update content in file /opt/gitlab/etc/gitlab-workhorse/env/PATH from none to d5dc07[0m
      [32m- suppressed sensitive resource[0m
    * file[/opt/gitlab/etc/gitlab-workhorse/env/HOME] action create[2025-07-12T20:46:54+03:00] INFO: file[/opt/gitlab/etc/gitlab-workhorse/env/HOME] created file /opt/gitlab/etc/gitlab-workhorse/env/HOME

      [32m- create new file /opt/gitlab/etc/gitlab-workhorse/env/HOME[0m[2025-07-12T20:46:54+03:00] INFO: file[/opt/gitlab/etc/gitlab-workhorse/env/HOME] updated file contents /opt/gitlab/etc/gitlab-workhorse/env/HOME

      [32m- update content in file /opt/gitlab/etc/gitlab-workhorse/env/HOME from none to 205bb9[0m
      [32m- suppressed sensitive resource[0m
    * file[/opt/gitlab/etc/gitlab-workhorse/env/SSL_CERT_DIR] action create[2025-07-12T20:46:54+03:00] INFO: file[/opt/gitlab/etc/gitlab-workhorse/env/SSL_CERT_DIR] created file /opt/gitlab/etc/gitlab-workhorse/env/SSL_CERT_DIR

      [32m- create new file /opt/gitlab/etc/gitlab-workhorse/env/SSL_CERT_DIR[0m[2025-07-12T20:46:54+03:00] INFO: file[/opt/gitlab/etc/gitlab-workhorse/env/SSL_CERT_DIR] updated file contents /opt/gitlab/etc/gitlab-workhorse/env/SSL_CERT_DIR

      [32m- update content in file /opt/gitlab/etc/gitlab-workhorse/env/SSL_CERT_DIR from none to 4f45cf[0m
      [32m- suppressed sensitive resource[0m
  
[2025-07-12T20:46:54+03:00] INFO: env_dir[/opt/gitlab/etc/gitlab-workhorse/env] not queuing delayed action restart on runit_service[gitlab-workhorse] (delayed), as it's already been queued
  * service[gitlab-workhorse] action nothing (skipped due to action :nothing)
  * runit_service[gitlab-workhorse] action enable
    * ruby_block[restart_service] action nothing (skipped due to action :nothing)
    * ruby_block[restart_log_service] action nothing (skipped due to action :nothing)
    * ruby_block[reload_log_service] action nothing (skipped due to action :nothing)
    * directory[/opt/gitlab/sv/gitlab-workhorse] action create[2025-07-12T20:46:54+03:00] INFO: directory[/opt/gitlab/sv/gitlab-workhorse] created directory /opt/gitlab/sv/gitlab-workhorse

      [32m- create new directory /opt/gitlab/sv/gitlab-workhorse[0m[2025-07-12T20:46:54+03:00] INFO: directory[/opt/gitlab/sv/gitlab-workhorse] owner changed to 0
[2025-07-12T20:46:54+03:00] INFO: directory[/opt/gitlab/sv/gitlab-workhorse] group changed to 0
[2025-07-12T20:46:54+03:00] INFO: directory[/opt/gitlab/sv/gitlab-workhorse] mode changed to 755

      [32m- change mode from '' to '0755'[0m
      [32m- change owner from '' to 'root'[0m
      [32m- change group from '' to 'root'[0m
    * template[/opt/gitlab/sv/gitlab-workhorse/run] action create[2025-07-12T20:46:54+03:00] INFO: template[/opt/gitlab/sv/gitlab-workhorse/run] created file /opt/gitlab/sv/gitlab-workhorse/run

      [32m- create new file /opt/gitlab/sv/gitlab-workhorse/run[0m[2025-07-12T20:46:54+03:00] INFO: template[/opt/gitlab/sv/gitlab-workhorse/run] updated file contents /opt/gitlab/sv/gitlab-workhorse/run

      [32m- update content in file /opt/gitlab/sv/gitlab-workhorse/run from none to b1d72f[0m
      [37m--- /opt/gitlab/sv/gitlab-workhorse/run	2025-07-12 20:46:54.321226127 +0300[0m
      [37m+++ /opt/gitlab/sv/gitlab-workhorse/.chef-run20250712-17810-bra9q5	2025-07-12 20:46:54.321226127 +0300[0m
      [37m@@ -1,27 +1,54 @@[0m
      [37m+#!/bin/sh[0m
      [37m+set -e # fail on errors[0m
      [37m+[0m
      [37m+# Redirect stderr -> stdout[0m
      [37m+exec 2>&1[0m
      [37m+[0m
      [37m+[0m
      [37m+[0m
      [37m+cd /var/opt/gitlab/gitlab-workhorse[0m
      [37m+[0m
      [37m+exec chpst -e /opt/gitlab/etc/gitlab-workhorse/env -P \[0m
      [37m+  -U git:git \[0m
      [37m+  -u git:git \[0m
      [37m+  /opt/gitlab/embedded/bin/gitlab-workhorse \[0m
      [37m+    -listenNetwork unix \[0m
      [37m+    -listenUmask 0 \[0m
      [37m+    -listenAddr /var/opt/gitlab/gitlab-workhorse/sockets/socket \[0m
      [37m+    -authBackend http://localhost:8080 \[0m
      [37m+    -authSocket /var/opt/gitlab/gitlab-rails/sockets/gitlab.socket \[0m
      [37m+    -documentRoot /opt/gitlab/embedded/service/gitlab-rails/public \[0m
      [37m+    -pprofListenAddr ''\[0m
      [37m+    -prometheusListenAddr localhost:9229 \[0m
      [37m+    -secretPath /opt/gitlab/embedded/service/gitlab-rails/.gitlab_workhorse_secret \[0m
      [37m+    -logFormat json \[0m
      [37m+    -config config.toml \[0m
      [37m+[0m
      [37m+# Do not remove this line; it prevents trouble with the trailing backslashes above.[0m[2025-07-12T20:46:54+03:00] INFO: template[/opt/gitlab/sv/gitlab-workhorse/run] owner changed to 0
[2025-07-12T20:46:54+03:00] INFO: template[/opt/gitlab/sv/gitlab-workhorse/run] group changed to 0
[2025-07-12T20:46:54+03:00] INFO: template[/opt/gitlab/sv/gitlab-workhorse/run] mode changed to 755

      [32m- change mode from '' to '0755'[0m
      [32m- change owner from '' to 'root'[0m
      [32m- change group from '' to 'root'[0m
    * directory[/opt/gitlab/sv/gitlab-workhorse/log] action create[2025-07-12T20:46:54+03:00] INFO: directory[/opt/gitlab/sv/gitlab-workhorse/log] created directory /opt/gitlab/sv/gitlab-workhorse/log

      [32m- create new directory /opt/gitlab/sv/gitlab-workhorse/log[0m[2025-07-12T20:46:54+03:00] INFO: directory[/opt/gitlab/sv/gitlab-workhorse/log] owner changed to 0
[2025-07-12T20:46:54+03:00] INFO: directory[/opt/gitlab/sv/gitlab-workhorse/log] group changed to 0
[2025-07-12T20:46:54+03:00] INFO: directory[/opt/gitlab/sv/gitlab-workhorse/log] mode changed to 755

      [32m- change mode from '' to '0755'[0m
      [32m- change owner from '' to 'root'[0m
      [32m- change group from '' to 'root'[0m
    * directory[/opt/gitlab/sv/gitlab-workhorse/log/main] action create[2025-07-12T20:46:54+03:00] INFO: directory[/opt/gitlab/sv/gitlab-workhorse/log/main] created directory /opt/gitlab/sv/gitlab-workhorse/log/main

      [32m- create new directory /opt/gitlab/sv/gitlab-workhorse/log/main[0m[2025-07-12T20:46:54+03:00] INFO: directory[/opt/gitlab/sv/gitlab-workhorse/log/main] owner changed to 0
[2025-07-12T20:46:54+03:00] INFO: directory[/opt/gitlab/sv/gitlab-workhorse/log/main] group changed to 0
[2025-07-12T20:46:54+03:00] INFO: directory[/opt/gitlab/sv/gitlab-workhorse/log/main] mode changed to 755

      [32m- change mode from '' to '0755'[0m
      [32m- change owner from '' to 'root'[0m
      [32m- change group from '' to 'root'[0m
    * template[/opt/gitlab/sv/gitlab-workhorse/log/config] action create[2025-07-12T20:46:54+03:00] INFO: template[/opt/gitlab/sv/gitlab-workhorse/log/config] created file /opt/gitlab/sv/gitlab-workhorse/log/config

      [32m- create new file /opt/gitlab/sv/gitlab-workhorse/log/config[0m[2025-07-12T20:46:54+03:00] INFO: template[/opt/gitlab/sv/gitlab-workhorse/log/config] updated file contents /opt/gitlab/sv/gitlab-workhorse/log/config

      [32m- update content in file /opt/gitlab/sv/gitlab-workhorse/log/config from none to 623c00[0m
      [37m--- /opt/gitlab/sv/gitlab-workhorse/log/config	2025-07-12 20:46:54.349212127 +0300[0m
      [37m+++ /opt/gitlab/sv/gitlab-workhorse/log/.chef-config20250712-17810-3uju29	2025-07-12 20:46:54.349212127 +0300[0m
      [37m@@ -1,6 +1,12 @@[0m
      [37m+s209715200[0m
      [37m+n30[0m
      [37m+t86400[0m
      [37m+!gzip[0m
      [37m+[0m
      [37m+[0m[2025-07-12T20:46:54+03:00] INFO: template[/opt/gitlab/sv/gitlab-workhorse/log/config] owner changed to 0
[2025-07-12T20:46:54+03:00] INFO: template[/opt/gitlab/sv/gitlab-workhorse/log/config] group changed to 0
[2025-07-12T20:46:54+03:00] INFO: template[/opt/gitlab/sv/gitlab-workhorse/log/config] mode changed to 644

      [32m- change mode from '' to '0644'[0m
      [32m- change owner from '' to 'root'[0m
      [32m- change group from '' to 'root'[0m
    * ruby_block[verify_chown_persisted_on_gitlab-workhorse] action nothing (skipped due to action :nothing)
[2025-07-12T20:46:54+03:00] INFO: ruby_block[verify_chown_persisted_on_gitlab-workhorse] sent create action to ruby_block[verify_chown_persisted_on_gitlab-workhorse] (immediate at declaration time)
    * ruby_block[verify_chown_persisted_on_gitlab-workhorse] action create[2025-07-12T20:46:54+03:00] INFO: ruby_block[verify_chown_persisted_on_gitlab-workhorse] called

      [32m- execute the ruby block verify_chown_persisted_on_gitlab-workhorse[0m
    * link[/var/log/gitlab/gitlab-workhorse/config] action create[2025-07-12T20:46:54+03:00] INFO: link[/var/log/gitlab/gitlab-workhorse/config] created

      [32m- create symlink at /var/log/gitlab/gitlab-workhorse/config to /opt/gitlab/sv/gitlab-workhorse/log/config[0m
    * template[/opt/gitlab/sv/gitlab-workhorse/log/run] action create[2025-07-12T20:46:54+03:00] INFO: template[/opt/gitlab/sv/gitlab-workhorse/log/run] created file /opt/gitlab/sv/gitlab-workhorse/log/run

      [32m- create new file /opt/gitlab/sv/gitlab-workhorse/log/run[0m[2025-07-12T20:46:54+03:00] INFO: template[/opt/gitlab/sv/gitlab-workhorse/log/run] updated file contents /opt/gitlab/sv/gitlab-workhorse/log/run

      [32m- update content in file /opt/gitlab/sv/gitlab-workhorse/log/run from none to b3b03a[0m
      [37m--- /opt/gitlab/sv/gitlab-workhorse/log/run	2025-07-12 20:46:54.365204127 +0300[0m
      [37m+++ /opt/gitlab/sv/gitlab-workhorse/log/.chef-run20250712-17810-4tfbcl	2025-07-12 20:46:54.365204127 +0300[0m
      [37m@@ -1,5 +1,10 @@[0m
      [37m+#!/bin/sh[0m
      [37m+exec chpst -P \[0m
      [37m+  -U root:root \[0m
      [37m+  -u root:root \[0m
      [37m+  svlogd /var/log/gitlab/gitlab-workhorse[0m[2025-07-12T20:46:54+03:00] INFO: template[/opt/gitlab/sv/gitlab-workhorse/log/run] owner changed to 0
[2025-07-12T20:46:54+03:00] INFO: template[/opt/gitlab/sv/gitlab-workhorse/log/run] group changed to 0
[2025-07-12T20:46:54+03:00] INFO: template[/opt/gitlab/sv/gitlab-workhorse/log/run] mode changed to 755

      [32m- change mode from '' to '0755'[0m
      [32m- change owner from '' to 'root'[0m
      [32m- change group from '' to 'root'[0m
    * directory[/opt/gitlab/sv/gitlab-workhorse/env] action create[2025-07-12T20:46:54+03:00] INFO: directory[/opt/gitlab/sv/gitlab-workhorse/env] created directory /opt/gitlab/sv/gitlab-workhorse/env

      [32m- create new directory /opt/gitlab/sv/gitlab-workhorse/env[0m[2025-07-12T20:46:54+03:00] INFO: directory[/opt/gitlab/sv/gitlab-workhorse/env] owner changed to 0
[2025-07-12T20:46:54+03:00] INFO: directory[/opt/gitlab/sv/gitlab-workhorse/env] group changed to 0
[2025-07-12T20:46:54+03:00] INFO: directory[/opt/gitlab/sv/gitlab-workhorse/env] mode changed to 755

      [32m- change mode from '' to '0755'[0m
      [32m- change owner from '' to 'root'[0m
      [32m- change group from '' to 'root'[0m
    * ruby_block[Delete unmanaged env files for gitlab-workhorse service] action run (skipped due to only_if)
    * template[/opt/gitlab/sv/gitlab-workhorse/check] action create (skipped due to only_if)
    * template[/opt/gitlab/sv/gitlab-workhorse/finish] action create (skipped due to only_if)
    * directory[/opt/gitlab/sv/gitlab-workhorse/control] action create[2025-07-12T20:46:54+03:00] INFO: directory[/opt/gitlab/sv/gitlab-workhorse/control] created directory /opt/gitlab/sv/gitlab-workhorse/control

      [32m- create new directory /opt/gitlab/sv/gitlab-workhorse/control[0m[2025-07-12T20:46:54+03:00] INFO: directory[/opt/gitlab/sv/gitlab-workhorse/control] owner changed to 0
[2025-07-12T20:46:54+03:00] INFO: directory[/opt/gitlab/sv/gitlab-workhorse/control] group changed to 0
[2025-07-12T20:46:54+03:00] INFO: directory[/opt/gitlab/sv/gitlab-workhorse/control] mode changed to 755

      [32m- change mode from '' to '0755'[0m
      [32m- change owner from '' to 'root'[0m
      [32m- change group from '' to 'root'[0m
    * link[/opt/gitlab/init/gitlab-workhorse] action create[2025-07-12T20:46:54+03:00] INFO: link[/opt/gitlab/init/gitlab-workhorse] created

      [32m- create symlink at /opt/gitlab/init/gitlab-workhorse to /opt/gitlab/embedded/bin/sv[0m
    * file[/opt/gitlab/sv/gitlab-workhorse/down] action nothing (skipped due to action :nothing)
[2025-07-12T20:46:54+03:00] INFO: template[/opt/gitlab/sv/gitlab-workhorse/run] sending run action to ruby_block[restart_service] (delayed)
    * ruby_block[restart_service] action run (skipped due to only_if)
[2025-07-12T20:46:54+03:00] INFO: template[/opt/gitlab/sv/gitlab-workhorse/log/config] sending create action to ruby_block[reload_log_service] (delayed)
    * ruby_block[reload_log_service] action create
      * ruby_block[restart_service] action nothing (skipped due to action :nothing)
      * ruby_block[restart_log_service] action nothing (skipped due to action :nothing)
      * ruby_block[reload_log_service] action nothing (skipped due to action :nothing)
      * directory[/opt/gitlab/sv/gitlab-workhorse] action create (up to date)
      * template[/opt/gitlab/sv/gitlab-workhorse/run] action create (up to date)
      * directory[/opt/gitlab/sv/gitlab-workhorse/log] action create (up to date)
      * directory[/opt/gitlab/sv/gitlab-workhorse/log/main] action create (up to date)
      * template[/opt/gitlab/sv/gitlab-workhorse/log/config] action create (up to date)
      * ruby_block[verify_chown_persisted_on_gitlab-workhorse] action nothing (skipped due to action :nothing)
      * link[/var/log/gitlab/gitlab-workhorse/config] action create (up to date)
      * template[/opt/gitlab/sv/gitlab-workhorse/log/run] action create (up to date)
      * directory[/opt/gitlab/sv/gitlab-workhorse/env] action create (up to date)
      * ruby_block[Delete unmanaged env files for gitlab-workhorse service] action run (skipped due to only_if)
      * template[/opt/gitlab/sv/gitlab-workhorse/check] action create (skipped due to only_if)
      * template[/opt/gitlab/sv/gitlab-workhorse/finish] action create (skipped due to only_if)
      * directory[/opt/gitlab/sv/gitlab-workhorse/control] action create (up to date)
      * link[/opt/gitlab/init/gitlab-workhorse] action create (up to date)
      * file[/opt/gitlab/sv/gitlab-workhorse/down] action nothing (skipped due to action :nothing)
      * directory[/opt/gitlab/service] action create (up to date)
      * link[/opt/gitlab/service/gitlab-workhorse] action create[2025-07-12T20:46:54+03:00] INFO: link[/opt/gitlab/service/gitlab-workhorse] created

        [32m- create symlink at /opt/gitlab/service/gitlab-workhorse to /opt/gitlab/sv/gitlab-workhorse[0m
      * ruby_block[wait for gitlab-workhorse service socket] action run[2025-07-12T20:46:56+03:00] INFO: ruby_block[wait for gitlab-workhorse service socket] called

        [32m- execute the ruby block wait for gitlab-workhorse service socket[0m
      * file[/var/log/gitlab/gitlab-workhorse/current] action touch (skipped due to only_if)
[2025-07-12T20:46:57+03:00] INFO: ruby_block[reload_log_service] called
      [32m- execute the ruby block reload_log_service[0m
[2025-07-12T20:46:57+03:00] INFO: template[/opt/gitlab/sv/gitlab-workhorse/log/run] sending run action to ruby_block[restart_log_service] (delayed)
    * ruby_block[restart_log_service] action run
      * ruby_block[restart_service] action nothing (skipped due to action :nothing)
      * ruby_block[restart_log_service] action nothing (skipped due to action :nothing)
      * ruby_block[reload_log_service] action nothing (skipped due to action :nothing)
      * directory[/opt/gitlab/sv/gitlab-workhorse] action create (up to date)
      * template[/opt/gitlab/sv/gitlab-workhorse/run] action create (up to date)
      * directory[/opt/gitlab/sv/gitlab-workhorse/log] action create (up to date)
      * directory[/opt/gitlab/sv/gitlab-workhorse/log/main] action create (up to date)
      * template[/opt/gitlab/sv/gitlab-workhorse/log/config] action create (up to date)
      * ruby_block[verify_chown_persisted_on_gitlab-workhorse] action nothing (skipped due to action :nothing)
      * link[/var/log/gitlab/gitlab-workhorse/config] action create (up to date)
      * template[/opt/gitlab/sv/gitlab-workhorse/log/run] action create (up to date)
      * directory[/opt/gitlab/sv/gitlab-workhorse/env] action create (up to date)
      * ruby_block[Delete unmanaged env files for gitlab-workhorse service] action run (skipped due to only_if)
      * template[/opt/gitlab/sv/gitlab-workhorse/check] action create (skipped due to only_if)
      * template[/opt/gitlab/sv/gitlab-workhorse/finish] action create (skipped due to only_if)
      * directory[/opt/gitlab/sv/gitlab-workhorse/control] action create (up to date)
      * link[/opt/gitlab/init/gitlab-workhorse] action create (up to date)
      * file[/opt/gitlab/sv/gitlab-workhorse/down] action nothing (skipped due to action :nothing)
      * directory[/opt/gitlab/service] action create (up to date)
      * link[/opt/gitlab/service/gitlab-workhorse] action create (up to date)
      * ruby_block[wait for gitlab-workhorse service socket] action run (skipped due to not_if)
      * file[/var/log/gitlab/gitlab-workhorse/current] action touch (skipped due to only_if)
[2025-07-12T20:46:57+03:00] INFO: ruby_block[restart_log_service] called
      [32m- execute the ruby block restart_log_service[0m
    * directory[/opt/gitlab/service] action create (up to date)
    * link[/opt/gitlab/service/gitlab-workhorse] action create (up to date)
    * ruby_block[wait for gitlab-workhorse service socket] action run (skipped due to not_if)
    * file[/var/log/gitlab/gitlab-workhorse/current] action touch (skipped due to only_if)
  
  * consul_service[workhorse] action delete
    * file[/var/opt/gitlab/consul/config.d/workhorse-service.json] action delete (up to date)
     (up to date)
  * version_file[Create version file for Workhorse] action create
    * file[/var/opt/gitlab/gitlab-workhorse/VERSION] action create[2025-07-12T20:46:58+03:00] INFO: file[/var/opt/gitlab/gitlab-workhorse/VERSION] created file /var/opt/gitlab/gitlab-workhorse/VERSION

      [32m- create new file /var/opt/gitlab/gitlab-workhorse/VERSION[0m[2025-07-12T20:46:58+03:00] INFO: file[/var/opt/gitlab/gitlab-workhorse/VERSION] updated file contents /var/opt/gitlab/gitlab-workhorse/VERSION

      [32m- update content in file /var/opt/gitlab/gitlab-workhorse/VERSION from none to e252d4[0m
      [37m--- /var/opt/gitlab/gitlab-workhorse/VERSION	2025-07-12 20:46:58.862954134 +0300[0m
      [37m+++ /var/opt/gitlab/gitlab-workhorse/.chef-VERSION20250712-17810-5c5vfu	2025-07-12 20:46:58.862954134 +0300[0m
      [37m@@ -1 +1,2 @@[0m
      [37m+gitlab-workhorse (v18.1.2)-(20250709.044018)[0m
  
[2025-07-12T20:46:58+03:00] INFO: version_file[Create version file for Workhorse] not queuing delayed action restart on runit_service[gitlab-workhorse] (delayed), as it's already been queued
  * template[/var/opt/gitlab/gitlab-workhorse/config.toml] action create[2025-07-12T20:46:58+03:00] INFO: template[/var/opt/gitlab/gitlab-workhorse/config.toml] created file /var/opt/gitlab/gitlab-workhorse/config.toml

    [32m- create new file /var/opt/gitlab/gitlab-workhorse/config.toml[0m[2025-07-12T20:46:58+03:00] INFO: template[/var/opt/gitlab/gitlab-workhorse/config.toml] updated file contents /var/opt/gitlab/gitlab-workhorse/config.toml

    [32m- update content in file /var/opt/gitlab/gitlab-workhorse/config.toml from none to 3a652a[0m
    [32m- suppressed sensitive resource[0m[2025-07-12T20:46:58+03:00] INFO: template[/var/opt/gitlab/gitlab-workhorse/config.toml] owner changed to 0
[2025-07-12T20:46:58+03:00] INFO: template[/var/opt/gitlab/gitlab-workhorse/config.toml] group changed to 991
[2025-07-12T20:46:58+03:00] INFO: template[/var/opt/gitlab/gitlab-workhorse/config.toml] mode changed to 640

    [32m- change mode from '' to '0640'[0m
    [32m- change owner from '' to 'root'[0m
    [32m- change group from '' to 'git'[0m
[2025-07-12T20:46:58+03:00] INFO: template[/var/opt/gitlab/gitlab-workhorse/config.toml] not queuing delayed action restart on runit_service[gitlab-workhorse] (delayed), as it's already been queued
Recipe: gitlab::mailroom_disable
  * service[mailroom] action nothing (skipped due to action :nothing)
  * runit_service[mailroom] action disable
    * ruby_block[disable mailroom] action run (skipped due to only_if)
     (up to date)
Recipe: gitlab::nginx
  * directory[/var/opt/gitlab/nginx] action create[2025-07-12T20:46:58+03:00] INFO: directory[/var/opt/gitlab/nginx] created directory /var/opt/gitlab/nginx

    [32m- create new directory /var/opt/gitlab/nginx[0m[2025-07-12T20:46:58+03:00] INFO: directory[/var/opt/gitlab/nginx] owner changed to 0
[2025-07-12T20:46:58+03:00] INFO: directory[/var/opt/gitlab/nginx] group changed to 992
[2025-07-12T20:46:58+03:00] INFO: directory[/var/opt/gitlab/nginx] mode changed to 750

    [32m- change mode from '' to '0750'[0m
    [32m- change owner from '' to 'root'[0m
    [32m- change group from '' to 'gitlab-www'[0m
  * directory[/var/opt/gitlab/nginx/conf] action create[2025-07-12T20:46:58+03:00] INFO: directory[/var/opt/gitlab/nginx/conf] created directory /var/opt/gitlab/nginx/conf

    [32m- create new directory /var/opt/gitlab/nginx/conf[0m[2025-07-12T20:46:58+03:00] INFO: directory[/var/opt/gitlab/nginx/conf] owner changed to 0
[2025-07-12T20:46:58+03:00] INFO: directory[/var/opt/gitlab/nginx/conf] group changed to 992
[2025-07-12T20:46:58+03:00] INFO: directory[/var/opt/gitlab/nginx/conf] mode changed to 750

    [32m- change mode from '' to '0750'[0m
    [32m- change owner from '' to 'root'[0m
    [32m- change group from '' to 'gitlab-www'[0m
  * directory[/var/log/gitlab/nginx] action create[2025-07-12T20:46:58+03:00] INFO: directory[/var/log/gitlab/nginx] created directory /var/log/gitlab/nginx

    [32m- create new directory /var/log/gitlab/nginx[0m[2025-07-12T20:46:58+03:00] INFO: directory[/var/log/gitlab/nginx] owner changed to 0
[2025-07-12T20:46:58+03:00] INFO: directory[/var/log/gitlab/nginx] group changed to 992
[2025-07-12T20:46:58+03:00] INFO: directory[/var/log/gitlab/nginx] mode changed to 750

    [32m- change mode from '' to '0750'[0m
    [32m- change owner from '' to 'root'[0m
    [32m- change group from '' to 'gitlab-www'[0m
  * link[/var/opt/gitlab/nginx/logs] action create[2025-07-12T20:46:58+03:00] INFO: link[/var/opt/gitlab/nginx/logs] created

    [32m- create symlink at /var/opt/gitlab/nginx/logs to /var/log/gitlab/nginx[0m
  * template[/var/opt/gitlab/nginx/conf/gitlab-http.conf] action create[2025-07-12T20:46:58+03:00] INFO: template[/var/opt/gitlab/nginx/conf/gitlab-http.conf] created file /var/opt/gitlab/nginx/conf/gitlab-http.conf

    [32m- create new file /var/opt/gitlab/nginx/conf/gitlab-http.conf[0m[2025-07-12T20:46:58+03:00] INFO: template[/var/opt/gitlab/nginx/conf/gitlab-http.conf] updated file contents /var/opt/gitlab/nginx/conf/gitlab-http.conf

    [32m- update content in file /var/opt/gitlab/nginx/conf/gitlab-http.conf from none to 9c7ef8[0m
    [37m--- /var/opt/gitlab/nginx/conf/gitlab-http.conf	2025-07-12 20:46:58.958906126 +0300[0m
    [37m+++ /var/opt/gitlab/nginx/conf/.chef-gitlab-http20250712-17810-7o0omj.conf	2025-07-12 20:46:58.958906126 +0300[0m
    [37m@@ -1,141 +1,282 @@[0m
    [37m+# This file is managed by gitlab-ctl. Manual changes will be[0m
    [37m+# erased! To change the contents below, edit /etc/gitlab/gitlab.rb[0m
    [37m+# and run `sudo gitlab-ctl reconfigure`.[0m
    [37m+[0m
    [37m+## GitLab[0m
    [37m+## Modified from https://gitlab.com/gitlab-org/gitlab-foss/blob/master/lib/support/nginx/gitlab-ssl & https://gitlab.com/gitlab-org/gitlab-foss/blob/master/lib/support/nginx/gitlab[0m
    [37m+##[0m
    [37m+## Lines starting with two hashes (##) are comments with information.[0m
    [37m+## Lines starting with one hash (#) are configuration parameters that can be uncommented.[0m
    [37m+##[0m
    [37m+##################################[0m
    [37m+##        CHUNKED TRANSFER      ##[0m
    [37m+##################################[0m
    [37m+##[0m
    [37m+## It is a known issue that Git-over-HTTP requires chunked transfer encoding [0][0m
    [37m+## which is not supported by Nginx < 1.3.9 [1]. As a result, pushing a large object[0m
    [37m+## with Git (i.e. a single large file) can lead to a 411 error. In theory you can get[0m
    [37m+## around this by tweaking this configuration file and either:[0m
    [37m+## - installing an old version of Nginx with the chunkin module [2] compiled in, or[0m
    [37m+## - using a newer version of Nginx.[0m
    [37m+##[0m
    [37m+## At the time of writing we do not know if either of these theoretical solutions works.[0m
    [37m+## As a workaround users can use Git over SSH to push large files.[0m
    [37m+##[0m
    [37m+## [0] https://git.kernel.org/cgit/git/git.git/tree/Documentation/technical/http-protocol.txt#n99[0m
    [37m+## [1] https://github.com/agentzh/chunkin-nginx-module#status[0m
    [37m+## [2] https://github.com/agentzh/chunkin-nginx-module[0m
    [37m+##[0m
    [37m+###################################[0m
    [37m+##         configuration         ##[0m
    [37m+###################################[0m
    [37m+[0m
    [37m+[0m
    [37m+server { ## HTTPS server[0m
    [37m+  listen *:80;[0m
    [37m+[0m
    [37m+[0m
    [37m+  server_name gitlab.example.com;[0m
    [37m+  server_tokens off; ## Don't show the nginx version number, a security best practice[0m
    [37m+[0m
    [37m+  ## Increase this if you want to upload large attachments[0m
    [37m+  ## Or if you want to accept large git objects over http[0m
    [37m+  client_max_body_size 0;[0m
    [37m+[0m
    [37m+[0m
    [37m+  ## Real IP Module Config[0m
    [37m+  ## http://nginx.org/en/docs/http/ngx_http_realip_module.html[0m
    [37m+[0m
    [37m+  ## HSTS Config[0m
    [37m+  ## https://www.nginx.com/blog/http-strict-transport-security-hsts-and-nginx/[0m
    [37m+  add_header Strict-Transport-Security "max-age=63072000" always;[0m
    [37m+[0m
    [37m+  # Rails sets a default policy of strict-origin-when-cross-origin, so[0m
    [37m+  # hide that and just send the one we've configured for nginx[0m
    [37m+  proxy_hide_header Referrer-Policy;[0m
    [37m+  add_header Referrer-Policy strict-origin-when-cross-origin;[0m
    [37m+[0m
    [37m+  ## Individual nginx logs for this GitLab vhost[0m
    [37m+  access_log  /var/log/gitlab/nginx/gitlab_access.log gitlab_access;[0m
    [37m+  error_log   /var/log/gitlab/nginx/gitlab_error.log error;[0m
    [37m+[0m
    [37m+  if ($http_host = "") {[0m
    [37m+    set $http_host_with_default "gitlab.example.com";[0m
    [37m+  }[0m
    [37m+[0m
    [37m+  if ($http_host != "") {[0m
    [37m+    set $http_host_with_default $http_host;[0m
    [37m+  }[0m
    [37m+[0m
    [37m+  gzip on;[0m
    [37m+  gzip_static on;[0m
    [37m+  gzip_comp_level 2;[0m
    [37m+  gzip_http_version 1.1;[0m
    [37m+  gzip_vary on;[0m
    [37m+  gzip_disable "msie6";[0m
    [37m+  gzip_min_length 250;[0m
    [37m+  gzip_proxied no-cache no-store private expired auth;[0m
    [37m+  gzip_types text/plain text/css application/x-javascript text/xml application/xml application/xml+rss text/javascript application/json;[0m
    [37m+[0m
    [37m+  ## https://github.com/gitlabhq/gitlabhq/issues/694[0m
    [37m+  ## Some requests take more than 30 seconds.[0m
    [37m+  proxy_read_timeout      3600;[0m
    [37m+  proxy_connect_timeout   300;[0m
    [37m+  proxy_redirect          off;[0m
    [37m+  proxy_http_version 1.1;[0m
    [37m+[0m
    [37m+  proxy_set_header Host $http_host_with_default;[0m
    [37m+  proxy_set_header X-Real-IP $remote_addr;[0m
    [37m+  proxy_set_header X-Forwarded-For $remote_addr;[0m
    [37m+  proxy_set_header Upgrade $http_upgrade;[0m
    [37m+  proxy_set_header Connection $connection_upgrade;[0m
    [37m+  proxy_set_header X-Forwarded-Proto http;[0m
    [37m+[0m
    [37m+  location ~ (/api/v\d/jobs/\d+/artifacts$|/import/gitlab_project$|\.git/git-receive-pack$|\.git/ssh-receive-pack$|\.git/ssh-upload-pack$|\.git/gitlab-lfs/objects|\.git/info/lfs/objects/batch$) {[0m
    [37m+    proxy_cache off;[0m
    [37m+    proxy_pass http://gitlab-workhorse;[0m
    [37m+    proxy_request_buffering off;[0m
    [37m+  }[0m
    [37m+[0m
    [37m+  location ~ ^/api/v\d {[0m
    [37m+    proxy_cache off;[0m
    [37m+    proxy_pass http://gitlab-workhorse;[0m
    [37m+    proxy_intercept_errors off;[0m
    [37m+  }[0m
    [37m+[0m
    [37m+  location = /-/kubernetes-agent/ {[0m
    [37m+    proxy_pass http://localhost:8150/;[0m
    [37m+    proxy_intercept_errors off;[0m
    [37m+  }[0m
    [37m+[0m
    [37m+  location /-/kubernetes-agent/k8s-proxy/ {[0m
    [37m+    proxy_pass http://localhost:8154/;[0m
    [37m+    proxy_buffering off;[0m
    [37m+    proxy_intercept_errors off;[0m
    [37m+  }[0m
    [37m+[0m
    [37m+  # health checks configuration[0m
    [37m+  include /var/opt/gitlab/nginx/conf/gitlab-health.conf;[0m
    [37m+[0m
    [37m+[0m
    [37m+  location / {[0m
    [37m+    proxy_cache off;[0m
    [37m+    proxy_pass  http://gitlab-workhorse;[0m
    [37m+  }[0m
    [37m+[0m
    [37m+  location /assets {[0m
    [37m+    add_header X-Content-Type-Options nosniff;[0m
    [37m+    proxy_cache gitlab;[0m
    [37m+    proxy_pass  http://gitlab-workhorse;[0m
    [37m+  }[0m
    [37m+[0m
    [37m+  error_page 404 /404.html;[0m
    [37m+  error_page 500 /500.html;[0m
    [37m+  error_page 502 /502.html;[0m
    [37m+  location ~ ^/(404|500|502)(-custom)?\.html$ {[0m
    [37m+    root /opt/gitlab/embedded/service/gitlab-rails/public;[0m
    [37m+    internal;[0m
    [37m+  }[0m
    [37m+[0m
    [37m+  [0m
    [37m+} ## end HTTPS server[0m[2025-07-12T20:46:58+03:00] INFO: template[/var/opt/gitlab/nginx/conf/gitlab-http.conf] owner changed to 0
[2025-07-12T20:46:58+03:00] INFO: template[/var/opt/gitlab/nginx/conf/gitlab-http.conf] group changed to 0
[2025-07-12T20:46:58+03:00] INFO: template[/var/opt/gitlab/nginx/conf/gitlab-http.conf] mode changed to 644

    [32m- change mode from '' to '0644'[0m
    [32m- change owner from '' to 'root'[0m
    [32m- change group from '' to 'root'[0m
  * template[/var/opt/gitlab/nginx/conf/gitlab-smartcard-http.conf] action delete (up to date)
  * template[/var/opt/gitlab/nginx/conf/gitlab-health.conf] action create[2025-07-12T20:46:58+03:00] INFO: template[/var/opt/gitlab/nginx/conf/gitlab-health.conf] created file /var/opt/gitlab/nginx/conf/gitlab-health.conf

    [32m- create new file /var/opt/gitlab/nginx/conf/gitlab-health.conf[0m[2025-07-12T20:46:58+03:00] INFO: template[/var/opt/gitlab/nginx/conf/gitlab-health.conf] updated file contents /var/opt/gitlab/nginx/conf/gitlab-health.conf

    [32m- update content in file /var/opt/gitlab/nginx/conf/gitlab-health.conf from none to 00013f[0m
    [37m--- /var/opt/gitlab/nginx/conf/gitlab-health.conf	2025-07-12 20:46:58.974898124 +0300[0m
    [37m+++ /var/opt/gitlab/nginx/conf/.chef-gitlab-health20250712-17810-estwb5.conf	2025-07-12 20:46:58.974898124 +0300[0m
    [37m@@ -1,32 +1,64 @@[0m
    [37m+# This file is managed by gitlab-ctl. Manual changes will be[0m
    [37m+# erased! To change the contents below, edit /etc/gitlab/gitlab.rb[0m
    [37m+# and run `sudo gitlab-ctl reconfigure`.[0m
    [37m+[0m
    [37m+location /error.txt {[0m
    [37m+  # return code here is ignored by the error_page directive[0m
    [37m+  return 500 'nginx returned $status when communicating with gitlab-workhorse\n';[0m
    [37m+}[0m
    [37m+[0m
    [37m+location /error.json  {[0m
    [37m+  # return code here is ignored by the error_page directive[0m
    [37m+  return 500 '{"error":"nginx returned $status when communicating with gitlab-workhorse","status":$status}\n';[0m
    [37m+}[0m
    [37m+[0m
    [37m+location = /-/health {[0m
    [37m+  proxy_cache off;[0m
    [37m+  proxy_http_version 1.0;[0m
    [37m+  proxy_pass  http://gitlab-workhorse;[0m
    [37m+  error_page 404 500 502 /error.txt;[0m
    [37m+}[0m
    [37m+location = /-/readiness {[0m
    [37m+  proxy_cache off;[0m
    [37m+  proxy_http_version 1.0;[0m
    [37m+  proxy_pass  http://gitlab-workhorse;[0m
    [37m+  error_page 404 500 502 /error.json;[0m
    [37m+}[0m
    [37m+location = /-/liveness {[0m
    [37m+  proxy_cache off;[0m
    [37m+  proxy_http_version 1.0;[0m
    [37m+  proxy_pass  http://gitlab-workhorse;[0m
    [37m+  error_page 404 500 502 /error.json;[0m
    [37m+}[0m[2025-07-12T20:46:58+03:00] INFO: template[/var/opt/gitlab/nginx/conf/gitlab-health.conf] owner changed to 0
[2025-07-12T20:46:58+03:00] INFO: template[/var/opt/gitlab/nginx/conf/gitlab-health.conf] group changed to 0
[2025-07-12T20:46:58+03:00] INFO: template[/var/opt/gitlab/nginx/conf/gitlab-health.conf] mode changed to 644

    [32m- change mode from '' to '0644'[0m
    [32m- change owner from '' to 'root'[0m
    [32m- change group from '' to 'root'[0m
  * template[/var/opt/gitlab/nginx/conf/gitlab-pages.conf] action delete (up to date)
  * template[/var/opt/gitlab/nginx/conf/gitlab-registry.conf] action delete (up to date)
  * template[/var/opt/gitlab/nginx/conf/gitlab-mattermost-http.conf] action delete (up to date)
  * template[/var/opt/gitlab/nginx/conf/gitlab-kas.conf] action delete (up to date)
  * template[/var/opt/gitlab/nginx/conf/nginx-status.conf] action create[2025-07-12T20:46:58+03:00] INFO: template[/var/opt/gitlab/nginx/conf/nginx-status.conf] created file /var/opt/gitlab/nginx/conf/nginx-status.conf

    [32m- create new file /var/opt/gitlab/nginx/conf/nginx-status.conf[0m[2025-07-12T20:46:58+03:00] INFO: template[/var/opt/gitlab/nginx/conf/nginx-status.conf] updated file contents /var/opt/gitlab/nginx/conf/nginx-status.conf

    [32m- update content in file /var/opt/gitlab/nginx/conf/nginx-status.conf from none to 4fdeba[0m
    [37m--- /var/opt/gitlab/nginx/conf/nginx-status.conf	2025-07-12 20:46:58.994888123 +0300[0m
    [37m+++ /var/opt/gitlab/nginx/conf/.chef-nginx-status20250712-17810-18slf4.conf	2025-07-12 20:46:58.994888123 +0300[0m
    [37m@@ -1,29 +1,58 @@[0m
    [37m+server  {[0m
    [37m+    listen *:8060;[0m
    [37m+    server_name localhost;[0m
    [37m+    location /nginx_status {[0m
    [37m+      stub_status;[0m
    [37m+      server_tokens off;[0m
    [37m+      access_log off;[0m
    [37m+      allow 127.0.0.1;[0m
    [37m+      deny all;[0m
    [37m+    }[0m
    [37m+    location /metrics {[0m
    [37m+      vhost_traffic_status_display;[0m
    [37m+      vhost_traffic_status_display_format prometheus;[0m
    [37m+      server_tokens off;[0m
    [37m+      access_log off;[0m
    [37m+      allow 127.0.0.1;[0m
    [37m+      deny all;[0m
    [37m+    }[0m
    [37m+[0m
    [37m+    location /rails-metrics {[0m
    [37m+      proxy_cache off;[0m
    [37m+      proxy_http_version 1.0;[0m
    [37m+      proxy_pass  http://gitlab-workhorse/-/metrics;[0m
    [37m+      server_tokens off;[0m
    [37m+      access_log off;[0m
    [37m+      allow 127.0.0.1;[0m
    [37m+      deny all;[0m
    [37m+    }[0m
    [37m+}[0m[2025-07-12T20:46:59+03:00] INFO: template[/var/opt/gitlab/nginx/conf/nginx-status.conf] owner changed to 0
[2025-07-12T20:46:59+03:00] INFO: template[/var/opt/gitlab/nginx/conf/nginx-status.conf] group changed to 0
[2025-07-12T20:46:59+03:00] INFO: template[/var/opt/gitlab/nginx/conf/nginx-status.conf] mode changed to 644

    [32m- change mode from '' to '0644'[0m
    [32m- change owner from '' to 'root'[0m
    [32m- change group from '' to 'root'[0m
  * consul_service[nginx] action delete
    * file[/var/opt/gitlab/consul/config.d/nginx-service.json] action delete (up to date)
     (up to date)
  * template[/var/opt/gitlab/nginx/conf/nginx.conf] action create[2025-07-12T20:46:59+03:00] INFO: template[/var/opt/gitlab/nginx/conf/nginx.conf] created file /var/opt/gitlab/nginx/conf/nginx.conf

    [32m- create new file /var/opt/gitlab/nginx/conf/nginx.conf[0m[2025-07-12T20:46:59+03:00] INFO: template[/var/opt/gitlab/nginx/conf/nginx.conf] updated file contents /var/opt/gitlab/nginx/conf/nginx.conf

    [32m- update content in file /var/opt/gitlab/nginx/conf/nginx.conf from none to 7dbf9a[0m
    [37m--- /var/opt/gitlab/nginx/conf/nginx.conf	2025-07-12 20:46:59.018876123 +0300[0m
    [37m+++ /var/opt/gitlab/nginx/conf/.chef-nginx20250712-17810-ohz93h.conf	2025-07-12 20:46:59.018876123 +0300[0m
    [37m@@ -1,102 +1,204 @@[0m
    [37m+# This file is managed by gitlab-ctl. Manual changes will be[0m
    [37m+# erased! To change the contents below, edit /etc/gitlab/gitlab.rb[0m
    [37m+# and run `sudo gitlab-ctl reconfigure`.[0m
    [37m+[0m
    [37m+user gitlab-www gitlab-www;[0m
    [37m+worker_processes 4;[0m
    [37m+error_log stderr;[0m
    [37m+pid nginx.pid;[0m
    [37m+[0m
    [37m+daemon off;[0m
    [37m+[0m
    [37m+events {[0m
    [37m+  worker_connections 10240;[0m
    [37m+}[0m
    [37m+[0m
    [37m+http {[0m
    [37m+  log_format gitlab_access '$remote_addr - $remote_user [$time_local] "$request_method $filtered_request_uri $server_protocol" $status $body_bytes_sent "$filtered_http_referer" "$http_user_agent" $gzip_ratio';[0m
    [37m+  log_format gitlab_mattermost_access '$remote_addr - $remote_user [$time_local] "$request_method $filtered_request_uri $server_protocol" $status $body_bytes_sent "$filtered_http_referer" "$http_user_agent" $gzip_ratio';[0m
    [37m+[0m
    [37m+  hide_server_tokens off;[0m
    [37m+[0m
    [37m+  server_names_hash_bucket_size 64;[0m
    [37m+[0m
    [37m+  sendfile on;[0m
    [37m+  tcp_nopush on;[0m
    [37m+  tcp_nodelay on;[0m
    [37m+[0m
    [37m+  keepalive_timeout 65;[0m
    [37m+  keepalive_time 1h;[0m
    [37m+[0m
    [37m+  gzip on;[0m
    [37m+  gzip_http_version 1.1;[0m
    [37m+  gzip_comp_level 2;[0m
    [37m+  gzip_proxied no-cache no-store private expired auth;[0m
    [37m+  gzip_types text/plain text/css application/x-javascript text/xml application/xml application/xml+rss text/javascript application/json;[0m
    [37m+[0m
    [37m+  include /opt/gitlab/embedded/conf/mime.types;[0m
    [37m+[0m
    [37m+  proxy_cache_path proxy_cache keys_zone=gitlab:10m max_size=1g levels=1:2;[0m
    [37m+  proxy_cache gitlab;[0m
    [37m+[0m
    [37m+  map $http_upgrade $connection_upgrade {[0m
    [37m+      default upgrade;[0m
    [37m+      ''      close;[0m
    [37m+  }[0m
    [37m+[0m
    [37m+  # Remove private_token from the request URI[0m
    [37m+  # In:  /foo?private_token=unfiltered&authenticity_token=unfiltered&rss_token=unfiltered&token=glptt-unfiltered&...[0m
    [37m+  # Out: /foo?private_token=[FILTERED]&authenticity_token=unfiltered&rss_token=unfiltered&token=glptt-unfiltered...[0m
    [37m+  map $request_uri $temp_request_uri_1 {[0m
    [37m+    default $request_uri;[0m
    [37m+    ~(?i)^(?<start>.*)(?<temp>[\?&]private[\-_]token)=[^&]*(?<rest>.*)$ "$start$temp=[FILTERED]$rest";[0m
    [37m+  }[0m
    [37m+[0m
    [37m+  # Remove authenticity_token from the request URI[0m
    [37m+  # In:  /foo?private_token=[FILTERED]&authenticity_token=unfiltered&rss_token=unfiltered&token=glptt-unfiltered&..[0m
    [37m+  # Out: /foo?private_token=[FILTERED]&authenticity_token=[FILTERED]&rss_token=unfiltered&token=glptt-unfiltered&..[0m
    [37m+  map $temp_request_uri_1 $temp_request_uri_2 {[0m
    [37m+    default $temp_request_uri_1;[0m
    [37m+    ~(?i)^(?<start>.*)(?<temp>[\?&]authenticity[\-_]token)=[^&]*(?<rest>.*)$ "$start$temp=[FILTERED]$rest";[0m
    [37m+  }[0m
    [37m+[0m
    [37m+  # Remove rss_token from the request URI[0m
    [37m+  # In:  /foo?private_token=[FILTERED]&authenticity_token=[FILTERED]&rss_token=unfiltered&token=glptt-unfiltered&...[0m
    [37m+  # Out: /foo?private_token=[FILTERED]&authenticity_token=[FILTERED]&rss_token=[FILTERED]&token=glptt-unfiltered&...[0m
    [37m+  map $temp_request_uri_2 $temp_request_uri_3 {[0m
    [37m+    default $temp_request_uri_2;[0m
    [37m+    ~(?i)^(?<start>.*)(?<temp>[\?&]rss[\-_]token)=[^&]*(?<rest>.*)$ "$start$temp=[FILTERED]$rest";[0m
    [37m+  }[0m
    [37m+[0m
    [37m+  # Remove pipeline trigger token from the request URI[0m
    [37m+  # In:  /foo?private_token=[FILTERED]&authenticity_token=[FILTERED]&rss_token=[FILTERED]&token=glptt-unfiltered&...[0m
    [37m+  # Out: /foo?private_token=[FILTERED]&authenticity_token=[FILTERED]&rss_token=[FILTERED]&token=[FILTERED]&...[0m
    [37m+  map $temp_request_uri_3 $filtered_request_uri {[0m
    [37m+    default $temp_request_uri_3;[0m
    [37m+    ~(?i)^(?<start>.*)(?<temp>[\?&]token)=glptt-[^&]*(?<rest>.*)$ "$start$temp=[FILTERED]$rest";[0m
    [37m+  }[0m
    [37m+[0m
    [37m+  # A version of the referer without the query string[0m
    [37m+  map $http_referer $filtered_http_referer {[0m
    [37m+    default $http_referer;[0m
    [37m+    ~^(?<temp>.*)\? $temp;[0m
    [37m+  }[0m
    [37m+[0m
    [37m+  # Enable vts status module.[0m
    [37m+  vhost_traffic_status_zone;[0m
    [37m+[0m
    [37m+  upstream gitlab-workhorse {[0m
    [37m+    server unix:/var/opt/gitlab/gitlab-workhorse/sockets/socket;[0m
    [37m+  }[0m
    [37m+[0m
    [37m+  include /var/opt/gitlab/nginx/conf/gitlab-http.conf;[0m
    [37m+[0m
    [37m+[0m
    [37m+[0m
    [37m+[0m
    [37m+[0m
    [37m+[0m
    [37m+  include /var/opt/gitlab/nginx/conf/nginx-status.conf;[0m
    [37m+[0m
    [37m+  [0m
    [37m+}[0m[2025-07-12T20:46:59+03:00] INFO: template[/var/opt/gitlab/nginx/conf/nginx.conf] owner changed to 0
[2025-07-12T20:46:59+03:00] INFO: template[/var/opt/gitlab/nginx/conf/nginx.conf] group changed to 0
[2025-07-12T20:46:59+03:00] INFO: template[/var/opt/gitlab/nginx/conf/nginx.conf] mode changed to 644

    [32m- change mode from '' to '0644'[0m
    [32m- change owner from '' to 'root'[0m
    [32m- change group from '' to 'root'[0m
Recipe: nginx::enable
  * service[nginx] action nothing (skipped due to action :nothing)
  * runit_service[nginx] action enable
    * ruby_block[restart_service] action nothing (skipped due to action :nothing)
    * ruby_block[restart_log_service] action nothing (skipped due to action :nothing)
    * ruby_block[reload_log_service] action nothing (skipped due to action :nothing)
    * directory[/opt/gitlab/sv/nginx] action create[2025-07-12T20:46:59+03:00] INFO: directory[/opt/gitlab/sv/nginx] created directory /opt/gitlab/sv/nginx

      [32m- create new directory /opt/gitlab/sv/nginx[0m[2025-07-12T20:46:59+03:00] INFO: directory[/opt/gitlab/sv/nginx] owner changed to 0
[2025-07-12T20:46:59+03:00] INFO: directory[/opt/gitlab/sv/nginx] group changed to 0
[2025-07-12T20:46:59+03:00] INFO: directory[/opt/gitlab/sv/nginx] mode changed to 755

      [32m- change mode from '' to '0755'[0m
      [32m- change owner from '' to 'root'[0m
      [32m- change group from '' to 'root'[0m
    * template[/opt/gitlab/sv/nginx/run] action create[2025-07-12T20:46:59+03:00] INFO: template[/opt/gitlab/sv/nginx/run] created file /opt/gitlab/sv/nginx/run

      [32m- create new file /opt/gitlab/sv/nginx/run[0m[2025-07-12T20:46:59+03:00] INFO: template[/opt/gitlab/sv/nginx/run] updated file contents /opt/gitlab/sv/nginx/run

      [32m- update content in file /opt/gitlab/sv/nginx/run from none to d75aea[0m
      [37m--- /opt/gitlab/sv/nginx/run	2025-07-12 20:46:59.042864122 +0300[0m
      [37m+++ /opt/gitlab/sv/nginx/.chef-run20250712-17810-pp8r1d	2025-07-12 20:46:59.042864122 +0300[0m
      [37m@@ -1,5 +1,10 @@[0m
      [37m+#!/bin/sh[0m
      [37m+exec 2>&1[0m
      [37m+[0m
      [37m+cd /var/opt/gitlab/nginx[0m
      [37m+exec chpst -P /opt/gitlab/embedded/sbin/nginx -p /var/opt/gitlab/nginx[0m[2025-07-12T20:46:59+03:00] INFO: template[/opt/gitlab/sv/nginx/run] owner changed to 0
[2025-07-12T20:46:59+03:00] INFO: template[/opt/gitlab/sv/nginx/run] group changed to 0
[2025-07-12T20:46:59+03:00] INFO: template[/opt/gitlab/sv/nginx/run] mode changed to 755

      [32m- change mode from '' to '0755'[0m
      [32m- change owner from '' to 'root'[0m
      [32m- change group from '' to 'root'[0m
    * directory[/opt/gitlab/sv/nginx/log] action create[2025-07-12T20:46:59+03:00] INFO: directory[/opt/gitlab/sv/nginx/log] created directory /opt/gitlab/sv/nginx/log

      [32m- create new directory /opt/gitlab/sv/nginx/log[0m[2025-07-12T20:46:59+03:00] INFO: directory[/opt/gitlab/sv/nginx/log] owner changed to 0
[2025-07-12T20:46:59+03:00] INFO: directory[/opt/gitlab/sv/nginx/log] group changed to 0
[2025-07-12T20:46:59+03:00] INFO: directory[/opt/gitlab/sv/nginx/log] mode changed to 755

      [32m- change mode from '' to '0755'[0m
      [32m- change owner from '' to 'root'[0m
      [32m- change group from '' to 'root'[0m
    * directory[/opt/gitlab/sv/nginx/log/main] action create[2025-07-12T20:46:59+03:00] INFO: directory[/opt/gitlab/sv/nginx/log/main] created directory /opt/gitlab/sv/nginx/log/main

      [32m- create new directory /opt/gitlab/sv/nginx/log/main[0m[2025-07-12T20:46:59+03:00] INFO: directory[/opt/gitlab/sv/nginx/log/main] owner changed to 0
[2025-07-12T20:46:59+03:00] INFO: directory[/opt/gitlab/sv/nginx/log/main] group changed to 0
[2025-07-12T20:46:59+03:00] INFO: directory[/opt/gitlab/sv/nginx/log/main] mode changed to 755

      [32m- change mode from '' to '0755'[0m
      [32m- change owner from '' to 'root'[0m
      [32m- change group from '' to 'root'[0m
    * template[/opt/gitlab/sv/nginx/log/config] action create[2025-07-12T20:46:59+03:00] INFO: template[/opt/gitlab/sv/nginx/log/config] created file /opt/gitlab/sv/nginx/log/config

      [32m- create new file /opt/gitlab/sv/nginx/log/config[0m[2025-07-12T20:46:59+03:00] INFO: template[/opt/gitlab/sv/nginx/log/config] updated file contents /opt/gitlab/sv/nginx/log/config

      [32m- update content in file /opt/gitlab/sv/nginx/log/config from none to 623c00[0m
      [37m--- /opt/gitlab/sv/nginx/log/config	2025-07-12 20:46:59.066852122 +0300[0m
      [37m+++ /opt/gitlab/sv/nginx/log/.chef-config20250712-17810-rqc24p	2025-07-12 20:46:59.066852122 +0300[0m
      [37m@@ -1,6 +1,12 @@[0m
      [37m+s209715200[0m
      [37m+n30[0m
      [37m+t86400[0m
      [37m+!gzip[0m
      [37m+[0m
      [37m+[0m[2025-07-12T20:46:59+03:00] INFO: template[/opt/gitlab/sv/nginx/log/config] owner changed to 0
[2025-07-12T20:46:59+03:00] INFO: template[/opt/gitlab/sv/nginx/log/config] group changed to 0
[2025-07-12T20:46:59+03:00] INFO: template[/opt/gitlab/sv/nginx/log/config] mode changed to 644

      [32m- change mode from '' to '0644'[0m
      [32m- change owner from '' to 'root'[0m
      [32m- change group from '' to 'root'[0m
    * ruby_block[verify_chown_persisted_on_nginx] action nothing (skipped due to action :nothing)
[2025-07-12T20:46:59+03:00] INFO: ruby_block[verify_chown_persisted_on_nginx] sent create action to ruby_block[verify_chown_persisted_on_nginx] (immediate at declaration time)
    * ruby_block[verify_chown_persisted_on_nginx] action create[2025-07-12T20:46:59+03:00] INFO: ruby_block[verify_chown_persisted_on_nginx] called

      [32m- execute the ruby block verify_chown_persisted_on_nginx[0m
    * link[/var/log/gitlab/nginx/config] action create[2025-07-12T20:46:59+03:00] INFO: link[/var/log/gitlab/nginx/config] created

      [32m- create symlink at /var/log/gitlab/nginx/config to /opt/gitlab/sv/nginx/log/config[0m
    * template[/opt/gitlab/sv/nginx/log/run] action create[2025-07-12T20:46:59+03:00] INFO: template[/opt/gitlab/sv/nginx/log/run] created file /opt/gitlab/sv/nginx/log/run

      [32m- create new file /opt/gitlab/sv/nginx/log/run[0m[2025-07-12T20:46:59+03:00] INFO: template[/opt/gitlab/sv/nginx/log/run] updated file contents /opt/gitlab/sv/nginx/log/run

      [32m- update content in file /opt/gitlab/sv/nginx/log/run from none to 2d00df[0m
      [37m--- /opt/gitlab/sv/nginx/log/run	2025-07-12 20:46:59.078846122 +0300[0m
      [37m+++ /opt/gitlab/sv/nginx/log/.chef-run20250712-17810-mqp511	2025-07-12 20:46:59.078846122 +0300[0m
      [37m@@ -1,5 +1,10 @@[0m
      [37m+#!/bin/sh[0m
      [37m+exec chpst -P \[0m
      [37m+  -U root:root \[0m
      [37m+  -u root:root \[0m
      [37m+  svlogd -tt /var/log/gitlab/nginx[0m[2025-07-12T20:46:59+03:00] INFO: template[/opt/gitlab/sv/nginx/log/run] owner changed to 0
[2025-07-12T20:46:59+03:00] INFO: template[/opt/gitlab/sv/nginx/log/run] group changed to 0
[2025-07-12T20:46:59+03:00] INFO: template[/opt/gitlab/sv/nginx/log/run] mode changed to 755

      [32m- change mode from '' to '0755'[0m
      [32m- change owner from '' to 'root'[0m
      [32m- change group from '' to 'root'[0m
    * directory[/opt/gitlab/sv/nginx/env] action create[2025-07-12T20:46:59+03:00] INFO: directory[/opt/gitlab/sv/nginx/env] created directory /opt/gitlab/sv/nginx/env

      [32m- create new directory /opt/gitlab/sv/nginx/env[0m[2025-07-12T20:46:59+03:00] INFO: directory[/opt/gitlab/sv/nginx/env] owner changed to 0
[2025-07-12T20:46:59+03:00] INFO: directory[/opt/gitlab/sv/nginx/env] group changed to 0
[2025-07-12T20:46:59+03:00] INFO: directory[/opt/gitlab/sv/nginx/env] mode changed to 755

      [32m- change mode from '' to '0755'[0m
      [32m- change owner from '' to 'root'[0m
      [32m- change group from '' to 'root'[0m
    * ruby_block[Delete unmanaged env files for nginx service] action run (skipped due to only_if)
    * template[/opt/gitlab/sv/nginx/check] action create (skipped due to only_if)
    * template[/opt/gitlab/sv/nginx/finish] action create (skipped due to only_if)
    * directory[/opt/gitlab/sv/nginx/control] action create[2025-07-12T20:46:59+03:00] INFO: directory[/opt/gitlab/sv/nginx/control] created directory /opt/gitlab/sv/nginx/control

      [32m- create new directory /opt/gitlab/sv/nginx/control[0m[2025-07-12T20:46:59+03:00] INFO: directory[/opt/gitlab/sv/nginx/control] owner changed to 0
[2025-07-12T20:46:59+03:00] INFO: directory[/opt/gitlab/sv/nginx/control] group changed to 0
[2025-07-12T20:46:59+03:00] INFO: directory[/opt/gitlab/sv/nginx/control] mode changed to 755

      [32m- change mode from '' to '0755'[0m
      [32m- change owner from '' to 'root'[0m
      [32m- change group from '' to 'root'[0m
    * link[/opt/gitlab/init/nginx] action create[2025-07-12T20:46:59+03:00] INFO: link[/opt/gitlab/init/nginx] created

      [32m- create symlink at /opt/gitlab/init/nginx to /opt/gitlab/embedded/bin/sv[0m
    * file[/opt/gitlab/sv/nginx/down] action nothing (skipped due to action :nothing)
[2025-07-12T20:46:59+03:00] INFO: template[/opt/gitlab/sv/nginx/run] sending run action to ruby_block[restart_service] (delayed)
    * ruby_block[restart_service] action run (skipped due to only_if)
[2025-07-12T20:46:59+03:00] INFO: template[/opt/gitlab/sv/nginx/log/config] sending create action to ruby_block[reload_log_service] (delayed)
    * ruby_block[reload_log_service] action create
      * ruby_block[restart_service] action nothing (skipped due to action :nothing)
      * ruby_block[restart_log_service] action nothing (skipped due to action :nothing)
      * ruby_block[reload_log_service] action nothing (skipped due to action :nothing)
      * directory[/opt/gitlab/sv/nginx] action create (up to date)
      * template[/opt/gitlab/sv/nginx/run] action create (up to date)
      * directory[/opt/gitlab/sv/nginx/log] action create (up to date)
      * directory[/opt/gitlab/sv/nginx/log/main] action create (up to date)
      * template[/opt/gitlab/sv/nginx/log/config] action create (up to date)
      * ruby_block[verify_chown_persisted_on_nginx] action nothing (skipped due to action :nothing)
      * link[/var/log/gitlab/nginx/config] action create (up to date)
      * template[/opt/gitlab/sv/nginx/log/run] action create (up to date)
      * directory[/opt/gitlab/sv/nginx/env] action create (up to date)
      * ruby_block[Delete unmanaged env files for nginx service] action run (skipped due to only_if)
      * template[/opt/gitlab/sv/nginx/check] action create (skipped due to only_if)
      * template[/opt/gitlab/sv/nginx/finish] action create (skipped due to only_if)
      * directory[/opt/gitlab/sv/nginx/control] action create (up to date)
      * link[/opt/gitlab/init/nginx] action create (up to date)
      * file[/opt/gitlab/sv/nginx/down] action nothing (skipped due to action :nothing)
      * directory[/opt/gitlab/service] action create (up to date)
      * link[/opt/gitlab/service/nginx] action create[2025-07-12T20:46:59+03:00] INFO: link[/opt/gitlab/service/nginx] created

        [32m- create symlink at /opt/gitlab/service/nginx to /opt/gitlab/sv/nginx[0m
      * ruby_block[wait for nginx service socket] action run[2025-07-12T20:47:03+03:00] INFO: ruby_block[wait for nginx service socket] called

        [32m- execute the ruby block wait for nginx service socket[0m
      * file[/var/log/gitlab/nginx/current] action touch (skipped due to only_if)
[2025-07-12T20:47:04+03:00] INFO: ruby_block[reload_log_service] called
      [32m- execute the ruby block reload_log_service[0m
[2025-07-12T20:47:04+03:00] INFO: template[/opt/gitlab/sv/nginx/log/run] sending run action to ruby_block[restart_log_service] (delayed)
    * ruby_block[restart_log_service] action run
      * ruby_block[restart_service] action nothing (skipped due to action :nothing)
      * ruby_block[restart_log_service] action nothing (skipped due to action :nothing)
      * ruby_block[reload_log_service] action nothing (skipped due to action :nothing)
      * directory[/opt/gitlab/sv/nginx] action create (up to date)
      * template[/opt/gitlab/sv/nginx/run] action create (up to date)
      * directory[/opt/gitlab/sv/nginx/log] action create (up to date)
      * directory[/opt/gitlab/sv/nginx/log/main] action create (up to date)
      * template[/opt/gitlab/sv/nginx/log/config] action create (up to date)
      * ruby_block[verify_chown_persisted_on_nginx] action nothing (skipped due to action :nothing)
      * link[/var/log/gitlab/nginx/config] action create (up to date)
      * template[/opt/gitlab/sv/nginx/log/run] action create (up to date)
      * directory[/opt/gitlab/sv/nginx/env] action create (up to date)
      * ruby_block[Delete unmanaged env files for nginx service] action run (skipped due to only_if)
      * template[/opt/gitlab/sv/nginx/check] action create (skipped due to only_if)
      * template[/opt/gitlab/sv/nginx/finish] action create (skipped due to only_if)
      * directory[/opt/gitlab/sv/nginx/control] action create (up to date)
      * link[/opt/gitlab/init/nginx] action create (up to date)
      * file[/opt/gitlab/sv/nginx/down] action nothing (skipped due to action :nothing)
      * directory[/opt/gitlab/service] action create (up to date)
      * link[/opt/gitlab/service/nginx] action create (up to date)
      * ruby_block[wait for nginx service socket] action run (skipped due to not_if)
      * file[/var/log/gitlab/nginx/current] action touch (skipped due to only_if)
[2025-07-12T20:47:04+03:00] INFO: ruby_block[restart_log_service] called
      [32m- execute the ruby block restart_log_service[0m
    * directory[/opt/gitlab/service] action create (up to date)
    * link[/opt/gitlab/service/nginx] action create (up to date)
    * ruby_block[wait for nginx service socket] action run (skipped due to not_if)
    * file[/var/log/gitlab/nginx/current] action touch (skipped due to only_if)
  
  * version_file[Create version file for NGINX] action create
    * file[/var/opt/gitlab/nginx/VERSION] action create[2025-07-12T20:47:04+03:00] INFO: file[/var/opt/gitlab/nginx/VERSION] created file /var/opt/gitlab/nginx/VERSION

      [32m- create new file /var/opt/gitlab/nginx/VERSION[0m[2025-07-12T20:47:04+03:00] INFO: file[/var/opt/gitlab/nginx/VERSION] updated file contents /var/opt/gitlab/nginx/VERSION

      [32m- update content in file /var/opt/gitlab/nginx/VERSION from none to fe3277[0m
      [37m--- /var/opt/gitlab/nginx/VERSION	2025-07-12 20:47:04.915926125 +0300[0m
      [37m+++ /var/opt/gitlab/nginx/.chef-VERSION20250712-17810-rvha0x	2025-07-12 20:47:04.915926125 +0300[0m
      [37m@@ -1 +1,2 @@[0m
      [37m+nginx version: nginx/1.28.0[0m
  
  * execute[reload nginx] action nothing (skipped due to action :nothing)
Recipe: gitlab::nginx
  * execute[/opt/gitlab/bin/gitlab-ctl start nginx] action run
    [execute] ok: run: nginx: (pid 18879) 3s
[2025-07-12T20:47:05+03:00] INFO: execute[/opt/gitlab/bin/gitlab-ctl start nginx] ran successfully
    [32m- execute /opt/gitlab/bin/gitlab-ctl start nginx[0m
Recipe: gitlab::remote-syslog_disable
  * service[remote-syslog] action nothing (skipped due to action :nothing)
  * runit_service[remote-syslog] action disable
    * ruby_block[disable remote-syslog] action run (skipped due to only_if)
     (up to date)
Recipe: gitlab::bootstrap
  * file[/var/opt/gitlab/bootstrapped] action create[2025-07-12T20:47:05+03:00] INFO: file[/var/opt/gitlab/bootstrapped] created file /var/opt/gitlab/bootstrapped

    [32m- create new file /var/opt/gitlab/bootstrapped[0m[2025-07-12T20:47:05+03:00] INFO: file[/var/opt/gitlab/bootstrapped] updated file contents /var/opt/gitlab/bootstrapped

    [32m- update content in file /var/opt/gitlab/bootstrapped from none to 4ae00c[0m
    [37m--- /var/opt/gitlab/bootstrapped	2025-07-12 20:47:05.815476124 +0300[0m
    [37m+++ /var/opt/gitlab/.chef-bootstrapped20250712-17810-v45tyx	2025-07-12 20:47:05.815476124 +0300[0m
    [37m@@ -1 +1,2 @@[0m
    [37m+All your bootstraps are belong to Chef[0m[2025-07-12T20:47:05+03:00] INFO: file[/var/opt/gitlab/bootstrapped] owner changed to 0
[2025-07-12T20:47:05+03:00] INFO: file[/var/opt/gitlab/bootstrapped] group changed to 0
[2025-07-12T20:47:05+03:00] INFO: file[/var/opt/gitlab/bootstrapped] mode changed to 600

    [32m- change mode from '' to '0600'[0m
    [32m- change owner from '' to 'root'[0m
    [32m- change group from '' to 'root'[0m
Recipe: gitlab::storage-check_disable
  * service[storage-check] action nothing (skipped due to action :nothing)
  * runit_service[storage-check] action disable
    * ruby_block[disable storage-check] action run (skipped due to only_if)
     (up to date)
Recipe: gitlab-pages::disable
  * service[gitlab-pages] action nothing (skipped due to action :nothing)
  * runit_service[gitlab-pages] action disable
    * ruby_block[disable gitlab-pages] action run (skipped due to only_if)
     (up to date)
Recipe: registry::disable
  * service[registry] action nothing (skipped due to action :nothing)
  * runit_service[registry] action disable
    * ruby_block[disable registry] action run (skipped due to only_if)
     (up to date)
Recipe: mattermost::disable
  * service[mattermost] action nothing (skipped due to action :nothing)
  * runit_service[mattermost] action disable
    * ruby_block[disable mattermost] action run (skipped due to only_if)
     (up to date)
Recipe: letsencrypt::disable
  * crond_job[letsencrypt-renew] action delete
    * file[/var/opt/gitlab/crond/letsencrypt-renew] action delete (up to date)
     (up to date)
Recipe: gitlab::gitlab-healthcheck
  * template[/opt/gitlab/etc/gitlab-healthcheck-rc] action create[2025-07-12T20:47:05+03:00] INFO: template[/opt/gitlab/etc/gitlab-healthcheck-rc] created file /opt/gitlab/etc/gitlab-healthcheck-rc

    [32m- create new file /opt/gitlab/etc/gitlab-healthcheck-rc[0m[2025-07-12T20:47:05+03:00] INFO: template[/opt/gitlab/etc/gitlab-healthcheck-rc] updated file contents /opt/gitlab/etc/gitlab-healthcheck-rc

    [32m- update content in file /opt/gitlab/etc/gitlab-healthcheck-rc from none to f612c8[0m
    [37m--- /opt/gitlab/etc/gitlab-healthcheck-rc	2025-07-12 20:47:05.815476124 +0300[0m
    [37m+++ /opt/gitlab/etc/.chef-gitlab-healthcheck-rc20250712-17810-40kvnx	2025-07-12 20:47:05.815476124 +0300[0m
    [37m@@ -1,2 +1,4 @@[0m
    [37m+url='http://localhost:80/help'[0m
    [37m+flags=(--insecure)[0m[2025-07-12T20:47:05+03:00] INFO: template[/opt/gitlab/etc/gitlab-healthcheck-rc] owner changed to 0
[2025-07-12T20:47:05+03:00] INFO: template[/opt/gitlab/etc/gitlab-healthcheck-rc] group changed to 0

    [32m- change owner from '' to 'root'[0m
    [32m- change group from '' to 'root'[0m
Recipe: monitoring::user
  * account[Prometheus user and group] action create
    * group[Prometheus user and group] action create[2025-07-12T20:47:05+03:00] INFO: group[Prometheus user and group] created

      [32m- create group gitlab-prometheus[0m
    * linux_user[Prometheus user and group] action create[2025-07-12T20:47:06+03:00] INFO: linux_user[Prometheus user and group] created

      [32m- create user gitlab-prometheus[0m
  
Recipe: monitoring::node-exporter
  * directory[/var/log/gitlab/node-exporter] action create[2025-07-12T20:47:06+03:00] INFO: directory[/var/log/gitlab/node-exporter] created directory /var/log/gitlab/node-exporter

    [32m- create new directory /var/log/gitlab/node-exporter[0m[2025-07-12T20:47:06+03:00] INFO: directory[/var/log/gitlab/node-exporter] owner changed to 991
[2025-07-12T20:47:06+03:00] INFO: directory[/var/log/gitlab/node-exporter] mode changed to 700

    [32m- change mode from '' to '0700'[0m
    [32m- change owner from '' to 'gitlab-prometheus'[0m
  * directory[/opt/gitlab/etc/node-exporter/env] action create[2025-07-12T20:47:06+03:00] INFO: directory[/opt/gitlab/etc/node-exporter/env] created directory /opt/gitlab/etc/node-exporter/env

    [32m- create new directory /opt/gitlab/etc/node-exporter/env[0m[2025-07-12T20:47:06+03:00] INFO: directory[/opt/gitlab/etc/node-exporter/env] owner changed to 991
[2025-07-12T20:47:06+03:00] INFO: directory[/opt/gitlab/etc/node-exporter/env] mode changed to 700

    [32m- change mode from '' to '0700'[0m
    [32m- change owner from '' to 'gitlab-prometheus'[0m
  * env_dir[/opt/gitlab/etc/node-exporter/env] action create
    * directory[/opt/gitlab/etc/node-exporter/env] action create (up to date)
    * file[/opt/gitlab/etc/node-exporter/env/SSL_CERT_DIR] action create[2025-07-12T20:47:06+03:00] INFO: file[/opt/gitlab/etc/node-exporter/env/SSL_CERT_DIR] created file /opt/gitlab/etc/node-exporter/env/SSL_CERT_DIR

      [32m- create new file /opt/gitlab/etc/node-exporter/env/SSL_CERT_DIR[0m[2025-07-12T20:47:06+03:00] INFO: file[/opt/gitlab/etc/node-exporter/env/SSL_CERT_DIR] updated file contents /opt/gitlab/etc/node-exporter/env/SSL_CERT_DIR

      [32m- update content in file /opt/gitlab/etc/node-exporter/env/SSL_CERT_DIR from none to 4f45cf[0m
      [32m- suppressed sensitive resource[0m
  
  * directory[/var/opt/gitlab/node-exporter/textfile_collector] action create[2025-07-12T20:47:06+03:00] INFO: directory[/var/opt/gitlab/node-exporter/textfile_collector] created directory /var/opt/gitlab/node-exporter/textfile_collector

    [32m- create new directory /var/opt/gitlab/node-exporter/textfile_collector[0m[2025-07-12T20:47:06+03:00] INFO: directory[/var/opt/gitlab/node-exporter/textfile_collector] owner changed to 991
[2025-07-12T20:47:06+03:00] INFO: directory[/var/opt/gitlab/node-exporter/textfile_collector] mode changed to 755

    [32m- change mode from '' to '0755'[0m
    [32m- change owner from '' to 'gitlab-prometheus'[0m
  * service[node-exporter] action nothing (skipped due to action :nothing)
  * runit_service[node-exporter] action enable
    * ruby_block[restart_service] action nothing (skipped due to action :nothing)
    * ruby_block[restart_log_service] action nothing (skipped due to action :nothing)
    * ruby_block[reload_log_service] action nothing (skipped due to action :nothing)
    * directory[/opt/gitlab/sv/node-exporter] action create[2025-07-12T20:47:06+03:00] INFO: directory[/opt/gitlab/sv/node-exporter] created directory /opt/gitlab/sv/node-exporter

      [32m- create new directory /opt/gitlab/sv/node-exporter[0m[2025-07-12T20:47:06+03:00] INFO: directory[/opt/gitlab/sv/node-exporter] owner changed to 0
[2025-07-12T20:47:06+03:00] INFO: directory[/opt/gitlab/sv/node-exporter] group changed to 0
[2025-07-12T20:47:06+03:00] INFO: directory[/opt/gitlab/sv/node-exporter] mode changed to 755

      [32m- change mode from '' to '0755'[0m
      [32m- change owner from '' to 'root'[0m
      [32m- change group from '' to 'root'[0m
    * template[/opt/gitlab/sv/node-exporter/run] action create[2025-07-12T20:47:06+03:00] INFO: template[/opt/gitlab/sv/node-exporter/run] created file /opt/gitlab/sv/node-exporter/run

      [32m- create new file /opt/gitlab/sv/node-exporter/run[0m[2025-07-12T20:47:06+03:00] INFO: template[/opt/gitlab/sv/node-exporter/run] updated file contents /opt/gitlab/sv/node-exporter/run

      [32m- update content in file /opt/gitlab/sv/node-exporter/run from none to 744544[0m
      [37m--- /opt/gitlab/sv/node-exporter/run	2025-07-12 20:47:06.143312123 +0300[0m
      [37m+++ /opt/gitlab/sv/node-exporter/.chef-run20250712-17810-ocdvzr	2025-07-12 20:47:06.139314124 +0300[0m
      [37m@@ -1,8 +1,16 @@[0m
      [37m+#!/bin/sh[0m
      [37m+exec 2>&1[0m
      [37m+[0m
      [37m+umask 077[0m
      [37m+exec chpst -P -e /opt/gitlab/etc/node-exporter/env \[0m
      [37m+  -U gitlab-prometheus:gitlab-prometheus \[0m
      [37m+  -u gitlab-prometheus:gitlab-prometheus \[0m
      [37m+  /opt/gitlab/embedded/bin/node_exporter --web.listen-address=localhost:9100 --collector.mountstats --collector.runit --collector.runit.servicedir=/opt/gitlab/sv --collector.textfile.directory=/var/opt/gitlab/node-exporter/textfile_collector[0m[2025-07-12T20:47:06+03:00] INFO: template[/opt/gitlab/sv/node-exporter/run] owner changed to 0
[2025-07-12T20:47:06+03:00] INFO: template[/opt/gitlab/sv/node-exporter/run] group changed to 0
[2025-07-12T20:47:06+03:00] INFO: template[/opt/gitlab/sv/node-exporter/run] mode changed to 755

      [32m- change mode from '' to '0755'[0m
      [32m- change owner from '' to 'root'[0m
      [32m- change group from '' to 'root'[0m
    * directory[/opt/gitlab/sv/node-exporter/log] action create[2025-07-12T20:47:06+03:00] INFO: directory[/opt/gitlab/sv/node-exporter/log] created directory /opt/gitlab/sv/node-exporter/log

      [32m- create new directory /opt/gitlab/sv/node-exporter/log[0m[2025-07-12T20:47:06+03:00] INFO: directory[/opt/gitlab/sv/node-exporter/log] owner changed to 0
[2025-07-12T20:47:06+03:00] INFO: directory[/opt/gitlab/sv/node-exporter/log] group changed to 0
[2025-07-12T20:47:06+03:00] INFO: directory[/opt/gitlab/sv/node-exporter/log] mode changed to 755

      [32m- change mode from '' to '0755'[0m
      [32m- change owner from '' to 'root'[0m
      [32m- change group from '' to 'root'[0m
    * directory[/opt/gitlab/sv/node-exporter/log/main] action create[2025-07-12T20:47:06+03:00] INFO: directory[/opt/gitlab/sv/node-exporter/log/main] created directory /opt/gitlab/sv/node-exporter/log/main

      [32m- create new directory /opt/gitlab/sv/node-exporter/log/main[0m[2025-07-12T20:47:06+03:00] INFO: directory[/opt/gitlab/sv/node-exporter/log/main] owner changed to 0
[2025-07-12T20:47:06+03:00] INFO: directory[/opt/gitlab/sv/node-exporter/log/main] group changed to 0
[2025-07-12T20:47:06+03:00] INFO: directory[/opt/gitlab/sv/node-exporter/log/main] mode changed to 755

      [32m- change mode from '' to '0755'[0m
      [32m- change owner from '' to 'root'[0m
      [32m- change group from '' to 'root'[0m
    * template[/opt/gitlab/sv/node-exporter/log/config] action create[2025-07-12T20:47:06+03:00] INFO: template[/opt/gitlab/sv/node-exporter/log/config] created file /opt/gitlab/sv/node-exporter/log/config

      [32m- create new file /opt/gitlab/sv/node-exporter/log/config[0m[2025-07-12T20:47:06+03:00] INFO: template[/opt/gitlab/sv/node-exporter/log/config] updated file contents /opt/gitlab/sv/node-exporter/log/config

      [32m- update content in file /opt/gitlab/sv/node-exporter/log/config from none to 623c00[0m
      [37m--- /opt/gitlab/sv/node-exporter/log/config	2025-07-12 20:47:06.175296124 +0300[0m
      [37m+++ /opt/gitlab/sv/node-exporter/log/.chef-config20250712-17810-cpjhi5	2025-07-12 20:47:06.175296124 +0300[0m
      [37m@@ -1,6 +1,12 @@[0m
      [37m+s209715200[0m
      [37m+n30[0m
      [37m+t86400[0m
      [37m+!gzip[0m
      [37m+[0m
      [37m+[0m[2025-07-12T20:47:06+03:00] INFO: template[/opt/gitlab/sv/node-exporter/log/config] owner changed to 0
[2025-07-12T20:47:06+03:00] INFO: template[/opt/gitlab/sv/node-exporter/log/config] group changed to 0
[2025-07-12T20:47:06+03:00] INFO: template[/opt/gitlab/sv/node-exporter/log/config] mode changed to 644

      [32m- change mode from '' to '0644'[0m
      [32m- change owner from '' to 'root'[0m
      [32m- change group from '' to 'root'[0m
    * ruby_block[verify_chown_persisted_on_node-exporter] action nothing (skipped due to action :nothing)
[2025-07-12T20:47:06+03:00] INFO: ruby_block[verify_chown_persisted_on_node-exporter] sent create action to ruby_block[verify_chown_persisted_on_node-exporter] (immediate at declaration time)
    * ruby_block[verify_chown_persisted_on_node-exporter] action create[2025-07-12T20:47:06+03:00] INFO: ruby_block[verify_chown_persisted_on_node-exporter] called

      [32m- execute the ruby block verify_chown_persisted_on_node-exporter[0m
    * link[/var/log/gitlab/node-exporter/config] action create[2025-07-12T20:47:06+03:00] INFO: link[/var/log/gitlab/node-exporter/config] created

      [32m- create symlink at /var/log/gitlab/node-exporter/config to /opt/gitlab/sv/node-exporter/log/config[0m
    * template[/opt/gitlab/sv/node-exporter/log/run] action create[2025-07-12T20:47:06+03:00] INFO: template[/opt/gitlab/sv/node-exporter/log/run] created file /opt/gitlab/sv/node-exporter/log/run

      [32m- create new file /opt/gitlab/sv/node-exporter/log/run[0m[2025-07-12T20:47:06+03:00] INFO: template[/opt/gitlab/sv/node-exporter/log/run] updated file contents /opt/gitlab/sv/node-exporter/log/run

      [32m- update content in file /opt/gitlab/sv/node-exporter/log/run from none to ed81f2[0m
      [37m--- /opt/gitlab/sv/node-exporter/log/run	2025-07-12 20:47:06.199284124 +0300[0m
      [37m+++ /opt/gitlab/sv/node-exporter/log/.chef-run20250712-17810-tnp4jf	2025-07-12 20:47:06.199284124 +0300[0m
      [37m@@ -1,5 +1,10 @@[0m
      [37m+#!/bin/sh[0m
      [37m+exec chpst -P \[0m
      [37m+  -U root:root \[0m
      [37m+  -u root:root \[0m
      [37m+  svlogd -tt /var/log/gitlab/node-exporter[0m[2025-07-12T20:47:06+03:00] INFO: template[/opt/gitlab/sv/node-exporter/log/run] owner changed to 0
[2025-07-12T20:47:06+03:00] INFO: template[/opt/gitlab/sv/node-exporter/log/run] group changed to 0
[2025-07-12T20:47:06+03:00] INFO: template[/opt/gitlab/sv/node-exporter/log/run] mode changed to 755

      [32m- change mode from '' to '0755'[0m
      [32m- change owner from '' to 'root'[0m
      [32m- change group from '' to 'root'[0m
    * directory[/opt/gitlab/sv/node-exporter/env] action create[2025-07-12T20:47:06+03:00] INFO: directory[/opt/gitlab/sv/node-exporter/env] created directory /opt/gitlab/sv/node-exporter/env

      [32m- create new directory /opt/gitlab/sv/node-exporter/env[0m[2025-07-12T20:47:06+03:00] INFO: directory[/opt/gitlab/sv/node-exporter/env] owner changed to 0
[2025-07-12T20:47:06+03:00] INFO: directory[/opt/gitlab/sv/node-exporter/env] group changed to 0
[2025-07-12T20:47:06+03:00] INFO: directory[/opt/gitlab/sv/node-exporter/env] mode changed to 755

      [32m- change mode from '' to '0755'[0m
      [32m- change owner from '' to 'root'[0m
      [32m- change group from '' to 'root'[0m
    * ruby_block[Delete unmanaged env files for node-exporter service] action run (skipped due to only_if)
    * template[/opt/gitlab/sv/node-exporter/check] action create (skipped due to only_if)
    * template[/opt/gitlab/sv/node-exporter/finish] action create (skipped due to only_if)
    * directory[/opt/gitlab/sv/node-exporter/control] action create[2025-07-12T20:47:06+03:00] INFO: directory[/opt/gitlab/sv/node-exporter/control] created directory /opt/gitlab/sv/node-exporter/control

      [32m- create new directory /opt/gitlab/sv/node-exporter/control[0m[2025-07-12T20:47:06+03:00] INFO: directory[/opt/gitlab/sv/node-exporter/control] owner changed to 0
[2025-07-12T20:47:06+03:00] INFO: directory[/opt/gitlab/sv/node-exporter/control] group changed to 0
[2025-07-12T20:47:06+03:00] INFO: directory[/opt/gitlab/sv/node-exporter/control] mode changed to 755

      [32m- change mode from '' to '0755'[0m
      [32m- change owner from '' to 'root'[0m
      [32m- change group from '' to 'root'[0m
    * link[/opt/gitlab/init/node-exporter] action create[2025-07-12T20:47:06+03:00] INFO: link[/opt/gitlab/init/node-exporter] created

      [32m- create symlink at /opt/gitlab/init/node-exporter to /opt/gitlab/embedded/bin/sv[0m
    * file[/opt/gitlab/sv/node-exporter/down] action nothing (skipped due to action :nothing)
[2025-07-12T20:47:06+03:00] INFO: template[/opt/gitlab/sv/node-exporter/run] sending run action to ruby_block[restart_service] (delayed)
    * ruby_block[restart_service] action run (skipped due to only_if)
[2025-07-12T20:47:06+03:00] INFO: template[/opt/gitlab/sv/node-exporter/log/config] sending create action to ruby_block[reload_log_service] (delayed)
    * ruby_block[reload_log_service] action create
      * ruby_block[restart_service] action nothing (skipped due to action :nothing)
      * ruby_block[restart_log_service] action nothing (skipped due to action :nothing)
      * ruby_block[reload_log_service] action nothing (skipped due to action :nothing)
      * directory[/opt/gitlab/sv/node-exporter] action create (up to date)
      * template[/opt/gitlab/sv/node-exporter/run] action create (up to date)
      * directory[/opt/gitlab/sv/node-exporter/log] action create (up to date)
      * directory[/opt/gitlab/sv/node-exporter/log/main] action create (up to date)
      * template[/opt/gitlab/sv/node-exporter/log/config] action create (up to date)
      * ruby_block[verify_chown_persisted_on_node-exporter] action nothing (skipped due to action :nothing)
      * link[/var/log/gitlab/node-exporter/config] action create (up to date)
      * template[/opt/gitlab/sv/node-exporter/log/run] action create (up to date)
      * directory[/opt/gitlab/sv/node-exporter/env] action create (up to date)
      * ruby_block[Delete unmanaged env files for node-exporter service] action run (skipped due to only_if)
      * template[/opt/gitlab/sv/node-exporter/check] action create (skipped due to only_if)
      * template[/opt/gitlab/sv/node-exporter/finish] action create (skipped due to only_if)
      * directory[/opt/gitlab/sv/node-exporter/control] action create (up to date)
      * link[/opt/gitlab/init/node-exporter] action create (up to date)
      * file[/opt/gitlab/sv/node-exporter/down] action nothing (skipped due to action :nothing)
      * directory[/opt/gitlab/service] action create (up to date)
      * link[/opt/gitlab/service/node-exporter] action create[2025-07-12T20:47:06+03:00] INFO: link[/opt/gitlab/service/node-exporter] created

        [32m- create symlink at /opt/gitlab/service/node-exporter to /opt/gitlab/sv/node-exporter[0m
      * ruby_block[wait for node-exporter service socket] action run[2025-07-12T20:47:09+03:00] INFO: ruby_block[wait for node-exporter service socket] called

        [32m- execute the ruby block wait for node-exporter service socket[0m
      * file[/var/log/gitlab/node-exporter/current] action touch (skipped due to only_if)
[2025-07-12T20:47:10+03:00] INFO: ruby_block[reload_log_service] called
      [32m- execute the ruby block reload_log_service[0m
[2025-07-12T20:47:10+03:00] INFO: template[/opt/gitlab/sv/node-exporter/log/run] sending run action to ruby_block[restart_log_service] (delayed)
    * ruby_block[restart_log_service] action run
      * ruby_block[restart_service] action nothing (skipped due to action :nothing)
      * ruby_block[restart_log_service] action nothing (skipped due to action :nothing)
      * ruby_block[reload_log_service] action nothing (skipped due to action :nothing)
      * directory[/opt/gitlab/sv/node-exporter] action create (up to date)
      * template[/opt/gitlab/sv/node-exporter/run] action create (up to date)
      * directory[/opt/gitlab/sv/node-exporter/log] action create (up to date)
      * directory[/opt/gitlab/sv/node-exporter/log/main] action create (up to date)
      * template[/opt/gitlab/sv/node-exporter/log/config] action create (up to date)
      * ruby_block[verify_chown_persisted_on_node-exporter] action nothing (skipped due to action :nothing)
      * link[/var/log/gitlab/node-exporter/config] action create (up to date)
      * template[/opt/gitlab/sv/node-exporter/log/run] action create (up to date)
      * directory[/opt/gitlab/sv/node-exporter/env] action create (up to date)
      * ruby_block[Delete unmanaged env files for node-exporter service] action run (skipped due to only_if)
      * template[/opt/gitlab/sv/node-exporter/check] action create (skipped due to only_if)
      * template[/opt/gitlab/sv/node-exporter/finish] action create (skipped due to only_if)
      * directory[/opt/gitlab/sv/node-exporter/control] action create (up to date)
      * link[/opt/gitlab/init/node-exporter] action create (up to date)
      * file[/opt/gitlab/sv/node-exporter/down] action nothing (skipped due to action :nothing)
      * directory[/opt/gitlab/service] action create (up to date)
      * link[/opt/gitlab/service/node-exporter] action create (up to date)
      * ruby_block[wait for node-exporter service socket] action run (skipped due to not_if)
      * file[/var/log/gitlab/node-exporter/current] action touch (skipped due to only_if)
[2025-07-12T20:47:10+03:00] INFO: ruby_block[restart_log_service] called
      [32m- execute the ruby block restart_log_service[0m
    * directory[/opt/gitlab/service] action create (up to date)
    * link[/opt/gitlab/service/node-exporter] action create (up to date)
    * ruby_block[wait for node-exporter service socket] action run (skipped due to not_if)
    * file[/var/log/gitlab/node-exporter/current] action touch (skipped due to only_if)
  
  * execute[/opt/gitlab/bin/gitlab-ctl start node-exporter] action run
    [execute] ok: run: node-exporter: (pid 18925) 4s
[2025-07-12T20:47:12+03:00] INFO: execute[/opt/gitlab/bin/gitlab-ctl start node-exporter] ran successfully
    [32m- execute /opt/gitlab/bin/gitlab-ctl start node-exporter[0m
  * consul_service[node-exporter] action delete
    * file[/var/opt/gitlab/consul/config.d/node-exporter-service.json] action delete (up to date)
     (up to date)
Recipe: monitoring::gitlab-exporter
  * directory[/var/opt/gitlab/gitlab-exporter] action create[2025-07-12T20:47:12+03:00] INFO: directory[/var/opt/gitlab/gitlab-exporter] created directory /var/opt/gitlab/gitlab-exporter

    [32m- create new directory /var/opt/gitlab/gitlab-exporter[0m[2025-07-12T20:47:12+03:00] INFO: directory[/var/opt/gitlab/gitlab-exporter] owner changed to 994
[2025-07-12T20:47:12+03:00] INFO: directory[/var/opt/gitlab/gitlab-exporter] mode changed to 755

    [32m- change mode from '' to '0755'[0m
    [32m- change owner from '' to 'git'[0m
  * directory[/var/log/gitlab/gitlab-exporter] action create[2025-07-12T20:47:12+03:00] INFO: directory[/var/log/gitlab/gitlab-exporter] created directory /var/log/gitlab/gitlab-exporter

    [32m- create new directory /var/log/gitlab/gitlab-exporter[0m[2025-07-12T20:47:12+03:00] INFO: directory[/var/log/gitlab/gitlab-exporter] owner changed to 994
[2025-07-12T20:47:12+03:00] INFO: directory[/var/log/gitlab/gitlab-exporter] mode changed to 700

    [32m- change mode from '' to '0700'[0m
    [32m- change owner from '' to 'git'[0m
  * env_dir[/opt/gitlab/etc/gitlab-exporter/env] action create
    * directory[/opt/gitlab/etc/gitlab-exporter/env] action create[2025-07-12T20:47:12+03:00] INFO: directory[/opt/gitlab/etc/gitlab-exporter/env] created directory /opt/gitlab/etc/gitlab-exporter/env

      [32m- create new directory /opt/gitlab/etc/gitlab-exporter/env[0m
    * file[/opt/gitlab/etc/gitlab-exporter/env/MALLOC_CONF] action create[2025-07-12T20:47:12+03:00] INFO: file[/opt/gitlab/etc/gitlab-exporter/env/MALLOC_CONF] created file /opt/gitlab/etc/gitlab-exporter/env/MALLOC_CONF

      [32m- create new file /opt/gitlab/etc/gitlab-exporter/env/MALLOC_CONF[0m[2025-07-12T20:47:12+03:00] INFO: file[/opt/gitlab/etc/gitlab-exporter/env/MALLOC_CONF] updated file contents /opt/gitlab/etc/gitlab-exporter/env/MALLOC_CONF

      [32m- update content in file /opt/gitlab/etc/gitlab-exporter/env/MALLOC_CONF from none to 2ea29b[0m
      [32m- suppressed sensitive resource[0m
    * file[/opt/gitlab/etc/gitlab-exporter/env/RUBY_GC_HEAP_INIT_SLOTS] action create[2025-07-12T20:47:12+03:00] INFO: file[/opt/gitlab/etc/gitlab-exporter/env/RUBY_GC_HEAP_INIT_SLOTS] created file /opt/gitlab/etc/gitlab-exporter/env/RUBY_GC_HEAP_INIT_SLOTS

      [32m- create new file /opt/gitlab/etc/gitlab-exporter/env/RUBY_GC_HEAP_INIT_SLOTS[0m[2025-07-12T20:47:12+03:00] INFO: file[/opt/gitlab/etc/gitlab-exporter/env/RUBY_GC_HEAP_INIT_SLOTS] updated file contents /opt/gitlab/etc/gitlab-exporter/env/RUBY_GC_HEAP_INIT_SLOTS

      [32m- update content in file /opt/gitlab/etc/gitlab-exporter/env/RUBY_GC_HEAP_INIT_SLOTS from none to 47b250[0m
      [32m- suppressed sensitive resource[0m
    * file[/opt/gitlab/etc/gitlab-exporter/env/RUBY_GC_HEAP_FREE_SLOTS_MIN_RATIO] action create[2025-07-12T20:47:12+03:00] INFO: file[/opt/gitlab/etc/gitlab-exporter/env/RUBY_GC_HEAP_FREE_SLOTS_MIN_RATIO] created file /opt/gitlab/etc/gitlab-exporter/env/RUBY_GC_HEAP_FREE_SLOTS_MIN_RATIO

      [32m- create new file /opt/gitlab/etc/gitlab-exporter/env/RUBY_GC_HEAP_FREE_SLOTS_MIN_RATIO[0m[2025-07-12T20:47:12+03:00] INFO: file[/opt/gitlab/etc/gitlab-exporter/env/RUBY_GC_HEAP_FREE_SLOTS_MIN_RATIO] updated file contents /opt/gitlab/etc/gitlab-exporter/env/RUBY_GC_HEAP_FREE_SLOTS_MIN_RATIO

      [32m- update content in file /opt/gitlab/etc/gitlab-exporter/env/RUBY_GC_HEAP_FREE_SLOTS_MIN_RATIO from none to c945fb[0m
      [32m- suppressed sensitive resource[0m
    * file[/opt/gitlab/etc/gitlab-exporter/env/RUBY_GC_HEAP_FREE_SLOTS_MAX_RATIO] action create[2025-07-12T20:47:12+03:00] INFO: file[/opt/gitlab/etc/gitlab-exporter/env/RUBY_GC_HEAP_FREE_SLOTS_MAX_RATIO] created file /opt/gitlab/etc/gitlab-exporter/env/RUBY_GC_HEAP_FREE_SLOTS_MAX_RATIO

      [32m- create new file /opt/gitlab/etc/gitlab-exporter/env/RUBY_GC_HEAP_FREE_SLOTS_MAX_RATIO[0m[2025-07-12T20:47:12+03:00] INFO: file[/opt/gitlab/etc/gitlab-exporter/env/RUBY_GC_HEAP_FREE_SLOTS_MAX_RATIO] updated file contents /opt/gitlab/etc/gitlab-exporter/env/RUBY_GC_HEAP_FREE_SLOTS_MAX_RATIO

      [32m- update content in file /opt/gitlab/etc/gitlab-exporter/env/RUBY_GC_HEAP_FREE_SLOTS_MAX_RATIO from none to 8a60e9[0m
      [32m- suppressed sensitive resource[0m
    * file[/opt/gitlab/etc/gitlab-exporter/env/SSL_CERT_DIR] action create[2025-07-12T20:47:12+03:00] INFO: file[/opt/gitlab/etc/gitlab-exporter/env/SSL_CERT_DIR] created file /opt/gitlab/etc/gitlab-exporter/env/SSL_CERT_DIR

      [32m- create new file /opt/gitlab/etc/gitlab-exporter/env/SSL_CERT_DIR[0m[2025-07-12T20:47:12+03:00] INFO: file[/opt/gitlab/etc/gitlab-exporter/env/SSL_CERT_DIR] updated file contents /opt/gitlab/etc/gitlab-exporter/env/SSL_CERT_DIR

      [32m- update content in file /opt/gitlab/etc/gitlab-exporter/env/SSL_CERT_DIR from none to 4f45cf[0m
      [32m- suppressed sensitive resource[0m
    * file[/opt/gitlab/etc/gitlab-exporter/env/SSL_CERT_FILE] action create[2025-07-12T20:47:12+03:00] INFO: file[/opt/gitlab/etc/gitlab-exporter/env/SSL_CERT_FILE] created file /opt/gitlab/etc/gitlab-exporter/env/SSL_CERT_FILE

      [32m- create new file /opt/gitlab/etc/gitlab-exporter/env/SSL_CERT_FILE[0m[2025-07-12T20:47:12+03:00] INFO: file[/opt/gitlab/etc/gitlab-exporter/env/SSL_CERT_FILE] updated file contents /opt/gitlab/etc/gitlab-exporter/env/SSL_CERT_FILE

      [32m- update content in file /opt/gitlab/etc/gitlab-exporter/env/SSL_CERT_FILE from none to f7ce84[0m
      [32m- suppressed sensitive resource[0m
  
  * template[/var/opt/gitlab/gitlab-exporter/gitlab-exporter.yml] action create[2025-07-12T20:47:12+03:00] INFO: template[/var/opt/gitlab/gitlab-exporter/gitlab-exporter.yml] created file /var/opt/gitlab/gitlab-exporter/gitlab-exporter.yml

    [32m- create new file /var/opt/gitlab/gitlab-exporter/gitlab-exporter.yml[0m[2025-07-12T20:47:12+03:00] INFO: template[/var/opt/gitlab/gitlab-exporter/gitlab-exporter.yml] updated file contents /var/opt/gitlab/gitlab-exporter/gitlab-exporter.yml

    [32m- update content in file /var/opt/gitlab/gitlab-exporter/gitlab-exporter.yml from none to 167fe6[0m
    [32m- suppressed sensitive resource[0m[2025-07-12T20:47:12+03:00] INFO: template[/var/opt/gitlab/gitlab-exporter/gitlab-exporter.yml] owner changed to 994
[2025-07-12T20:47:12+03:00] INFO: template[/var/opt/gitlab/gitlab-exporter/gitlab-exporter.yml] mode changed to 600

    [32m- change mode from '' to '0600'[0m
    [32m- change owner from '' to 'git'[0m
[2025-07-12T20:47:12+03:00] INFO: template[/var/opt/gitlab/gitlab-exporter/gitlab-exporter.yml] not queuing delayed action restart on runit_service[gitlab-exporter] (delayed), as it's already been queued
  * version_file[Create version file for GitLab-Exporter] action create
    * file[/var/opt/gitlab/gitlab-exporter/RUBY_VERSION] action create[2025-07-12T20:47:12+03:00] INFO: file[/var/opt/gitlab/gitlab-exporter/RUBY_VERSION] created file /var/opt/gitlab/gitlab-exporter/RUBY_VERSION

      [32m- create new file /var/opt/gitlab/gitlab-exporter/RUBY_VERSION[0m[2025-07-12T20:47:12+03:00] INFO: file[/var/opt/gitlab/gitlab-exporter/RUBY_VERSION] updated file contents /var/opt/gitlab/gitlab-exporter/RUBY_VERSION

      [32m- update content in file /var/opt/gitlab/gitlab-exporter/RUBY_VERSION from none to a57ad3[0m
      [37m--- /var/opt/gitlab/gitlab-exporter/RUBY_VERSION	2025-07-12 20:47:12.756004079 +0300[0m
      [37m+++ /var/opt/gitlab/gitlab-exporter/.chef-RUBY_VERSION20250712-17810-vqnoxh	2025-07-12 20:47:12.756004079 +0300[0m
      [37m@@ -1 +1,2 @@[0m
      [37m+ruby 3.2.5 (2024-07-26 revision 31d0f1a2e7) [x86_64-linux][0m
  
[2025-07-12T20:47:12+03:00] INFO: version_file[Create version file for GitLab-Exporter] not queuing delayed action restart on runit_service[gitlab-exporter] (delayed), as it's already been queued
  * service[gitlab-exporter] action nothing (skipped due to action :nothing)
  * runit_service[gitlab-exporter] action enable
    * ruby_block[restart_service] action nothing (skipped due to action :nothing)
    * ruby_block[restart_log_service] action nothing (skipped due to action :nothing)
    * ruby_block[reload_log_service] action nothing (skipped due to action :nothing)
    * directory[/opt/gitlab/sv/gitlab-exporter] action create[2025-07-12T20:47:12+03:00] INFO: directory[/opt/gitlab/sv/gitlab-exporter] created directory /opt/gitlab/sv/gitlab-exporter

      [32m- create new directory /opt/gitlab/sv/gitlab-exporter[0m[2025-07-12T20:47:12+03:00] INFO: directory[/opt/gitlab/sv/gitlab-exporter] owner changed to 0
[2025-07-12T20:47:12+03:00] INFO: directory[/opt/gitlab/sv/gitlab-exporter] group changed to 0
[2025-07-12T20:47:12+03:00] INFO: directory[/opt/gitlab/sv/gitlab-exporter] mode changed to 755

      [32m- change mode from '' to '0755'[0m
      [32m- change owner from '' to 'root'[0m
      [32m- change group from '' to 'root'[0m
    * template[/opt/gitlab/sv/gitlab-exporter/run] action create[2025-07-12T20:47:12+03:00] INFO: template[/opt/gitlab/sv/gitlab-exporter/run] created file /opt/gitlab/sv/gitlab-exporter/run

      [32m- create new file /opt/gitlab/sv/gitlab-exporter/run[0m[2025-07-12T20:47:12+03:00] INFO: template[/opt/gitlab/sv/gitlab-exporter/run] updated file contents /opt/gitlab/sv/gitlab-exporter/run

      [32m- update content in file /opt/gitlab/sv/gitlab-exporter/run from none to d78ca8[0m
      [37m--- /opt/gitlab/sv/gitlab-exporter/run	2025-07-12 20:47:12.760002080 +0300[0m
      [37m+++ /opt/gitlab/sv/gitlab-exporter/.chef-run20250712-17810-d4j941	2025-07-12 20:47:12.760002080 +0300[0m
      [37m@@ -1,9 +1,18 @@[0m
      [37m+#!/bin/sh[0m
      [37m+exec 2>&1[0m
      [37m+[0m
      [37m+umask 077[0m
      [37m+exec chpst -P -e /opt/gitlab/etc/gitlab-exporter/env \[0m
      [37m+  -U git:git \[0m
      [37m+  -u git:git \[0m
      [37m+  /opt/gitlab/embedded/bin/gitlab-exporter web \[0m
      [37m+  -c /var/opt/gitlab/gitlab-exporter/gitlab-exporter.yml[0m[2025-07-12T20:47:12+03:00] INFO: template[/opt/gitlab/sv/gitlab-exporter/run] owner changed to 0
[2025-07-12T20:47:12+03:00] INFO: template[/opt/gitlab/sv/gitlab-exporter/run] group changed to 0
[2025-07-12T20:47:12+03:00] INFO: template[/opt/gitlab/sv/gitlab-exporter/run] mode changed to 755

      [32m- change mode from '' to '0755'[0m
      [32m- change owner from '' to 'root'[0m
      [32m- change group from '' to 'root'[0m
    * directory[/opt/gitlab/sv/gitlab-exporter/log] action create[2025-07-12T20:47:12+03:00] INFO: directory[/opt/gitlab/sv/gitlab-exporter/log] created directory /opt/gitlab/sv/gitlab-exporter/log

      [32m- create new directory /opt/gitlab/sv/gitlab-exporter/log[0m[2025-07-12T20:47:12+03:00] INFO: directory[/opt/gitlab/sv/gitlab-exporter/log] owner changed to 0
[2025-07-12T20:47:12+03:00] INFO: directory[/opt/gitlab/sv/gitlab-exporter/log] group changed to 0
[2025-07-12T20:47:12+03:00] INFO: directory[/opt/gitlab/sv/gitlab-exporter/log] mode changed to 755

      [32m- change mode from '' to '0755'[0m
      [32m- change owner from '' to 'root'[0m
      [32m- change group from '' to 'root'[0m
    * directory[/opt/gitlab/sv/gitlab-exporter/log/main] action create[2025-07-12T20:47:12+03:00] INFO: directory[/opt/gitlab/sv/gitlab-exporter/log/main] created directory /opt/gitlab/sv/gitlab-exporter/log/main

      [32m- create new directory /opt/gitlab/sv/gitlab-exporter/log/main[0m[2025-07-12T20:47:12+03:00] INFO: directory[/opt/gitlab/sv/gitlab-exporter/log/main] owner changed to 0
[2025-07-12T20:47:12+03:00] INFO: directory[/opt/gitlab/sv/gitlab-exporter/log/main] group changed to 0
[2025-07-12T20:47:12+03:00] INFO: directory[/opt/gitlab/sv/gitlab-exporter/log/main] mode changed to 755

      [32m- change mode from '' to '0755'[0m
      [32m- change owner from '' to 'root'[0m
      [32m- change group from '' to 'root'[0m
    * template[/opt/gitlab/sv/gitlab-exporter/log/config] action create[2025-07-12T20:47:12+03:00] INFO: template[/opt/gitlab/sv/gitlab-exporter/log/config] created file /opt/gitlab/sv/gitlab-exporter/log/config

      [32m- create new file /opt/gitlab/sv/gitlab-exporter/log/config[0m[2025-07-12T20:47:12+03:00] INFO: template[/opt/gitlab/sv/gitlab-exporter/log/config] updated file contents /opt/gitlab/sv/gitlab-exporter/log/config

      [32m- update content in file /opt/gitlab/sv/gitlab-exporter/log/config from none to 623c00[0m
      [37m--- /opt/gitlab/sv/gitlab-exporter/log/config	2025-07-12 20:47:12.819972082 +0300[0m
      [37m+++ /opt/gitlab/sv/gitlab-exporter/log/.chef-config20250712-17810-49kv5z	2025-07-12 20:47:12.819972082 +0300[0m
      [37m@@ -1,6 +1,12 @@[0m
      [37m+s209715200[0m
      [37m+n30[0m
      [37m+t86400[0m
      [37m+!gzip[0m
      [37m+[0m
      [37m+[0m[2025-07-12T20:47:12+03:00] INFO: template[/opt/gitlab/sv/gitlab-exporter/log/config] owner changed to 0
[2025-07-12T20:47:12+03:00] INFO: template[/opt/gitlab/sv/gitlab-exporter/log/config] group changed to 0
[2025-07-12T20:47:12+03:00] INFO: template[/opt/gitlab/sv/gitlab-exporter/log/config] mode changed to 644

      [32m- change mode from '' to '0644'[0m
      [32m- change owner from '' to 'root'[0m
      [32m- change group from '' to 'root'[0m
    * ruby_block[verify_chown_persisted_on_gitlab-exporter] action nothing (skipped due to action :nothing)
[2025-07-12T20:47:12+03:00] INFO: ruby_block[verify_chown_persisted_on_gitlab-exporter] sent create action to ruby_block[verify_chown_persisted_on_gitlab-exporter] (immediate at declaration time)
    * ruby_block[verify_chown_persisted_on_gitlab-exporter] action create[2025-07-12T20:47:12+03:00] INFO: ruby_block[verify_chown_persisted_on_gitlab-exporter] called

      [32m- execute the ruby block verify_chown_persisted_on_gitlab-exporter[0m
    * link[/var/log/gitlab/gitlab-exporter/config] action create[2025-07-12T20:47:12+03:00] INFO: link[/var/log/gitlab/gitlab-exporter/config] created

      [32m- create symlink at /var/log/gitlab/gitlab-exporter/config to /opt/gitlab/sv/gitlab-exporter/log/config[0m
    * template[/opt/gitlab/sv/gitlab-exporter/log/run] action create[2025-07-12T20:47:12+03:00] INFO: template[/opt/gitlab/sv/gitlab-exporter/log/run] created file /opt/gitlab/sv/gitlab-exporter/log/run

      [32m- create new file /opt/gitlab/sv/gitlab-exporter/log/run[0m[2025-07-12T20:47:12+03:00] INFO: template[/opt/gitlab/sv/gitlab-exporter/log/run] updated file contents /opt/gitlab/sv/gitlab-exporter/log/run

      [32m- update content in file /opt/gitlab/sv/gitlab-exporter/log/run from none to 0b0a31[0m
      [37m--- /opt/gitlab/sv/gitlab-exporter/log/run	2025-07-12 20:47:12.991886088 +0300[0m
      [37m+++ /opt/gitlab/sv/gitlab-exporter/log/.chef-run20250712-17810-kmctqh	2025-07-12 20:47:12.987888088 +0300[0m
      [37m@@ -1,5 +1,10 @@[0m
      [37m+#!/bin/sh[0m
      [37m+exec chpst -P \[0m
      [37m+  -U root:root \[0m
      [37m+  -u root:root \[0m
      [37m+  svlogd -tt /var/log/gitlab/gitlab-exporter[0m[2025-07-12T20:47:12+03:00] INFO: template[/opt/gitlab/sv/gitlab-exporter/log/run] owner changed to 0
[2025-07-12T20:47:12+03:00] INFO: template[/opt/gitlab/sv/gitlab-exporter/log/run] group changed to 0
[2025-07-12T20:47:12+03:00] INFO: template[/opt/gitlab/sv/gitlab-exporter/log/run] mode changed to 755

      [32m- change mode from '' to '0755'[0m
      [32m- change owner from '' to 'root'[0m
      [32m- change group from '' to 'root'[0m
    * directory[/opt/gitlab/sv/gitlab-exporter/env] action create[2025-07-12T20:47:13+03:00] INFO: directory[/opt/gitlab/sv/gitlab-exporter/env] created directory /opt/gitlab/sv/gitlab-exporter/env

      [32m- create new directory /opt/gitlab/sv/gitlab-exporter/env[0m[2025-07-12T20:47:13+03:00] INFO: directory[/opt/gitlab/sv/gitlab-exporter/env] owner changed to 0
[2025-07-12T20:47:13+03:00] INFO: directory[/opt/gitlab/sv/gitlab-exporter/env] group changed to 0
[2025-07-12T20:47:13+03:00] INFO: directory[/opt/gitlab/sv/gitlab-exporter/env] mode changed to 755

      [32m- change mode from '' to '0755'[0m
      [32m- change owner from '' to 'root'[0m
      [32m- change group from '' to 'root'[0m
    * ruby_block[Delete unmanaged env files for gitlab-exporter service] action run (skipped due to only_if)
    * template[/opt/gitlab/sv/gitlab-exporter/check] action create (skipped due to only_if)
    * template[/opt/gitlab/sv/gitlab-exporter/finish] action create (skipped due to only_if)
    * directory[/opt/gitlab/sv/gitlab-exporter/control] action create[2025-07-12T20:47:13+03:00] INFO: directory[/opt/gitlab/sv/gitlab-exporter/control] created directory /opt/gitlab/sv/gitlab-exporter/control

      [32m- create new directory /opt/gitlab/sv/gitlab-exporter/control[0m[2025-07-12T20:47:13+03:00] INFO: directory[/opt/gitlab/sv/gitlab-exporter/control] owner changed to 0
[2025-07-12T20:47:13+03:00] INFO: directory[/opt/gitlab/sv/gitlab-exporter/control] group changed to 0
[2025-07-12T20:47:13+03:00] INFO: directory[/opt/gitlab/sv/gitlab-exporter/control] mode changed to 755

      [32m- change mode from '' to '0755'[0m
      [32m- change owner from '' to 'root'[0m
      [32m- change group from '' to 'root'[0m
    * link[/opt/gitlab/init/gitlab-exporter] action create[2025-07-12T20:47:13+03:00] INFO: link[/opt/gitlab/init/gitlab-exporter] created

      [32m- create symlink at /opt/gitlab/init/gitlab-exporter to /opt/gitlab/embedded/bin/sv[0m
    * file[/opt/gitlab/sv/gitlab-exporter/down] action nothing (skipped due to action :nothing)
[2025-07-12T20:47:13+03:00] INFO: template[/opt/gitlab/sv/gitlab-exporter/run] sending run action to ruby_block[restart_service] (delayed)
    * ruby_block[restart_service] action run (skipped due to only_if)
[2025-07-12T20:47:13+03:00] INFO: template[/opt/gitlab/sv/gitlab-exporter/log/config] sending create action to ruby_block[reload_log_service] (delayed)
    * ruby_block[reload_log_service] action create
      * ruby_block[restart_service] action nothing (skipped due to action :nothing)
      * ruby_block[restart_log_service] action nothing (skipped due to action :nothing)
      * ruby_block[reload_log_service] action nothing (skipped due to action :nothing)
      * directory[/opt/gitlab/sv/gitlab-exporter] action create (up to date)
      * template[/opt/gitlab/sv/gitlab-exporter/run] action create (up to date)
      * directory[/opt/gitlab/sv/gitlab-exporter/log] action create (up to date)
      * directory[/opt/gitlab/sv/gitlab-exporter/log/main] action create (up to date)
      * template[/opt/gitlab/sv/gitlab-exporter/log/config] action create (up to date)
      * ruby_block[verify_chown_persisted_on_gitlab-exporter] action nothing (skipped due to action :nothing)
      * link[/var/log/gitlab/gitlab-exporter/config] action create (up to date)
      * template[/opt/gitlab/sv/gitlab-exporter/log/run] action create (up to date)
      * directory[/opt/gitlab/sv/gitlab-exporter/env] action create (up to date)
      * ruby_block[Delete unmanaged env files for gitlab-exporter service] action run (skipped due to only_if)
      * template[/opt/gitlab/sv/gitlab-exporter/check] action create (skipped due to only_if)
      * template[/opt/gitlab/sv/gitlab-exporter/finish] action create (skipped due to only_if)
      * directory[/opt/gitlab/sv/gitlab-exporter/control] action create (up to date)
      * link[/opt/gitlab/init/gitlab-exporter] action create (up to date)
      * file[/opt/gitlab/sv/gitlab-exporter/down] action nothing (skipped due to action :nothing)
      * directory[/opt/gitlab/service] action create (up to date)
      * link[/opt/gitlab/service/gitlab-exporter] action create[2025-07-12T20:47:13+03:00] INFO: link[/opt/gitlab/service/gitlab-exporter] created

        [32m- create symlink at /opt/gitlab/service/gitlab-exporter to /opt/gitlab/sv/gitlab-exporter[0m
      * ruby_block[wait for gitlab-exporter service socket] action run[2025-07-12T20:47:15+03:00] INFO: ruby_block[wait for gitlab-exporter service socket] called

        [32m- execute the ruby block wait for gitlab-exporter service socket[0m
      * file[/var/log/gitlab/gitlab-exporter/current] action touch (skipped due to only_if)
[2025-07-12T20:47:16+03:00] INFO: ruby_block[reload_log_service] called
      [32m- execute the ruby block reload_log_service[0m
[2025-07-12T20:47:16+03:00] INFO: template[/opt/gitlab/sv/gitlab-exporter/log/run] sending run action to ruby_block[restart_log_service] (delayed)
    * ruby_block[restart_log_service] action run
      * ruby_block[restart_service] action nothing (skipped due to action :nothing)
      * ruby_block[restart_log_service] action nothing (skipped due to action :nothing)
      * ruby_block[reload_log_service] action nothing (skipped due to action :nothing)
      * directory[/opt/gitlab/sv/gitlab-exporter] action create (up to date)
      * template[/opt/gitlab/sv/gitlab-exporter/run] action create (up to date)
      * directory[/opt/gitlab/sv/gitlab-exporter/log] action create (up to date)
      * directory[/opt/gitlab/sv/gitlab-exporter/log/main] action create (up to date)
      * template[/opt/gitlab/sv/gitlab-exporter/log/config] action create (up to date)
      * ruby_block[verify_chown_persisted_on_gitlab-exporter] action nothing (skipped due to action :nothing)
      * link[/var/log/gitlab/gitlab-exporter/config] action create (up to date)
      * template[/opt/gitlab/sv/gitlab-exporter/log/run] action create (up to date)
      * directory[/opt/gitlab/sv/gitlab-exporter/env] action create (up to date)
      * ruby_block[Delete unmanaged env files for gitlab-exporter service] action run (skipped due to only_if)
      * template[/opt/gitlab/sv/gitlab-exporter/check] action create (skipped due to only_if)
      * template[/opt/gitlab/sv/gitlab-exporter/finish] action create (skipped due to only_if)
      * directory[/opt/gitlab/sv/gitlab-exporter/control] action create (up to date)
      * link[/opt/gitlab/init/gitlab-exporter] action create (up to date)
      * file[/opt/gitlab/sv/gitlab-exporter/down] action nothing (skipped due to action :nothing)
      * directory[/opt/gitlab/service] action create (up to date)
      * link[/opt/gitlab/service/gitlab-exporter] action create (up to date)
      * ruby_block[wait for gitlab-exporter service socket] action run (skipped due to not_if)
      * file[/var/log/gitlab/gitlab-exporter/current] action touch (skipped due to only_if)
[2025-07-12T20:47:16+03:00] INFO: ruby_block[restart_log_service] called
      [32m- execute the ruby block restart_log_service[0m
    * directory[/opt/gitlab/service] action create (up to date)
    * link[/opt/gitlab/service/gitlab-exporter] action create (up to date)
    * ruby_block[wait for gitlab-exporter service socket] action run (skipped due to not_if)
    * file[/var/log/gitlab/gitlab-exporter/current] action touch (skipped due to only_if)
  
  * execute[/opt/gitlab/bin/gitlab-ctl start gitlab-exporter] action run
    [execute] ok: run: gitlab-exporter: (pid 18970) 4s
[2025-07-12T20:47:18+03:00] INFO: execute[/opt/gitlab/bin/gitlab-ctl start gitlab-exporter] ran successfully
    [32m- execute /opt/gitlab/bin/gitlab-ctl start gitlab-exporter[0m
  * consul_service[gitlab-exporter] action delete
    * file[/var/opt/gitlab/consul/config.d/gitlab-exporter-service.json] action delete (up to date)
     (up to date)
Recipe: monitoring::redis-exporter
  * directory[/var/log/gitlab/redis-exporter] action create[2025-07-12T20:47:18+03:00] INFO: directory[/var/log/gitlab/redis-exporter] created directory /var/log/gitlab/redis-exporter

    [32m- create new directory /var/log/gitlab/redis-exporter[0m[2025-07-12T20:47:18+03:00] INFO: directory[/var/log/gitlab/redis-exporter] owner changed to 993
[2025-07-12T20:47:18+03:00] INFO: directory[/var/log/gitlab/redis-exporter] mode changed to 700

    [32m- change mode from '' to '0700'[0m
    [32m- change owner from '' to 'gitlab-redis'[0m
  * directory[/opt/gitlab/etc/redis-exporter/env] action create[2025-07-12T20:47:18+03:00] INFO: directory[/opt/gitlab/etc/redis-exporter/env] created directory /opt/gitlab/etc/redis-exporter/env

    [32m- create new directory /opt/gitlab/etc/redis-exporter/env[0m[2025-07-12T20:47:18+03:00] INFO: directory[/opt/gitlab/etc/redis-exporter/env] owner changed to 993
[2025-07-12T20:47:18+03:00] INFO: directory[/opt/gitlab/etc/redis-exporter/env] mode changed to 700

    [32m- change mode from '' to '0700'[0m
    [32m- change owner from '' to 'gitlab-redis'[0m
  * env_dir[/opt/gitlab/etc/redis-exporter/env] action create
    * directory[/opt/gitlab/etc/redis-exporter/env] action create (up to date)
    * file[/opt/gitlab/etc/redis-exporter/env/SSL_CERT_DIR] action create[2025-07-12T20:47:18+03:00] INFO: file[/opt/gitlab/etc/redis-exporter/env/SSL_CERT_DIR] created file /opt/gitlab/etc/redis-exporter/env/SSL_CERT_DIR

      [32m- create new file /opt/gitlab/etc/redis-exporter/env/SSL_CERT_DIR[0m[2025-07-12T20:47:18+03:00] INFO: file[/opt/gitlab/etc/redis-exporter/env/SSL_CERT_DIR] updated file contents /opt/gitlab/etc/redis-exporter/env/SSL_CERT_DIR

      [32m- update content in file /opt/gitlab/etc/redis-exporter/env/SSL_CERT_DIR from none to 4f45cf[0m
      [32m- suppressed sensitive resource[0m
  
  * service[redis-exporter] action nothing (skipped due to action :nothing)
  * runit_service[redis-exporter] action enable
    * ruby_block[restart_service] action nothing (skipped due to action :nothing)
    * ruby_block[restart_log_service] action nothing (skipped due to action :nothing)
    * ruby_block[reload_log_service] action nothing (skipped due to action :nothing)
    * directory[/opt/gitlab/sv/redis-exporter] action create[2025-07-12T20:47:18+03:00] INFO: directory[/opt/gitlab/sv/redis-exporter] created directory /opt/gitlab/sv/redis-exporter

      [32m- create new directory /opt/gitlab/sv/redis-exporter[0m[2025-07-12T20:47:18+03:00] INFO: directory[/opt/gitlab/sv/redis-exporter] owner changed to 0
[2025-07-12T20:47:18+03:00] INFO: directory[/opt/gitlab/sv/redis-exporter] group changed to 0
[2025-07-12T20:47:18+03:00] INFO: directory[/opt/gitlab/sv/redis-exporter] mode changed to 755

      [32m- change mode from '' to '0755'[0m
      [32m- change owner from '' to 'root'[0m
      [32m- change group from '' to 'root'[0m
    * template[/opt/gitlab/sv/redis-exporter/run] action create[2025-07-12T20:47:18+03:00] INFO: template[/opt/gitlab/sv/redis-exporter/run] created file /opt/gitlab/sv/redis-exporter/run

      [32m- create new file /opt/gitlab/sv/redis-exporter/run[0m[2025-07-12T20:47:18+03:00] INFO: template[/opt/gitlab/sv/redis-exporter/run] updated file contents /opt/gitlab/sv/redis-exporter/run

      [32m- update content in file /opt/gitlab/sv/redis-exporter/run from none to a21d3f[0m
      [37m--- /opt/gitlab/sv/redis-exporter/run	2025-07-12 20:47:18.153304120 +0300[0m
      [37m+++ /opt/gitlab/sv/redis-exporter/.chef-run20250712-17810-g8ocbf	2025-07-12 20:47:18.153304120 +0300[0m
      [37m@@ -1,8 +1,16 @@[0m
      [37m+#!/bin/sh[0m
      [37m+exec 2>&1[0m
      [37m+[0m
      [37m+umask 077[0m
      [37m+exec chpst -P -e /opt/gitlab/etc/redis-exporter/env \[0m
      [37m+  -U gitlab-redis:git \[0m
      [37m+  -u gitlab-redis:git \[0m
      [37m+  /opt/gitlab/embedded/bin/redis_exporter --web.listen-address=localhost:9121 --redis.addr=unix:///var/opt/gitlab/redis/redis.socket[0m[2025-07-12T20:47:18+03:00] INFO: template[/opt/gitlab/sv/redis-exporter/run] owner changed to 0
[2025-07-12T20:47:18+03:00] INFO: template[/opt/gitlab/sv/redis-exporter/run] group changed to 0
[2025-07-12T20:47:18+03:00] INFO: template[/opt/gitlab/sv/redis-exporter/run] mode changed to 755

      [32m- change mode from '' to '0755'[0m
      [32m- change owner from '' to 'root'[0m
      [32m- change group from '' to 'root'[0m
    * directory[/opt/gitlab/sv/redis-exporter/log] action create[2025-07-12T20:47:18+03:00] INFO: directory[/opt/gitlab/sv/redis-exporter/log] created directory /opt/gitlab/sv/redis-exporter/log

      [32m- create new directory /opt/gitlab/sv/redis-exporter/log[0m[2025-07-12T20:47:18+03:00] INFO: directory[/opt/gitlab/sv/redis-exporter/log] owner changed to 0
[2025-07-12T20:47:18+03:00] INFO: directory[/opt/gitlab/sv/redis-exporter/log] group changed to 0
[2025-07-12T20:47:18+03:00] INFO: directory[/opt/gitlab/sv/redis-exporter/log] mode changed to 755

      [32m- change mode from '' to '0755'[0m
      [32m- change owner from '' to 'root'[0m
      [32m- change group from '' to 'root'[0m
    * directory[/opt/gitlab/sv/redis-exporter/log/main] action create[2025-07-12T20:47:18+03:00] INFO: directory[/opt/gitlab/sv/redis-exporter/log/main] created directory /opt/gitlab/sv/redis-exporter/log/main

      [32m- create new directory /opt/gitlab/sv/redis-exporter/log/main[0m[2025-07-12T20:47:18+03:00] INFO: directory[/opt/gitlab/sv/redis-exporter/log/main] owner changed to 0
[2025-07-12T20:47:18+03:00] INFO: directory[/opt/gitlab/sv/redis-exporter/log/main] group changed to 0
[2025-07-12T20:47:18+03:00] INFO: directory[/opt/gitlab/sv/redis-exporter/log/main] mode changed to 755

      [32m- change mode from '' to '0755'[0m
      [32m- change owner from '' to 'root'[0m
      [32m- change group from '' to 'root'[0m
    * template[/opt/gitlab/sv/redis-exporter/log/config] action create[2025-07-12T20:47:18+03:00] INFO: template[/opt/gitlab/sv/redis-exporter/log/config] created file /opt/gitlab/sv/redis-exporter/log/config

      [32m- create new file /opt/gitlab/sv/redis-exporter/log/config[0m[2025-07-12T20:47:18+03:00] INFO: template[/opt/gitlab/sv/redis-exporter/log/config] updated file contents /opt/gitlab/sv/redis-exporter/log/config

      [32m- update content in file /opt/gitlab/sv/redis-exporter/log/config from none to 623c00[0m
      [37m--- /opt/gitlab/sv/redis-exporter/log/config	2025-07-12 20:47:18.177292120 +0300[0m
      [37m+++ /opt/gitlab/sv/redis-exporter/log/.chef-config20250712-17810-2tcqhx	2025-07-12 20:47:18.177292120 +0300[0m
      [37m@@ -1,6 +1,12 @@[0m
      [37m+s209715200[0m
      [37m+n30[0m
      [37m+t86400[0m
      [37m+!gzip[0m
      [37m+[0m
      [37m+[0m[2025-07-12T20:47:18+03:00] INFO: template[/opt/gitlab/sv/redis-exporter/log/config] owner changed to 0
[2025-07-12T20:47:18+03:00] INFO: template[/opt/gitlab/sv/redis-exporter/log/config] group changed to 0
[2025-07-12T20:47:18+03:00] INFO: template[/opt/gitlab/sv/redis-exporter/log/config] mode changed to 644

      [32m- change mode from '' to '0644'[0m
      [32m- change owner from '' to 'root'[0m
      [32m- change group from '' to 'root'[0m
    * ruby_block[verify_chown_persisted_on_redis-exporter] action nothing (skipped due to action :nothing)
[2025-07-12T20:47:18+03:00] INFO: ruby_block[verify_chown_persisted_on_redis-exporter] sent create action to ruby_block[verify_chown_persisted_on_redis-exporter] (immediate at declaration time)
    * ruby_block[verify_chown_persisted_on_redis-exporter] action create[2025-07-12T20:47:18+03:00] INFO: ruby_block[verify_chown_persisted_on_redis-exporter] called

      [32m- execute the ruby block verify_chown_persisted_on_redis-exporter[0m
    * link[/var/log/gitlab/redis-exporter/config] action create[2025-07-12T20:47:18+03:00] INFO: link[/var/log/gitlab/redis-exporter/config] created

      [32m- create symlink at /var/log/gitlab/redis-exporter/config to /opt/gitlab/sv/redis-exporter/log/config[0m
    * template[/opt/gitlab/sv/redis-exporter/log/run] action create[2025-07-12T20:47:18+03:00] INFO: template[/opt/gitlab/sv/redis-exporter/log/run] created file /opt/gitlab/sv/redis-exporter/log/run

      [32m- create new file /opt/gitlab/sv/redis-exporter/log/run[0m[2025-07-12T20:47:18+03:00] INFO: template[/opt/gitlab/sv/redis-exporter/log/run] updated file contents /opt/gitlab/sv/redis-exporter/log/run

      [32m- update content in file /opt/gitlab/sv/redis-exporter/log/run from none to 2dc23f[0m
      [37m--- /opt/gitlab/sv/redis-exporter/log/run	2025-07-12 20:47:18.201280120 +0300[0m
      [37m+++ /opt/gitlab/sv/redis-exporter/log/.chef-run20250712-17810-p9ory8	2025-07-12 20:47:18.201280120 +0300[0m
      [37m@@ -1,5 +1,10 @@[0m
      [37m+#!/bin/sh[0m
      [37m+exec chpst -P \[0m
      [37m+  -U root:root \[0m
      [37m+  -u root:root \[0m
      [37m+  svlogd -tt /var/log/gitlab/redis-exporter[0m[2025-07-12T20:47:18+03:00] INFO: template[/opt/gitlab/sv/redis-exporter/log/run] owner changed to 0
[2025-07-12T20:47:18+03:00] INFO: template[/opt/gitlab/sv/redis-exporter/log/run] group changed to 0
[2025-07-12T20:47:18+03:00] INFO: template[/opt/gitlab/sv/redis-exporter/log/run] mode changed to 755

      [32m- change mode from '' to '0755'[0m
      [32m- change owner from '' to 'root'[0m
      [32m- change group from '' to 'root'[0m
    * directory[/opt/gitlab/sv/redis-exporter/env] action create[2025-07-12T20:47:18+03:00] INFO: directory[/opt/gitlab/sv/redis-exporter/env] created directory /opt/gitlab/sv/redis-exporter/env

      [32m- create new directory /opt/gitlab/sv/redis-exporter/env[0m[2025-07-12T20:47:18+03:00] INFO: directory[/opt/gitlab/sv/redis-exporter/env] owner changed to 0
[2025-07-12T20:47:18+03:00] INFO: directory[/opt/gitlab/sv/redis-exporter/env] group changed to 0
[2025-07-12T20:47:18+03:00] INFO: directory[/opt/gitlab/sv/redis-exporter/env] mode changed to 755

      [32m- change mode from '' to '0755'[0m
      [32m- change owner from '' to 'root'[0m
      [32m- change group from '' to 'root'[0m
    * ruby_block[Delete unmanaged env files for redis-exporter service] action run (skipped due to only_if)
    * template[/opt/gitlab/sv/redis-exporter/check] action create (skipped due to only_if)
    * template[/opt/gitlab/sv/redis-exporter/finish] action create (skipped due to only_if)
    * directory[/opt/gitlab/sv/redis-exporter/control] action create[2025-07-12T20:47:18+03:00] INFO: directory[/opt/gitlab/sv/redis-exporter/control] created directory /opt/gitlab/sv/redis-exporter/control

      [32m- create new directory /opt/gitlab/sv/redis-exporter/control[0m[2025-07-12T20:47:18+03:00] INFO: directory[/opt/gitlab/sv/redis-exporter/control] owner changed to 0
[2025-07-12T20:47:18+03:00] INFO: directory[/opt/gitlab/sv/redis-exporter/control] group changed to 0
[2025-07-12T20:47:18+03:00] INFO: directory[/opt/gitlab/sv/redis-exporter/control] mode changed to 755

      [32m- change mode from '' to '0755'[0m
      [32m- change owner from '' to 'root'[0m
      [32m- change group from '' to 'root'[0m
    * link[/opt/gitlab/init/redis-exporter] action create[2025-07-12T20:47:18+03:00] INFO: link[/opt/gitlab/init/redis-exporter] created

      [32m- create symlink at /opt/gitlab/init/redis-exporter to /opt/gitlab/embedded/bin/sv[0m
    * file[/opt/gitlab/sv/redis-exporter/down] action nothing (skipped due to action :nothing)
[2025-07-12T20:47:18+03:00] INFO: template[/opt/gitlab/sv/redis-exporter/run] sending run action to ruby_block[restart_service] (delayed)
    * ruby_block[restart_service] action run (skipped due to only_if)
[2025-07-12T20:47:18+03:00] INFO: template[/opt/gitlab/sv/redis-exporter/log/config] sending create action to ruby_block[reload_log_service] (delayed)
    * ruby_block[reload_log_service] action create
      * ruby_block[restart_service] action nothing (skipped due to action :nothing)
      * ruby_block[restart_log_service] action nothing (skipped due to action :nothing)
      * ruby_block[reload_log_service] action nothing (skipped due to action :nothing)
      * directory[/opt/gitlab/sv/redis-exporter] action create (up to date)
      * template[/opt/gitlab/sv/redis-exporter/run] action create (up to date)
      * directory[/opt/gitlab/sv/redis-exporter/log] action create (up to date)
      * directory[/opt/gitlab/sv/redis-exporter/log/main] action create (up to date)
      * template[/opt/gitlab/sv/redis-exporter/log/config] action create (up to date)
      * ruby_block[verify_chown_persisted_on_redis-exporter] action nothing (skipped due to action :nothing)
      * link[/var/log/gitlab/redis-exporter/config] action create (up to date)
      * template[/opt/gitlab/sv/redis-exporter/log/run] action create (up to date)
      * directory[/opt/gitlab/sv/redis-exporter/env] action create (up to date)
      * ruby_block[Delete unmanaged env files for redis-exporter service] action run (skipped due to only_if)
      * template[/opt/gitlab/sv/redis-exporter/check] action create (skipped due to only_if)
      * template[/opt/gitlab/sv/redis-exporter/finish] action create (skipped due to only_if)
      * directory[/opt/gitlab/sv/redis-exporter/control] action create (up to date)
      * link[/opt/gitlab/init/redis-exporter] action create (up to date)
      * file[/opt/gitlab/sv/redis-exporter/down] action nothing (skipped due to action :nothing)
      * directory[/opt/gitlab/service] action create (up to date)
      * link[/opt/gitlab/service/redis-exporter] action create[2025-07-12T20:47:18+03:00] INFO: link[/opt/gitlab/service/redis-exporter] created

        [32m- create symlink at /opt/gitlab/service/redis-exporter to /opt/gitlab/sv/redis-exporter[0m
      * ruby_block[wait for redis-exporter service socket] action run[2025-07-12T20:47:21+03:00] INFO: ruby_block[wait for redis-exporter service socket] called

        [32m- execute the ruby block wait for redis-exporter service socket[0m
      * file[/var/log/gitlab/redis-exporter/current] action touch (skipped due to only_if)
[2025-07-12T20:47:22+03:00] INFO: ruby_block[reload_log_service] called
      [32m- execute the ruby block reload_log_service[0m
[2025-07-12T20:47:22+03:00] INFO: template[/opt/gitlab/sv/redis-exporter/log/run] sending run action to ruby_block[restart_log_service] (delayed)
    * ruby_block[restart_log_service] action run
      * ruby_block[restart_service] action nothing (skipped due to action :nothing)
      * ruby_block[restart_log_service] action nothing (skipped due to action :nothing)
      * ruby_block[reload_log_service] action nothing (skipped due to action :nothing)
      * directory[/opt/gitlab/sv/redis-exporter] action create (up to date)
      * template[/opt/gitlab/sv/redis-exporter/run] action create (up to date)
      * directory[/opt/gitlab/sv/redis-exporter/log] action create (up to date)
      * directory[/opt/gitlab/sv/redis-exporter/log/main] action create (up to date)
      * template[/opt/gitlab/sv/redis-exporter/log/config] action create (up to date)
      * ruby_block[verify_chown_persisted_on_redis-exporter] action nothing (skipped due to action :nothing)
      * link[/var/log/gitlab/redis-exporter/config] action create (up to date)
      * template[/opt/gitlab/sv/redis-exporter/log/run] action create (up to date)
      * directory[/opt/gitlab/sv/redis-exporter/env] action create (up to date)
      * ruby_block[Delete unmanaged env files for redis-exporter service] action run (skipped due to only_if)
      * template[/opt/gitlab/sv/redis-exporter/check] action create (skipped due to only_if)
      * template[/opt/gitlab/sv/redis-exporter/finish] action create (skipped due to only_if)
      * directory[/opt/gitlab/sv/redis-exporter/control] action create (up to date)
      * link[/opt/gitlab/init/redis-exporter] action create (up to date)
      * file[/opt/gitlab/sv/redis-exporter/down] action nothing (skipped due to action :nothing)
      * directory[/opt/gitlab/service] action create (up to date)
      * link[/opt/gitlab/service/redis-exporter] action create (up to date)
      * ruby_block[wait for redis-exporter service socket] action run (skipped due to not_if)
      * file[/var/log/gitlab/redis-exporter/current] action touch (skipped due to only_if)
[2025-07-12T20:47:22+03:00] INFO: ruby_block[restart_log_service] called
      [32m- execute the ruby block restart_log_service[0m
    * directory[/opt/gitlab/service] action create (up to date)
    * link[/opt/gitlab/service/redis-exporter] action create (up to date)
    * ruby_block[wait for redis-exporter service socket] action run (skipped due to not_if)
    * file[/var/log/gitlab/redis-exporter/current] action touch (skipped due to only_if)
  
  * execute[/opt/gitlab/bin/gitlab-ctl start redis-exporter] action run
    [execute] ok: run: redis-exporter: (pid 18985) 3s
[2025-07-12T20:47:23+03:00] INFO: execute[/opt/gitlab/bin/gitlab-ctl start redis-exporter] ran successfully
    [32m- execute /opt/gitlab/bin/gitlab-ctl start redis-exporter[0m
  * consul_service[redis-exporter] action delete
    * file[/var/opt/gitlab/consul/config.d/redis-exporter-service.json] action delete (up to date)
     (up to date)
Recipe: monitoring::prometheus
  * directory[/var/opt/gitlab/prometheus] action create[2025-07-12T20:47:23+03:00] INFO: directory[/var/opt/gitlab/prometheus] created directory /var/opt/gitlab/prometheus

    [32m- create new directory /var/opt/gitlab/prometheus[0m[2025-07-12T20:47:23+03:00] INFO: directory[/var/opt/gitlab/prometheus] owner changed to 991
[2025-07-12T20:47:23+03:00] INFO: directory[/var/opt/gitlab/prometheus] mode changed to 750

    [32m- change mode from '' to '0750'[0m
    [32m- change owner from '' to 'gitlab-prometheus'[0m
  * directory[/var/opt/gitlab/prometheus/rules] action create[2025-07-12T20:47:23+03:00] INFO: directory[/var/opt/gitlab/prometheus/rules] created directory /var/opt/gitlab/prometheus/rules

    [32m- create new directory /var/opt/gitlab/prometheus/rules[0m[2025-07-12T20:47:23+03:00] INFO: directory[/var/opt/gitlab/prometheus/rules] owner changed to 991
[2025-07-12T20:47:23+03:00] INFO: directory[/var/opt/gitlab/prometheus/rules] mode changed to 750

    [32m- change mode from '' to '0750'[0m
    [32m- change owner from '' to 'gitlab-prometheus'[0m
  * directory[/var/log/gitlab/prometheus] action create[2025-07-12T20:47:23+03:00] INFO: directory[/var/log/gitlab/prometheus] created directory /var/log/gitlab/prometheus

    [32m- create new directory /var/log/gitlab/prometheus[0m[2025-07-12T20:47:23+03:00] INFO: directory[/var/log/gitlab/prometheus] owner changed to 991
[2025-07-12T20:47:23+03:00] INFO: directory[/var/log/gitlab/prometheus] mode changed to 700

    [32m- change mode from '' to '0700'[0m
    [32m- change owner from '' to 'gitlab-prometheus'[0m
  * directory[/opt/gitlab/etc/prometheus/env] action create[2025-07-12T20:47:23+03:00] INFO: directory[/opt/gitlab/etc/prometheus/env] created directory /opt/gitlab/etc/prometheus/env

    [32m- create new directory /opt/gitlab/etc/prometheus/env[0m[2025-07-12T20:47:23+03:00] INFO: directory[/opt/gitlab/etc/prometheus/env] owner changed to 991
[2025-07-12T20:47:23+03:00] INFO: directory[/opt/gitlab/etc/prometheus/env] mode changed to 700

    [32m- change mode from '' to '0700'[0m
    [32m- change owner from '' to 'gitlab-prometheus'[0m
  * env_dir[/opt/gitlab/etc/prometheus/env] action create
    * directory[/opt/gitlab/etc/prometheus/env] action create (up to date)
    * file[/opt/gitlab/etc/prometheus/env/SSL_CERT_DIR] action create[2025-07-12T20:47:23+03:00] INFO: file[/opt/gitlab/etc/prometheus/env/SSL_CERT_DIR] created file /opt/gitlab/etc/prometheus/env/SSL_CERT_DIR

      [32m- create new file /opt/gitlab/etc/prometheus/env/SSL_CERT_DIR[0m[2025-07-12T20:47:23+03:00] INFO: file[/opt/gitlab/etc/prometheus/env/SSL_CERT_DIR] updated file contents /opt/gitlab/etc/prometheus/env/SSL_CERT_DIR

      [32m- update content in file /opt/gitlab/etc/prometheus/env/SSL_CERT_DIR from none to 4f45cf[0m
      [32m- suppressed sensitive resource[0m
  
  * execute[reload prometheus] action nothing (skipped due to action :nothing)
  * file[Prometheus config] action create[2025-07-12T20:47:23+03:00] INFO: file[Prometheus config] created file /var/opt/gitlab/prometheus/prometheus.yml

    [32m- create new file /var/opt/gitlab/prometheus/prometheus.yml[0m[2025-07-12T20:47:23+03:00] INFO: file[Prometheus config] updated file contents /var/opt/gitlab/prometheus/prometheus.yml

    [32m- update content in file /var/opt/gitlab/prometheus/prometheus.yml from none to 0fbf9e[0m
    [37m--- /var/opt/gitlab/prometheus/prometheus.yml	2025-07-12 20:47:23.674542067 +0300[0m
    [37m+++ /var/opt/gitlab/prometheus/.chef-prometheus20250712-17810-vramns.yml	2025-07-12 20:47:23.674542067 +0300[0m
    [37m@@ -1,171 +1,342 @@[0m
    [37m+---[0m
    [37m+global:[0m
    [37m+  scrape_interval: 15s[0m
    [37m+  scrape_timeout: 15s[0m
    [37m+  external_labels: {}[0m
    [37m+remote_read: [][0m
    [37m+remote_write: [][0m
    [37m+rule_files:[0m
    [37m+- "/var/opt/gitlab/prometheus/rules/*.rules"[0m
    [37m+scrape_configs:[0m
    [37m+- job_name: prometheus[0m
    [37m+  static_configs:[0m
    [37m+  - targets:[0m
    [37m+    - localhost:9090[0m
    [37m+- job_name: nginx[0m
    [37m+  static_configs:[0m
    [37m+  - targets:[0m
    [37m+    - localhost:8060[0m
    [37m+- job_name: redis[0m
    [37m+  static_configs:[0m
    [37m+  - targets:[0m
    [37m+    - localhost:9121[0m
    [37m+- job_name: postgres[0m
    [37m+  static_configs:[0m
    [37m+  - targets:[0m
    [37m+    - localhost:9187[0m
    [37m+- job_name: node[0m
    [37m+  static_configs:[0m
    [37m+  - targets:[0m
    [37m+    - localhost:9100[0m
    [37m+- job_name: gitlab-workhorse[0m
    [37m+  static_configs:[0m
    [37m+  - targets:[0m
    [37m+    - localhost:9229[0m
    [37m+- job_name: gitlab-rails[0m
    [37m+  metrics_path: "/-/metrics"[0m
    [37m+  static_configs:[0m
    [37m+  - targets:[0m
    [37m+    - 127.0.0.1:8080[0m
    [37m+  relabel_configs:[0m
    [37m+  - source_labels:[0m
    [37m+    - __address__[0m
    [37m+    regex: 127.0.0.1:(.*)[0m
    [37m+    replacement: localhost:$1[0m
    [37m+    target_label: instance[0m
    [37m+- job_name: gitlab-sidekiq[0m
    [37m+  static_configs:[0m
    [37m+  - targets:[0m
    [37m+    - 127.0.0.1:8082[0m
    [37m+  relabel_configs:[0m
    [37m+  - source_labels:[0m
    [37m+    - __address__[0m
    [37m+    regex: 127.0.0.1:(.*)[0m
    [37m+    replacement: localhost:$1[0m
    [37m+    target_label: instance[0m
    [37m+- job_name: gitlab_exporter_database[0m
    [37m+  metrics_path: "/database"[0m
    [37m+  static_configs:[0m
    [37m+  - targets:[0m
    [37m+    - localhost:9168[0m
    [37m+- job_name: gitlab_exporter_sidekiq[0m
    [37m+  metrics_path: "/sidekiq"[0m
    [37m+  static_configs:[0m
    [37m+  - targets:[0m
    [37m+    - localhost:9168[0m
    [37m+- job_name: gitlab_exporter_ruby[0m
    [37m+  metrics_path: "/ruby"[0m
    [37m+  static_configs:[0m
    [37m+  - targets:[0m
    [37m+    - localhost:9168[0m
    [37m+- job_name: gitaly[0m
    [37m+  static_configs:[0m
    [37m+  - targets:[0m
    [37m+    - localhost:9236[0m
    [37m+- job_name: kubernetes-cadvisor[0m
    [37m+  scheme: https[0m
    [37m+  tls_config:[0m
    [37m+    ca_file: "/var/run/secrets/kubernetes.io/serviceaccount/ca.crt"[0m
    [37m+    insecure_skip_verify: true[0m
    [37m+  bearer_token_file: "/var/run/secrets/kubernetes.io/serviceaccount/token"[0m
    [37m+  kubernetes_sd_configs:[0m
    [37m+  - role: node[0m
    [37m+    api_server: https://kubernetes.default.svc:443[0m
    [37m+    tls_config:[0m
    [37m+      ca_file: "/var/run/secrets/kubernetes.io/serviceaccount/ca.crt"[0m
    [37m+    bearer_token_file: "/var/run/secrets/kubernetes.io/serviceaccount/token"[0m
    [37m+  relabel_configs:[0m
    [37m+  - action: labelmap[0m
    [37m+    regex: __meta_kubernetes_node_label_(.+)[0m
    [37m+  - target_label: __address__[0m
    [37m+    replacement: kubernetes.default.svc:443[0m
    [37m+  - source_labels:[0m
    [37m+    - __meta_kubernetes_node_name[0m
    [37m+    regex: "(.+)"[0m
    [37m+    target_label: __metrics_path__[0m
    [37m+    replacement: "/api/v1/nodes/${1}/proxy/metrics/cadvisor"[0m
    [37m+  metric_relabel_configs:[0m
    [37m+  - source_labels:[0m
    [37m+    - pod_name[0m
    [37m+    target_label: environment[0m
    [37m+    regex: "(.+)-.+-.+"[0m
    [37m+- job_name: kubernetes-nodes[0m
    [37m+  scheme: https[0m
    [37m+  tls_config:[0m
    [37m+    ca_file: "/var/run/secrets/kubernetes.io/serviceaccount/ca.crt"[0m
    [37m+    insecure_skip_verify: true[0m
    [37m+  bearer_token_file: "/var/run/secrets/kubernetes.io/serviceaccount/token"[0m
    [37m+  kubernetes_sd_configs:[0m
    [37m+  - role: node[0m
    [37m+    api_server: https://kubernetes.default.svc:443[0m
    [37m+    tls_config:[0m
    [37m+      ca_file: "/var/run/secrets/kubernetes.io/serviceaccount/ca.crt"[0m
    [37m+    bearer_token_file: "/var/run/secrets/kubernetes.io/serviceaccount/token"[0m
    [37m+  relabel_configs:[0m
    [37m+  - action: labelmap[0m
    [37m+    regex: __meta_kubernetes_node_label_(.+)[0m
    [37m+  - target_label: __address__[0m
    [37m+    replacement: kubernetes.default.svc:443[0m
    [37m+  - source_labels:[0m
    [37m+    - __meta_kubernetes_node_name[0m
    [37m+    regex: "(.+)"[0m
    [37m+    target_label: __metrics_path__[0m
    [37m+    replacement: "/api/v1/nodes/${1}/proxy/metrics"[0m
    [37m+  metric_relabel_configs:[0m
    [37m+  - source_labels:[0m
    [37m+    - pod_name[0m
    [37m+    target_label: environment[0m
    [37m+    regex: "(.+)-.+-.+"[0m
    [37m+- job_name: kubernetes-pods[0m
    [37m+  tls_config:[0m
    [37m+    ca_file: "/var/run/secrets/kubernetes.io/serviceaccount/ca.crt"[0m
    [37m+    insecure_skip_verify: true[0m
    [37m+  bearer_token_file: "/var/run/secrets/kubernetes.io/serviceaccount/token"[0m
    [37m+  kubernetes_sd_configs:[0m
    [37m+  - role: pod[0m
    [37m+    api_server: https://kubernetes.default.svc:443[0m
    [37m+    tls_config:[0m
    [37m+      ca_file: "/var/run/secrets/kubernetes.io/serviceaccount/ca.crt"[0m
    [37m+    bearer_token_file: "/var/run/secrets/kubernetes.io/serviceaccount/token"[0m
    [37m+  relabel_configs:[0m
    [37m+  - source_labels:[0m
    [37m+    - __meta_kubernetes_pod_annotation_prometheus_io_scrape[0m
    [37m+    action: keep[0m
    [37m+    regex: 'true'[0m
    [37m+  - source_labels:[0m
    [37m+    - __meta_kubernetes_pod_annotation_prometheus_io_path[0m
    [37m+    action: replace[0m
    [37m+    target_label: __metrics_path__[0m
    [37m+    regex: "(.+)"[0m
    [37m+  - source_labels:[0m
    [37m+    - __address__[0m
    [37m+    - __meta_kubernetes_pod_annotation_prometheus_io_port[0m
    [37m+    action: replace[0m
    [37m+    regex: "([^:]+)(?::[0-9]+)?;([0-9]+)"[0m
    [37m+    replacement: "$1:$2"[0m
    [37m+    target_label: __address__[0m
    [37m+  - action: labelmap[0m
    [37m+    regex: __meta_kubernetes_pod_label_(.+)[0m
    [37m+  - source_labels:[0m
    [37m+    - __meta_kubernetes_namespace[0m
    [37m+    action: replace[0m
    [37m+    target_label: kubernetes_namespace[0m
    [37m+  - source_labels:[0m
    [37m+    - __meta_kubernetes_pod_name[0m
    [37m+    action: replace[0m
    [37m+    target_label: kubernetes_pod_name[0m
    [37m+alerting:[0m
    [37m+  alertmanagers:[0m
    [37m+  - static_configs:[0m
    [37m+    - targets:[0m
    [37m+      - localhost:9093[0m[2025-07-12T20:47:23+03:00] INFO: file[Prometheus config] owner changed to 991
[2025-07-12T20:47:23+03:00] INFO: file[Prometheus config] mode changed to 644

    [32m- change mode from '' to '0644'[0m
    [32m- change owner from '' to 'gitlab-prometheus'[0m
  * service[prometheus] action nothing (skipped due to action :nothing)
  * runit_service[prometheus] action enable
    * ruby_block[restart_service] action nothing (skipped due to action :nothing)
    * ruby_block[restart_log_service] action nothing (skipped due to action :nothing)
    * ruby_block[reload_log_service] action nothing (skipped due to action :nothing)
    * directory[/opt/gitlab/sv/prometheus] action create[2025-07-12T20:47:23+03:00] INFO: directory[/opt/gitlab/sv/prometheus] created directory /opt/gitlab/sv/prometheus

      [32m- create new directory /opt/gitlab/sv/prometheus[0m[2025-07-12T20:47:23+03:00] INFO: directory[/opt/gitlab/sv/prometheus] owner changed to 0
[2025-07-12T20:47:23+03:00] INFO: directory[/opt/gitlab/sv/prometheus] group changed to 0
[2025-07-12T20:47:23+03:00] INFO: directory[/opt/gitlab/sv/prometheus] mode changed to 755

      [32m- change mode from '' to '0755'[0m
      [32m- change owner from '' to 'root'[0m
      [32m- change group from '' to 'root'[0m
    * template[/opt/gitlab/sv/prometheus/run] action create[2025-07-12T20:47:23+03:00] INFO: template[/opt/gitlab/sv/prometheus/run] created file /opt/gitlab/sv/prometheus/run

      [32m- create new file /opt/gitlab/sv/prometheus/run[0m[2025-07-12T20:47:23+03:00] INFO: template[/opt/gitlab/sv/prometheus/run] updated file contents /opt/gitlab/sv/prometheus/run

      [32m- update content in file /opt/gitlab/sv/prometheus/run from none to 60f91b[0m
      [37m--- /opt/gitlab/sv/prometheus/run	2025-07-12 20:47:23.742508069 +0300[0m
      [37m+++ /opt/gitlab/sv/prometheus/.chef-run20250712-17810-xnrbno	2025-07-12 20:47:23.742508069 +0300[0m
      [37m@@ -1,8 +1,16 @@[0m
      [37m+#!/bin/sh[0m
      [37m+exec 2>&1[0m
      [37m+[0m
      [37m+umask 077[0m
      [37m+exec chpst -P -e /opt/gitlab/etc/prometheus/env \[0m
      [37m+  -U gitlab-prometheus:gitlab-prometheus \[0m
      [37m+  -u gitlab-prometheus:gitlab-prometheus \[0m
      [37m+  /opt/gitlab/embedded/bin/prometheus --web.listen-address=localhost:9090 --storage.tsdb.path=/var/opt/gitlab/prometheus/data --config.file=/var/opt/gitlab/prometheus/prometheus.yml[0m[2025-07-12T20:47:23+03:00] INFO: template[/opt/gitlab/sv/prometheus/run] owner changed to 0
[2025-07-12T20:47:23+03:00] INFO: template[/opt/gitlab/sv/prometheus/run] group changed to 0
[2025-07-12T20:47:23+03:00] INFO: template[/opt/gitlab/sv/prometheus/run] mode changed to 755

      [32m- change mode from '' to '0755'[0m
      [32m- change owner from '' to 'root'[0m
      [32m- change group from '' to 'root'[0m
    * directory[/opt/gitlab/sv/prometheus/log] action create[2025-07-12T20:47:23+03:00] INFO: directory[/opt/gitlab/sv/prometheus/log] created directory /opt/gitlab/sv/prometheus/log

      [32m- create new directory /opt/gitlab/sv/prometheus/log[0m[2025-07-12T20:47:23+03:00] INFO: directory[/opt/gitlab/sv/prometheus/log] owner changed to 0
[2025-07-12T20:47:23+03:00] INFO: directory[/opt/gitlab/sv/prometheus/log] group changed to 0
[2025-07-12T20:47:23+03:00] INFO: directory[/opt/gitlab/sv/prometheus/log] mode changed to 755

      [32m- change mode from '' to '0755'[0m
      [32m- change owner from '' to 'root'[0m
      [32m- change group from '' to 'root'[0m
    * directory[/opt/gitlab/sv/prometheus/log/main] action create[2025-07-12T20:47:23+03:00] INFO: directory[/opt/gitlab/sv/prometheus/log/main] created directory /opt/gitlab/sv/prometheus/log/main

      [32m- create new directory /opt/gitlab/sv/prometheus/log/main[0m[2025-07-12T20:47:23+03:00] INFO: directory[/opt/gitlab/sv/prometheus/log/main] owner changed to 0
[2025-07-12T20:47:23+03:00] INFO: directory[/opt/gitlab/sv/prometheus/log/main] group changed to 0
[2025-07-12T20:47:23+03:00] INFO: directory[/opt/gitlab/sv/prometheus/log/main] mode changed to 755

      [32m- change mode from '' to '0755'[0m
      [32m- change owner from '' to 'root'[0m
      [32m- change group from '' to 'root'[0m
    * template[/opt/gitlab/sv/prometheus/log/config] action create[2025-07-12T20:47:23+03:00] INFO: template[/opt/gitlab/sv/prometheus/log/config] created file /opt/gitlab/sv/prometheus/log/config

      [32m- create new file /opt/gitlab/sv/prometheus/log/config[0m[2025-07-12T20:47:23+03:00] INFO: template[/opt/gitlab/sv/prometheus/log/config] updated file contents /opt/gitlab/sv/prometheus/log/config

      [32m- update content in file /opt/gitlab/sv/prometheus/log/config from none to 623c00[0m
      [37m--- /opt/gitlab/sv/prometheus/log/config	2025-07-12 20:47:23.742508069 +0300[0m
      [37m+++ /opt/gitlab/sv/prometheus/log/.chef-config20250712-17810-4oo58e	2025-07-12 20:47:23.742508069 +0300[0m
      [37m@@ -1,6 +1,12 @@[0m
      [37m+s209715200[0m
      [37m+n30[0m
      [37m+t86400[0m
      [37m+!gzip[0m
      [37m+[0m
      [37m+[0m[2025-07-12T20:47:23+03:00] INFO: template[/opt/gitlab/sv/prometheus/log/config] owner changed to 0
[2025-07-12T20:47:23+03:00] INFO: template[/opt/gitlab/sv/prometheus/log/config] group changed to 0
[2025-07-12T20:47:23+03:00] INFO: template[/opt/gitlab/sv/prometheus/log/config] mode changed to 644

      [32m- change mode from '' to '0644'[0m
      [32m- change owner from '' to 'root'[0m
      [32m- change group from '' to 'root'[0m
    * ruby_block[verify_chown_persisted_on_prometheus] action nothing (skipped due to action :nothing)
[2025-07-12T20:47:23+03:00] INFO: ruby_block[verify_chown_persisted_on_prometheus] sent create action to ruby_block[verify_chown_persisted_on_prometheus] (immediate at declaration time)
    * ruby_block[verify_chown_persisted_on_prometheus] action create[2025-07-12T20:47:23+03:00] INFO: ruby_block[verify_chown_persisted_on_prometheus] called

      [32m- execute the ruby block verify_chown_persisted_on_prometheus[0m
    * link[/var/log/gitlab/prometheus/config] action create[2025-07-12T20:47:23+03:00] INFO: link[/var/log/gitlab/prometheus/config] created

      [32m- create symlink at /var/log/gitlab/prometheus/config to /opt/gitlab/sv/prometheus/log/config[0m
    * template[/opt/gitlab/sv/prometheus/log/run] action create[2025-07-12T20:47:23+03:00] INFO: template[/opt/gitlab/sv/prometheus/log/run] created file /opt/gitlab/sv/prometheus/log/run

      [32m- create new file /opt/gitlab/sv/prometheus/log/run[0m[2025-07-12T20:47:23+03:00] INFO: template[/opt/gitlab/sv/prometheus/log/run] updated file contents /opt/gitlab/sv/prometheus/log/run

      [32m- update content in file /opt/gitlab/sv/prometheus/log/run from none to 8afdb7[0m
      [37m--- /opt/gitlab/sv/prometheus/log/run	2025-07-12 20:47:23.742508069 +0300[0m
      [37m+++ /opt/gitlab/sv/prometheus/log/.chef-run20250712-17810-esn6af	2025-07-12 20:47:23.742508069 +0300[0m
      [37m@@ -1,5 +1,10 @@[0m
      [37m+#!/bin/sh[0m
      [37m+exec chpst -P \[0m
      [37m+  -U root:root \[0m
      [37m+  -u root:root \[0m
      [37m+  svlogd -tt /var/log/gitlab/prometheus[0m[2025-07-12T20:47:23+03:00] INFO: template[/opt/gitlab/sv/prometheus/log/run] owner changed to 0
[2025-07-12T20:47:23+03:00] INFO: template[/opt/gitlab/sv/prometheus/log/run] group changed to 0
[2025-07-12T20:47:23+03:00] INFO: template[/opt/gitlab/sv/prometheus/log/run] mode changed to 755

      [32m- change mode from '' to '0755'[0m
      [32m- change owner from '' to 'root'[0m
      [32m- change group from '' to 'root'[0m
    * directory[/opt/gitlab/sv/prometheus/env] action create[2025-07-12T20:47:23+03:00] INFO: directory[/opt/gitlab/sv/prometheus/env] created directory /opt/gitlab/sv/prometheus/env

      [32m- create new directory /opt/gitlab/sv/prometheus/env[0m[2025-07-12T20:47:23+03:00] INFO: directory[/opt/gitlab/sv/prometheus/env] owner changed to 0
[2025-07-12T20:47:23+03:00] INFO: directory[/opt/gitlab/sv/prometheus/env] group changed to 0
[2025-07-12T20:47:23+03:00] INFO: directory[/opt/gitlab/sv/prometheus/env] mode changed to 755

      [32m- change mode from '' to '0755'[0m
      [32m- change owner from '' to 'root'[0m
      [32m- change group from '' to 'root'[0m
    * ruby_block[Delete unmanaged env files for prometheus service] action run (skipped due to only_if)
    * template[/opt/gitlab/sv/prometheus/check] action create (skipped due to only_if)
    * template[/opt/gitlab/sv/prometheus/finish] action create (skipped due to only_if)
    * directory[/opt/gitlab/sv/prometheus/control] action create[2025-07-12T20:47:23+03:00] INFO: directory[/opt/gitlab/sv/prometheus/control] created directory /opt/gitlab/sv/prometheus/control

      [32m- create new directory /opt/gitlab/sv/prometheus/control[0m[2025-07-12T20:47:23+03:00] INFO: directory[/opt/gitlab/sv/prometheus/control] owner changed to 0
[2025-07-12T20:47:23+03:00] INFO: directory[/opt/gitlab/sv/prometheus/control] group changed to 0
[2025-07-12T20:47:23+03:00] INFO: directory[/opt/gitlab/sv/prometheus/control] mode changed to 755

      [32m- change mode from '' to '0755'[0m
      [32m- change owner from '' to 'root'[0m
      [32m- change group from '' to 'root'[0m
    * link[/opt/gitlab/init/prometheus] action create[2025-07-12T20:47:23+03:00] INFO: link[/opt/gitlab/init/prometheus] created

      [32m- create symlink at /opt/gitlab/init/prometheus to /opt/gitlab/embedded/bin/sv[0m
    * file[/opt/gitlab/sv/prometheus/down] action nothing (skipped due to action :nothing)
[2025-07-12T20:47:23+03:00] INFO: template[/opt/gitlab/sv/prometheus/run] sending run action to ruby_block[restart_service] (delayed)
    * ruby_block[restart_service] action run (skipped due to only_if)
[2025-07-12T20:47:23+03:00] INFO: template[/opt/gitlab/sv/prometheus/log/config] sending create action to ruby_block[reload_log_service] (delayed)
    * ruby_block[reload_log_service] action create
      * ruby_block[restart_service] action nothing (skipped due to action :nothing)
      * ruby_block[restart_log_service] action nothing (skipped due to action :nothing)
      * ruby_block[reload_log_service] action nothing (skipped due to action :nothing)
      * directory[/opt/gitlab/sv/prometheus] action create (up to date)
      * template[/opt/gitlab/sv/prometheus/run] action create (up to date)
      * directory[/opt/gitlab/sv/prometheus/log] action create (up to date)
      * directory[/opt/gitlab/sv/prometheus/log/main] action create (up to date)
      * template[/opt/gitlab/sv/prometheus/log/config] action create (up to date)
      * ruby_block[verify_chown_persisted_on_prometheus] action nothing (skipped due to action :nothing)
      * link[/var/log/gitlab/prometheus/config] action create (up to date)
      * template[/opt/gitlab/sv/prometheus/log/run] action create (up to date)
      * directory[/opt/gitlab/sv/prometheus/env] action create (up to date)
      * ruby_block[Delete unmanaged env files for prometheus service] action run (skipped due to only_if)
      * template[/opt/gitlab/sv/prometheus/check] action create (skipped due to only_if)
      * template[/opt/gitlab/sv/prometheus/finish] action create (skipped due to only_if)
      * directory[/opt/gitlab/sv/prometheus/control] action create (up to date)
      * link[/opt/gitlab/init/prometheus] action create (up to date)
      * file[/opt/gitlab/sv/prometheus/down] action nothing (skipped due to action :nothing)
      * directory[/opt/gitlab/service] action create (up to date)
      * link[/opt/gitlab/service/prometheus] action create[2025-07-12T20:47:23+03:00] INFO: link[/opt/gitlab/service/prometheus] created

        [32m- create symlink at /opt/gitlab/service/prometheus to /opt/gitlab/sv/prometheus[0m
      * ruby_block[wait for prometheus service socket] action run[2025-07-12T20:47:27+03:00] INFO: ruby_block[wait for prometheus service socket] called

        [32m- execute the ruby block wait for prometheus service socket[0m
      * file[/var/log/gitlab/prometheus/current] action touch (skipped due to only_if)
[2025-07-12T20:47:28+03:00] INFO: ruby_block[reload_log_service] called
      [32m- execute the ruby block reload_log_service[0m
[2025-07-12T20:47:28+03:00] INFO: template[/opt/gitlab/sv/prometheus/log/run] sending run action to ruby_block[restart_log_service] (delayed)
    * ruby_block[restart_log_service] action run
      * ruby_block[restart_service] action nothing (skipped due to action :nothing)
      * ruby_block[restart_log_service] action nothing (skipped due to action :nothing)
      * ruby_block[reload_log_service] action nothing (skipped due to action :nothing)
      * directory[/opt/gitlab/sv/prometheus] action create (up to date)
      * template[/opt/gitlab/sv/prometheus/run] action create (up to date)
      * directory[/opt/gitlab/sv/prometheus/log] action create (up to date)
      * directory[/opt/gitlab/sv/prometheus/log/main] action create (up to date)
      * template[/opt/gitlab/sv/prometheus/log/config] action create (up to date)
      * ruby_block[verify_chown_persisted_on_prometheus] action nothing (skipped due to action :nothing)
      * link[/var/log/gitlab/prometheus/config] action create (up to date)
      * template[/opt/gitlab/sv/prometheus/log/run] action create (up to date)
      * directory[/opt/gitlab/sv/prometheus/env] action create (up to date)
      * ruby_block[Delete unmanaged env files for prometheus service] action run (skipped due to only_if)
      * template[/opt/gitlab/sv/prometheus/check] action create (skipped due to only_if)
      * template[/opt/gitlab/sv/prometheus/finish] action create (skipped due to only_if)
      * directory[/opt/gitlab/sv/prometheus/control] action create (up to date)
      * link[/opt/gitlab/init/prometheus] action create (up to date)
      * file[/opt/gitlab/sv/prometheus/down] action nothing (skipped due to action :nothing)
      * directory[/opt/gitlab/service] action create (up to date)
      * link[/opt/gitlab/service/prometheus] action create (up to date)
      * ruby_block[wait for prometheus service socket] action run (skipped due to not_if)
      * file[/var/log/gitlab/prometheus/current] action touch (skipped due to only_if)
[2025-07-12T20:47:28+03:00] INFO: ruby_block[restart_log_service] called
      [32m- execute the ruby block restart_log_service[0m
    * directory[/opt/gitlab/service] action create (up to date)
    * link[/opt/gitlab/service/prometheus] action create (up to date)
    * ruby_block[wait for prometheus service socket] action run (skipped due to not_if)
    * file[/var/log/gitlab/prometheus/current] action touch (skipped due to only_if)
  
  * consul_service[prometheus] action delete
    * file[/var/opt/gitlab/consul/config.d/prometheus-service.json] action delete (up to date)
     (up to date)
  * execute[/opt/gitlab/bin/gitlab-ctl start prometheus] action run
    [execute] ok: run: prometheus: (pid 19005) 3s
[2025-07-12T20:47:29+03:00] INFO: execute[/opt/gitlab/bin/gitlab-ctl start prometheus] ran successfully
    [32m- execute /opt/gitlab/bin/gitlab-ctl start prometheus[0m
  * template[/var/opt/gitlab/prometheus/rules/gitlab.rules] action create[2025-07-12T20:47:29+03:00] INFO: template[/var/opt/gitlab/prometheus/rules/gitlab.rules] created file /var/opt/gitlab/prometheus/rules/gitlab.rules

    [32m- create new file /var/opt/gitlab/prometheus/rules/gitlab.rules[0m[2025-07-12T20:47:29+03:00] INFO: template[/var/opt/gitlab/prometheus/rules/gitlab.rules] updated file contents /var/opt/gitlab/prometheus/rules/gitlab.rules

    [32m- update content in file /var/opt/gitlab/prometheus/rules/gitlab.rules from none to a55956[0m
    [37m--- /var/opt/gitlab/prometheus/rules/gitlab.rules	2025-07-12 20:47:29.631562119 +0300[0m
    [37m+++ /var/opt/gitlab/prometheus/rules/.chef-gitlab20250712-17810-t3o27f.rules	2025-07-12 20:47:29.631562119 +0300[0m
    [37m@@ -1,492 +1,984 @@[0m
    [37m+---[0m
    [37m+groups:[0m
    [37m+- name: GitLab[0m
    [37m+  rules:[0m
    [37m+  - record: instance:puma_utilization:ratio[0m
    [37m+    expr: >[0m
    [37m+      sum by (instance) ([0m
    [37m+        puma_active_connections[0m
    [37m+      ) /[0m
    [37m+      sum by (instance) ([0m
    [37m+        puma_max_threads[0m
    [37m+      )[0m
    [37m+  - record: job_route_method_code:gitlab_workhorse_http_request_duration_seconds_count:rate5m[0m
    [37m+    expr: >[0m
    [37m+      sum by (job, route, method, code) ([0m
    [37m+        rate(gitlab_workhorse_http_request_duration_seconds_count[5m])[0m
    [37m+      )[0m
    [37m+[0m
    [37m+  - alert: ServiceDown[0m
    [37m+    expr: avg_over_time(up[5m]) * 100 < 50[0m
    [37m+    annotations:[0m
    [37m+      description: The service {{ $labels.job }} instance {{ $labels.instance }} is[0m
    [37m+        not responding for more than 50% of the time for 5 minutes.[0m
    [37m+      summary: The service {{ $labels.job }} is not responding[0m
    [37m+  - alert: RedisDown[0m
    [37m+    expr: avg_over_time(redis_up[5m]) * 100 < 50[0m
    [37m+    annotations:[0m
    [37m+      description: The Redis service {{ $labels.job }} instance {{ $labels.instance[0m
    [37m+        }} is not responding for more than 50% of the time for 5 minutes.[0m
    [37m+      summary: The Redis service {{ $labels.job }} is not responding[0m
    [37m+  - alert: PostgresDown[0m
    [37m+    expr: avg_over_time(pg_up[5m]) * 100 < 50[0m
    [37m+    annotations:[0m
    [37m+      description: The Postgres service {{ $labels.job }} instance {{ $labels.instance[0m
    [37m+        }} is not responding for more than 50% of the time for 5 minutes.[0m
    [37m+      summary: The Postgres service {{ $labels.job }} is not responding[0m
    [37m+  - alert: PumaQueueing[0m
    [37m+    expr: avg_over_time(puma_queued_connections[30m]) > 1[0m
    [37m+    annotations:[0m
    [37m+      description: Puma instance {{ $labels.instance }} is queueing requests with[0m
    [37m+        an average of {{ $value | printf "%.1f" }} over the last 30 minutes.[0m
    [37m+      summary: Puma is queueing requests[0m
    [37m+  - alert: HighPumaUtilization[0m
    [37m+    expr: instance:puma_utilization:ratio * 100 > 90[0m
    [37m+    for: 60m[0m
    [37m+    annotations:[0m
    [37m+      description: Puma instance {{ $labels.instance }} has more than 90% thread utilization ({{ $value | printf "%.1f" }}%) over the last 60 minutes.[0m
    [37m+      summary: Puma is has high utilization[0m
    [37m+  - alert: SidekiqJobsQueuing[0m
    [37m+    expr: sum by (name) (sidekiq_queue_size) > 0[0m
    [37m+    for: 60m[0m
    [37m+    annotations:[0m
    [37m+      summary: Sidekiq has jobs queued[0m
    [37m+      description: Sidekiq queue {{ $labels.name }} has {{ $value }} jobs queued for 60 minutes.[0m
    [37m+  - alert: HighgRPCResourceExhaustedRate[0m
    [37m+    expr: >[0m
    [37m+      sum without (grpc_code, grpc_method, grpc_service, grpc_type) ([0m
    [37m+        rate(grpc_server_handled_total{grpc_code="ResourceExhausted"}[5m])[0m
    [37m+      ) /[0m
    [37m+      sum without (grpc_code, grpc_method, grpc_service, grpc_type) ([0m
    [37m+        rate(grpc_server_handled_total[5m])[0m
    [37m+      ) * 100 > 1[0m
    [37m+    for: 60m[0m
    [37m+    annotations:[0m
    [37m+      summary: High gRPC ResourceExhausted error rate[0m
    [37m+      description: Job {{ $labels.job }} instance {{ $labels.instance }} gRPC is returning more than 1% ({{ $value | printf "%.1f" }}%) ResourceExhausted errors over the last 60 minutes.[0m
    [37m+  - alert: PostgresDatabaseDeadlocks[0m
    [37m+    expr: increase(pg_stat_database_deadlocks[5m]) > 0[0m
    [37m+    annotations:[0m
    [37m+      summary: Postgres database has deadlocks[0m
    [37m+      description: Postgres database {{ $labels.instance }} had {{ $value | printf "%d" }} deadlocks in the last 5 minutes.[0m
    [37m+  - alert: PostgresDatabaseDeadlockCancels[0m
    [37m+    expr: increase(pg_stat_database_deadlocks[5m]) > 0[0m
    [37m+    annotations:[0m
    [37m+      summary: Postgres database has queries canceled due to deadlocks[0m
    [37m+      description: Postgres database {{ $labels.instance }} had {{ $value | printf "%d" }} queries canceled due to deadlocks in the last 5 minutes.[0m
    [37m+  # Low-traffic - < 10 QPS (600 RPM)[0m
    [37m+  - alert: WorkhorseHighErrorRate[0m
    [37m+    expr: >[0m
    [37m+      ([0m
    [37m+        sum without (job, code) ([0m
    [37m+          job_route_method_code:gitlab_workhorse_http_request_duration_seconds_count:rate5m{code=~"5.."}[0m
    [37m+        ) /[0m
    [37m+        sum without (job,code) ([0m
    [37m+          job_route_method_code:gitlab_workhorse_http_request_duration_seconds_count:rate5m[0m
    [37m+        ) < 10[0m
    [37m+      ) * 100 > 50[0m
    [37m+    annotations:[0m
    [37m+      summary: Workhorse has high error rates[0m
    [37m+      description: Workhorse route {{ $labels.route }} method {{ $labels.method }} has more than 50% errors ({{ $value | printf "%.1f" }}%) for the last 60 minutes.[0m
    [37m+  # High-traffic - >= 10 QPS (600 RPM)[0m
    [37m+  - alert: WorkhorseHighErrorRate[0m
    [37m+    expr: >[0m
    [37m+      ([0m
    [37m+        sum without (job, code) ([0m
    [37m+          job_route_method_code:gitlab_workhorse_http_request_duration_seconds_count:rate5m{code=~"5.."}[0m
    [37m+        ) /[0m
    [37m+        sum without (job,code) ([0m
    [37m+          job_route_method_code:gitlab_workhorse_http_request_duration_seconds_count:rate5m[0m
    [37m+        ) > 10[0m
    [37m+      ) * 100 > 10[0m
    [37m+    annotations:[0m
    [37m+      summary: Workhorse has high error rates[0m
    [37m+      description: Workhorse route {{ $labels.route }} method {{ $labels.method }} has more than 10% errors ({{ $value | printf "%.1f" }}%) for the last 60 minutes.[0m
    [37m+[0m
    [37m+###[0m
    [37m+# These metrics are top-level GitLab Service Level Indicators (SLIs). They can[0m
    [37m+# be used to monitor the overall health of a GitLab instance.[0m
    [37m+- name: Service Level Indicators[0m
    [37m+  interval: 30s[0m
    [37m+  rules:[0m
    [37m+  # Service availability.[0m
    [37m+  - record: gitlab_sli:job:availability:ratio[0m
    [37m+    expr: >[0m
    [37m+      avg by (job) ([0m
    [37m+        avg_over_time(up[30s])[0m
    [37m+      )[0m
    [37m+  # Rails worker/thread capacity.[0m
    [37m+  - record: gitlab_sli:rails_active_connections:avg30s[0m
    [37m+    expr: >[0m
    [37m+      sum(avg_over_time(puma_active_connections[30s]))[0m
    [37m+  - record: gitlab_sli:rails_queued_connections:avg30s[0m
    [37m+    expr: >[0m
    [37m+      sum(avg_over_time(puma_queued_connections[30s]))[0m
    [37m+  - record: gitlab_sli:rails_active_connections:max30s[0m
    [37m+    expr: >[0m
    [37m+      sum(max_over_time(puma_active_connections[30s]))[0m
    [37m+  - record: gitlab_sli:rails_queued_connections:max30s[0m
    [37m+    expr: >[0m
    [37m+      sum(max_over_time(puma_queued_connections[30s]))[0m
    [37m+  - record: gitlab_sli:rails_workers:avg30s[0m
    [37m+    expr: >[0m
    [37m+      count(avg_over_time(ruby_memory_bytes[30s])) or[0m
    [37m+      sum(avg_over_time(puma_max_threads[30s]))[0m
    [37m+  # Redis CPU use.[0m
    [37m+  - record: gitlab_sli:redis_cpu_seconds:rate1m[0m
    [37m+    expr: >[0m
    [37m+      (sum(rate(redis_used_cpu_sys[1m])) + sum(rate(redis_used_cpu_user[1m]))) or[0m
    [37m+      (sum(rate(redis_cpu_sys_seconds_total[1m])) + sum(rate(redis_cpu_user_seconds_total[1m])))[0m
    [37m+  # Workhorse traffic.[0m
    [37m+  - record: gitlab_sli:code_method_route:workhorse_http_request_count:rate1m[0m
    [37m+    expr: >[0m
    [37m+      sum by (code,method,route) ([0m
    [37m+        rate(gitlab_workhorse_http_request_duration_seconds_count[1m])[0m
    [37m+      )[0m
    [37m+  - record: gitlab_sli:code_method_route:workhorse_http_request_duration_seconds:rate1m[0m
    [37m+    expr: >[0m
    [37m+      sum by (code,method,route) ([0m
    [37m+        rate(gitlab_workhorse_http_request_duration_seconds_sum[1m])[0m
    [37m+      )[0m
    [37m+# SLI - Apdex[0m
    [37m+- name: Service Level Indicators - Apdex[0m
    [37m+  interval: 1m[0m
    [37m+  rules:[0m
    [37m+  # Gitaly goserver[0m
    [37m+  # Satisfied -> 0.5 seconds[0m
    [37m+  # Acceptable -> 1 seconds[0m
    [37m+  - record: gitlab_sli:gitlab_component_apdex:ratio[0m
    [37m+    labels:[0m
    [37m+      job: gitaly[0m
    [37m+    expr: >[0m
    [37m+      ([0m
    [37m+        sum(rate(grpc_server_handling_seconds_bucket{job="gitaly",grpc_type="unary",le="0.5",grpc_method!~"GarbageCollect|Fsck|RepackFull|RepackIncremental|CommitLanguages|CreateRepositoryFromURL|UserRebase|UserSquash|CreateFork|UserUpdateBranch|FindRemoteRepository|UserCherryPick|FetchRemote|UserRevert|FindRemoteRootRef"}[1m]))[0m
    [37m+        +[0m
    [37m+        sum(rate(grpc_server_handling_seconds_bucket{job="gitaly",grpc_type="unary",le="1",grpc_method!~"GarbageCollect|Fsck|RepackFull|RepackIncremental|CommitLanguages|CreateRepositoryFromURL|UserRebase|UserSquash|CreateFork|UserUpdateBranch|FindRemoteRepository|UserCherryPick|FetchRemote|UserRevert|FindRemoteRootRef"}[1m]))[0m
    [37m+      )[0m
    [37m+      /[0m
    [37m+      2 / sum(rate(grpc_server_handling_seconds_count{job="gitaly",grpc_type="unary",grpc_method!~"GarbageCollect|Fsck|RepackFull|RepackIncremental|CommitLanguages|CreateRepositoryFromURL|UserRebase|UserSquash|CreateFork|UserUpdateBranch|FindRemoteRepository|UserCherryPick|FetchRemote|UserRevert|FindRemoteRootRef"}[1m]))[0m
    [37m+  # Sidekiq TODO: https://gitlab.com/gitlab-org/gitlab-foss/issues/56752[0m
    [37m+  # - record: gitlab_sli:gitlab_component_apdex:ratio[0m
    [37m+  #   labels:[0m
    [37m+  #     job: gitlab-sidekiq[0m
    [37m+  #   expr: >[0m
    [37m+  #     ([0m
    [37m+  #       sum(rate(sidekiq_jobs_completion_time_seconds_bucket{le="25"}[1m]))[0m
    [37m+  #       +[0m
    [37m+  #       sum(rate(sidekiq_jobs_completion_time_seconds_bucket{le="50"}[1m]))[0m
    [37m+  #     )[0m
    [37m+  #     / 2[0m
    [37m+  #     /[0m
    [37m+  #     sum(rate(sidekiq_jobs_completion_time_seconds_count[1m]))[0m
    [37m+[0m
    [37m+  # Workhorse[0m
    [37m+  # Satisfied -> 1 seconds[0m
    [37m+  # Acceptable -> 10 seconds[0m
    [37m+  - record: gitlab_sli:gitlab_component_apdex:ratio[0m
    [37m+    labels:[0m
    [37m+      job: gitlab-workhorse[0m
    [37m+    expr: >[0m
    [37m+      ([0m
    [37m+        sum(rate(gitlab_workhorse_http_request_duration_seconds_bucket{le="1",route!="^/([^/]+/){1,}[^/]+/uploads\\z",route!="^/api/v4/jobs/request\\z"}[1m]))[0m
    [37m+      +[0m
    [37m+        sum(rate(gitlab_workhorse_http_request_duration_seconds_bucket{le="10",route!="^/([^/]+/){1,}[^/]+/uploads\\z",route!="^/api/v4/jobs/request\\z"}[1m]))[0m
    [37m+      )[0m
    [37m+      /[0m
    [37m+      2 / sum(rate(gitlab_workhorse_http_request_duration_seconds_count{route!="^/([^/]+/){1,}[^/]+/uploads\\z",route!="^/api/v4/jobs/request\\z"}[1m]))[0m
    [37m+[0m
    [37m+# SLI - Errors[0m
    [37m+- name: Service Level Indicators - Errors[0m
    [37m+  interval: 1m[0m
    [37m+  rules:[0m
    [37m+  # PostgreSQL[0m
    [37m+  - record: gitlab_sli:gitlab_component_ops:rate[0m
    [37m+    labels:[0m
    [37m+      job: postgres[0m
    [37m+    expr: >[0m
    [37m+      sum(rate(pg_stat_database_xact_commit[1m])) +[0m
    [37m+      sum(rate(pg_stat_database_xact_rollback[1m]))[0m
    [37m+  - record: gitlab_sli:gitlab_component_errors:rate[0m
    [37m+    labels:[0m
    [37m+      job: postgres[0m
    [37m+    expr: sum(rate(pg_stat_database_xact_rollback[1m]))[0m
    [37m+  # Rails (Puma)[0m
    [37m+  - record: gitlab_sli:gitlab_component_ops:rate[0m
    [37m+    labels:[0m
    [37m+      job: gitlab-rails[0m
    [37m+    expr: >[0m
    [37m+      sum([0m
    [37m+        rate(http_request_duration_seconds_count{job="gitlab-rails"}[1m])[0m
    [37m+      )[0m
    [37m+  - record: gitlab_sli:gitlab_component_errors:rate[0m
    [37m+    labels:[0m
    [37m+      job: gitlab-rails[0m
    [37m+    expr: >[0m
    [37m+      sum([0m
    [37m+        rate(http_request_duration_seconds_count{job="gitlab-rails",status=~"5.."}[1m])[0m
    [37m+      )[0m
    [37m+  # Sidekiq TODO: https://gitlab.com/gitlab-org/gitlab-foss/issues/56752[0m
    [37m+  # - record: gitlab_sli:gitlab_component_ops:rate[0m
    [37m+  #   labels:[0m
    [37m+  #     job: gitlab-sidekiq[0m
    [37m+  #   expr: >[0m
    [37m+  #     sum ([0m
    [37m+  #       rate(sidekiq_jobs_started_total{job="gitlab-sidekiq"}[1m])[0m
    [37m+  #     )[0m
    [37m+  # - record: gitlab_sli:gitlab_component_errors:rate[0m
    [37m+  #   labels:[0m
    [37m+  #     job: gitlab-sidekiq[0m
    [37m+  #   expr: >[0m
    [37m+  #     sum ([0m
    [37m+  #       rate(sidekiq_jobs_failed_total{job="gitlab-sidekiq"}[1m])[0m
    [37m+  #     )[0m
    [37m+  # Workhorse[0m
    [37m+  - record: gitlab_sli:gitlab_component_ops:rate[0m
    [37m+    labels:[0m
    [37m+      job: gitlab-workhorse[0m
    [37m+    expr: >[0m
    [37m+      sum([0m
    [37m+        rate(gitlab_workhorse_http_requests_total{job="gitlab-workhorse"}[1m])[0m
    [37m+      )[0m
    [37m+  - record: gitlab_sli:gitlab_component_errors:rate[0m
    [37m+    labels:[0m
    [37m+      job: gitlab-workhorse[0m
    [37m+    expr: >[0m
    [37m+      sum([0m
    [37m+        rate(gitlab_workhorse_http_requests_total{job="gitlab-workhorse",code=~"5.."}[1m])[0m
    [37m+      )[0m
    [37m+  ###[0m
    [37m+  # Calculate service error ratios[0m
    [37m+  - record: gitlab_sli:gitlab_component_errors:ratio[0m
    [37m+    expr: >[0m
    [37m+      gitlab_sli:gitlab_component_errors:rate /[0m
    [37m+      gitlab_sli:gitlab_component_ops:rate[0m
    [37m+[0m
    [37m+- name: GitLab Saturation Ratios[0m
    [37m+  interval: 1m[0m
    [37m+  rules:[0m
    [37m+  # type: *, component: cpu[0m
    [37m+  # this measures average CPU across all the cores for the entire fleet for the given service[0m
    [37m+  - record: gitlab_sli:gitlab_component_saturation:ratio[0m
    [37m+    labels:[0m
    [37m+      component: 'cpu'[0m
    [37m+    expr: >[0m
    [37m+      avg(1 - rate(node_cpu_seconds_total{mode="idle"}[1m]))[0m
    [37m+[0m
    [37m+  # type: *, component: single_node_cpu[0m
    [37m+  # this measures the maximum cpu availability across all the codes on a single server[0m
    [37m+  # this can be helpful if CPU is not even distributed across the fleet.[0m
    [37m+  - record: gitlab_sli:gitlab_component_saturation:ratio[0m
    [37m+    labels:[0m
    [37m+      component: 'single_node_cpu'[0m
    [37m+    expr: >[0m
    [37m+      max([0m
    [37m+        avg(1 - rate(node_cpu_seconds_total{mode="idle"}[1m]))[0m
    [37m+      )[0m
    [37m+[0m
    [37m+  - record: gitlab_sli:gitlab_component_saturation:ratio[0m
    [37m+    labels:[0m
    [37m+      component: 'disk_space'[0m
    [37m+    expr: >[0m
    [37m+      max([0m
    [37m+        ([0m
    [37m+          ([0m
    [37m+            node_filesystem_size_bytes{fstype=~"ext.|xfs|nfs.?"}[0m
    [37m+            -[0m
    [37m+            node_filesystem_free_bytes{fstype=~"ext.|xfs|nfs.?"}[0m
    [37m+          )[0m
    [37m+          /[0m
    [37m+          node_filesystem_size_bytes{fstype=~"ext.|xfs|nfs.?"}[0m
    [37m+        )[0m
    [37m+      )[0m
    [37m+[0m
    [37m+  - record: gitlab_sli:gitlab_component_saturation:ratio[0m
    [37m+    labels:[0m
    [37m+      component: 'memory'[0m
    [37m+    expr: max (instance:node_memory_utilization:ratio)[0m
    [37m+[0m
    [37m+  - record: gitlab_sli:gitlab_component_saturation:ratio[0m
    [37m+    labels:[0m
    [37m+      component: 'single_threaded_cpu'[0m
    [37m+    expr: >[0m
    [37m+      clamp_max([0m
    [37m+        max ([0m
    [37m+         (rate(redis_cpu_user_seconds_total[1m]) + rate(redis_cpu_sys_seconds_total[1m])) or[0m
    [37m+         (rate(redis_used_cpu_user[1m]) + rate(redis_used_cpu_sys[1m]))[0m
    [37m+        ),[0m
    [37m+        1[0m
    [37m+      )[0m
    [37m+[0m
    [37m+  - record: gitlab_sli:gitlab_component_saturation:ratio[0m
    [37m+    labels:[0m
    [37m+      component: 'connection_pool'[0m
    [37m+    expr: >[0m
    [37m+      clamp_max([0m
    [37m+        max([0m
    [37m+          max_over_time(pgbouncer_pools_server_active_connections{user="gitlab"}[1m]) /[0m
    [37m+          ([0m
    [37m+            ([0m
    [37m+              pgbouncer_pools_server_idle_connections{user="gitlab"} +[0m
    [37m+              pgbouncer_pools_server_active_connections{user="gitlab"} +[0m
    [37m+              pgbouncer_pools_server_testing_connections{user="gitlab"} +[0m
    [37m+              pgbouncer_pools_server_used_connections{user="gitlab"} +[0m
    [37m+              pgbouncer_pools_server_login_connections{user="gitlab"}[0m
    [37m+            )[0m
    [37m+            > 0[0m
    [37m+          )[0m
    [37m+      ), 1)[0m
    [37m+[0m
    [37m+  # type: postgres-delayed, postgres-archive, patroni[0m
    [37m+  - record: gitlab_sli:gitlab_component_saturation:ratio[0m
    [37m+    labels:[0m
    [37m+      component: 'active_db_connections'[0m
    [37m+    expr: >[0m
    [37m+      clamp_max([0m
    [37m+        max([0m
    [37m+          sum without(state) (pg_stat_activity_count{datname="gitlabhq_production", state!="idle"})[0m
    [37m+          /[0m
    [37m+          (sum without(state) (pg_stat_activity_count{datname="gitlabhq_production"}) > 0)[0m
    [37m+      ), 1)[0m
    [37m+[0m
    [37m+  # type: redis, redis-cache, component: redis_clients[0m
    [37m+  # Records the saturation of redis client connections against a redis fleet[0m
    [37m+  - record: gitlab_sli:gitlab_component_saturation:ratio[0m
    [37m+    labels:[0m
    [37m+      component: 'redis_clients'[0m
    [37m+    expr: >[0m
    [37m+      max([0m
    [37m+        max_over_time(redis_connected_clients[1m])[0m
    [37m+        /[0m
    [37m+        redis_config_maxclients[0m
    [37m+      )[0m
    [37m+[0m
    [37m+  # Aggregate over all components within a service using max[0m
    [37m+  - record: gitlab_sli:gitlab_service_saturation:ratio[0m
    [37m+    expr: >[0m
    [37m+      max by (component) (gitlab_sli:gitlab_component_saturation:ratio)[0m
    [37m+[0m
    [37m+  # Calculate the "sapdex" - the saturation apdex for the metric. 1 < less then soft limit, 0.5 < hard limit, else 0[0m
    [37m+  - record: gitlab_sli:gitlab_component_saturation:ratio:sapdex[0m
    [37m+    expr: >[0m
    [37m+      clamp_min(gitlab_sli:gitlab_component_saturation:ratio <= on(component) group_left slo:max:soft:gitlab_sli:gitlab_component_saturation:ratio, 1)[0m
    [37m+      or[0m
    [37m+      clamp_min(clamp_max(gitlab_sli:gitlab_component_saturation:ratio > on(component) group_left slo:max:soft:gitlab_sli:gitlab_component_saturation:ratio, 0.5), 0.5)[0m
    [37m+      or[0m
    [37m+      clamp_max(gitlab_sli:gitlab_component_saturation:ratio > on(component) group_left slo:max:hard:gitlab_sli:gitlab_component_saturation:ratio, 0)[0m
    [37m+[0m
    [37m+  # Open file descriptors[0m
    [37m+  - record: gitlab_sli:gitlab_component_saturation:ratio[0m
    [37m+    labels:[0m
    [37m+      component: 'open_fds'[0m
    [37m+    expr: >[0m
    [37m+      max([0m
    [37m+        max_over_time(process_open_fds[1m])[0m
    [37m+        /[0m
    [37m+        max_over_time(process_max_fds[1m])[0m
    [37m+      )[0m
    [37m+  - record: gitlab_sli:gitlab_component_saturation:ratio[0m
    [37m+    labels:[0m
    [37m+      component: 'open_ruby_fds'[0m
    [37m+    expr: >[0m
    [37m+      max([0m
    [37m+        max_over_time(ruby_file_descriptors[1m])[0m
    [37m+        /[0m
    [37m+        max_over_time(ruby_process_max_fds[1m])[0m
    [37m+      )[0m
    [37m+[0m
    [37m+# Unlike other service metrics, we record the stats for each component independently[0m
    [37m+- name: GitLab Saturation Ratios Stats[0m
    [37m+  interval: 5m[0m
    [37m+  rules:[0m
    [37m+  # Average values for each service, over a week[0m
    [37m+  - record: gitlab_sli:gitlab_component_saturation:ratio:avg_over_time_1w[0m
    [37m+    expr: >[0m
    [37m+      avg_over_time(gitlab_sli:gitlab_component_saturation:ratio[1w])[0m
    [37m+[0m
    [37m+  # Using linear week-on-week growth, what prediction to we have for 2w from now?[0m
    [37m+  - record: gitlab_sli:gitlab_component_saturation:ratio:predict_linear_2w[0m
    [37m+    expr: >[0m
    [37m+      predict_linear(gitlab_sli:gitlab_component_saturation:ratio:avg_over_time_1w[1w], 86400 * 14)[0m
    [37m+[0m
    [37m+  # Using linear week-on-week growth, what prediction to we have for 30d from now?[0m
    [37m+  - record: gitlab_sli:gitlab_component_saturation:ratio:predict_linear_30d[0m
    [37m+    expr: >[0m
    [37m+      predict_linear(gitlab_sli:gitlab_component_saturation:ratio:avg_over_time_1w[1w], 86400 * 30)[0m
    [37m+[0m
    [37m+  # Sapdex, average for week[0m
    [37m+  - record: gitlab_sli:gitlab_component_saturation:ratio:sapdex:avg_over_time_1w[0m
    [37m+    expr: >[0m
    [37m+      avg_over_time(gitlab_sli:gitlab_component_saturation:ratio:sapdex[1w])[0m
    [37m+[0m
    [37m+  # Sapdex long term trend forecasting[0m
    [37m+  # Using linear week-on-week growth, what prediction to we have for 30d from now?[0m
    [37m+  - record: gitlab_sli:gitlab_component_saturation:ratio:sapdex:avg_over_time_1w:predict_linear_30d[0m
    [37m+    expr: >[0m
    [37m+      predict_linear(gitlab_sli:gitlab_component_saturation:ratio:sapdex:avg_over_time_1w[1w], 86400 * 30)[0m
    [37m+[0m
    [37m+###[0m
    [37m+# Metrics used by Usage Ping reports. These are primarily for self-managed installations.[0m
    [37m+# See https://docs.gitlab.com/ee/development/telemetry/usage_ping.html#prometheus-queries[0m
    [37m+#[0m
    [37m+- name: GitLab Usage Ping[0m
    [37m+  interval: 5m[0m
    [37m+  rules:[0m
    [37m+  ###[0m
    [37m+  # Application wide metrics[0m
    [37m+  #[0m
    [37m+  - record: gitlab_usage_ping:ops:rate5m[0m
    [37m+    labels:[0m
    [37m+      service: workhorse[0m
    [37m+      component: http_requests[0m
    [37m+    expr: sum (rate (gitlab_workhorse_http_requests_total[5m]))[0m
    [37m+[0m
    [37m+  # Database Primary Performance Indicator: Query apdex[0m
    [37m+  # Target -> 100ms[0m
    [37m+  # Tolerable -> 250ms[0m
    [37m+  - record: gitlab_usage_ping:sql_duration_apdex:ratio_rate5m[0m
    [37m+    expr: >[0m
    [37m+      ([0m
    [37m+        sum(rate(gitlab_sql_duration_seconds_bucket{le="0.1"}[5m]))[0m
    [37m+        +[0m
    [37m+        sum(rate(gitlab_sql_duration_seconds_bucket{le="0.25"}[5m]))[0m
    [37m+      )[0m
    [37m+      /[0m
    [37m+      2[0m
    [37m+      /[0m
    [37m+      ([0m
    [37m+        sum(rate(gitlab_sql_duration_seconds_count[5m])) > 0[0m
    [37m+      )[0m
    [37m+[0m
    [37m+  - record: gitlab_usage_ping:gitaly_apdex:ratio_avg_over_time_5m[0m
    [37m+    expr: avg_over_time(gitlab_sli:gitlab_component_apdex:ratio{job="gitaly"}[5m])[0m
    [37m+[0m
    [37m+  ###[0m
    [37m+  # Node level metrics[0m
    [37m+  #[0m
    [37m+  - record: gitlab_usage_ping:node_cpus:count[0m
    [37m+    expr: max (instance:node_cpus:count) by (instance)[0m
    [37m+  - record: gitlab_usage_ping:node_memory_total_bytes:max[0m
    [37m+    expr: max (node_memory_MemTotal_bytes) by (instance)[0m
    [37m+  - record: gitlab_usage_ping:node_cpu_utilization:avg[0m
    [37m+    expr: avg (instance:node_cpu_utilization:ratio) by (instance)[0m
    [37m+  - record: gitlab_usage_ping:node_memory_utilization:avg[0m
    [37m+    expr: avg (instance:node_memory_utilization:ratio) by (instance)[0m
    [37m+[0m
    [37m+  ###[0m
    [37m+  # Service level metrics[0m
    [37m+  #[0m
    [37m+  - record: gitlab_usage_ping:node_service_process_resident_memory_bytes:avg[0m
    [37m+    expr: avg by (instance, job) ({__name__ =~ "(ruby_){0,1}process_resident_memory_bytes", job != "gitlab_exporter_process"})[0m
    [37m+  - record: gitlab_usage_ping:node_service_process_unique_memory_bytes:avg[0m
    [37m+    expr: avg by (instance, job) ({__name__ =~ "(ruby_){0,1}process_unique_memory_bytes", job != "gitlab_exporter_process"})[0m
    [37m+  - record: gitlab_usage_ping:node_service_process_proportional_memory_bytes:avg[0m
    [37m+    expr: avg by (instance, job) ({__name__ =~ "(ruby_){0,1}process_proportional_memory_bytes", job != "gitlab_exporter_process"})[0m
    [37m+  - record: gitlab_usage_ping:node_service_process:count[0m
    [37m+    expr: >[0m
    [37m+      count by (instance, job) ([0m
    [37m+        {__name__ =~ "(ruby_){0,1}process_start_time_seconds", job != "gitlab_exporter_process"}[0m
    [37m+      )[0m
    [37m+  - record: gitlab_usage_ping:node_service_app_server_workers:sum[0m
    [37m+    labels:[0m
    [37m+      server: puma[0m
    [37m+    expr: sum by (instance, job) (puma_workers)[0m[2025-07-12T20:47:29+03:00] INFO: template[/var/opt/gitlab/prometheus/rules/gitlab.rules] owner changed to 991
[2025-07-12T20:47:29+03:00] INFO: template[/var/opt/gitlab/prometheus/rules/gitlab.rules] mode changed to 644

    [32m- change mode from '' to '0644'[0m
    [32m- change owner from '' to 'gitlab-prometheus'[0m
[2025-07-12T20:47:29+03:00] INFO: template[/var/opt/gitlab/prometheus/rules/gitlab.rules] not queuing delayed action run on execute[reload prometheus] (delayed), as it's already been queued
  * template[/var/opt/gitlab/prometheus/rules/node.rules] action create[2025-07-12T20:47:29+03:00] INFO: template[/var/opt/gitlab/prometheus/rules/node.rules] created file /var/opt/gitlab/prometheus/rules/node.rules

    [32m- create new file /var/opt/gitlab/prometheus/rules/node.rules[0m[2025-07-12T20:47:29+03:00] INFO: template[/var/opt/gitlab/prometheus/rules/node.rules] updated file contents /var/opt/gitlab/prometheus/rules/node.rules

    [32m- update content in file /var/opt/gitlab/prometheus/rules/node.rules from none to bea78d[0m
    [37m--- /var/opt/gitlab/prometheus/rules/node.rules	2025-07-12 20:47:29.659548119 +0300[0m
    [37m+++ /var/opt/gitlab/prometheus/rules/.chef-node20250712-17810-kzr9eb.rules	2025-07-12 20:47:29.659548119 +0300[0m
    [37m@@ -1,42 +1,84 @@[0m
    [37m+groups:[0m
    [37m+- name: Node[0m
    [37m+  rules:[0m
    [37m+  - record: instance:node_cpus:count[0m
    [37m+    expr: count without(cpu, mode) (node_cpu{mode="idle"})[0m
    [37m+  - record: instance:node_cpus:count[0m
    [37m+    expr: count without(cpu, mode) (node_cpu_seconds_total{mode="idle"})[0m
    [37m+  - record: instance_cpu:node_cpu_seconds_not_idle:rate5m[0m
    [37m+    expr: sum without(mode) (rate(node_cpu{mode!="idle"}[5m]))[0m
    [37m+  - record: instance_cpu:node_cpu_seconds_not_idle:rate5m[0m
    [37m+    expr: sum without(mode) (rate(node_cpu_seconds_total{mode!="idle"}[5m]))[0m
    [37m+  - record: instance_mode:node_cpu_seconds:rate5m[0m
    [37m+    expr: sum without(cpu) (rate(node_cpu[5m]))[0m
    [37m+  - record: instance_mode:node_cpu_seconds:rate5m[0m
    [37m+    expr: sum without(cpu) (rate(node_cpu_seconds_total[5m]))[0m
    [37m+  - record: instance:node_cpu_utilization:ratio[0m
    [37m+    expr: sum without(mode) (instance_mode:node_cpu_seconds:rate5m{mode!="idle"})[0m
    [37m+      / instance:node_cpus:count[0m
    [37m+  - record: instance:node_memory_utilization:ratio[0m
    [37m+    expr: >[0m
    [37m+      1 - ([0m
    [37m+        node_memory_MemAvailable_bytes or[0m
    [37m+         (node_memory_MemFree_bytes + node_memory_Buffers_bytes + node_memory_Cached_bytes)[0m
    [37m+      ) / node_memory_MemTotal_bytes[0m
    [37m+  - record: instance:node_filesystem_avail:ratio[0m
    [37m+    expr: node_filesystem_avail_bytes / (node_filesystem_size_bytes > 0)[0m
    [37m+  - alert: FilesystemAlmostFull[0m
    [37m+    expr: instance:node_filesystem_avail:ratio * 100 < 5 and node_filesystem_avail_bytes < 10 * 1024 * 1024 * 1024[0m
    [37m+    for: 10m[0m
    [37m+    annotations:[0m
    [37m+      description: The filesystem {{ $labels.device }}:{{ $labels.mountpoint }} on[0m
    [37m+        {{ $labels.instance }} has {{ $value | printf "%.2f" }}% space available.[0m
    [37m+      summary: The filesystem {{ $labels.device }}:{{ $labels.mountpoint }} is almost[0m
    [37m+        full[0m
    [37m+  - alert: FilesystemFullIn1Day[0m
    [37m+    expr: predict_linear(node_filesystem_avail_bytes[6h], 24 * 3600) < 0[0m
    [37m+    for: 30m[0m
    [37m+    annotations:[0m
    [37m+      description: The filesystem {{ $labels.device }}:{{ $labels.mountpoint }} on[0m
    [37m+        {{ $labels.instance }} will be full in the next 24 hours.[0m
    [37m+      summary: The filesystem {{ $labels.device }}:{{ $labels.mountpoint }} will be[0m
    [37m+        full within 24 hours[0m[2025-07-12T20:47:29+03:00] INFO: template[/var/opt/gitlab/prometheus/rules/node.rules] owner changed to 991
[2025-07-12T20:47:29+03:00] INFO: template[/var/opt/gitlab/prometheus/rules/node.rules] mode changed to 644

    [32m- change mode from '' to '0644'[0m
    [32m- change owner from '' to 'gitlab-prometheus'[0m
[2025-07-12T20:47:29+03:00] INFO: template[/var/opt/gitlab/prometheus/rules/node.rules] not queuing delayed action run on execute[reload prometheus] (delayed), as it's already been queued
Recipe: monitoring::alertmanager
  * directory[/var/opt/gitlab/alertmanager] action create[2025-07-12T20:47:29+03:00] INFO: directory[/var/opt/gitlab/alertmanager] created directory /var/opt/gitlab/alertmanager

    [32m- create new directory /var/opt/gitlab/alertmanager[0m[2025-07-12T20:47:29+03:00] INFO: directory[/var/opt/gitlab/alertmanager] owner changed to 991
[2025-07-12T20:47:29+03:00] INFO: directory[/var/opt/gitlab/alertmanager] mode changed to 750

    [32m- change mode from '' to '0750'[0m
    [32m- change owner from '' to 'gitlab-prometheus'[0m
  * directory[/var/log/gitlab/alertmanager] action create[2025-07-12T20:47:29+03:00] INFO: directory[/var/log/gitlab/alertmanager] created directory /var/log/gitlab/alertmanager

    [32m- create new directory /var/log/gitlab/alertmanager[0m[2025-07-12T20:47:29+03:00] INFO: directory[/var/log/gitlab/alertmanager] owner changed to 991
[2025-07-12T20:47:29+03:00] INFO: directory[/var/log/gitlab/alertmanager] mode changed to 700

    [32m- change mode from '' to '0700'[0m
    [32m- change owner from '' to 'gitlab-prometheus'[0m
  * directory[/opt/gitlab/etc/alertmanager/env] action create[2025-07-12T20:47:29+03:00] INFO: directory[/opt/gitlab/etc/alertmanager/env] created directory /opt/gitlab/etc/alertmanager/env

    [32m- create new directory /opt/gitlab/etc/alertmanager/env[0m[2025-07-12T20:47:29+03:00] INFO: directory[/opt/gitlab/etc/alertmanager/env] owner changed to 991
[2025-07-12T20:47:29+03:00] INFO: directory[/opt/gitlab/etc/alertmanager/env] mode changed to 700

    [32m- change mode from '' to '0700'[0m
    [32m- change owner from '' to 'gitlab-prometheus'[0m
  * env_dir[/opt/gitlab/etc/alertmanager/env] action create
    * directory[/opt/gitlab/etc/alertmanager/env] action create (up to date)
    * file[/opt/gitlab/etc/alertmanager/env/SSL_CERT_DIR] action create[2025-07-12T20:47:29+03:00] INFO: file[/opt/gitlab/etc/alertmanager/env/SSL_CERT_DIR] created file /opt/gitlab/etc/alertmanager/env/SSL_CERT_DIR

      [32m- create new file /opt/gitlab/etc/alertmanager/env/SSL_CERT_DIR[0m[2025-07-12T20:47:29+03:00] INFO: file[/opt/gitlab/etc/alertmanager/env/SSL_CERT_DIR] updated file contents /opt/gitlab/etc/alertmanager/env/SSL_CERT_DIR

      [32m- update content in file /opt/gitlab/etc/alertmanager/env/SSL_CERT_DIR from none to 4f45cf[0m
      [32m- suppressed sensitive resource[0m
  
  * file[Alertmanager config] action create[2025-07-12T20:47:29+03:00] INFO: file[Alertmanager config] created file /var/opt/gitlab/alertmanager/alertmanager.yml

    [32m- create new file /var/opt/gitlab/alertmanager/alertmanager.yml[0m[2025-07-12T20:47:29+03:00] INFO: file[Alertmanager config] updated file contents /var/opt/gitlab/alertmanager/alertmanager.yml

    [32m- update content in file /var/opt/gitlab/alertmanager/alertmanager.yml from none to 21b7be[0m
    [32m- suppressed sensitive resource[0m[2025-07-12T20:47:29+03:00] INFO: file[Alertmanager config] owner changed to 991
[2025-07-12T20:47:29+03:00] INFO: file[Alertmanager config] mode changed to 644

    [32m- change mode from '' to '0644'[0m
    [32m- change owner from '' to 'gitlab-prometheus'[0m
[2025-07-12T20:47:29+03:00] INFO: file[Alertmanager config] not queuing delayed action restart on runit_service[alertmanager] (delayed), as it's already been queued
  * service[alertmanager] action nothing (skipped due to action :nothing)
  * runit_service[alertmanager] action enable
    * ruby_block[restart_service] action nothing (skipped due to action :nothing)
    * ruby_block[restart_log_service] action nothing (skipped due to action :nothing)
    * ruby_block[reload_log_service] action nothing (skipped due to action :nothing)
    * directory[/opt/gitlab/sv/alertmanager] action create[2025-07-12T20:47:29+03:00] INFO: directory[/opt/gitlab/sv/alertmanager] created directory /opt/gitlab/sv/alertmanager

      [32m- create new directory /opt/gitlab/sv/alertmanager[0m[2025-07-12T20:47:29+03:00] INFO: directory[/opt/gitlab/sv/alertmanager] owner changed to 0
[2025-07-12T20:47:29+03:00] INFO: directory[/opt/gitlab/sv/alertmanager] group changed to 0
[2025-07-12T20:47:29+03:00] INFO: directory[/opt/gitlab/sv/alertmanager] mode changed to 755

      [32m- change mode from '' to '0755'[0m
      [32m- change owner from '' to 'root'[0m
      [32m- change group from '' to 'root'[0m
    * template[/opt/gitlab/sv/alertmanager/run] action create[2025-07-12T20:47:29+03:00] INFO: template[/opt/gitlab/sv/alertmanager/run] created file /opt/gitlab/sv/alertmanager/run

      [32m- create new file /opt/gitlab/sv/alertmanager/run[0m[2025-07-12T20:47:29+03:00] INFO: template[/opt/gitlab/sv/alertmanager/run] updated file contents /opt/gitlab/sv/alertmanager/run

      [32m- update content in file /opt/gitlab/sv/alertmanager/run from none to 36da8b[0m
      [37m--- /opt/gitlab/sv/alertmanager/run	2025-07-12 20:47:29.711522119 +0300[0m
      [37m+++ /opt/gitlab/sv/alertmanager/.chef-run20250712-17810-xnwvif	2025-07-12 20:47:29.711522119 +0300[0m
      [37m@@ -1,8 +1,16 @@[0m
      [37m+#!/bin/sh[0m
      [37m+exec 2>&1[0m
      [37m+[0m
      [37m+umask 077[0m
      [37m+exec chpst -P -e /opt/gitlab/etc/alertmanager/env \[0m
      [37m+  -U gitlab-prometheus:gitlab-prometheus \[0m
      [37m+  -u gitlab-prometheus:gitlab-prometheus \[0m
      [37m+  /opt/gitlab/embedded/bin/alertmanager --web.listen-address=localhost:9093 --storage.path=/var/opt/gitlab/alertmanager/data --config.file=/var/opt/gitlab/alertmanager/alertmanager.yml[0m[2025-07-12T20:47:29+03:00] INFO: template[/opt/gitlab/sv/alertmanager/run] owner changed to 0
[2025-07-12T20:47:29+03:00] INFO: template[/opt/gitlab/sv/alertmanager/run] group changed to 0
[2025-07-12T20:47:29+03:00] INFO: template[/opt/gitlab/sv/alertmanager/run] mode changed to 755

      [32m- change mode from '' to '0755'[0m
      [32m- change owner from '' to 'root'[0m
      [32m- change group from '' to 'root'[0m
    * directory[/opt/gitlab/sv/alertmanager/log] action create[2025-07-12T20:47:29+03:00] INFO: directory[/opt/gitlab/sv/alertmanager/log] created directory /opt/gitlab/sv/alertmanager/log

      [32m- create new directory /opt/gitlab/sv/alertmanager/log[0m[2025-07-12T20:47:29+03:00] INFO: directory[/opt/gitlab/sv/alertmanager/log] owner changed to 0
[2025-07-12T20:47:29+03:00] INFO: directory[/opt/gitlab/sv/alertmanager/log] group changed to 0
[2025-07-12T20:47:29+03:00] INFO: directory[/opt/gitlab/sv/alertmanager/log] mode changed to 755

      [32m- change mode from '' to '0755'[0m
      [32m- change owner from '' to 'root'[0m
      [32m- change group from '' to 'root'[0m
    * directory[/opt/gitlab/sv/alertmanager/log/main] action create[2025-07-12T20:47:29+03:00] INFO: directory[/opt/gitlab/sv/alertmanager/log/main] created directory /opt/gitlab/sv/alertmanager/log/main

      [32m- create new directory /opt/gitlab/sv/alertmanager/log/main[0m[2025-07-12T20:47:29+03:00] INFO: directory[/opt/gitlab/sv/alertmanager/log/main] owner changed to 0
[2025-07-12T20:47:29+03:00] INFO: directory[/opt/gitlab/sv/alertmanager/log/main] group changed to 0
[2025-07-12T20:47:29+03:00] INFO: directory[/opt/gitlab/sv/alertmanager/log/main] mode changed to 755

      [32m- change mode from '' to '0755'[0m
      [32m- change owner from '' to 'root'[0m
      [32m- change group from '' to 'root'[0m
    * template[/opt/gitlab/sv/alertmanager/log/config] action create[2025-07-12T20:47:29+03:00] INFO: template[/opt/gitlab/sv/alertmanager/log/config] created file /opt/gitlab/sv/alertmanager/log/config

      [32m- create new file /opt/gitlab/sv/alertmanager/log/config[0m[2025-07-12T20:47:29+03:00] INFO: template[/opt/gitlab/sv/alertmanager/log/config] updated file contents /opt/gitlab/sv/alertmanager/log/config

      [32m- update content in file /opt/gitlab/sv/alertmanager/log/config from none to 623c00[0m
      [37m--- /opt/gitlab/sv/alertmanager/log/config	2025-07-12 20:47:29.735510119 +0300[0m
      [37m+++ /opt/gitlab/sv/alertmanager/log/.chef-config20250712-17810-zr24jz	2025-07-12 20:47:29.731512119 +0300[0m
      [37m@@ -1,6 +1,12 @@[0m
      [37m+s209715200[0m
      [37m+n30[0m
      [37m+t86400[0m
      [37m+!gzip[0m
      [37m+[0m
      [37m+[0m[2025-07-12T20:47:29+03:00] INFO: template[/opt/gitlab/sv/alertmanager/log/config] owner changed to 0
[2025-07-12T20:47:29+03:00] INFO: template[/opt/gitlab/sv/alertmanager/log/config] group changed to 0
[2025-07-12T20:47:29+03:00] INFO: template[/opt/gitlab/sv/alertmanager/log/config] mode changed to 644

      [32m- change mode from '' to '0644'[0m
      [32m- change owner from '' to 'root'[0m
      [32m- change group from '' to 'root'[0m
    * ruby_block[verify_chown_persisted_on_alertmanager] action nothing (skipped due to action :nothing)
[2025-07-12T20:47:29+03:00] INFO: ruby_block[verify_chown_persisted_on_alertmanager] sent create action to ruby_block[verify_chown_persisted_on_alertmanager] (immediate at declaration time)
    * ruby_block[verify_chown_persisted_on_alertmanager] action create[2025-07-12T20:47:29+03:00] INFO: ruby_block[verify_chown_persisted_on_alertmanager] called

      [32m- execute the ruby block verify_chown_persisted_on_alertmanager[0m
    * link[/var/log/gitlab/alertmanager/config] action create[2025-07-12T20:47:29+03:00] INFO: link[/var/log/gitlab/alertmanager/config] created

      [32m- create symlink at /var/log/gitlab/alertmanager/config to /opt/gitlab/sv/alertmanager/log/config[0m
    * template[/opt/gitlab/sv/alertmanager/log/run] action create[2025-07-12T20:47:29+03:00] INFO: template[/opt/gitlab/sv/alertmanager/log/run] created file /opt/gitlab/sv/alertmanager/log/run

      [32m- create new file /opt/gitlab/sv/alertmanager/log/run[0m[2025-07-12T20:47:29+03:00] INFO: template[/opt/gitlab/sv/alertmanager/log/run] updated file contents /opt/gitlab/sv/alertmanager/log/run

      [32m- update content in file /opt/gitlab/sv/alertmanager/log/run from none to 9a4626[0m
      [37m--- /opt/gitlab/sv/alertmanager/log/run	2025-07-12 20:47:29.751502119 +0300[0m
      [37m+++ /opt/gitlab/sv/alertmanager/log/.chef-run20250712-17810-swrh0b	2025-07-12 20:47:29.751502119 +0300[0m
      [37m@@ -1,5 +1,10 @@[0m
      [37m+#!/bin/sh[0m
      [37m+exec chpst -P \[0m
      [37m+  -U root:root \[0m
      [37m+  -u root:root \[0m
      [37m+  svlogd -tt /var/log/gitlab/alertmanager[0m[2025-07-12T20:47:29+03:00] INFO: template[/opt/gitlab/sv/alertmanager/log/run] owner changed to 0
[2025-07-12T20:47:29+03:00] INFO: template[/opt/gitlab/sv/alertmanager/log/run] group changed to 0
[2025-07-12T20:47:29+03:00] INFO: template[/opt/gitlab/sv/alertmanager/log/run] mode changed to 755

      [32m- change mode from '' to '0755'[0m
      [32m- change owner from '' to 'root'[0m
      [32m- change group from '' to 'root'[0m
    * directory[/opt/gitlab/sv/alertmanager/env] action create[2025-07-12T20:47:29+03:00] INFO: directory[/opt/gitlab/sv/alertmanager/env] created directory /opt/gitlab/sv/alertmanager/env

      [32m- create new directory /opt/gitlab/sv/alertmanager/env[0m[2025-07-12T20:47:29+03:00] INFO: directory[/opt/gitlab/sv/alertmanager/env] owner changed to 0
[2025-07-12T20:47:29+03:00] INFO: directory[/opt/gitlab/sv/alertmanager/env] group changed to 0
[2025-07-12T20:47:29+03:00] INFO: directory[/opt/gitlab/sv/alertmanager/env] mode changed to 755

      [32m- change mode from '' to '0755'[0m
      [32m- change owner from '' to 'root'[0m
      [32m- change group from '' to 'root'[0m
    * ruby_block[Delete unmanaged env files for alertmanager service] action run (skipped due to only_if)
    * template[/opt/gitlab/sv/alertmanager/check] action create (skipped due to only_if)
    * template[/opt/gitlab/sv/alertmanager/finish] action create (skipped due to only_if)
    * directory[/opt/gitlab/sv/alertmanager/control] action create[2025-07-12T20:47:29+03:00] INFO: directory[/opt/gitlab/sv/alertmanager/control] created directory /opt/gitlab/sv/alertmanager/control

      [32m- create new directory /opt/gitlab/sv/alertmanager/control[0m[2025-07-12T20:47:29+03:00] INFO: directory[/opt/gitlab/sv/alertmanager/control] owner changed to 0
[2025-07-12T20:47:29+03:00] INFO: directory[/opt/gitlab/sv/alertmanager/control] group changed to 0
[2025-07-12T20:47:29+03:00] INFO: directory[/opt/gitlab/sv/alertmanager/control] mode changed to 755

      [32m- change mode from '' to '0755'[0m
      [32m- change owner from '' to 'root'[0m
      [32m- change group from '' to 'root'[0m
    * link[/opt/gitlab/init/alertmanager] action create[2025-07-12T20:47:29+03:00] INFO: link[/opt/gitlab/init/alertmanager] created

      [32m- create symlink at /opt/gitlab/init/alertmanager to /opt/gitlab/embedded/bin/sv[0m
    * file[/opt/gitlab/sv/alertmanager/down] action nothing (skipped due to action :nothing)
[2025-07-12T20:47:29+03:00] INFO: template[/opt/gitlab/sv/alertmanager/run] sending run action to ruby_block[restart_service] (delayed)
    * ruby_block[restart_service] action run (skipped due to only_if)
[2025-07-12T20:47:29+03:00] INFO: template[/opt/gitlab/sv/alertmanager/log/config] sending create action to ruby_block[reload_log_service] (delayed)
    * ruby_block[reload_log_service] action create
      * ruby_block[restart_service] action nothing (skipped due to action :nothing)
      * ruby_block[restart_log_service] action nothing (skipped due to action :nothing)
      * ruby_block[reload_log_service] action nothing (skipped due to action :nothing)
      * directory[/opt/gitlab/sv/alertmanager] action create (up to date)
      * template[/opt/gitlab/sv/alertmanager/run] action create (up to date)
      * directory[/opt/gitlab/sv/alertmanager/log] action create (up to date)
      * directory[/opt/gitlab/sv/alertmanager/log/main] action create (up to date)
      * template[/opt/gitlab/sv/alertmanager/log/config] action create (up to date)
      * ruby_block[verify_chown_persisted_on_alertmanager] action nothing (skipped due to action :nothing)
      * link[/var/log/gitlab/alertmanager/config] action create (up to date)
      * template[/opt/gitlab/sv/alertmanager/log/run] action create (up to date)
      * directory[/opt/gitlab/sv/alertmanager/env] action create (up to date)
      * ruby_block[Delete unmanaged env files for alertmanager service] action run (skipped due to only_if)
      * template[/opt/gitlab/sv/alertmanager/check] action create (skipped due to only_if)
      * template[/opt/gitlab/sv/alertmanager/finish] action create (skipped due to only_if)
      * directory[/opt/gitlab/sv/alertmanager/control] action create (up to date)
      * link[/opt/gitlab/init/alertmanager] action create (up to date)
      * file[/opt/gitlab/sv/alertmanager/down] action nothing (skipped due to action :nothing)
      * directory[/opt/gitlab/service] action create (up to date)
      * link[/opt/gitlab/service/alertmanager] action create[2025-07-12T20:47:29+03:00] INFO: link[/opt/gitlab/service/alertmanager] created

        [32m- create symlink at /opt/gitlab/service/alertmanager to /opt/gitlab/sv/alertmanager[0m
      * ruby_block[wait for alertmanager service socket] action run[2025-07-12T20:47:33+03:00] INFO: ruby_block[wait for alertmanager service socket] called

        [32m- execute the ruby block wait for alertmanager service socket[0m
      * file[/var/log/gitlab/alertmanager/current] action touch (skipped due to only_if)
[2025-07-12T20:47:34+03:00] INFO: ruby_block[reload_log_service] called
      [32m- execute the ruby block reload_log_service[0m
[2025-07-12T20:47:34+03:00] INFO: template[/opt/gitlab/sv/alertmanager/log/run] sending run action to ruby_block[restart_log_service] (delayed)
    * ruby_block[restart_log_service] action run
      * ruby_block[restart_service] action nothing (skipped due to action :nothing)
      * ruby_block[restart_log_service] action nothing (skipped due to action :nothing)
      * ruby_block[reload_log_service] action nothing (skipped due to action :nothing)
      * directory[/opt/gitlab/sv/alertmanager] action create (up to date)
      * template[/opt/gitlab/sv/alertmanager/run] action create (up to date)
      * directory[/opt/gitlab/sv/alertmanager/log] action create (up to date)
      * directory[/opt/gitlab/sv/alertmanager/log/main] action create (up to date)
      * template[/opt/gitlab/sv/alertmanager/log/config] action create (up to date)
      * ruby_block[verify_chown_persisted_on_alertmanager] action nothing (skipped due to action :nothing)
      * link[/var/log/gitlab/alertmanager/config] action create (up to date)
      * template[/opt/gitlab/sv/alertmanager/log/run] action create (up to date)
      * directory[/opt/gitlab/sv/alertmanager/env] action create (up to date)
      * ruby_block[Delete unmanaged env files for alertmanager service] action run (skipped due to only_if)
      * template[/opt/gitlab/sv/alertmanager/check] action create (skipped due to only_if)
      * template[/opt/gitlab/sv/alertmanager/finish] action create (skipped due to only_if)
      * directory[/opt/gitlab/sv/alertmanager/control] action create (up to date)
      * link[/opt/gitlab/init/alertmanager] action create (up to date)
      * file[/opt/gitlab/sv/alertmanager/down] action nothing (skipped due to action :nothing)
      * directory[/opt/gitlab/service] action create (up to date)
      * link[/opt/gitlab/service/alertmanager] action create (up to date)
      * ruby_block[wait for alertmanager service socket] action run (skipped due to not_if)
      * file[/var/log/gitlab/alertmanager/current] action touch (skipped due to only_if)
[2025-07-12T20:47:35+03:00] INFO: ruby_block[restart_log_service] called
      [32m- execute the ruby block restart_log_service[0m
    * directory[/opt/gitlab/service] action create (up to date)
    * link[/opt/gitlab/service/alertmanager] action create (up to date)
    * ruby_block[wait for alertmanager service socket] action run (skipped due to not_if)
    * file[/var/log/gitlab/alertmanager/current] action touch (skipped due to only_if)
  
  * execute[/opt/gitlab/bin/gitlab-ctl start alertmanager] action run
    [execute] ok: run: alertmanager: (pid 19027) 4s
[2025-07-12T20:47:36+03:00] INFO: execute[/opt/gitlab/bin/gitlab-ctl start alertmanager] ran successfully
    [32m- execute /opt/gitlab/bin/gitlab-ctl start alertmanager[0m
Recipe: monitoring::postgres-exporter
  * directory[/var/log/gitlab/postgres-exporter] action create[2025-07-12T20:47:36+03:00] INFO: directory[/var/log/gitlab/postgres-exporter] created directory /var/log/gitlab/postgres-exporter

    [32m- create new directory /var/log/gitlab/postgres-exporter[0m[2025-07-12T20:47:36+03:00] INFO: directory[/var/log/gitlab/postgres-exporter] owner changed to 992
[2025-07-12T20:47:36+03:00] INFO: directory[/var/log/gitlab/postgres-exporter] mode changed to 700

    [32m- change mode from '' to '0700'[0m
    [32m- change owner from '' to 'gitlab-psql'[0m
  * directory[/var/opt/gitlab/postgres-exporter] action create[2025-07-12T20:47:36+03:00] INFO: directory[/var/opt/gitlab/postgres-exporter] created directory /var/opt/gitlab/postgres-exporter

    [32m- create new directory /var/opt/gitlab/postgres-exporter[0m[2025-07-12T20:47:36+03:00] INFO: directory[/var/opt/gitlab/postgres-exporter] owner changed to 992
[2025-07-12T20:47:36+03:00] INFO: directory[/var/opt/gitlab/postgres-exporter] mode changed to 700

    [32m- change mode from '' to '0700'[0m
    [32m- change owner from '' to 'gitlab-psql'[0m
  * env_dir[/opt/gitlab/etc/postgres-exporter/env] action create
    * directory[/opt/gitlab/etc/postgres-exporter/env] action create[2025-07-12T20:47:36+03:00] INFO: directory[/opt/gitlab/etc/postgres-exporter/env] created directory /opt/gitlab/etc/postgres-exporter/env

      [32m- create new directory /opt/gitlab/etc/postgres-exporter/env[0m
    * file[/opt/gitlab/etc/postgres-exporter/env/SSL_CERT_DIR] action create[2025-07-12T20:47:36+03:00] INFO: file[/opt/gitlab/etc/postgres-exporter/env/SSL_CERT_DIR] created file /opt/gitlab/etc/postgres-exporter/env/SSL_CERT_DIR

      [32m- create new file /opt/gitlab/etc/postgres-exporter/env/SSL_CERT_DIR[0m[2025-07-12T20:47:36+03:00] INFO: file[/opt/gitlab/etc/postgres-exporter/env/SSL_CERT_DIR] updated file contents /opt/gitlab/etc/postgres-exporter/env/SSL_CERT_DIR

      [32m- update content in file /opt/gitlab/etc/postgres-exporter/env/SSL_CERT_DIR from none to 4f45cf[0m
      [32m- suppressed sensitive resource[0m
    * file[/opt/gitlab/etc/postgres-exporter/env/DATA_SOURCE_NAME] action create[2025-07-12T20:47:36+03:00] INFO: file[/opt/gitlab/etc/postgres-exporter/env/DATA_SOURCE_NAME] created file /opt/gitlab/etc/postgres-exporter/env/DATA_SOURCE_NAME

      [32m- create new file /opt/gitlab/etc/postgres-exporter/env/DATA_SOURCE_NAME[0m[2025-07-12T20:47:36+03:00] INFO: file[/opt/gitlab/etc/postgres-exporter/env/DATA_SOURCE_NAME] updated file contents /opt/gitlab/etc/postgres-exporter/env/DATA_SOURCE_NAME

      [32m- update content in file /opt/gitlab/etc/postgres-exporter/env/DATA_SOURCE_NAME from none to af4c92[0m
      [32m- suppressed sensitive resource[0m
  
  * service[postgres-exporter] action nothing (skipped due to action :nothing)
  * runit_service[postgres-exporter] action enable
    * ruby_block[restart_service] action nothing (skipped due to action :nothing)
    * ruby_block[restart_log_service] action nothing (skipped due to action :nothing)
    * ruby_block[reload_log_service] action nothing (skipped due to action :nothing)
    * directory[/opt/gitlab/sv/postgres-exporter] action create[2025-07-12T20:47:36+03:00] INFO: directory[/opt/gitlab/sv/postgres-exporter] created directory /opt/gitlab/sv/postgres-exporter

      [32m- create new directory /opt/gitlab/sv/postgres-exporter[0m[2025-07-12T20:47:36+03:00] INFO: directory[/opt/gitlab/sv/postgres-exporter] owner changed to 0
[2025-07-12T20:47:36+03:00] INFO: directory[/opt/gitlab/sv/postgres-exporter] group changed to 0
[2025-07-12T20:47:36+03:00] INFO: directory[/opt/gitlab/sv/postgres-exporter] mode changed to 755

      [32m- change mode from '' to '0755'[0m
      [32m- change owner from '' to 'root'[0m
      [32m- change group from '' to 'root'[0m
    * template[/opt/gitlab/sv/postgres-exporter/run] action create[2025-07-12T20:47:36+03:00] INFO: template[/opt/gitlab/sv/postgres-exporter/run] created file /opt/gitlab/sv/postgres-exporter/run

      [32m- create new file /opt/gitlab/sv/postgres-exporter/run[0m[2025-07-12T20:47:36+03:00] INFO: template[/opt/gitlab/sv/postgres-exporter/run] updated file contents /opt/gitlab/sv/postgres-exporter/run

      [32m- update content in file /opt/gitlab/sv/postgres-exporter/run from none to 6d0bb3[0m
      [37m--- /opt/gitlab/sv/postgres-exporter/run	2025-07-12 20:47:36.851950115 +0300[0m
      [37m+++ /opt/gitlab/sv/postgres-exporter/.chef-run20250712-17810-3eqqmg	2025-07-12 20:47:36.851950115 +0300[0m
      [37m@@ -1,6 +1,12 @@[0m
      [37m+#!/bin/sh[0m
      [37m+exec 2>&1[0m
      [37m+[0m
      [37m+umask 077[0m
      [37m+exec chpst -e /opt/gitlab/etc/postgres-exporter/env -P -U gitlab-psql:git -u gitlab-psql:git /opt/gitlab/embedded/bin/postgres_exporter --no-collector.stat_user_tables --collector.postmaster --web.listen-address=localhost:9187 --extend.query-path=/var/opt/gitlab/postgres-exporter/queries.yaml[0m
      [37m+[0m[2025-07-12T20:47:36+03:00] INFO: template[/opt/gitlab/sv/postgres-exporter/run] owner changed to 0
[2025-07-12T20:47:36+03:00] INFO: template[/opt/gitlab/sv/postgres-exporter/run] group changed to 0
[2025-07-12T20:47:36+03:00] INFO: template[/opt/gitlab/sv/postgres-exporter/run] mode changed to 755

      [32m- change mode from '' to '0755'[0m
      [32m- change owner from '' to 'root'[0m
      [32m- change group from '' to 'root'[0m
    * directory[/opt/gitlab/sv/postgres-exporter/log] action create[2025-07-12T20:47:36+03:00] INFO: directory[/opt/gitlab/sv/postgres-exporter/log] created directory /opt/gitlab/sv/postgres-exporter/log

      [32m- create new directory /opt/gitlab/sv/postgres-exporter/log[0m[2025-07-12T20:47:36+03:00] INFO: directory[/opt/gitlab/sv/postgres-exporter/log] owner changed to 0
[2025-07-12T20:47:36+03:00] INFO: directory[/opt/gitlab/sv/postgres-exporter/log] group changed to 0
[2025-07-12T20:47:36+03:00] INFO: directory[/opt/gitlab/sv/postgres-exporter/log] mode changed to 755

      [32m- change mode from '' to '0755'[0m
      [32m- change owner from '' to 'root'[0m
      [32m- change group from '' to 'root'[0m
    * directory[/opt/gitlab/sv/postgres-exporter/log/main] action create[2025-07-12T20:47:36+03:00] INFO: directory[/opt/gitlab/sv/postgres-exporter/log/main] created directory /opt/gitlab/sv/postgres-exporter/log/main

      [32m- create new directory /opt/gitlab/sv/postgres-exporter/log/main[0m[2025-07-12T20:47:36+03:00] INFO: directory[/opt/gitlab/sv/postgres-exporter/log/main] owner changed to 0
[2025-07-12T20:47:36+03:00] INFO: directory[/opt/gitlab/sv/postgres-exporter/log/main] group changed to 0
[2025-07-12T20:47:36+03:00] INFO: directory[/opt/gitlab/sv/postgres-exporter/log/main] mode changed to 755

      [32m- change mode from '' to '0755'[0m
      [32m- change owner from '' to 'root'[0m
      [32m- change group from '' to 'root'[0m
    * template[/opt/gitlab/sv/postgres-exporter/log/config] action create[2025-07-12T20:47:36+03:00] INFO: template[/opt/gitlab/sv/postgres-exporter/log/config] created file /opt/gitlab/sv/postgres-exporter/log/config

      [32m- create new file /opt/gitlab/sv/postgres-exporter/log/config[0m[2025-07-12T20:47:36+03:00] INFO: template[/opt/gitlab/sv/postgres-exporter/log/config] updated file contents /opt/gitlab/sv/postgres-exporter/log/config

      [32m- update content in file /opt/gitlab/sv/postgres-exporter/log/config from none to 623c00[0m
      [37m--- /opt/gitlab/sv/postgres-exporter/log/config	2025-07-12 20:47:36.875938115 +0300[0m
      [37m+++ /opt/gitlab/sv/postgres-exporter/log/.chef-config20250712-17810-vh0ue3	2025-07-12 20:47:36.875938115 +0300[0m
      [37m@@ -1,6 +1,12 @@[0m
      [37m+s209715200[0m
      [37m+n30[0m
      [37m+t86400[0m
      [37m+!gzip[0m
      [37m+[0m
      [37m+[0m[2025-07-12T20:47:36+03:00] INFO: template[/opt/gitlab/sv/postgres-exporter/log/config] owner changed to 0
[2025-07-12T20:47:36+03:00] INFO: template[/opt/gitlab/sv/postgres-exporter/log/config] group changed to 0
[2025-07-12T20:47:36+03:00] INFO: template[/opt/gitlab/sv/postgres-exporter/log/config] mode changed to 644

      [32m- change mode from '' to '0644'[0m
      [32m- change owner from '' to 'root'[0m
      [32m- change group from '' to 'root'[0m
    * ruby_block[verify_chown_persisted_on_postgres-exporter] action nothing (skipped due to action :nothing)
[2025-07-12T20:47:36+03:00] INFO: ruby_block[verify_chown_persisted_on_postgres-exporter] sent create action to ruby_block[verify_chown_persisted_on_postgres-exporter] (immediate at declaration time)
    * ruby_block[verify_chown_persisted_on_postgres-exporter] action create[2025-07-12T20:47:36+03:00] INFO: ruby_block[verify_chown_persisted_on_postgres-exporter] called

      [32m- execute the ruby block verify_chown_persisted_on_postgres-exporter[0m
    * link[/var/log/gitlab/postgres-exporter/config] action create[2025-07-12T20:47:36+03:00] INFO: link[/var/log/gitlab/postgres-exporter/config] created

      [32m- create symlink at /var/log/gitlab/postgres-exporter/config to /opt/gitlab/sv/postgres-exporter/log/config[0m
    * template[/opt/gitlab/sv/postgres-exporter/log/run] action create[2025-07-12T20:47:36+03:00] INFO: template[/opt/gitlab/sv/postgres-exporter/log/run] created file /opt/gitlab/sv/postgres-exporter/log/run

      [32m- create new file /opt/gitlab/sv/postgres-exporter/log/run[0m[2025-07-12T20:47:36+03:00] INFO: template[/opt/gitlab/sv/postgres-exporter/log/run] updated file contents /opt/gitlab/sv/postgres-exporter/log/run

      [32m- update content in file /opt/gitlab/sv/postgres-exporter/log/run from none to fd2977[0m
      [37m--- /opt/gitlab/sv/postgres-exporter/log/run	2025-07-12 20:47:36.891930115 +0300[0m
      [37m+++ /opt/gitlab/sv/postgres-exporter/log/.chef-run20250712-17810-bwz708	2025-07-12 20:47:36.891930115 +0300[0m
      [37m@@ -1,5 +1,10 @@[0m
      [37m+#!/bin/sh[0m
      [37m+exec chpst -P \[0m
      [37m+  -U root:root \[0m
      [37m+  -u root:root \[0m
      [37m+  svlogd -tt /var/log/gitlab/postgres-exporter[0m[2025-07-12T20:47:36+03:00] INFO: template[/opt/gitlab/sv/postgres-exporter/log/run] owner changed to 0
[2025-07-12T20:47:36+03:00] INFO: template[/opt/gitlab/sv/postgres-exporter/log/run] group changed to 0
[2025-07-12T20:47:36+03:00] INFO: template[/opt/gitlab/sv/postgres-exporter/log/run] mode changed to 755

      [32m- change mode from '' to '0755'[0m
      [32m- change owner from '' to 'root'[0m
      [32m- change group from '' to 'root'[0m
    * directory[/opt/gitlab/sv/postgres-exporter/env] action create[2025-07-12T20:47:36+03:00] INFO: directory[/opt/gitlab/sv/postgres-exporter/env] created directory /opt/gitlab/sv/postgres-exporter/env

      [32m- create new directory /opt/gitlab/sv/postgres-exporter/env[0m[2025-07-12T20:47:36+03:00] INFO: directory[/opt/gitlab/sv/postgres-exporter/env] owner changed to 0
[2025-07-12T20:47:36+03:00] INFO: directory[/opt/gitlab/sv/postgres-exporter/env] group changed to 0
[2025-07-12T20:47:36+03:00] INFO: directory[/opt/gitlab/sv/postgres-exporter/env] mode changed to 755

      [32m- change mode from '' to '0755'[0m
      [32m- change owner from '' to 'root'[0m
      [32m- change group from '' to 'root'[0m
    * ruby_block[Delete unmanaged env files for postgres-exporter service] action run (skipped due to only_if)
    * template[/opt/gitlab/sv/postgres-exporter/check] action create (skipped due to only_if)
    * template[/opt/gitlab/sv/postgres-exporter/finish] action create (skipped due to only_if)
    * directory[/opt/gitlab/sv/postgres-exporter/control] action create[2025-07-12T20:47:36+03:00] INFO: directory[/opt/gitlab/sv/postgres-exporter/control] created directory /opt/gitlab/sv/postgres-exporter/control

      [32m- create new directory /opt/gitlab/sv/postgres-exporter/control[0m[2025-07-12T20:47:36+03:00] INFO: directory[/opt/gitlab/sv/postgres-exporter/control] owner changed to 0
[2025-07-12T20:47:36+03:00] INFO: directory[/opt/gitlab/sv/postgres-exporter/control] group changed to 0
[2025-07-12T20:47:36+03:00] INFO: directory[/opt/gitlab/sv/postgres-exporter/control] mode changed to 755

      [32m- change mode from '' to '0755'[0m
      [32m- change owner from '' to 'root'[0m
      [32m- change group from '' to 'root'[0m
    * link[/opt/gitlab/init/postgres-exporter] action create[2025-07-12T20:47:36+03:00] INFO: link[/opt/gitlab/init/postgres-exporter] created

      [32m- create symlink at /opt/gitlab/init/postgres-exporter to /opt/gitlab/embedded/bin/sv[0m
    * file[/opt/gitlab/sv/postgres-exporter/down] action nothing (skipped due to action :nothing)
[2025-07-12T20:47:36+03:00] INFO: template[/opt/gitlab/sv/postgres-exporter/run] sending run action to ruby_block[restart_service] (delayed)
    * ruby_block[restart_service] action run (skipped due to only_if)
[2025-07-12T20:47:36+03:00] INFO: template[/opt/gitlab/sv/postgres-exporter/log/config] sending create action to ruby_block[reload_log_service] (delayed)
    * ruby_block[reload_log_service] action create
      * ruby_block[restart_service] action nothing (skipped due to action :nothing)
      * ruby_block[restart_log_service] action nothing (skipped due to action :nothing)
      * ruby_block[reload_log_service] action nothing (skipped due to action :nothing)
      * directory[/opt/gitlab/sv/postgres-exporter] action create (up to date)
      * template[/opt/gitlab/sv/postgres-exporter/run] action create (up to date)
      * directory[/opt/gitlab/sv/postgres-exporter/log] action create (up to date)
      * directory[/opt/gitlab/sv/postgres-exporter/log/main] action create (up to date)
      * template[/opt/gitlab/sv/postgres-exporter/log/config] action create (up to date)
      * ruby_block[verify_chown_persisted_on_postgres-exporter] action nothing (skipped due to action :nothing)
      * link[/var/log/gitlab/postgres-exporter/config] action create (up to date)
      * template[/opt/gitlab/sv/postgres-exporter/log/run] action create (up to date)
      * directory[/opt/gitlab/sv/postgres-exporter/env] action create (up to date)
      * ruby_block[Delete unmanaged env files for postgres-exporter service] action run (skipped due to only_if)
      * template[/opt/gitlab/sv/postgres-exporter/check] action create (skipped due to only_if)
      * template[/opt/gitlab/sv/postgres-exporter/finish] action create (skipped due to only_if)
      * directory[/opt/gitlab/sv/postgres-exporter/control] action create (up to date)
      * link[/opt/gitlab/init/postgres-exporter] action create (up to date)
      * file[/opt/gitlab/sv/postgres-exporter/down] action nothing (skipped due to action :nothing)
      * directory[/opt/gitlab/service] action create (up to date)
      * link[/opt/gitlab/service/postgres-exporter] action create[2025-07-12T20:47:36+03:00] INFO: link[/opt/gitlab/service/postgres-exporter] created

        [32m- create symlink at /opt/gitlab/service/postgres-exporter to /opt/gitlab/sv/postgres-exporter[0m
      * ruby_block[wait for postgres-exporter service socket] action run[2025-07-12T20:47:39+03:00] INFO: ruby_block[wait for postgres-exporter service socket] called

        [32m- execute the ruby block wait for postgres-exporter service socket[0m
      * file[/var/log/gitlab/postgres-exporter/current] action touch (skipped due to only_if)
[2025-07-12T20:47:41+03:00] INFO: ruby_block[reload_log_service] called
      [32m- execute the ruby block reload_log_service[0m
[2025-07-12T20:47:41+03:00] INFO: template[/opt/gitlab/sv/postgres-exporter/log/run] sending run action to ruby_block[restart_log_service] (delayed)
    * ruby_block[restart_log_service] action run
      * ruby_block[restart_service] action nothing (skipped due to action :nothing)
      * ruby_block[restart_log_service] action nothing (skipped due to action :nothing)
      * ruby_block[reload_log_service] action nothing (skipped due to action :nothing)
      * directory[/opt/gitlab/sv/postgres-exporter] action create (up to date)
      * template[/opt/gitlab/sv/postgres-exporter/run] action create (up to date)
      * directory[/opt/gitlab/sv/postgres-exporter/log] action create (up to date)
      * directory[/opt/gitlab/sv/postgres-exporter/log/main] action create (up to date)
      * template[/opt/gitlab/sv/postgres-exporter/log/config] action create (up to date)
      * ruby_block[verify_chown_persisted_on_postgres-exporter] action nothing (skipped due to action :nothing)
      * link[/var/log/gitlab/postgres-exporter/config] action create (up to date)
      * template[/opt/gitlab/sv/postgres-exporter/log/run] action create (up to date)
      * directory[/opt/gitlab/sv/postgres-exporter/env] action create (up to date)
      * ruby_block[Delete unmanaged env files for postgres-exporter service] action run (skipped due to only_if)
      * template[/opt/gitlab/sv/postgres-exporter/check] action create (skipped due to only_if)
      * template[/opt/gitlab/sv/postgres-exporter/finish] action create (skipped due to only_if)
      * directory[/opt/gitlab/sv/postgres-exporter/control] action create (up to date)
      * link[/opt/gitlab/init/postgres-exporter] action create (up to date)
      * file[/opt/gitlab/sv/postgres-exporter/down] action nothing (skipped due to action :nothing)
      * directory[/opt/gitlab/service] action create (up to date)
      * link[/opt/gitlab/service/postgres-exporter] action create (up to date)
      * ruby_block[wait for postgres-exporter service socket] action run (skipped due to not_if)
      * file[/var/log/gitlab/postgres-exporter/current] action touch (skipped due to only_if)
[2025-07-12T20:47:42+03:00] INFO: ruby_block[restart_log_service] called
      [32m- execute the ruby block restart_log_service[0m
    * directory[/opt/gitlab/service] action create (up to date)
    * link[/opt/gitlab/service/postgres-exporter] action create (up to date)
    * ruby_block[wait for postgres-exporter service socket] action run (skipped due to not_if)
    * file[/var/log/gitlab/postgres-exporter/current] action touch (skipped due to only_if)
  
  * template[/var/opt/gitlab/postgres-exporter/queries.yaml] action create[2025-07-12T20:47:42+03:00] INFO: template[/var/opt/gitlab/postgres-exporter/queries.yaml] created file /var/opt/gitlab/postgres-exporter/queries.yaml

    [32m- create new file /var/opt/gitlab/postgres-exporter/queries.yaml[0m[2025-07-12T20:47:42+03:00] INFO: template[/var/opt/gitlab/postgres-exporter/queries.yaml] updated file contents /var/opt/gitlab/postgres-exporter/queries.yaml

    [32m- update content in file /var/opt/gitlab/postgres-exporter/queries.yaml from none to 1fcf7b[0m
    [37m--- /var/opt/gitlab/postgres-exporter/queries.yaml	2025-07-12 20:47:42.433158114 +0300[0m
    [37m+++ /var/opt/gitlab/postgres-exporter/.chef-queries20250712-17810-kr2wxh.yaml	2025-07-12 20:47:42.433158114 +0300[0m
    [37m@@ -1,387 +1,774 @@[0m
    [37m+pg_total_relation_size:[0m
    [37m+  query: |[0m
    [37m+    SELECT relnamespace::regnamespace as schemaname,[0m
    [37m+           relname as relname,[0m
    [37m+           pg_total_relation_size(oid) bytes[0m
    [37m+      FROM pg_class[0m
    [37m+     WHERE relkind = 'r';[0m
    [37m+  metrics:[0m
    [37m+    - schemaname:[0m
    [37m+        usage: "LABEL"[0m
    [37m+        description: "Name of the schema that this table is in"[0m
    [37m+    - relname:[0m
    [37m+        usage: "LABEL"[0m
    [37m+        description: "Name of this table"[0m
    [37m+    - bytes:[0m
    [37m+        usage: "GAUGE"[0m
    [37m+        description: "total disk space usage for the specified table and associated indexes"[0m
    [37m+[0m
    [37m+pg_blocked:[0m
    [37m+  query: |[0m
    [37m+    SELECT[0m
    [37m+      count(blocked.transactionid) AS queries,[0m
    [37m+      '__transaction__' AS table[0m
    [37m+    FROM pg_catalog.pg_locks blocked[0m
    [37m+    WHERE NOT blocked.granted AND locktype = 'transactionid'[0m
    [37m+    GROUP BY locktype[0m
    [37m+    UNION[0m
    [37m+    SELECT[0m
    [37m+      count(blocked.relation) AS queries,[0m
    [37m+      blocked.relation::regclass::text AS table[0m
    [37m+    FROM pg_catalog.pg_locks blocked[0m
    [37m+    WHERE NOT blocked.granted AND locktype != 'transactionid'[0m
    [37m+    GROUP BY relation[0m
    [37m+  metrics:[0m
    [37m+    - queries:[0m
    [37m+        usage: "GAUGE"[0m
    [37m+        description: "The current number of blocked queries"[0m
    [37m+    - table:[0m
    [37m+        usage: "LABEL"[0m
    [37m+        description: "The table on which a query is blocked"[0m
    [37m+[0m
    [37m+pg_oldest_blocked:[0m
    [37m+  query: |[0m
    [37m+    SELECT coalesce(extract('epoch' from max(clock_timestamp() - state_change)), 0) age_seconds[0m
    [37m+      FROM pg_stat_activity[0m
    [37m+     WHERE wait_event_type = 'Lock'[0m
    [37m+       AND state='active'[0m
    [37m+  metrics:[0m
    [37m+    - age_seconds:[0m
    [37m+        usage: "GAUGE"[0m
    [37m+        description: "Largest number of seconds any transaction is currently waiting on a lock"[0m
    [37m+[0m
    [37m+pg_slow:[0m
    [37m+  query: |[0m
    [37m+    SELECT COUNT(*) AS queries[0m
    [37m+    FROM pg_stat_activity[0m
    [37m+    WHERE state = 'active' AND (now() - query_start) > '1 seconds'::interval[0m
    [37m+  metrics:[0m
    [37m+    - queries:[0m
    [37m+        usage: "GAUGE"[0m
    [37m+        description: "Current number of slow queries"[0m
    [37m+[0m
    [37m+pg_long_running_transactions:[0m
    [37m+  query: |[0m
    [37m+    SELECT COUNT(*) as transactions,[0m
    [37m+    coalesce(MAX(EXTRACT(EPOCH FROM (clock_timestamp() - xact_start))), 0) AS age_in_seconds[0m
    [37m+    FROM pg_stat_activity[0m
    [37m+    WHERE state is distinct from 'idle' AND (now() - xact_start) > '1 minutes'::interval AND query not like 'autovacuum:%'[0m
    [37m+  metrics:[0m
    [37m+    - transactions:[0m
    [37m+        usage: "GAUGE"[0m
    [37m+        description: "Current number of long running transactions"[0m
    [37m+    - age_in_seconds:[0m
    [37m+        usage: "GAUGE"[0m
    [37m+        description: "The current maximum transaction age in seconds"[0m
    [37m+[0m
    [37m+pg_stuck_idle_in_transaction:[0m
    [37m+  query: |[0m
    [37m+    SELECT COUNT(*) AS queries[0m
    [37m+    FROM pg_stat_activity[0m
    [37m+    WHERE state = 'idle in transaction' AND (now() - query_start) > '10 minutes'::interval[0m
    [37m+  metrics:[0m
    [37m+    - queries:[0m
    [37m+        usage: "GAUGE"[0m
    [37m+        description: "Current number of queries that are stuck being idle in transactions"[0m
    [37m+[0m
    [37m+# All xid and lsn metrics here are reported mod 2^52 to ensure they[0m
    [37m+# fit within a float for Prometheus :( Really annoying that counters[0m
    [37m+# aren't stored in a 64-bit integer. Note that for queries that report[0m
    [37m+# floats this only works because postgres_exporter does know to set[0m
    [37m+# extra_float_digits (which it sets to 2). So they don't print in[0m
    [37m+# exponential notation and precision is maintained up to 2^53-1.[0m
    [37m+[0m
    [37m+pg_vacuum:[0m
    [37m+  query: |[0m
    [37m+    SELECT[0m
    [37m+      COUNT(*) AS queries,[0m
    [37m+      MAX(EXTRACT(EPOCH FROM (clock_timestamp() - query_start))) AS age_in_seconds[0m
    [37m+    FROM pg_catalog.pg_stat_activity[0m
    [37m+    WHERE state = 'active' AND trim(query) ~* '\AVACUUM (?!ANALYZE)'[0m
    [37m+  metrics:[0m
    [37m+    - queries:[0m
    [37m+        usage: "GAUGE"[0m
    [37m+        description: "The current number of VACUUM queries"[0m
    [37m+    - age_in_seconds:[0m
    [37m+        usage: "GAUGE"[0m
    [37m+        description: "The current maximum VACUUM query age in seconds"[0m
    [37m+[0m
    [37m+pg_vacuum_analyze:[0m
    [37m+  query: |[0m
    [37m+    SELECT[0m
    [37m+      COUNT(*) AS queries,[0m
    [37m+      MAX(EXTRACT(EPOCH FROM (clock_timestamp() - query_start))) AS age_in_seconds[0m
    [37m+    FROM pg_catalog.pg_stat_activity[0m
    [37m+    WHERE state = 'active' AND trim(query) ~* '\AVACUUM ANALYZE'[0m
    [37m+  metrics:[0m
    [37m+    - queries:[0m
    [37m+        usage: "GAUGE"[0m
    [37m+        description: "The current number of VACUUM ANALYZE queries"[0m
    [37m+    - age_in_seconds:[0m
    [37m+        usage: "GAUGE"[0m
    [37m+        description: "The current maximum VACUUM ANALYZE query age in seconds"[0m
    [37m+[0m
    [37m+pg_stuck_idle_in_transaction:[0m
    [37m+  query: |[0m
    [37m+    SELECT COUNT(*) AS queries[0m
    [37m+    FROM pg_stat_activity[0m
    [37m+    WHERE state = 'idle in transaction' AND (now() - query_start) > '10 minutes'::interval[0m
    [37m+  metrics:[0m
    [37m+    - queries:[0m
    [37m+        usage: "GAUGE"[0m
    [37m+        description: "Current number of queries that are stuck being idle in transactions"[0m
    [37m+[0m
    [37m+pg_vacuum_queue:[0m
    [37m+  #master: true [0m
    [37m+  # Until postgres_exporter is upgraded. See [0m
    [37m+  # https://gitlab.com/gitlab-org/omnibus-gitlab/issues/4887[0m
    [37m+  query: |[0m
    [37m+    with table_opts_vs_statistic as ([0m
    [37m+      select[0m
    [37m+        pg_class.oid,[0m
    [37m+        pg_class.relname,[0m
    [37m+        coalesce(nspname, 'public') as schemaname,[0m
    [37m+        pg_class.relpages,[0m
    [37m+        pg_class.reltuples,[0m
    [37m+        case[0m
    [37m+          when array_to_string(reloptions, '') like '%autovacuum_vacuum_threshold%' then regexp_replace(array_to_string(reloptions, ''), '.*autovacuum_vacuum_threshold=([0-9.]+).*', E'\\1')::int8[0m
    [37m+          else current_setting('autovacuum_vacuum_threshold')::int8[0m
    [37m+        end as autovacuum_vacuum_threshold,[0m
    [37m+        case[0m
    [37m+          when array_to_string(reloptions, '') like '%autovacuum_vacuum_scale_factor%' then regexp_replace(array_to_string(reloptions, ''), '.*autovacuum_vacuum_scale_factor=([0-9.]+).*', E'\\1')::numeric[0m
    [37m+          else current_setting('autovacuum_vacuum_scale_factor')::numeric[0m
    [37m+        end as autovacuum_vacuum_scale_factor,[0m
    [37m+        case when array_to_string(reloptions, '') ~ 'autovacuum_enabled=(false|off)' then false else true end as autovacuum_enabled,[0m
    [37m+        n_dead_tup,[0m
    [37m+        last_autovacuum,[0m
    [37m+        last_vacuum[0m
    [37m+      from pg_class[0m
    [37m+      join pg_namespace ns on relnamespace = ns.oid [0m
    [37m+      join pg_stat_all_tables psat  on psat.relid  = pg_class.oid[0m
    [37m+      where relkind in ('r','m') [0m
    [37m+    ), p as ([0m
    [37m+      select pgspv.*,a.query,a.wait_event_type,a.wait_event,a.query_start[0m
    [37m+      from pg_stat_progress_vacuum pgspv[0m
    [37m+      left join pg_stat_activity a using (pid)[0m
    [37m+    ) [0m
    [37m+    select[0m
    [37m+      table_opts_vs_statistic.schemaname as schemaname,[0m
    [37m+      table_opts_vs_statistic.relname as relname,[0m
    [37m+      round((100 * table_opts_vs_statistic.n_dead_tup::numeric / nullif(table_opts_vs_statistic.reltuples, 0))::numeric, 2) as dead_tup_pct,[0m
    [37m+      table_opts_vs_statistic.reltuples::numeric as reltuples,[0m
    [37m+      table_opts_vs_statistic.n_dead_tup,[0m
    [37m+      (relpages::bigint*8*1024) AS table_size_bytes,[0m
    [37m+      'V. Threshold:' || table_opts_vs_statistic.autovacuum_vacuum_threshold[0m
    [37m+        || ', V. Scale Factor: ' || (table_opts_vs_statistic.autovacuum_vacuum_scale_factor)::numeric *100 ||' %'[0m
    [37m+        || case when not autovacuum_enabled then ', DISABLED' else ', enabled' end as "effective_settings",[0m
    [37m+      case[0m
    [37m+        when last_autovacuum > coalesce(last_vacuum, '0001-01-01') then last_autovacuum::timestamp(0)[0m
    [37m+        when last_vacuum is not null then last_vacuum::timestamp(0)[0m
    [37m+        else null[0m
    [37m+      end as "last_vacuumed",[0m
    [37m+      case[0m
    [37m+        when last_autovacuum > coalesce(last_vacuum, '0001-01-01') then 'auto'[0m
    [37m+        when last_vacuum is not null then 'manual'[0m
    [37m+        else null[0m
    [37m+      end as "type",[0m
    [37m+      coalesce(p.phase, 'in queue') as status,[0m
    [37m+      p.pid as pid,[0m
    [37m+      coalesce  (p.query,'')as  action,[0m
    [37m+      case when p.pid is null then null else coalesce(wait_event_type ||'.'|| wait_event, 'f') end as waiting,[0m
    [37m+      round(100.0 * p.heap_blks_scanned / nullif(p.heap_blks_total, 0), 1) AS scanned_pct,[0m
    [37m+      round(100.0 * p.heap_blks_vacuumed / nullif(p.heap_blks_total, 0), 1) AS vacuumed_pct,[0m
    [37m+      extract ('epoch' from  now()-query_start) elapsed_time[0m
    [37m+    from [0m
    [37m+    table_opts_vs_statistic[0m
    [37m+    full outer join p on p.relid = table_opts_vs_statistic.oid and p.datname = current_database()[0m
    [37m+    where[0m
    [37m+      table_opts_vs_statistic.relpages >= 8[0m
    [37m+      and  autovacuum_vacuum_threshold + (autovacuum_vacuum_scale_factor::numeric * table_opts_vs_statistic.reltuples) < table_opts_vs_statistic.n_dead_tup[0m
    [37m+  metrics:[0m
    [37m+    - schemaname:[0m
    [37m+        usage: "LABEL"[0m
    [37m+        description: "Table Schema"[0m
    [37m+    - relname:[0m
    [37m+        usage: "LABEL"[0m
    [37m+        description: "Table name"[0m
    [37m+    - dead_tup_pct:[0m
    [37m+        usage: "GAUGE"[0m
    [37m+        description: "Estimated dead tuples percent"[0m
    [37m+    - reltuples:[0m
    [37m+        usage: "GAUGE"[0m
    [37m+        description: "Number of tuples in table"[0m
    [37m+    - n_dead_tup:[0m
    [37m+        usage: "GAUGE"[0m
    [37m+        description: "Estimated number of dead tuples"[0m
    [37m+    - table_size_bytes:[0m
    [37m+        usage: "GAUGE"[0m
    [37m+        description: "Estimated table size"[0m
    [37m+    - effective_settings:[0m
    [37m+        usage: "LABEL"[0m
    [37m+        description: "Autovacuums settings"[0m
    [37m+    - last_vacuumed:[0m
    [37m+        usage: "GAUGE"[0m
    [37m+        description: "Last time at which this table was vacuumed"[0m
    [37m+    - type:[0m
    [37m+        usage: "LABEL"[0m
    [37m+        description: "Last vacuum type"[0m
    [37m+    - status:[0m
    [37m+        usage: "LABEL"[0m
    [37m+        description: "Vacuum actual status"[0m
    [37m+    - pid:[0m
    [37m+        usage: "GAUGE"[0m
    [37m+        description: "Vacuum process id"[0m
    [37m+    - action:[0m
    [37m+        usage: "LABEL"[0m
    [37m+        description: "Type of vacuum executed"[0m
    [37m+    - waiting:[0m
    [37m+        usage: "LABEL"[0m
    [37m+        description: "Vacuum queue status"[0m
    [37m+    - scanned_pct:[0m
    [37m+        usage: "GAUGE"[0m
    [37m+        description: "Estimated rows scanned percent"[0m
    [37m+    - vacuumed_pct:[0m
    [37m+        usage: "GAUGE"[0m
    [37m+        description: "Estimated vacuumed rows percent"[0m
    [37m+    - elapsed_time:[0m
    [37m+        usage: "GAUGE"[0m
    [37m+        description: "Elapsed time vacuuming (in seconds)"[0m
    [37m+[0m
    [37m+#[0m
    [37m+# This query extracts marginalia comments from pg_stat_activity and provides a sampled summary of the type of[0m
    [37m+# endpoints that are actively making calls[0m
    [37m+#[0m
    [37m+pg_stat_activity_marginalia_sampler:[0m
    [37m+  query: >[0m
    [37m+    SELECT[0m
    [37m+      usename AS usename,[0m
    [37m+      a.matches[1] AS application,[0m
    [37m+      a.matches[2] AS endpoint,[0m
    [37m+      a.matches[3] AS command,[0m
    [37m+      a.wait_event AS wait_event,[0m
    [37m+      a.state AS state,[0m
    [37m+      a.wait_event_type AS wait_event_type,[0m
    [37m+      COUNT(*) active_count,[0m
    [37m+     MAX(coalesce(age_in_seconds, 0)) AS max_tx_age_in_seconds[0m
    [37m+    FROM ([0m
    [37m+      SELECT[0m
    [37m+        usename,[0m
    [37m+        regexp_matches(query, '^\s*(?:\/\*(?:application:(\w+),?)?(?:correlation_id:\w+,?)?(?:jid:\w+,?)?(?:endpoint_id:([\w/\-\.:\#\s]+),?)?.*?\*\/)?\s*(\w+)') AS matches,[0m
    [37m+        state,[0m
    [37m+        wait_event,[0m
    [37m+        wait_event_type,[0m
    [37m+        EXTRACT(EPOCH FROM (clock_timestamp() - xact_start)) AS age_in_seconds[0m
    [37m+      FROM[0m
    [37m+        pg_stat_activity[0m
    [37m+      ) a[0m
    [37m+    GROUP BY usename, application, endpoint, command, state, wait_event, wait_event_type[0m
    [37m+    ORDER BY active_count DESC[0m
    [37m+  metrics:[0m
    [37m+    - usename:[0m
    [37m+        usage: LABEL[0m
    [37m+        description: The user running the command[0m
    [37m+    - application:[0m
    [37m+        usage: LABEL[0m
    [37m+        description: Name of the application as presented in marginalia comment[0m
    [37m+    - endpoint:[0m
    [37m+        usage: LABEL[0m
    [37m+        description: Name of the web endpoint or sidekiq job as presented in marginalia comment[0m
    [37m+    - command:[0m
    [37m+        usage: LABEL[0m
    [37m+        description: The first word for the running command[0m
    [37m+    - wait_event:[0m
    [37m+        usage: LABEL[0m
    [37m+        description: Wait event  of the activity as presented by pg_stat_activity.wait_event[0m
    [37m+    - state:[0m
    [37m+        usage: LABEL[0m
    [37m+        description: State of the activity as presented by pg_stat_activity.state[0m
    [37m+    - wait_event_type:[0m
    [37m+        usage: LABEL[0m
    [37m+        description: Wait event type of the activity as presented by pg_stat_activity.wait_event_type[0m
    [37m+    - active_count:[0m
    [37m+        usage: GAUGE[0m
    [37m+        description: Number of active queries at time of sample[0m
    [37m+    - max_tx_age_in_seconds:[0m
    [37m+        usage: GAUGE[0m
    [37m+        description: Number of active queries at time of sample[0m
    [37m+[0m
    [37m+# This records long running autovacuum processes. The reason we limit to[0m
    [37m+# long-running processes is to avoid cardinality problems in prometheus. Since[0m
    [37m+# we're only concerned about long running processes we limit the output only to[0m
    [37m+# those that take longer than 5 minutes.[0m
    [37m+pg_stat_activity_autovacuum:[0m
    [37m+  query: >[0m
    [37m+    SELECT[0m
    [37m+      SPLIT_PART(query, '.', 2) AS relname,[0m
    [37m+      EXTRACT(EPOCH FROM (clock_timestamp() - xact_start)) AS age_in_seconds[0m
    [37m+    FROM[0m
    [37m+      pg_stat_activity[0m
    [37m+    WHERE[0m
    [37m+      query like 'autovacuum:%'[0m
    [37m+    AND[0m
    [37m+      EXTRACT(EPOCH FROM (clock_timestamp() - xact_start)) > 300[0m
    [37m+  metrics:[0m
    [37m+    - relname:[0m
    [37m+        usage: LABEL[0m
    [37m+        description: The table being vacuumed[0m
    [37m+    - age_in_seconds:[0m
    [37m+        usage: GAUGE[0m
    [37m+        description: The age of the vacuum process in seconds[0m
    [37m+[0m
    [37m+# Keep track of the number of the total number of autovacuum workers[0m
    [37m+# currently active[0m
    [37m+pg_stat_activity_autovacuum_active:[0m
    [37m+  query: >[0m
    [37m+    SELECT v.phase,[0m
    [37m+           CASE[0m
    [37m+             when a.query ~ '^autovacuum.*to prevent wraparound' then 'wraparound'[0m
    [37m+             when a.query ~* '^vacuum' then 'user'[0m
    [37m+             when a.pid is null then null[0m
    [37m+             ELSE 'regular'[0m
    [37m+           END as mode,[0m
    [37m+           count(1) as workers_count[0m
    [37m+      FROM pg_stat_progress_vacuum v[0m
    [37m+      LEFT JOIN pg_stat_activity a using (pid)[0m
    [37m+     GROUP BY 1,2[0m
    [37m+  metrics:[0m
    [37m+    - phase:[0m
    [37m+        usage: LABEL[0m
    [37m+        description: Vacuum phase[0m
    [37m+    - mode:[0m
    [37m+        usage: LABEL[0m
    [37m+        description: Vacuum mode[0m
    [37m+    - workers_count:[0m
    [37m+        usage: GAUGE[0m
    [37m+        description: The number of active autovacuum workers in this state[0m
    [37m+[0m
    [37m+#[0m
    